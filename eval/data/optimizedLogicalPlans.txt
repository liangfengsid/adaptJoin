==== q1 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=2.7 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=9.83E+31 B)
   +- Sort [c_customer_id#82 ASC NULLS FIRST], true, Statistics(sizeInBytes=9.83E+31 B)
      +- Project [c_customer_id#82], Statistics(sizeInBytes=9.83E+31 B)
         +- Join Inner, (ctr_customer_sk#1 = c_customer_sk#81), Statistics(sizeInBytes=1.26E+32 B)
            :- Project [ctr_customer_sk#1], Statistics(sizeInBytes=1.00E+26 B)
            :  +- Join Inner, (s_store_sk#52 = ctr_store_sk#2), Statistics(sizeInBytes=1.67E+26 B)
            :     :- Project [ctr_customer_sk#1, ctr_store_sk#2], Statistics(sizeInBytes=5.63E+22 B)
            :     :  +- Join Inner, ((cast(ctr_total_return#3 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#103) AND (ctr_store_sk#2 = ctr_store_sk#2#107)), Statistics(sizeInBytes=1.55E+23 B)
            :     :     :- Filter isnotnull(ctr_total_return#3), Statistics(sizeInBytes=339.3 GiB)
            :     :     :  +- Aggregate [sr_customer_sk#7, sr_store_sk#11], [sr_customer_sk#7 AS ctr_customer_sk#1, sr_store_sk#11 AS ctr_store_sk#2, MakeDecimal(sum(UnscaledValue(sr_return_amt#15)),17,2) AS ctr_total_return#3], Statistics(sizeInBytes=339.3 GiB)
            :     :     :     +- Project [sr_customer_sk#7, sr_store_sk#11, sr_return_amt#15], Statistics(sizeInBytes=339.3 GiB)
            :     :     :        +- Join Inner, (sr_returned_date_sk#4 = d_date_sk#24), Statistics(sizeInBytes=452.4 GiB)
            :     :     :           :- Project [sr_returned_date_sk#4, sr_customer_sk#7, sr_store_sk#11, sr_return_amt#15], Statistics(sizeInBytes=4.3 MiB)
            :     :     :           :  +- Filter (isnotnull(sr_returned_date_sk#4) AND (isnotnull(sr_store_sk#11) AND isnotnull(sr_customer_sk#7))), Statistics(sizeInBytes=19.0 MiB)
            :     :     :           :     +- Relation default.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet, Statistics(sizeInBytes=19.0 MiB)
            :     :     :           +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
            :     :     :              +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2000)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :     :     :                 +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :     +- Filter isnotnull((avg(ctr_total_return) * 1.2)#103), Statistics(sizeInBytes=395.9 GiB)
            :     :        +- Aggregate [ctr_store_sk#2], [CheckOverflow((promote_precision(avg(ctr_total_return#3)) * 1.200000), DecimalType(24,7)) AS (avg(ctr_total_return) * 1.2)#103, ctr_store_sk#2 AS ctr_store_sk#2#107], Statistics(sizeInBytes=395.9 GiB)
            :     :           +- Aggregate [sr_customer_sk#7, sr_store_sk#11], [sr_store_sk#11 AS ctr_store_sk#2, MakeDecimal(sum(UnscaledValue(sr_return_amt#15)),17,2) AS ctr_total_return#3], Statistics(sizeInBytes=282.8 GiB)
            :     :              +- Project [sr_customer_sk#7, sr_store_sk#11, sr_return_amt#15], Statistics(sizeInBytes=339.3 GiB)
            :     :                 +- Join Inner, (sr_returned_date_sk#4 = d_date_sk#24), Statistics(sizeInBytes=452.4 GiB)
            :     :                    :- Project [sr_returned_date_sk#4, sr_customer_sk#7, sr_store_sk#11, sr_return_amt#15], Statistics(sizeInBytes=4.3 MiB)
            :     :                    :  +- Filter (isnotnull(sr_returned_date_sk#4) AND isnotnull(sr_store_sk#11)), Statistics(sizeInBytes=19.0 MiB)
            :     :                    :     +- Relation default.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet, Statistics(sizeInBytes=19.0 MiB)
            :     :                    +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
            :     :                       +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2000)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :     :                          +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     +- Project [s_store_sk#52], Statistics(sizeInBytes=2.9 KiB)
            :        +- Filter ((isnotnull(s_state#76) AND (s_state#76 = TN)) AND isnotnull(s_store_sk#52)), Statistics(sizeInBytes=101.7 KiB)
            :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
            +- Project [c_customer_sk#81, c_customer_id#82], Statistics(sizeInBytes=1228.5 KiB)
               +- Filter isnotnull(c_customer_sk#81), Statistics(sizeInBytes=7.8 MiB)
                  +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)

==== q2 ====
== Optimized Logical Plan ==
Sort [d_week_seq1#136 ASC NULLS FIRST], true, Statistics(sizeInBytes=5.55E+35 B)
+- Project [d_week_seq1#136, round(CheckOverflow((promote_precision(sun_sales1#137) / promote_precision(sun_sales2#145)), DecimalType(37,20)), 2) AS round((sun_sales1 / sun_sales2), 2)#296, round(CheckOverflow((promote_precision(mon_sales1#138) / promote_precision(mon_sales2#146)), DecimalType(37,20)), 2) AS round((mon_sales1 / mon_sales2), 2)#297, round(CheckOverflow((promote_precision(tue_sales1#139) / promote_precision(tue_sales2#147)), DecimalType(37,20)), 2) AS round((tue_sales1 / tue_sales2), 2)#298, round(CheckOverflow((promote_precision(wed_sales1#140) / promote_precision(wed_sales2#148)), DecimalType(37,20)), 2) AS round((wed_sales1 / wed_sales2), 2)#299, round(CheckOverflow((promote_precision(thu_sales1#141) / promote_precision(thu_sales2#149)), DecimalType(37,20)), 2) AS round((thu_sales1 / thu_sales2), 2)#300, round(CheckOverflow((promote_precision(fri_sales1#142) / promote_precision(fri_sales2#150)), DecimalType(37,20)), 2) AS round((fri_sales1 / fri_sales2), 2)#301, round(CheckOverflow((promote_precision(sat_sales1#143) / promote_precision(sat_sales2#151)), DecimalType(37,20)), 2) AS round((sat_sales1 / sat_sales2), 2)#302], Statistics(sizeInBytes=5.55E+35 B)
   +- Join Inner, (d_week_seq1#136 = (d_week_seq2#144 - 53)), Statistics(sizeInBytes=5.73E+35 B)
      :- Project [d_week_seq#28 AS d_week_seq1#136, sun_sales#156 AS sun_sales1#137, mon_sales#157 AS mon_sales1#138, tue_sales#158 AS tue_sales1#139, wed_sales#159 AS wed_sales1#140, thu_sales#160 AS thu_sales1#141, fri_sales#161 AS fri_sales1#142, sat_sales#162 AS sat_sales1#143], Statistics(sizeInBytes=672.5 PiB)
      :  +- Join Inner, (d_week_seq#235 = d_week_seq#28), Statistics(sizeInBytes=712.0 PiB)
      :     :- Aggregate [d_week_seq#28], [d_week_seq#28, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Sunday   ) THEN sales_price#153 END)),17,2) AS sun_sales#156, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Monday   ) THEN sales_price#153 END)),17,2) AS mon_sales#157, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Tuesday  ) THEN sales_price#153 END)),17,2) AS tue_sales#158, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Wednesday) THEN sales_price#153 END)),17,2) AS wed_sales#159, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Thursday ) THEN sales_price#153 END)),17,2) AS thu_sales#160, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Friday   ) THEN sales_price#153 END)),17,2) AS fri_sales#161, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Saturday ) THEN sales_price#153 END)),17,2) AS sat_sales#162], Statistics(sizeInBytes=6.8 TiB)
      :     :  +- Project [sales_price#153, d_week_seq#28, d_day_name#38], Statistics(sizeInBytes=4.0 TiB)
      :     :     +- Join Inner, (d_date_sk#24 = sold_date_sk#152), Statistics(sizeInBytes=4.8 TiB)
      :     :        :- Union false, false, Statistics(sizeInBytes=15.5 MiB)
      :     :        :  :- Project [ws_sold_date_sk#163 AS sold_date_sk#152, ws_ext_sales_price#186 AS sales_price#153], Statistics(sizeInBytes=5.1 MiB)
      :     :        :  :  +- Filter isnotnull(ws_sold_date_sk#163), Statistics(sizeInBytes=52.0 MiB)
      :     :        :  :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
      :     :        :  +- Project [cs_sold_date_sk#197 AS sold_date_sk#154, cs_ext_sales_price#220 AS sales_price#155], Statistics(sizeInBytes=10.4 MiB)
      :     :        :     +- Filter isnotnull(cs_sold_date_sk#197), Statistics(sizeInBytes=105.8 MiB)
      :     :        :        +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
      :     :        +- Project [d_date_sk#24, d_week_seq#28, d_day_name#38], Statistics(sizeInBytes=315.9 KiB)
      :     :           +- Filter (isnotnull(d_date_sk#24) AND isnotnull(d_week_seq#28)), Statistics(sizeInBytes=2.5 MiB)
      :     :              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
      :     +- Project [d_week_seq#235], Statistics(sizeInBytes=105.3 KiB)
      :        +- Filter ((isnotnull(d_year#237) AND (d_year#237 = 2001)) AND isnotnull(d_week_seq#235)), Statistics(sizeInBytes=2.5 MiB)
      :           +- Relation default.date_dim[d_date_sk#231,d_date_id#232,d_date#233,d_month_seq#234,d_week_seq#235,d_quarter_seq#236,d_year#237,d_dow#238,d_moy#239,d_dom#240,d_qoy#241,d_fy_year#242,d_fy_quarter_seq#243,d_fy_week_seq#244,d_day_name#245,d_quarter_name#246,d_holiday#247,d_weekend#248,d_following_holiday#249,d_first_dom#250,d_last_dom#251,d_same_day_ly#252,d_same_day_lq#253,d_current_day#254,d_current_week#255,d_current_month#256,d_current_quarter#257,d_current_year#258] parquet, Statistics(sizeInBytes=2.5 MiB)
      +- Project [d_week_seq#28 AS d_week_seq2#144, sun_sales#156 AS sun_sales2#145, mon_sales#157 AS mon_sales2#146, tue_sales#158 AS tue_sales2#147, wed_sales#159 AS wed_sales2#148, thu_sales#160 AS thu_sales2#149, fri_sales#161 AS fri_sales2#150, sat_sales#162 AS sat_sales2#151], Statistics(sizeInBytes=672.5 PiB)
         +- Join Inner, (d_week_seq#263 = d_week_seq#28), Statistics(sizeInBytes=712.0 PiB)
            :- Aggregate [d_week_seq#28], [d_week_seq#28, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Sunday   ) THEN sales_price#153 END)),17,2) AS sun_sales#156, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Monday   ) THEN sales_price#153 END)),17,2) AS mon_sales#157, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Tuesday  ) THEN sales_price#153 END)),17,2) AS tue_sales#158, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Wednesday) THEN sales_price#153 END)),17,2) AS wed_sales#159, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Thursday ) THEN sales_price#153 END)),17,2) AS thu_sales#160, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Friday   ) THEN sales_price#153 END)),17,2) AS fri_sales#161, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Saturday ) THEN sales_price#153 END)),17,2) AS sat_sales#162], Statistics(sizeInBytes=6.8 TiB)
            :  +- Project [sales_price#153, d_week_seq#28, d_day_name#38], Statistics(sizeInBytes=4.0 TiB)
            :     +- Join Inner, (d_date_sk#24 = sold_date_sk#152), Statistics(sizeInBytes=4.8 TiB)
            :        :- Union false, false, Statistics(sizeInBytes=15.5 MiB)
            :        :  :- Project [ws_sold_date_sk#163 AS sold_date_sk#152, ws_ext_sales_price#186 AS sales_price#153], Statistics(sizeInBytes=5.1 MiB)
            :        :  :  +- Filter isnotnull(ws_sold_date_sk#163), Statistics(sizeInBytes=52.0 MiB)
            :        :  :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
            :        :  +- Project [cs_sold_date_sk#197 AS sold_date_sk#154, cs_ext_sales_price#220 AS sales_price#155], Statistics(sizeInBytes=10.4 MiB)
            :        :     +- Filter isnotnull(cs_sold_date_sk#197), Statistics(sizeInBytes=105.8 MiB)
            :        :        +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
            :        +- Project [d_date_sk#24, d_week_seq#28, d_day_name#38], Statistics(sizeInBytes=315.9 KiB)
            :           +- Filter (isnotnull(d_date_sk#24) AND isnotnull(d_week_seq#28)), Statistics(sizeInBytes=2.5 MiB)
            :              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            +- Project [d_week_seq#263], Statistics(sizeInBytes=105.3 KiB)
               +- Filter ((isnotnull(d_year#265) AND (d_year#265 = 2002)) AND isnotnull(d_week_seq#263)), Statistics(sizeInBytes=2.5 MiB)
                  +- Relation default.date_dim[d_date_sk#259,d_date_id#260,d_date#261,d_month_seq#262,d_week_seq#263,d_quarter_seq#264,d_year#265,d_dow#266,d_moy#267,d_dom#268,d_qoy#269,d_fy_year#270,d_fy_quarter_seq#271,d_fy_week_seq#272,d_day_name#273,d_quarter_name#274,d_holiday#275,d_weekend#276,d_following_holiday#277,d_first_dom#278,d_last_dom#279,d_same_day_ly#280,d_same_day_lq#281,d_current_day#282,d_current_week#283,d_current_month#284,d_current_quarter#285,d_current_year#286] parquet, Statistics(sizeInBytes=2.5 MiB)

==== q3 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=4.3 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=766.5 PiB)
   +- Sort [d_year#30 ASC NULLS FIRST, sum_agg#413 DESC NULLS LAST, brand_id#411 ASC NULLS FIRST], true, Statistics(sizeInBytes=766.5 PiB)
      +- Aggregate [d_year#30, i_brand#445, i_brand_id#444], [d_year#30, i_brand_id#444 AS brand_id#411, i_brand#445 AS brand#412, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS sum_agg#413], Statistics(sizeInBytes=766.5 PiB)
         +- Project [d_year#30, ss_ext_sales_price#429, i_brand_id#444, i_brand#445], Statistics(sizeInBytes=766.5 PiB)
            +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=905.9 PiB)
               :- Project [d_year#30, ss_item_sk#416, ss_ext_sales_price#429], Statistics(sizeInBytes=2.4 TiB)
               :  +- Join Inner, (d_date_sk#24 = ss_sold_date_sk#414), Statistics(sizeInBytes=3.1 TiB)
               :     :- Project [d_date_sk#24, d_year#30], Statistics(sizeInBytes=140.4 KiB)
               :     :  +- Filter ((isnotnull(d_moy#32) AND (d_moy#32 = 11)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :     :     +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     +- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_ext_sales_price#429], Statistics(sizeInBytes=22.9 MiB)
               :        +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_item_sk#416)), Statistics(sizeInBytes=141.1 MiB)
               :           +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               +- Project [i_item_sk#437, i_brand_id#444, i_brand#445], Statistics(sizeInBytes=385.0 KiB)
                  +- Filter ((isnotnull(i_manufact_id#450) AND (i_manufact_id#450 = 128)) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
                     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)


==== q4 ==== 
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=14.5 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.69E+112 B)
   +- Sort [customer_id#600 ASC NULLS FIRST, customer_first_name#601 ASC NULLS FIRST, customer_last_name#602 ASC NULLS FIRST, customer_preferred_cust_flag#603 ASC NULLS FIRST, customer_birth_country#604 ASC NULLS FIRST, customer_login#605 ASC NULLS FIRST, customer_email_address#606 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.69E+112 B)
      +- Project [customer_id#600, customer_first_name#601, customer_last_name#602, customer_preferred_cust_flag#603, customer_birth_country#604, customer_login#605, customer_email_address#606], Statistics(sizeInBytes=1.69E+112 B)
         +- Join Inner, ((customer_id#471 = customer_id#640) AND (CASE WHEN (year_total#489 > 0.000000) THEN CheckOverflow((promote_precision(year_total#628) / promote_precision(year_total#489)), DecimalType(38,14)) END > CASE WHEN (year_total#499 > 0.000000) THEN CheckOverflow((promote_precision(year_total#648) / promote_precision(year_total#499)), DecimalType(38,14)) END)), Statistics(sizeInBytes=2.88E+112 B)
            :- Project [customer_id#471, customer_id#600, customer_first_name#601, customer_last_name#602, customer_preferred_cust_flag#603, customer_birth_country#604, customer_login#605, customer_email_address#606, year_total#489, year_total#628, year_total#499], Statistics(sizeInBytes=1.19E+94 B)
            :  +- Join Inner, (customer_id#471 = customer_id#491), Statistics(sizeInBytes=1.30E+94 B)
            :     :- Project [customer_id#471, customer_id#600, customer_first_name#601, customer_last_name#602, customer_preferred_cust_flag#603, customer_birth_country#604, customer_login#605, customer_email_address#606, year_total#489, year_total#628], Statistics(sizeInBytes=5.38E+75 B)
            :     :  +- Join Inner, ((customer_id#471 = customer_id#620) AND (CASE WHEN (year_total#489 > 0.000000) THEN CheckOverflow((promote_precision(year_total#628) / promote_precision(year_total#489)), DecimalType(38,14)) END > CASE WHEN (year_total#479 > 0.000000) THEN CheckOverflow((promote_precision(year_total#608) / promote_precision(year_total#479)), DecimalType(38,14)) END)), Statistics(sizeInBytes=6.78E+75 B)
            :     :     :- Project [customer_id#471, year_total#479, customer_id#600, customer_first_name#601, customer_last_name#602, customer_preferred_cust_flag#603, customer_birth_country#604, customer_login#605, customer_email_address#606, year_total#608, year_total#489], Statistics(sizeInBytes=1.38E+57 B)
            :     :     :  +- Join Inner, (customer_id#471 = customer_id#481), Statistics(sizeInBytes=1.50E+57 B)
            :     :     :     :- Join Inner, (customer_id#600 = customer_id#471), Statistics(sizeInBytes=3.05E+38 B)
            :     :     :     :  :- Filter (isnotnull(year_total#479) AND (year_total#479 > 0.000000)), Statistics(sizeInBytes=7.9 EiB)
            :     :     :     :  :  +- Aggregate [c_customer_id#82, c_first_name#89, c_last_name#90, c_preferred_cust_flag#91, c_birth_country#95, c_login#96, c_email_address#97, d_year#30], [c_customer_id#82 AS customer_id#471, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#431 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#430 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#428 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#429 as decimal(10,2)))), DecimalType(10,2))) / 2.00), DecimalType(14,6))) AS year_total#479], Statistics(sizeInBytes=7.9 EiB)
            :     :     :     :  :     +- Project [c_customer_id#82, c_first_name#89, c_last_name#90, c_preferred_cust_flag#91, c_birth_country#95, c_login#96, c_email_address#97, ss_ext_discount_amt#428, ss_ext_sales_price#429, ss_ext_wholesale_cost#430, ss_ext_list_price#431, d_year#30], Statistics(sizeInBytes=32.8 EiB)
            :     :     :     :  :        +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=34.3 EiB)
            :     :     :     :  :           :- Project [c_customer_id#82, c_first_name#89, c_last_name#90, c_preferred_cust_flag#91, c_birth_country#95, c_login#96, c_email_address#97, ss_sold_date_sk#414, ss_ext_discount_amt#428, ss_ext_sales_price#429, ss_ext_wholesale_cost#430, ss_ext_list_price#431], Statistics(sizeInBytes=249.9 TiB)
            :     :     :     :  :           :  +- Join Inner, (c_customer_sk#81 = ss_customer_sk#417), Statistics(sizeInBytes=260.7 TiB)
            :     :     :     :  :           :     :- Project [c_customer_sk#81, c_customer_id#82, c_first_name#89, c_last_name#90, c_preferred_cust_flag#91, c_birth_country#95, c_login#96, c_email_address#97], Statistics(sizeInBytes=5.7 MiB)
            :     :     :     :  :           :     :  +- Filter (isnotnull(c_customer_sk#81) AND isnotnull(c_customer_id#82)), Statistics(sizeInBytes=7.8 MiB)
            :     :     :     :  :           :     :     +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
            :     :     :     :  :           :     +- Project [ss_sold_date_sk#414, ss_customer_sk#417, ss_ext_discount_amt#428, ss_ext_sales_price#429, ss_ext_wholesale_cost#430, ss_ext_list_price#431], Statistics(sizeInBytes=45.8 MiB)
            :     :     :     :  :           :        +- Filter (isnotnull(ss_customer_sk#417) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
            :     :     :     :  :           :           +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     :     :     :  :           +- Project [d_date_sk#24, d_year#30], Statistics(sizeInBytes=140.4 KiB)
            :     :     :     :  :              +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2001)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :     :     :     :  :                 +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :     :     :  +- Aggregate [c_customer_id#1853, c_first_name#1860, c_last_name#1861, c_preferred_cust_flag#1862, c_birth_country#1866, c_login#1867, c_email_address#1868, d_year#1899], [c_customer_id#1853 AS customer_id#600, c_first_name#1860 AS customer_first_name#601, c_last_name#1861 AS customer_last_name#602, c_preferred_cust_flag#1862 AS customer_preferred_cust_flag#603, c_birth_country#1866 AS customer_birth_country#604, c_login#1867 AS customer_login#605, c_email_address#1868 AS customer_email_address#606, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#1887 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#1886 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#1884 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#1885 as decimal(10,2)))), DecimalType(10,2))) / 2.00), DecimalType(14,6))) AS year_total#608], Statistics(sizeInBytes=29.3 EiB)
            :     :     :     :     +- Project [c_customer_id#1853, c_first_name#1860, c_last_name#1861, c_preferred_cust_flag#1862, c_birth_country#1866, c_login#1867, c_email_address#1868, ss_ext_discount_amt#1884, ss_ext_sales_price#1885, ss_ext_wholesale_cost#1886, ss_ext_list_price#1887, d_year#1899], Statistics(sizeInBytes=32.8 EiB)
            :     :     :     :        +- Join Inner, (ss_sold_date_sk#1870 = d_date_sk#1893), Statistics(sizeInBytes=34.3 EiB)
            :     :     :     :           :- Project [c_customer_id#1853, c_first_name#1860, c_last_name#1861, c_preferred_cust_flag#1862, c_birth_country#1866, c_login#1867, c_email_address#1868, ss_sold_date_sk#1870, ss_ext_discount_amt#1884, ss_ext_sales_price#1885, ss_ext_wholesale_cost#1886, ss_ext_list_price#1887], Statistics(sizeInBytes=249.9 TiB)
            :     :     :     :           :  +- Join Inner, (c_customer_sk#1852 = ss_customer_sk#1873), Statistics(sizeInBytes=260.7 TiB)
            :     :     :     :           :     :- Project [c_customer_sk#1852, c_customer_id#1853, c_first_name#1860, c_last_name#1861, c_preferred_cust_flag#1862, c_birth_country#1866, c_login#1867, c_email_address#1868], Statistics(sizeInBytes=5.7 MiB)
            :     :     :     :           :     :  +- Filter (isnotnull(c_customer_sk#1852) AND isnotnull(c_customer_id#1853)), Statistics(sizeInBytes=7.8 MiB)
            :     :     :     :           :     :     +- Relation default.customer[c_customer_sk#1852,c_customer_id#1853,c_current_cdemo_sk#1854,c_current_hdemo_sk#1855,c_current_addr_sk#1856,c_first_shipto_date_sk#1857,c_first_sales_date_sk#1858,c_salutation#1859,c_first_name#1860,c_last_name#1861,c_preferred_cust_flag#1862,c_birth_day#1863,c_birth_month#1864,c_birth_year#1865,c_birth_country#1866,c_login#1867,c_email_address#1868,c_last_review_date#1869] parquet, Statistics(sizeInBytes=7.8 MiB)
            :     :     :     :           :     +- Project [ss_sold_date_sk#1870, ss_customer_sk#1873, ss_ext_discount_amt#1884, ss_ext_sales_price#1885, ss_ext_wholesale_cost#1886, ss_ext_list_price#1887], Statistics(sizeInBytes=45.8 MiB)
            :     :     :     :           :        +- Filter (isnotnull(ss_customer_sk#1873) AND isnotnull(ss_sold_date_sk#1870)), Statistics(sizeInBytes=141.1 MiB)
            :     :     :     :           :           +- Relation default.store_sales[ss_sold_date_sk#1870,ss_sold_time_sk#1871,ss_item_sk#1872,ss_customer_sk#1873,ss_cdemo_sk#1874,ss_hdemo_sk#1875,ss_addr_sk#1876,ss_store_sk#1877,ss_promo_sk#1878,ss_ticket_number#1879,ss_quantity#1880,ss_wholesale_cost#1881,ss_list_price#1882,ss_sales_price#1883,ss_ext_discount_amt#1884,ss_ext_sales_price#1885,ss_ext_wholesale_cost#1886,ss_ext_list_price#1887,ss_ext_tax#1888,ss_coupon_amt#1889,ss_net_paid#1890,ss_net_paid_inc_tax#1891,ss_net_profit#1892] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     :     :     :           +- Project [d_date_sk#1893, d_year#1899], Statistics(sizeInBytes=140.4 KiB)
            :     :     :     :              +- Filter ((isnotnull(d_year#1899) AND (d_year#1899 = 2002)) AND isnotnull(d_date_sk#1893)), Statistics(sizeInBytes=2.5 MiB)
            :     :     :     :                 +- Relation default.date_dim[d_date_sk#1893,d_date_id#1894,d_date#1895,d_month_seq#1896,d_week_seq#1897,d_quarter_seq#1898,d_year#1899,d_dow#1900,d_moy#1901,d_dom#1902,d_qoy#1903,d_fy_year#1904,d_fy_quarter_seq#1905,d_fy_week_seq#1906,d_day_name#1907,d_quarter_name#1908,d_holiday#1909,d_weekend#1910,d_following_holiday#1911,d_first_dom#1912,d_last_dom#1913,d_same_day_ly#1914,d_same_day_lq#1915,d_current_day#1916,d_current_week#1917,d_current_month#1918,d_current_quarter#1919,d_current_year#1920] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :     :     +- Filter (isnotnull(year_total#489) AND (year_total#489 > 0.000000)), Statistics(sizeInBytes=4.3 EiB)
            :     :     :        +- Aggregate [c_customer_id#2161, c_first_name#2168, c_last_name#2169, c_preferred_cust_flag#2170, c_birth_country#2174, c_login#2175, c_email_address#2176, d_year#2218], [c_customer_id#2161 AS customer_id#481, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#2203 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#2202 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#2200 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#2201 as decimal(10,2)))), DecimalType(10,2))) / 2.00), DecimalType(14,6))) AS year_total#489], Statistics(sizeInBytes=4.3 EiB)
            :     :     :           +- Project [c_customer_id#2161, c_first_name#2168, c_last_name#2169, c_preferred_cust_flag#2170, c_birth_country#2174, c_login#2175, c_email_address#2176, cs_ext_discount_amt#2200, cs_ext_sales_price#2201, cs_ext_wholesale_cost#2202, cs_ext_list_price#2203, d_year#2218], Statistics(sizeInBytes=17.9 EiB)
            :     :     :              +- Join Inner, (cs_sold_date_sk#2178 = d_date_sk#2212), Statistics(sizeInBytes=18.6 EiB)
            :     :     :                 :- Project [c_customer_id#2161, c_first_name#2168, c_last_name#2169, c_preferred_cust_flag#2170, c_birth_country#2174, c_login#2175, c_email_address#2176, cs_sold_date_sk#2178, cs_ext_discount_amt#2200, cs_ext_sales_price#2201, cs_ext_wholesale_cost#2202, cs_ext_list_price#2203], Statistics(sizeInBytes=136.0 TiB)
            :     :     :                 :  +- Join Inner, (c_customer_sk#2160 = cs_bill_customer_sk#2181), Statistics(sizeInBytes=141.9 TiB)
            :     :     :                 :     :- Project [c_customer_sk#2160, c_customer_id#2161, c_first_name#2168, c_last_name#2169, c_preferred_cust_flag#2170, c_birth_country#2174, c_login#2175, c_email_address#2176], Statistics(sizeInBytes=5.7 MiB)
            :     :     :                 :     :  +- Filter (isnotnull(c_customer_sk#2160) AND isnotnull(c_customer_id#2161)), Statistics(sizeInBytes=7.8 MiB)
            :     :     :                 :     :     +- Relation default.customer[c_customer_sk#2160,c_customer_id#2161,c_current_cdemo_sk#2162,c_current_hdemo_sk#2163,c_current_addr_sk#2164,c_first_shipto_date_sk#2165,c_first_sales_date_sk#2166,c_salutation#2167,c_first_name#2168,c_last_name#2169,c_preferred_cust_flag#2170,c_birth_day#2171,c_birth_month#2172,c_birth_year#2173,c_birth_country#2174,c_login#2175,c_email_address#2176,c_last_review_date#2177] parquet, Statistics(sizeInBytes=7.8 MiB)
            :     :     :                 :     +- Project [cs_sold_date_sk#2178, cs_bill_customer_sk#2181, cs_ext_discount_amt#2200, cs_ext_sales_price#2201, cs_ext_wholesale_cost#2202, cs_ext_list_price#2203], Statistics(sizeInBytes=24.9 MiB)
            :     :     :                 :        +- Filter (isnotnull(cs_bill_customer_sk#2181) AND isnotnull(cs_sold_date_sk#2178)), Statistics(sizeInBytes=105.8 MiB)
            :     :     :                 :           +- Relation default.catalog_sales[cs_sold_date_sk#2178,cs_sold_time_sk#2179,cs_ship_date_sk#2180,cs_bill_customer_sk#2181,cs_bill_cdemo_sk#2182,cs_bill_hdemo_sk#2183,cs_bill_addr_sk#2184,cs_ship_customer_sk#2185,cs_ship_cdemo_sk#2186,cs_ship_hdemo_sk#2187,cs_ship_addr_sk#2188,cs_call_center_sk#2189,cs_catalog_page_sk#2190,cs_ship_mode_sk#2191,cs_warehouse_sk#2192,cs_item_sk#2193,cs_promo_sk#2194,cs_order_number#2195,cs_quantity#2196,cs_wholesale_cost#2197,cs_list_price#2198,cs_sales_price#2199,cs_ext_discount_amt#2200,cs_ext_sales_price#2201,cs_ext_wholesale_cost#2202,cs_ext_list_price#2203,cs_ext_tax#2204,cs_coupon_amt#2205,cs_ext_ship_cost#2206,cs_net_paid#2207,cs_net_paid_inc_tax#2208,cs_net_paid_inc_ship#2209,cs_net_paid_inc_ship_tax#2210,cs_net_profit#2211] parquet, Statistics(sizeInBytes=105.8 MiB)
            :     :     :                 +- Project [d_date_sk#2212, d_year#2218], Statistics(sizeInBytes=140.4 KiB)
            :     :     :                    +- Filter ((isnotnull(d_year#2218) AND (d_year#2218 = 2001)) AND isnotnull(d_date_sk#2212)), Statistics(sizeInBytes=2.5 MiB)
            :     :     :                       +- Relation default.date_dim[d_date_sk#2212,d_date_id#2213,d_date#2214,d_month_seq#2215,d_week_seq#2216,d_quarter_seq#2217,d_year#2218,d_dow#2219,d_moy#2220,d_dom#2221,d_qoy#2222,d_fy_year#2223,d_fy_quarter_seq#2224,d_fy_week_seq#2225,d_day_name#2226,d_quarter_name#2227,d_holiday#2228,d_weekend#2229,d_following_holiday#2230,d_first_dom#2231,d_last_dom#2232,d_same_day_ly#2233,d_same_day_lq#2234,d_current_day#2235,d_current_week#2236,d_current_month#2237,d_current_quarter#2238,d_current_year#2239] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :     +- Aggregate [c_customer_id#2400, c_first_name#2407, c_last_name#2408, c_preferred_cust_flag#2409, c_birth_country#2413, c_login#2414, c_email_address#2415, d_year#2457], [c_customer_id#2400 AS customer_id#620, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#2442 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#2441 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#2439 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#2440 as decimal(10,2)))), DecimalType(10,2))) / 2.00), DecimalType(14,6))) AS year_total#628], Statistics(sizeInBytes=4.3 EiB)
            :     :        +- Project [c_customer_id#2400, c_first_name#2407, c_last_name#2408, c_preferred_cust_flag#2409, c_birth_country#2413, c_login#2414, c_email_address#2415, cs_ext_discount_amt#2439, cs_ext_sales_price#2440, cs_ext_wholesale_cost#2441, cs_ext_list_price#2442, d_year#2457], Statistics(sizeInBytes=17.9 EiB)
            :     :           +- Join Inner, (cs_sold_date_sk#2417 = d_date_sk#2451), Statistics(sizeInBytes=18.6 EiB)
            :     :              :- Project [c_customer_id#2400, c_first_name#2407, c_last_name#2408, c_preferred_cust_flag#2409, c_birth_country#2413, c_login#2414, c_email_address#2415, cs_sold_date_sk#2417, cs_ext_discount_amt#2439, cs_ext_sales_price#2440, cs_ext_wholesale_cost#2441, cs_ext_list_price#2442], Statistics(sizeInBytes=136.0 TiB)
            :     :              :  +- Join Inner, (c_customer_sk#2399 = cs_bill_customer_sk#2420), Statistics(sizeInBytes=141.9 TiB)
            :     :              :     :- Project [c_customer_sk#2399, c_customer_id#2400, c_first_name#2407, c_last_name#2408, c_preferred_cust_flag#2409, c_birth_country#2413, c_login#2414, c_email_address#2415], Statistics(sizeInBytes=5.7 MiB)
            :     :              :     :  +- Filter (isnotnull(c_customer_sk#2399) AND isnotnull(c_customer_id#2400)), Statistics(sizeInBytes=7.8 MiB)
            :     :              :     :     +- Relation default.customer[c_customer_sk#2399,c_customer_id#2400,c_current_cdemo_sk#2401,c_current_hdemo_sk#2402,c_current_addr_sk#2403,c_first_shipto_date_sk#2404,c_first_sales_date_sk#2405,c_salutation#2406,c_first_name#2407,c_last_name#2408,c_preferred_cust_flag#2409,c_birth_day#2410,c_birth_month#2411,c_birth_year#2412,c_birth_country#2413,c_login#2414,c_email_address#2415,c_last_review_date#2416] parquet, Statistics(sizeInBytes=7.8 MiB)
            :     :              :     +- Project [cs_sold_date_sk#2417, cs_bill_customer_sk#2420, cs_ext_discount_amt#2439, cs_ext_sales_price#2440, cs_ext_wholesale_cost#2441, cs_ext_list_price#2442], Statistics(sizeInBytes=24.9 MiB)
            :     :              :        +- Filter (isnotnull(cs_bill_customer_sk#2420) AND isnotnull(cs_sold_date_sk#2417)), Statistics(sizeInBytes=105.8 MiB)
            :     :              :           +- Relation default.catalog_sales[cs_sold_date_sk#2417,cs_sold_time_sk#2418,cs_ship_date_sk#2419,cs_bill_customer_sk#2420,cs_bill_cdemo_sk#2421,cs_bill_hdemo_sk#2422,cs_bill_addr_sk#2423,cs_ship_customer_sk#2424,cs_ship_cdemo_sk#2425,cs_ship_hdemo_sk#2426,cs_ship_addr_sk#2427,cs_call_center_sk#2428,cs_catalog_page_sk#2429,cs_ship_mode_sk#2430,cs_warehouse_sk#2431,cs_item_sk#2432,cs_promo_sk#2433,cs_order_number#2434,cs_quantity#2435,cs_wholesale_cost#2436,cs_list_price#2437,cs_sales_price#2438,cs_ext_discount_amt#2439,cs_ext_sales_price#2440,cs_ext_wholesale_cost#2441,cs_ext_list_price#2442,cs_ext_tax#2443,cs_coupon_amt#2444,cs_ext_ship_cost#2445,cs_net_paid#2446,cs_net_paid_inc_tax#2447,cs_net_paid_inc_ship#2448,cs_net_paid_inc_ship_tax#2449,cs_net_profit#2450] parquet, Statistics(sizeInBytes=105.8 MiB)
            :     :              +- Project [d_date_sk#2451, d_year#2457], Statistics(sizeInBytes=140.4 KiB)
            :     :                 +- Filter ((isnotnull(d_year#2457) AND (d_year#2457 = 2002)) AND isnotnull(d_date_sk#2451)), Statistics(sizeInBytes=2.5 MiB)
            :     :                    +- Relation default.date_dim[d_date_sk#2451,d_date_id#2452,d_date#2453,d_month_seq#2454,d_week_seq#2455,d_quarter_seq#2456,d_year#2457,d_dow#2458,d_moy#2459,d_dom#2460,d_qoy#2461,d_fy_year#2462,d_fy_quarter_seq#2463,d_fy_week_seq#2464,d_day_name#2465,d_quarter_name#2466,d_holiday#2467,d_weekend#2468,d_following_holiday#2469,d_first_dom#2470,d_last_dom#2471,d_same_day_ly#2472,d_same_day_lq#2473,d_current_day#2474,d_current_week#2475,d_current_month#2476,d_current_quarter#2477,d_current_year#2478] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     +- Filter (isnotnull(year_total#499) AND (year_total#499 > 0.000000)), Statistics(sizeInBytes=2.1 EiB)
            :        +- Aggregate [c_customer_id#2719, c_first_name#2726, c_last_name#2727, c_preferred_cust_flag#2728, c_birth_country#2732, c_login#2733, c_email_address#2734, d_year#2776], [c_customer_id#2719 AS customer_id#491, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#2761 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#2760 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#2758 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#2759 as decimal(10,2)))), DecimalType(10,2))) / 2.00), DecimalType(14,6))) AS year_total#499], Statistics(sizeInBytes=2.1 EiB)
            :           +- Project [c_customer_id#2719, c_first_name#2726, c_last_name#2727, c_preferred_cust_flag#2728, c_birth_country#2732, c_login#2733, c_email_address#2734, ws_ext_discount_amt#2758, ws_ext_sales_price#2759, ws_ext_wholesale_cost#2760, ws_ext_list_price#2761, d_year#2776], Statistics(sizeInBytes=8.8 EiB)
            :              +- Join Inner, (ws_sold_date_sk#2736 = d_date_sk#2770), Statistics(sizeInBytes=9.2 EiB)
            :                 :- Project [c_customer_id#2719, c_first_name#2726, c_last_name#2727, c_preferred_cust_flag#2728, c_birth_country#2732, c_login#2733, c_email_address#2734, ws_sold_date_sk#2736, ws_ext_discount_amt#2758, ws_ext_sales_price#2759, ws_ext_wholesale_cost#2760, ws_ext_list_price#2761], Statistics(sizeInBytes=66.8 TiB)
            :                 :  +- Join Inner, (c_customer_sk#2718 = ws_bill_customer_sk#2740), Statistics(sizeInBytes=69.7 TiB)
            :                 :     :- Project [c_customer_sk#2718, c_customer_id#2719, c_first_name#2726, c_last_name#2727, c_preferred_cust_flag#2728, c_birth_country#2732, c_login#2733, c_email_address#2734], Statistics(sizeInBytes=5.7 MiB)
            :                 :     :  +- Filter (isnotnull(c_customer_sk#2718) AND isnotnull(c_customer_id#2719)), Statistics(sizeInBytes=7.8 MiB)
            :                 :     :     +- Relation default.customer[c_customer_sk#2718,c_customer_id#2719,c_current_cdemo_sk#2720,c_current_hdemo_sk#2721,c_current_addr_sk#2722,c_first_shipto_date_sk#2723,c_first_sales_date_sk#2724,c_salutation#2725,c_first_name#2726,c_last_name#2727,c_preferred_cust_flag#2728,c_birth_day#2729,c_birth_month#2730,c_birth_year#2731,c_birth_country#2732,c_login#2733,c_email_address#2734,c_last_review_date#2735] parquet, Statistics(sizeInBytes=7.8 MiB)
            :                 :     +- Project [ws_sold_date_sk#2736, ws_bill_customer_sk#2740, ws_ext_discount_amt#2758, ws_ext_sales_price#2759, ws_ext_wholesale_cost#2760, ws_ext_list_price#2761], Statistics(sizeInBytes=12.2 MiB)
            :                 :        +- Filter (isnotnull(ws_bill_customer_sk#2740) AND isnotnull(ws_sold_date_sk#2736)), Statistics(sizeInBytes=52.0 MiB)
            :                 :           +- Relation default.web_sales[ws_sold_date_sk#2736,ws_sold_time_sk#2737,ws_ship_date_sk#2738,ws_item_sk#2739,ws_bill_customer_sk#2740,ws_bill_cdemo_sk#2741,ws_bill_hdemo_sk#2742,ws_bill_addr_sk#2743,ws_ship_customer_sk#2744,ws_ship_cdemo_sk#2745,ws_ship_hdemo_sk#2746,ws_ship_addr_sk#2747,ws_web_page_sk#2748,ws_web_site_sk#2749,ws_ship_mode_sk#2750,ws_warehouse_sk#2751,ws_promo_sk#2752,ws_order_number#2753,ws_quantity#2754,ws_wholesale_cost#2755,ws_list_price#2756,ws_sales_price#2757,ws_ext_discount_amt#2758,ws_ext_sales_price#2759,ws_ext_wholesale_cost#2760,ws_ext_list_price#2761,ws_ext_tax#2762,ws_coupon_amt#2763,ws_ext_ship_cost#2764,ws_net_paid#2765,ws_net_paid_inc_tax#2766,ws_net_paid_inc_ship#2767,ws_net_paid_inc_ship_tax#2768,ws_net_profit#2769] parquet, Statistics(sizeInBytes=52.0 MiB)
            :                 +- Project [d_date_sk#2770, d_year#2776], Statistics(sizeInBytes=140.4 KiB)
            :                    +- Filter ((isnotnull(d_year#2776) AND (d_year#2776 = 2001)) AND isnotnull(d_date_sk#2770)), Statistics(sizeInBytes=2.5 MiB)
            :                       +- Relation default.date_dim[d_date_sk#2770,d_date_id#2771,d_date#2772,d_month_seq#2773,d_week_seq#2774,d_quarter_seq#2775,d_year#2776,d_dow#2777,d_moy#2778,d_dom#2779,d_qoy#2780,d_fy_year#2781,d_fy_quarter_seq#2782,d_fy_week_seq#2783,d_day_name#2784,d_quarter_name#2785,d_holiday#2786,d_weekend#2787,d_following_holiday#2788,d_first_dom#2789,d_last_dom#2790,d_same_day_ly#2791,d_same_day_lq#2792,d_current_day#2793,d_current_week#2794,d_current_month#2795,d_current_quarter#2796,d_current_year#2797] parquet, Statistics(sizeInBytes=2.5 MiB)
            +- Aggregate [c_customer_id#2958, c_first_name#2965, c_last_name#2966, c_preferred_cust_flag#2967, c_birth_country#2971, c_login#2972, c_email_address#2973, d_year#3015], [c_customer_id#2958 AS customer_id#640, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#3000 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#2999 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#2997 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#2998 as decimal(10,2)))), DecimalType(10,2))) / 2.00), DecimalType(14,6))) AS year_total#648], Statistics(sizeInBytes=2.1 EiB)
               +- Project [c_customer_id#2958, c_first_name#2965, c_last_name#2966, c_preferred_cust_flag#2967, c_birth_country#2971, c_login#2972, c_email_address#2973, ws_ext_discount_amt#2997, ws_ext_sales_price#2998, ws_ext_wholesale_cost#2999, ws_ext_list_price#3000, d_year#3015], Statistics(sizeInBytes=8.8 EiB)
                  +- Join Inner, (ws_sold_date_sk#2975 = d_date_sk#3009), Statistics(sizeInBytes=9.2 EiB)
                     :- Project [c_customer_id#2958, c_first_name#2965, c_last_name#2966, c_preferred_cust_flag#2967, c_birth_country#2971, c_login#2972, c_email_address#2973, ws_sold_date_sk#2975, ws_ext_discount_amt#2997, ws_ext_sales_price#2998, ws_ext_wholesale_cost#2999, ws_ext_list_price#3000], Statistics(sizeInBytes=66.8 TiB)
                     :  +- Join Inner, (c_customer_sk#2957 = ws_bill_customer_sk#2979), Statistics(sizeInBytes=69.7 TiB)
                     :     :- Project [c_customer_sk#2957, c_customer_id#2958, c_first_name#2965, c_last_name#2966, c_preferred_cust_flag#2967, c_birth_country#2971, c_login#2972, c_email_address#2973], Statistics(sizeInBytes=5.7 MiB)
                     :     :  +- Filter (isnotnull(c_customer_sk#2957) AND isnotnull(c_customer_id#2958)), Statistics(sizeInBytes=7.8 MiB)
                     :     :     +- Relation default.customer[c_customer_sk#2957,c_customer_id#2958,c_current_cdemo_sk#2959,c_current_hdemo_sk#2960,c_current_addr_sk#2961,c_first_shipto_date_sk#2962,c_first_sales_date_sk#2963,c_salutation#2964,c_first_name#2965,c_last_name#2966,c_preferred_cust_flag#2967,c_birth_day#2968,c_birth_month#2969,c_birth_year#2970,c_birth_country#2971,c_login#2972,c_email_address#2973,c_last_review_date#2974] parquet, Statistics(sizeInBytes=7.8 MiB)
                     :     +- Project [ws_sold_date_sk#2975, ws_bill_customer_sk#2979, ws_ext_discount_amt#2997, ws_ext_sales_price#2998, ws_ext_wholesale_cost#2999, ws_ext_list_price#3000], Statistics(sizeInBytes=12.2 MiB)
                     :        +- Filter (isnotnull(ws_bill_customer_sk#2979) AND isnotnull(ws_sold_date_sk#2975)), Statistics(sizeInBytes=52.0 MiB)
                     :           +- Relation default.web_sales[ws_sold_date_sk#2975,ws_sold_time_sk#2976,ws_ship_date_sk#2977,ws_item_sk#2978,ws_bill_customer_sk#2979,ws_bill_cdemo_sk#2980,ws_bill_hdemo_sk#2981,ws_bill_addr_sk#2982,ws_ship_customer_sk#2983,ws_ship_cdemo_sk#2984,ws_ship_hdemo_sk#2985,ws_ship_addr_sk#2986,ws_web_page_sk#2987,ws_web_site_sk#2988,ws_ship_mode_sk#2989,ws_warehouse_sk#2990,ws_promo_sk#2991,ws_order_number#2992,ws_quantity#2993,ws_wholesale_cost#2994,ws_list_price#2995,ws_sales_price#2996,ws_ext_discount_amt#2997,ws_ext_sales_price#2998,ws_ext_wholesale_cost#2999,ws_ext_list_price#3000,ws_ext_tax#3001,ws_coupon_amt#3002,ws_ext_ship_cost#3003,ws_net_paid#3004,ws_net_paid_inc_tax#3005,ws_net_paid_inc_ship#3006,ws_net_paid_inc_ship_tax#3007,ws_net_profit#3008] parquet, Statistics(sizeInBytes=52.0 MiB)
                     +- Project [d_date_sk#3009, d_year#3015], Statistics(sizeInBytes=140.4 KiB)
                        +- Filter ((isnotnull(d_year#3015) AND (d_year#3015 = 2002)) AND isnotnull(d_date_sk#3009)), Statistics(sizeInBytes=2.5 MiB)
                           +- Relation default.date_dim[d_date_sk#3009,d_date_id#3010,d_date#3011,d_month_seq#3012,d_week_seq#3013,d_quarter_seq#3014,d_year#3015,d_dow#3016,d_moy#3017,d_dom#3018,d_qoy#3019,d_fy_year#3020,d_fy_quarter_seq#3021,d_fy_week_seq#3022,d_day_name#3023,d_quarter_name#3024,d_holiday#3025,d_weekend#3026,d_following_holiday#3027,d_first_dom#3028,d_last_dom#3029,d_same_day_ly#3030,d_same_day_lq#3031,d_current_day#3032,d_current_week#3033,d_current_month#3034,d_current_quarter#3035,d_current_year#3036] parquet, Statistics(sizeInBytes=2.5 MiB)

==== q5 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=9.4 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=7.54E+22 B)
   +- Sort [channel#3492 ASC NULLS FIRST, id#3493 ASC NULLS FIRST], true, Statistics(sizeInBytes=7.54E+22 B)
      +- Aggregate [channel#3492, id#3493, spark_grouping_id#3491L], [channel#3492, id#3493, sum(sales#3255) AS sales#3240, sum(returns#3257) AS returns#3241, sum(profit#3233) AS profit#3242], Statistics(sizeInBytes=7.54E+22 B)
         +- Expand [[sales#3255, returns#3257, profit#3233, channel#3489, id#3490, 0], [sales#3255, returns#3257, profit#3233, channel#3489, null, 1], [sales#3255, returns#3257, profit#3233, null, null, 3]], [sales#3255, returns#3257, profit#3233, channel#3492, id#3493, spark_grouping_id#3491L], Statistics(sizeInBytes=6.28E+22 B)
            +- Union false, false, Statistics(sizeInBytes=1.88E+22 B)
               :- Aggregate [s_store_id#53], [MakeDecimal(sum(UnscaledValue(sales_price#3245)),17,2) AS sales#3255, MakeDecimal(sum(UnscaledValue(return_amt#3247)),17,2) AS returns#3257, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#3246)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#3248)),17,2) as decimal(18,2)))), DecimalType(18,2)) AS profit#3233, store channel AS channel#3489, concat(store, s_store_id#53) AS id#3490], Statistics(sizeInBytes=37.9 PiB)
               :  +- Project [sales_price#3245, profit#3246, return_amt#3247, net_loss#3248, s_store_id#53], Statistics(sizeInBytes=31.6 PiB)
               :     +- Join Inner, (store_sk#3243 = s_store_sk#52), Statistics(sizeInBytes=35.8 PiB)
               :        :- Project [store_sk#3243, sales_price#3245, profit#3246, return_amt#3247, net_loss#3248], Statistics(sizeInBytes=4.6 TiB)
               :        :  +- Join Inner, (date_sk#3244 = d_date_sk#24), Statistics(sizeInBytes=5.5 TiB)
               :        :     :- Union false, false, Statistics(sizeInBytes=53.1 MiB)
               :        :     :  :- Project [ss_store_sk#421 AS store_sk#3243, ss_sold_date_sk#414 AS date_sk#3244, ss_ext_sales_price#429 AS sales_price#3245, ss_net_profit#436 AS profit#3246, 0.00 AS return_amt#3247, 0.00 AS net_loss#3248], Statistics(sizeInBytes=45.8 MiB)
               :        :     :  :  +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421)), Statistics(sizeInBytes=141.1 MiB)
               :        :     :  :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               :        :     :  +- Project [sr_store_sk#11 AS store_sk#3249, sr_returned_date_sk#4 AS date_sk#3250, 0.00 AS sales_price#3251, 0.00 AS profit#3252, sr_return_amt#15 AS return_amt#3253, sr_net_loss#23 AS net_loss#3254], Statistics(sizeInBytes=7.4 MiB)
               :        :     :     +- Filter (isnotnull(sr_returned_date_sk#4) AND isnotnull(sr_store_sk#11)), Statistics(sizeInBytes=19.0 MiB)
               :        :     :        +- Relation default.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet, Statistics(sizeInBytes=19.0 MiB)
               :        :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :        :        +- Filter ((isnotnull(d_date#26) AND ((d_date#26 >= 2000-08-23) AND (d_date#26 <= 2000-09-06))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :        :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :        +- Project [s_store_sk#52, s_store_id#53], Statistics(sizeInBytes=7.7 KiB)
               :           +- Filter isnotnull(s_store_sk#52), Statistics(sizeInBytes=101.7 KiB)
               :              +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
               :- Aggregate [cp_catalog_page_id#3319], [MakeDecimal(sum(UnscaledValue(sales_price#3261)),17,2) AS sales#3271, MakeDecimal(sum(UnscaledValue(return_amt#3263)),17,2) AS returns#3273, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#3262)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#3264)),17,2) as decimal(18,2)))), DecimalType(18,2)) AS profit#3236, catalog channel AS channel#3499, concat(catalog_page, cp_catalog_page_id#3319) AS id#3500], Statistics(sizeInBytes=894.3 PiB)
               :  +- Project [sales_price#3261, profit#3262, return_amt#3263, net_loss#3264, cp_catalog_page_id#3319], Statistics(sizeInBytes=745.3 PiB)
               :     +- Join Inner, (page_sk#3259 = cp_catalog_page_sk#3318), Statistics(sizeInBytes=844.7 PiB)
               :        :- Project [page_sk#3259, sales_price#3261, profit#3262, return_amt#3263, net_loss#3264], Statistics(sizeInBytes=2.5 TiB)
               :        :  +- Join Inner, (date_sk#3260 = d_date_sk#3377), Statistics(sizeInBytes=3.0 TiB)
               :        :     :- Union false, false, Statistics(sizeInBytes=28.9 MiB)
               :        :     :  :- Project [cs_catalog_page_sk#209 AS page_sk#3259, cs_sold_date_sk#197 AS date_sk#3260, cs_ext_sales_price#220 AS sales_price#3261, cs_net_profit#230 AS profit#3262, 0.00 AS return_amt#3263, 0.00 AS net_loss#3264], Statistics(sizeInBytes=24.9 MiB)
               :        :     :  :  +- Filter (isnotnull(cs_sold_date_sk#197) AND isnotnull(cs_catalog_page_sk#209)), Statistics(sizeInBytes=105.8 MiB)
               :        :     :  :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
               :        :     :  +- Project [cr_catalog_page_sk#3303 AS page_sk#3265, cr_returned_date_sk#3291 AS date_sk#3266, 0.00 AS sales_price#3267, 0.00 AS profit#3268, cr_return_amount#3309 AS return_amt#3269, cr_net_loss#3317 AS net_loss#3270], Statistics(sizeInBytes=4.0 MiB)
               :        :     :     +- Filter (isnotnull(cr_returned_date_sk#3291) AND isnotnull(cr_catalog_page_sk#3303)), Statistics(sizeInBytes=12.6 MiB)
               :        :     :        +- Relation default.catalog_returns[cr_returned_date_sk#3291,cr_returned_time_sk#3292,cr_item_sk#3293,cr_refunded_customer_sk#3294,cr_refunded_cdemo_sk#3295,cr_refunded_hdemo_sk#3296,cr_refunded_addr_sk#3297,cr_returning_customer_sk#3298,cr_returning_cdemo_sk#3299,cr_returning_hdemo_sk#3300,cr_returning_addr_sk#3301,cr_call_center_sk#3302,cr_catalog_page_sk#3303,cr_ship_mode_sk#3304,cr_warehouse_sk#3305,cr_reason_sk#3306,cr_order_number#3307,cr_return_quantity#3308,cr_return_amount#3309,cr_return_tax#3310,cr_return_amt_inc_tax#3311,cr_fee#3312,cr_return_ship_cost#3313,cr_refunded_cash#3314,cr_reversed_charge#3315,cr_store_credit#3316,cr_net_loss#3317] parquet, Statistics(sizeInBytes=12.6 MiB)
               :        :     +- Project [d_date_sk#3377], Statistics(sizeInBytes=105.3 KiB)
               :        :        +- Filter ((isnotnull(d_date#3379) AND ((d_date#3379 >= 2000-08-23) AND (d_date#3379 <= 2000-09-06))) AND isnotnull(d_date_sk#3377)), Statistics(sizeInBytes=2.5 MiB)
               :        :           +- Relation default.date_dim[d_date_sk#3377,d_date_id#3378,d_date#3379,d_month_seq#3380,d_week_seq#3381,d_quarter_seq#3382,d_year#3383,d_dow#3384,d_moy#3385,d_dom#3386,d_qoy#3387,d_fy_year#3388,d_fy_quarter_seq#3389,d_fy_week_seq#3390,d_day_name#3391,d_quarter_name#3392,d_holiday#3393,d_weekend#3394,d_following_holiday#3395,d_first_dom#3396,d_last_dom#3397,d_same_day_ly#3398,d_same_day_lq#3399,d_current_day#3400,d_current_week#3401,d_current_month#3402,d_current_quarter#3403,d_current_year#3404] parquet, Statistics(sizeInBytes=2.5 MiB)
               :        +- Project [cp_catalog_page_sk#3318, cp_catalog_page_id#3319], Statistics(sizeInBytes=336.3 KiB)
               :           +- Filter isnotnull(cp_catalog_page_sk#3318), Statistics(sizeInBytes=1134.9 KiB)
               :              +- Relation default.catalog_page[cp_catalog_page_sk#3318,cp_catalog_page_id#3319,cp_start_date_sk#3320,cp_end_date_sk#3321,cp_department#3322,cp_catalog_number#3323,cp_catalog_page_number#3324,cp_description#3325,cp_type#3326] parquet, Statistics(sizeInBytes=1134.9 KiB)
               +- Aggregate [web_site_id#3352], [MakeDecimal(sum(UnscaledValue(sales_price#3277)),17,2) AS sales#3287, MakeDecimal(sum(UnscaledValue(return_amt#3279)),17,2) AS returns#3289, CheckOverflow((promote_precision(cast(MakeDecimal(sum(UnscaledValue(profit#3278)),17,2) as decimal(18,2))) - promote_precision(cast(MakeDecimal(sum(UnscaledValue(net_loss#3280)),17,2) as decimal(18,2)))), DecimalType(18,2)) AS profit#3239, web channel AS channel#3501, concat(web_site, web_site_id#3352) AS id#3502], Statistics(sizeInBytes=1.88E+22 B)
                  +- Project [sales_price#3277, profit#3278, return_amt#3279, net_loss#3280, web_site_id#3352], Statistics(sizeInBytes=1.57E+22 B)
                     +- Join Inner, (wsr_web_site_sk#3275 = web_site_sk#3351), Statistics(sizeInBytes=1.78E+22 B)
                        :- Project [wsr_web_site_sk#3275, sales_price#3277, profit#3278, return_amt#3279, net_loss#3280], Statistics(sizeInBytes=759.0 PiB)
                        :  +- Join Inner, (date_sk#3276 = d_date_sk#3439), Statistics(sizeInBytes=897.0 PiB)
                        :     :- Union false, false, Statistics(sizeInBytes=8.5 TiB)
                        :     :  :- Project [ws_web_site_sk#176 AS wsr_web_site_sk#3275, ws_sold_date_sk#163 AS date_sk#3276, ws_ext_sales_price#186 AS sales_price#3277, ws_net_profit#196 AS profit#3278, 0.00 AS return_amt#3279, 0.00 AS net_loss#3280], Statistics(sizeInBytes=12.2 MiB)
                        :     :  :  +- Filter (isnotnull(ws_sold_date_sk#163) AND isnotnull(ws_web_site_sk#176)), Statistics(sizeInBytes=52.0 MiB)
                        :     :  :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                        :     :  +- Project [ws_web_site_sk#3418 AS wsr_web_site_sk#3281, wr_returned_date_sk#3327 AS date_sk#3282, 0.00 AS sales_price#3283, 0.00 AS profit#3284, wr_return_amt#3342 AS return_amt#3285, wr_net_loss#3350 AS net_loss#3286], Statistics(sizeInBytes=8.5 TiB)
                        :     :     +- Join Inner, ((wr_item_sk#3329 = ws_item_sk#3408) AND (wr_order_number#3340 = ws_order_number#3422)), Statistics(sizeInBytes=8.5 TiB)
                        :     :        :- Project [wr_returned_date_sk#3327, wr_item_sk#3329, wr_order_number#3340, wr_return_amt#3342, wr_net_loss#3350], Statistics(sizeInBytes=1711.5 KiB)
                        :     :        :  +- Filter isnotnull(wr_returned_date_sk#3327), Statistics(sizeInBytes=6.5 MiB)
                        :     :        :     +- Relation default.web_returns[wr_returned_date_sk#3327,wr_returned_time_sk#3328,wr_item_sk#3329,wr_refunded_customer_sk#3330,wr_refunded_cdemo_sk#3331,wr_refunded_hdemo_sk#3332,wr_refunded_addr_sk#3333,wr_returning_customer_sk#3334,wr_returning_cdemo_sk#3335,wr_returning_hdemo_sk#3336,wr_returning_addr_sk#3337,wr_web_page_sk#3338,wr_reason_sk#3339,wr_order_number#3340,wr_return_quantity#3341,wr_return_amt#3342,wr_return_tax#3343,wr_return_amt_inc_tax#3344,wr_fee#3345,wr_return_ship_cost#3346,wr_refunded_cash#3347,wr_reversed_charge#3348,wr_account_credit#3349,wr_net_loss#3350] parquet, Statistics(sizeInBytes=6.5 MiB)
                        :     :        +- Project [ws_item_sk#3408, ws_web_site_sk#3418, ws_order_number#3422], Statistics(sizeInBytes=5.1 MiB)
                        :     :           +- Filter ((isnotnull(ws_item_sk#3408) AND isnotnull(ws_order_number#3422)) AND isnotnull(ws_web_site_sk#3418)), Statistics(sizeInBytes=52.0 MiB)
                        :     :              +- Relation default.web_sales[ws_sold_date_sk#3405,ws_sold_time_sk#3406,ws_ship_date_sk#3407,ws_item_sk#3408,ws_bill_customer_sk#3409,ws_bill_cdemo_sk#3410,ws_bill_hdemo_sk#3411,ws_bill_addr_sk#3412,ws_ship_customer_sk#3413,ws_ship_cdemo_sk#3414,ws_ship_hdemo_sk#3415,ws_ship_addr_sk#3416,ws_web_page_sk#3417,ws_web_site_sk#3418,ws_ship_mode_sk#3419,ws_warehouse_sk#3420,ws_promo_sk#3421,ws_order_number#3422,ws_quantity#3423,ws_wholesale_cost#3424,ws_list_price#3425,ws_sales_price#3426,ws_ext_discount_amt#3427,ws_ext_sales_price#3428,ws_ext_wholesale_cost#3429,ws_ext_list_price#3430,ws_ext_tax#3431,ws_coupon_amt#3432,ws_ext_ship_cost#3433,ws_net_paid#3434,ws_net_paid_inc_tax#3435,ws_net_paid_inc_ship#3436,ws_net_paid_inc_ship_tax#3437,ws_net_profit#3438] parquet, Statistics(sizeInBytes=52.0 MiB)
                        :     +- Project [d_date_sk#3439], Statistics(sizeInBytes=105.3 KiB)
                        :        +- Filter ((isnotnull(d_date#3441) AND ((d_date#3441 >= 2000-08-23) AND (d_date#3441 <= 2000-09-06))) AND isnotnull(d_date_sk#3439)), Statistics(sizeInBytes=2.5 MiB)
                        :           +- Relation default.date_dim[d_date_sk#3439,d_date_id#3440,d_date#3441,d_month_seq#3442,d_week_seq#3443,d_quarter_seq#3444,d_year#3445,d_dow#3446,d_moy#3447,d_dom#3448,d_qoy#3449,d_fy_year#3450,d_fy_quarter_seq#3451,d_fy_week_seq#3452,d_day_name#3453,d_quarter_name#3454,d_holiday#3455,d_weekend#3456,d_following_holiday#3457,d_first_dom#3458,d_last_dom#3459,d_same_day_ly#3460,d_same_day_lq#3461,d_current_day#3462,d_current_week#3463,d_current_month#3464,d_current_quarter#3465,d_current_year#3466] parquet, Statistics(sizeInBytes=2.5 MiB)
                        +- Project [web_site_sk#3351, web_site_id#3352], Statistics(sizeInBytes=20.3 KiB)
                           +- Filter isnotnull(web_site_sk#3351), Statistics(sizeInBytes=249.1 KiB)
                              +- Relation default.web_site[web_site_sk#3351,web_site_id#3352,web_rec_start_date#3353,web_rec_end_date#3354,web_name#3355,web_open_date_sk#3356,web_close_date_sk#3357,web_class#3358,web_manager#3359,web_mkt_id#3360,web_mkt_class#3361,web_mkt_desc#3362,web_market_manager#3363,web_company_id#3364,web_company_name#3365,web_street_number#3366,web_street_name#3367,web_street_type#3368,web_suite_number#3369,web_city#3370,web_county#3371,web_state#3372,web_zip#3373,web_country#3374,web_gmt_offset#3375,web_tax_percentage#3376] parquet, Statistics(sizeInBytes=249.1 KiB)

==== q7 ==== 
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=5.9 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=2.59E+28 B)
   +- Sort [i_item_id#438 ASC NULLS FIRST], true, Statistics(sizeInBytes=2.59E+28 B)
      +- Aggregate [i_item_id#438], [i_item_id#438, avg(ss_quantity#424) AS agg1#3629, cast((avg(UnscaledValue(ss_list_price#426)) / 100.0) as decimal(11,6)) AS agg2#3630, cast((avg(UnscaledValue(ss_coupon_amt#433)) / 100.0) as decimal(11,6)) AS agg3#3631, cast((avg(UnscaledValue(ss_sales_price#427)) / 100.0) as decimal(11,6)) AS agg4#3632], Statistics(sizeInBytes=2.59E+28 B)
         +- Project [ss_quantity#424, ss_list_price#426, ss_sales_price#427, ss_coupon_amt#433, i_item_id#438], Statistics(sizeInBytes=2.42E+28 B)
            +- Join Inner, (ss_promo_sk#422 = p_promo_sk#3642), Statistics(sizeInBytes=2.77E+28 B)
               :- Project [ss_promo_sk#422, ss_quantity#424, ss_list_price#426, ss_sales_price#427, ss_coupon_amt#433, i_item_id#438], Statistics(sizeInBytes=1.13E+24 B)
               :  +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=1.28E+24 B)
               :     :- Project [ss_item_sk#416, ss_promo_sk#422, ss_quantity#424, ss_list_price#426, ss_sales_price#427, ss_coupon_amt#433], Statistics(sizeInBytes=3.2 EiB)
               :     :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=3.7 EiB)
               :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_promo_sk#422, ss_quantity#424, ss_list_price#426, ss_sales_price#427, ss_coupon_amt#433], Statistics(sizeInBytes=36.5 TiB)
               :     :     :  +- Join Inner, (ss_cdemo_sk#418 = cd_demo_sk#3633), Statistics(sizeInBytes=42.5 TiB)
               :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_cdemo_sk#418, ss_promo_sk#422, ss_quantity#424, ss_list_price#426, ss_sales_price#427, ss_coupon_amt#433], Statistics(sizeInBytes=49.6 MiB)
               :     :     :     :  +- Filter ((isnotnull(ss_cdemo_sk#418) AND isnotnull(ss_sold_date_sk#414)) AND (isnotnull(ss_item_sk#416) AND isnotnull(ss_promo_sk#422))), Statistics(sizeInBytes=141.1 MiB)
               :     :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               :     :     :     +- Project [cd_demo_sk#3633], Statistics(sizeInBytes=878.6 KiB)
               :     :     :        +- Filter ((((isnotnull(cd_gender#3634) AND isnotnull(cd_marital_status#3635)) AND isnotnull(cd_education_status#3636)) AND (((cd_gender#3634 = M) AND (cd_marital_status#3635 = S)) AND (cd_education_status#3636 = College             ))) AND isnotnull(cd_demo_sk#3633)), Statistics(sizeInBytes=7.7 MiB)
               :     :     :           +- Relation default.customer_demographics[cd_demo_sk#3633,cd_gender#3634,cd_marital_status#3635,cd_education_status#3636,cd_purchase_estimate#3637,cd_credit_rating#3638,cd_dep_count#3639,cd_dep_employed_count#3640,cd_dep_college_count#3641] parquet, Statistics(sizeInBytes=7.7 MiB)
               :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :     :        +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2000)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     +- Project [i_item_sk#437, i_item_id#438], Statistics(sizeInBytes=342.3 KiB)
               :        +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
               :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
               +- Project [p_promo_sk#3642], Statistics(sizeInBytes=23.9 KiB)
                  +- Filter (((p_channel_email#3651 = N) OR (p_channel_event#3656 = N)) AND isnotnull(p_promo_sk#3642)), Statistics(sizeInBytes=589.4 KiB)
                     +- Relation default.promotion[p_promo_sk#3642,p_promo_id#3643,p_start_date_sk#3644,p_end_date_sk#3645,p_item_sk#3646,p_cost#3647,p_response_target#3648,p_promo_name#3649,p_channel_dmail#3650,p_channel_email#3651,p_channel_catalog#3652,p_channel_tv#3653,p_channel_radio#3654,p_channel_press#3655,p_channel_event#3656,p_channel_demo#3657,p_channel_details#3658,p_purpose#3659,p_discount_active#3660] parquet, Statistics(sizeInBytes=589.4 KiB)

==== q8 ==== 
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=3.5 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=2.97E+21 B)
   +- Sort [s_store_name#57 ASC NULLS FIRST], true, Statistics(sizeInBytes=2.97E+21 B)
      +- Aggregate [s_store_name#57], [s_store_name#57, MakeDecimal(sum(UnscaledValue(ss_net_profit#436)),17,2) AS sum(ss_net_profit)#3746], Statistics(sizeInBytes=2.97E+21 B)
         +- Project [ss_net_profit#436, s_store_name#57], Statistics(sizeInBytes=2.97E+21 B)
            +- Join Inner, (substr(s_zip#77, 1, 2) = substr(ca_zip#3712, 1, 2)), Statistics(sizeInBytes=6.28E+21 B)
               :- Project [ss_net_profit#436, s_store_name#57, s_zip#77], Statistics(sizeInBytes=18.5 PiB)
               :  +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=21.1 PiB)
               :     :- Project [ss_store_sk#421, ss_net_profit#436], Statistics(sizeInBytes=1720.7 GiB)
               :     :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2.4 TiB)
               :     :     :- Project [ss_sold_date_sk#414, ss_store_sk#421, ss_net_profit#436], Statistics(sizeInBytes=22.9 MiB)
               :     :     :  +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421)), Statistics(sizeInBytes=141.1 MiB)
               :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :     :        +- Filter (((isnotnull(d_qoy#34) AND isnotnull(d_year#30)) AND ((d_qoy#34 = 2) AND (d_year#30 = 1998))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     +- Project [s_store_sk#52, s_store_name#57, s_zip#77], Statistics(sizeInBytes=12.6 KiB)
               :        +- Filter (isnotnull(s_store_sk#52) AND isnotnull(s_zip#77)), Statistics(sizeInBytes=101.7 KiB)
               :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
               +- Aggregate [ca_zip#3712], [ca_zip#3712], Statistics(sizeInBytes=294.4 KiB)
                  +- Project [substr(ca_zip#3726, 1, 5) AS ca_zip#3712], Statistics(sizeInBytes=294.4 KiB)
                     +- Join LeftSemi, (substr(ca_zip#3726, 1, 5) <=> ca_zip#3713), Statistics(sizeInBytes=294.4 KiB)
                        :- Project [ca_zip#3726], Statistics(sizeInBytes=294.4 KiB)
                        :  +- Filter (substr(ca_zip#3726, 1, 5) INSET 10144, 10336, 10390, 10445, 10516, 10567, 11101, 11356, 11376, 11489, 11634, 11928, 12305, 13354, 13375, 13376, 13394, 13595, 13695, 13955, 14060, 14089, 14171, 14328, 14663, 14867, 14922, 15126, 15146, 15371, 15455, 15559, 15723, 15734, 15765, 15798, 15882, 16021, 16725, 16807, 17043, 17183, 17871, 17879, 17920, 18119, 18270, 18376, 18383, 18426, 18652, 18767, 18799, 18840, 18842, 18845, 18906, 19430, 19505, 19512, 19515, 19736, 19769, 19849, 20004, 20260, 20548, 21076, 21195, 21286, 21309, 21337, 21756, 22152, 22245, 22246, 22351, 22437, 22461, 22685, 22744, 22752, 22927, 23006, 23470, 23932, 23968, 24128, 24206, 24317, 24610, 24671, 24676, 24996, 25003, 25103, 25280, 25486, 25631, 25733, 25782, 25858, 25989, 26065, 26105, 26231, 26233, 26653, 26689, 26859, 27068, 27156, 27385, 27700, 28286, 28488, 28545, 28577, 28587, 28709, 28810, 28898, 28915, 29178, 29741, 29839, 30010, 30122, 30431, 30450, 30469, 30625, 30903, 31016, 31029, 31387, 31671, 31880, 32213, 32754, 33123, 33282, 33515, 33786, 34102, 34322, 34425, 35258, 35458, 35474, 35576, 35850, 35942, 36233, 36420, 36446, 36495, 36634, 37125, 37126, 37930, 38122, 38193, 38415, 38607, 38935, 39127, 39192, 39371, 39516, 39736, 39861, 39972, 40081, 40162, 40558, 40604, 41248, 41367, 41368, 41766, 41918, 42029, 42666, 42961, 43285, 43848, 43933, 44165, 44438, 45200, 45266, 45375, 45549, 45692, 45721, 45748, 46081, 46136, 46820, 47305, 47537, 47770, 48033, 48425, 48583, 49130, 49156, 49448, 50016, 50298, 50308, 50412, 51061, 51103, 51200, 51211, 51622, 51649, 51650, 51798, 51949, 52867, 53179, 53268, 53535, 53672, 54364, 54601, 54917, 55253, 55307, 55565, 56240, 56458, 56529, 56571, 56575, 56616, 56691, 56910, 57047, 57647, 57665, 57834, 57855, 58048, 58058, 58078, 58263, 58470, 58943, 59166, 59402, 60099, 60279, 60576, 61265, 61547, 61810, 61860, 62377, 62496, 62878, 62971, 63089, 63193, 63435, 63792, 63837, 63981, 64034, 64147, 64457, 64528, 64544, 65084, 65164, 66162, 66708, 66864, 67030, 67301, 67467, 67473, 67853, 67875, 67897, 68014, 68100, 68101, 68309, 68341, 68621, 68786, 68806, 68880, 68893, 68908, 69035, 69399, 69913, 69952, 70372, 70466, 70738, 71256, 71286, 71791, 71954, 72013, 72151, 72175, 72305, 72325, 72425, 72550, 72823, 73134, 73171, 73241, 73273, 73520, 73650, 74351, 75691, 76107, 76231, 76232, 76614, 76638, 76698, 77191, 77556, 77610, 77721, 78451, 78567, 78668, 78890, 79077, 79777, 79994, 81019, 81096, 81312, 81426, 82136, 82276, 82636, 83041, 83144, 83444, 83849, 83921, 83926, 83933, 84093, 84935, 85816, 86057, 86198, 86284, 86379, 87343, 87501, 87816, 88086, 88190, 88424, 88885, 89091, 89360, 90225, 90257, 90578, 91068, 91110, 91137, 91393, 92712, 94167, 94627, 94898, 94945, 94983, 96451, 96576, 96765, 96888, 96976, 97189, 97789, 98025, 98235, 98294, 98359, 98569, 99076, 99543 AND isnotnull(substr(ca_zip#3726, 1, 5))), Statistics(sizeInBytes=2.5 MiB)
                        :     +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
                        +- Project [ca_zip#3713], Statistics(sizeInBytes=117.7 GiB)
                           +- Filter (cnt#3714L > 10), Statistics(sizeInBytes=151.3 GiB)
                              +- Aggregate [ca_zip#3739], [substr(ca_zip#3739, 1, 5) AS ca_zip#3713, count(1) AS cnt#3714L], Statistics(sizeInBytes=151.3 GiB)
                                 +- Project [ca_zip#3739], Statistics(sizeInBytes=117.7 GiB)
                                    +- Join Inner, (ca_address_sk#3730 = c_current_addr_sk#85), Statistics(sizeInBytes=151.3 GiB)
                                       :- Project [ca_address_sk#3730, ca_zip#3739], Statistics(sizeInBytes=336.4 KiB)
                                       :  +- Filter isnotnull(ca_address_sk#3730), Statistics(sizeInBytes=2.5 MiB)
                                       :     +- Relation default.customer_address[ca_address_sk#3730,ca_address_id#3731,ca_street_number#3732,ca_street_name#3733,ca_street_type#3734,ca_suite_number#3735,ca_city#3736,ca_county#3737,ca_state#3738,ca_zip#3739,ca_country#3740,ca_gmt_offset#3741,ca_location_type#3742] parquet, Statistics(sizeInBytes=2.5 MiB)
                                       +- Project [c_current_addr_sk#85], Statistics(sizeInBytes=460.7 KiB)
                                          +- Filter ((isnotnull(c_preferred_cust_flag#91) AND (c_preferred_cust_flag#91 = Y)) AND isnotnull(c_current_addr_sk#85)), Statistics(sizeInBytes=7.8 MiB)
                                             +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)

==== q9 ====
== Optimized Logical Plan ==
Project [CASE WHEN (scalar-subquery#3760 [].count(1) > 62316685) THEN scalar-subquery#3761 [].avg(ss_ext_discount_amt) ELSE scalar-subquery#3762 [].avg(ss_net_paid) END AS bucket1#3763, CASE WHEN (scalar-subquery#3764 [].count(1) > 19045798) THEN scalar-subquery#3765 [].avg(ss_ext_discount_amt) ELSE scalar-subquery#3766 [].avg(ss_net_paid) END AS bucket2#3767, CASE WHEN (scalar-subquery#3768 [].count(1) > 365541424) THEN scalar-subquery#3769 [].avg(ss_ext_discount_amt) ELSE scalar-subquery#3770 [].avg(ss_net_paid) END AS bucket3#3771, CASE WHEN (scalar-subquery#3772 [].count(1) > 216357808) THEN scalar-subquery#3773 [].avg(ss_ext_discount_amt) ELSE scalar-subquery#3774 [].avg(ss_net_paid) END AS bucket4#3775, CASE WHEN (scalar-subquery#3776 [].count(1) > 184483884) THEN scalar-subquery#3777 [].avg(ss_ext_discount_amt) ELSE scalar-subquery#3778 [].avg(ss_net_paid) END AS bucket5#3779], Statistics(sizeInBytes=50.7 KiB)
:  :- Project [named_struct(count(1), count(1)#3784L, avg(ss_ext_discount_amt), avg(ss_ext_discount_amt)#3786, avg(ss_net_paid), avg(ss_net_paid)#3788) AS mergedValue#4184], Statistics(sizeInBytes=32.0 B)
:  :  +- Aggregate [count(1) AS count(1)#3784L, cast((avg(UnscaledValue(ss_ext_discount_amt#428)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#3786, cast((avg(UnscaledValue(ss_net_paid#434)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#3788], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :     +- Project [ss_ext_discount_amt#428, ss_net_paid#434], Statistics(sizeInBytes=22.9 MiB)
:  :        +- Filter (isnotnull(ss_quantity#424) AND ((ss_quantity#424 >= 1) AND (ss_quantity#424 <= 20))), Statistics(sizeInBytes=141.1 MiB)
:  :           +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :- Project [named_struct(count(1), count(1)#3784L, avg(ss_ext_discount_amt), avg(ss_ext_discount_amt)#3786, avg(ss_net_paid), avg(ss_net_paid)#3788) AS mergedValue#4184], Statistics(sizeInBytes=32.0 B)
:  :  +- Aggregate [count(1) AS count(1)#3784L, cast((avg(UnscaledValue(ss_ext_discount_amt#428)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#3786, cast((avg(UnscaledValue(ss_net_paid#434)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#3788], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :     +- Project [ss_ext_discount_amt#428, ss_net_paid#434], Statistics(sizeInBytes=22.9 MiB)
:  :        +- Filter (isnotnull(ss_quantity#424) AND ((ss_quantity#424 >= 1) AND (ss_quantity#424 <= 20))), Statistics(sizeInBytes=141.1 MiB)
:  :           +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :- Project [named_struct(count(1), count(1)#3784L, avg(ss_ext_discount_amt), avg(ss_ext_discount_amt)#3786, avg(ss_net_paid), avg(ss_net_paid)#3788) AS mergedValue#4184], Statistics(sizeInBytes=32.0 B)
:  :  +- Aggregate [count(1) AS count(1)#3784L, cast((avg(UnscaledValue(ss_ext_discount_amt#428)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#3786, cast((avg(UnscaledValue(ss_net_paid#434)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#3788], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :     +- Project [ss_ext_discount_amt#428, ss_net_paid#434], Statistics(sizeInBytes=22.9 MiB)
:  :        +- Filter (isnotnull(ss_quantity#424) AND ((ss_quantity#424 >= 1) AND (ss_quantity#424 <= 20))), Statistics(sizeInBytes=141.1 MiB)
:  :           +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :- Project [named_struct(count(1), count(1)#3790L, avg(ss_ext_discount_amt), avg(ss_ext_discount_amt)#3792, avg(ss_net_paid), avg(ss_net_paid)#3794) AS mergedValue#4185], Statistics(sizeInBytes=32.0 B)
:  :  +- Aggregate [count(1) AS count(1)#3790L, cast((avg(UnscaledValue(ss_ext_discount_amt#3874)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#3792, cast((avg(UnscaledValue(ss_net_paid#3880)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#3794], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :     +- Project [ss_ext_discount_amt#3874, ss_net_paid#3880], Statistics(sizeInBytes=22.9 MiB)
:  :        +- Filter (isnotnull(ss_quantity#3870) AND ((ss_quantity#3870 >= 21) AND (ss_quantity#3870 <= 40))), Statistics(sizeInBytes=141.1 MiB)
:  :           +- Relation default.store_sales[ss_sold_date_sk#3860,ss_sold_time_sk#3861,ss_item_sk#3862,ss_customer_sk#3863,ss_cdemo_sk#3864,ss_hdemo_sk#3865,ss_addr_sk#3866,ss_store_sk#3867,ss_promo_sk#3868,ss_ticket_number#3869,ss_quantity#3870,ss_wholesale_cost#3871,ss_list_price#3872,ss_sales_price#3873,ss_ext_discount_amt#3874,ss_ext_sales_price#3875,ss_ext_wholesale_cost#3876,ss_ext_list_price#3877,ss_ext_tax#3878,ss_coupon_amt#3879,ss_net_paid#3880,ss_net_paid_inc_tax#3881,ss_net_profit#3882] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :- Project [named_struct(count(1), count(1)#3790L, avg(ss_ext_discount_amt), avg(ss_ext_discount_amt)#3792, avg(ss_net_paid), avg(ss_net_paid)#3794) AS mergedValue#4185], Statistics(sizeInBytes=32.0 B)
:  :  +- Aggregate [count(1) AS count(1)#3790L, cast((avg(UnscaledValue(ss_ext_discount_amt#3874)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#3792, cast((avg(UnscaledValue(ss_net_paid#3880)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#3794], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :     +- Project [ss_ext_discount_amt#3874, ss_net_paid#3880], Statistics(sizeInBytes=22.9 MiB)
:  :        +- Filter (isnotnull(ss_quantity#3870) AND ((ss_quantity#3870 >= 21) AND (ss_quantity#3870 <= 40))), Statistics(sizeInBytes=141.1 MiB)
:  :           +- Relation default.store_sales[ss_sold_date_sk#3860,ss_sold_time_sk#3861,ss_item_sk#3862,ss_customer_sk#3863,ss_cdemo_sk#3864,ss_hdemo_sk#3865,ss_addr_sk#3866,ss_store_sk#3867,ss_promo_sk#3868,ss_ticket_number#3869,ss_quantity#3870,ss_wholesale_cost#3871,ss_list_price#3872,ss_sales_price#3873,ss_ext_discount_amt#3874,ss_ext_sales_price#3875,ss_ext_wholesale_cost#3876,ss_ext_list_price#3877,ss_ext_tax#3878,ss_coupon_amt#3879,ss_net_paid#3880,ss_net_paid_inc_tax#3881,ss_net_profit#3882] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :- Project [named_struct(count(1), count(1)#3790L, avg(ss_ext_discount_amt), avg(ss_ext_discount_amt)#3792, avg(ss_net_paid), avg(ss_net_paid)#3794) AS mergedValue#4185], Statistics(sizeInBytes=32.0 B)
:  :  +- Aggregate [count(1) AS count(1)#3790L, cast((avg(UnscaledValue(ss_ext_discount_amt#3874)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#3792, cast((avg(UnscaledValue(ss_net_paid#3880)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#3794], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :     +- Project [ss_ext_discount_amt#3874, ss_net_paid#3880], Statistics(sizeInBytes=22.9 MiB)
:  :        +- Filter (isnotnull(ss_quantity#3870) AND ((ss_quantity#3870 >= 21) AND (ss_quantity#3870 <= 40))), Statistics(sizeInBytes=141.1 MiB)
:  :           +- Relation default.store_sales[ss_sold_date_sk#3860,ss_sold_time_sk#3861,ss_item_sk#3862,ss_customer_sk#3863,ss_cdemo_sk#3864,ss_hdemo_sk#3865,ss_addr_sk#3866,ss_store_sk#3867,ss_promo_sk#3868,ss_ticket_number#3869,ss_quantity#3870,ss_wholesale_cost#3871,ss_list_price#3872,ss_sales_price#3873,ss_ext_discount_amt#3874,ss_ext_sales_price#3875,ss_ext_wholesale_cost#3876,ss_ext_list_price#3877,ss_ext_tax#3878,ss_coupon_amt#3879,ss_net_paid#3880,ss_net_paid_inc_tax#3881,ss_net_profit#3882] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :- Project [named_struct(count(1), count(1)#3796L, avg(ss_ext_discount_amt), avg(ss_ext_discount_amt)#3798, avg(ss_net_paid), avg(ss_net_paid)#3800) AS mergedValue#4186], Statistics(sizeInBytes=32.0 B)
:  :  +- Aggregate [count(1) AS count(1)#3796L, cast((avg(UnscaledValue(ss_ext_discount_amt#3943)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#3798, cast((avg(UnscaledValue(ss_net_paid#3949)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#3800], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :     +- Project [ss_ext_discount_amt#3943, ss_net_paid#3949], Statistics(sizeInBytes=22.9 MiB)
:  :        +- Filter (isnotnull(ss_quantity#3939) AND ((ss_quantity#3939 >= 41) AND (ss_quantity#3939 <= 60))), Statistics(sizeInBytes=141.1 MiB)
:  :           +- Relation default.store_sales[ss_sold_date_sk#3929,ss_sold_time_sk#3930,ss_item_sk#3931,ss_customer_sk#3932,ss_cdemo_sk#3933,ss_hdemo_sk#3934,ss_addr_sk#3935,ss_store_sk#3936,ss_promo_sk#3937,ss_ticket_number#3938,ss_quantity#3939,ss_wholesale_cost#3940,ss_list_price#3941,ss_sales_price#3942,ss_ext_discount_amt#3943,ss_ext_sales_price#3944,ss_ext_wholesale_cost#3945,ss_ext_list_price#3946,ss_ext_tax#3947,ss_coupon_amt#3948,ss_net_paid#3949,ss_net_paid_inc_tax#3950,ss_net_profit#3951] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :- Project [named_struct(count(1), count(1)#3796L, avg(ss_ext_discount_amt), avg(ss_ext_discount_amt)#3798, avg(ss_net_paid), avg(ss_net_paid)#3800) AS mergedValue#4186], Statistics(sizeInBytes=32.0 B)
:  :  +- Aggregate [count(1) AS count(1)#3796L, cast((avg(UnscaledValue(ss_ext_discount_amt#3943)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#3798, cast((avg(UnscaledValue(ss_net_paid#3949)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#3800], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :     +- Project [ss_ext_discount_amt#3943, ss_net_paid#3949], Statistics(sizeInBytes=22.9 MiB)
:  :        +- Filter (isnotnull(ss_quantity#3939) AND ((ss_quantity#3939 >= 41) AND (ss_quantity#3939 <= 60))), Statistics(sizeInBytes=141.1 MiB)
:  :           +- Relation default.store_sales[ss_sold_date_sk#3929,ss_sold_time_sk#3930,ss_item_sk#3931,ss_customer_sk#3932,ss_cdemo_sk#3933,ss_hdemo_sk#3934,ss_addr_sk#3935,ss_store_sk#3936,ss_promo_sk#3937,ss_ticket_number#3938,ss_quantity#3939,ss_wholesale_cost#3940,ss_list_price#3941,ss_sales_price#3942,ss_ext_discount_amt#3943,ss_ext_sales_price#3944,ss_ext_wholesale_cost#3945,ss_ext_list_price#3946,ss_ext_tax#3947,ss_coupon_amt#3948,ss_net_paid#3949,ss_net_paid_inc_tax#3950,ss_net_profit#3951] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :- Project [named_struct(count(1), count(1)#3796L, avg(ss_ext_discount_amt), avg(ss_ext_discount_amt)#3798, avg(ss_net_paid), avg(ss_net_paid)#3800) AS mergedValue#4186], Statistics(sizeInBytes=32.0 B)
:  :  +- Aggregate [count(1) AS count(1)#3796L, cast((avg(UnscaledValue(ss_ext_discount_amt#3943)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#3798, cast((avg(UnscaledValue(ss_net_paid#3949)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#3800], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :     +- Project [ss_ext_discount_amt#3943, ss_net_paid#3949], Statistics(sizeInBytes=22.9 MiB)
:  :        +- Filter (isnotnull(ss_quantity#3939) AND ((ss_quantity#3939 >= 41) AND (ss_quantity#3939 <= 60))), Statistics(sizeInBytes=141.1 MiB)
:  :           +- Relation default.store_sales[ss_sold_date_sk#3929,ss_sold_time_sk#3930,ss_item_sk#3931,ss_customer_sk#3932,ss_cdemo_sk#3933,ss_hdemo_sk#3934,ss_addr_sk#3935,ss_store_sk#3936,ss_promo_sk#3937,ss_ticket_number#3938,ss_quantity#3939,ss_wholesale_cost#3940,ss_list_price#3941,ss_sales_price#3942,ss_ext_discount_amt#3943,ss_ext_sales_price#3944,ss_ext_wholesale_cost#3945,ss_ext_list_price#3946,ss_ext_tax#3947,ss_coupon_amt#3948,ss_net_paid#3949,ss_net_paid_inc_tax#3950,ss_net_profit#3951] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :- Project [named_struct(count(1), count(1)#3802L, avg(ss_ext_discount_amt), avg(ss_ext_discount_amt)#3804, avg(ss_net_paid), avg(ss_net_paid)#3806) AS mergedValue#4187], Statistics(sizeInBytes=32.0 B)
:  :  +- Aggregate [count(1) AS count(1)#3802L, cast((avg(UnscaledValue(ss_ext_discount_amt#4012)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#3804, cast((avg(UnscaledValue(ss_net_paid#4018)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#3806], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :     +- Project [ss_ext_discount_amt#4012, ss_net_paid#4018], Statistics(sizeInBytes=22.9 MiB)
:  :        +- Filter (isnotnull(ss_quantity#4008) AND ((ss_quantity#4008 >= 61) AND (ss_quantity#4008 <= 80))), Statistics(sizeInBytes=141.1 MiB)
:  :           +- Relation default.store_sales[ss_sold_date_sk#3998,ss_sold_time_sk#3999,ss_item_sk#4000,ss_customer_sk#4001,ss_cdemo_sk#4002,ss_hdemo_sk#4003,ss_addr_sk#4004,ss_store_sk#4005,ss_promo_sk#4006,ss_ticket_number#4007,ss_quantity#4008,ss_wholesale_cost#4009,ss_list_price#4010,ss_sales_price#4011,ss_ext_discount_amt#4012,ss_ext_sales_price#4013,ss_ext_wholesale_cost#4014,ss_ext_list_price#4015,ss_ext_tax#4016,ss_coupon_amt#4017,ss_net_paid#4018,ss_net_paid_inc_tax#4019,ss_net_profit#4020] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :- Project [named_struct(count(1), count(1)#3802L, avg(ss_ext_discount_amt), avg(ss_ext_discount_amt)#3804, avg(ss_net_paid), avg(ss_net_paid)#3806) AS mergedValue#4187], Statistics(sizeInBytes=32.0 B)
:  :  +- Aggregate [count(1) AS count(1)#3802L, cast((avg(UnscaledValue(ss_ext_discount_amt#4012)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#3804, cast((avg(UnscaledValue(ss_net_paid#4018)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#3806], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :     +- Project [ss_ext_discount_amt#4012, ss_net_paid#4018], Statistics(sizeInBytes=22.9 MiB)
:  :        +- Filter (isnotnull(ss_quantity#4008) AND ((ss_quantity#4008 >= 61) AND (ss_quantity#4008 <= 80))), Statistics(sizeInBytes=141.1 MiB)
:  :           +- Relation default.store_sales[ss_sold_date_sk#3998,ss_sold_time_sk#3999,ss_item_sk#4000,ss_customer_sk#4001,ss_cdemo_sk#4002,ss_hdemo_sk#4003,ss_addr_sk#4004,ss_store_sk#4005,ss_promo_sk#4006,ss_ticket_number#4007,ss_quantity#4008,ss_wholesale_cost#4009,ss_list_price#4010,ss_sales_price#4011,ss_ext_discount_amt#4012,ss_ext_sales_price#4013,ss_ext_wholesale_cost#4014,ss_ext_list_price#4015,ss_ext_tax#4016,ss_coupon_amt#4017,ss_net_paid#4018,ss_net_paid_inc_tax#4019,ss_net_profit#4020] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :- Project [named_struct(count(1), count(1)#3802L, avg(ss_ext_discount_amt), avg(ss_ext_discount_amt)#3804, avg(ss_net_paid), avg(ss_net_paid)#3806) AS mergedValue#4187], Statistics(sizeInBytes=32.0 B)
:  :  +- Aggregate [count(1) AS count(1)#3802L, cast((avg(UnscaledValue(ss_ext_discount_amt#4012)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#3804, cast((avg(UnscaledValue(ss_net_paid#4018)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#3806], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :     +- Project [ss_ext_discount_amt#4012, ss_net_paid#4018], Statistics(sizeInBytes=22.9 MiB)
:  :        +- Filter (isnotnull(ss_quantity#4008) AND ((ss_quantity#4008 >= 61) AND (ss_quantity#4008 <= 80))), Statistics(sizeInBytes=141.1 MiB)
:  :           +- Relation default.store_sales[ss_sold_date_sk#3998,ss_sold_time_sk#3999,ss_item_sk#4000,ss_customer_sk#4001,ss_cdemo_sk#4002,ss_hdemo_sk#4003,ss_addr_sk#4004,ss_store_sk#4005,ss_promo_sk#4006,ss_ticket_number#4007,ss_quantity#4008,ss_wholesale_cost#4009,ss_list_price#4010,ss_sales_price#4011,ss_ext_discount_amt#4012,ss_ext_sales_price#4013,ss_ext_wholesale_cost#4014,ss_ext_list_price#4015,ss_ext_tax#4016,ss_coupon_amt#4017,ss_net_paid#4018,ss_net_paid_inc_tax#4019,ss_net_profit#4020] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :- Project [named_struct(count(1), count(1)#3808L, avg(ss_ext_discount_amt), avg(ss_ext_discount_amt)#3810, avg(ss_net_paid), avg(ss_net_paid)#3812) AS mergedValue#4188], Statistics(sizeInBytes=32.0 B)
:  :  +- Aggregate [count(1) AS count(1)#3808L, cast((avg(UnscaledValue(ss_ext_discount_amt#4081)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#3810, cast((avg(UnscaledValue(ss_net_paid#4087)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#3812], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :     +- Project [ss_ext_discount_amt#4081, ss_net_paid#4087], Statistics(sizeInBytes=22.9 MiB)
:  :        +- Filter (isnotnull(ss_quantity#4077) AND ((ss_quantity#4077 >= 81) AND (ss_quantity#4077 <= 100))), Statistics(sizeInBytes=141.1 MiB)
:  :           +- Relation default.store_sales[ss_sold_date_sk#4067,ss_sold_time_sk#4068,ss_item_sk#4069,ss_customer_sk#4070,ss_cdemo_sk#4071,ss_hdemo_sk#4072,ss_addr_sk#4073,ss_store_sk#4074,ss_promo_sk#4075,ss_ticket_number#4076,ss_quantity#4077,ss_wholesale_cost#4078,ss_list_price#4079,ss_sales_price#4080,ss_ext_discount_amt#4081,ss_ext_sales_price#4082,ss_ext_wholesale_cost#4083,ss_ext_list_price#4084,ss_ext_tax#4085,ss_coupon_amt#4086,ss_net_paid#4087,ss_net_paid_inc_tax#4088,ss_net_profit#4089] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :- Project [named_struct(count(1), count(1)#3808L, avg(ss_ext_discount_amt), avg(ss_ext_discount_amt)#3810, avg(ss_net_paid), avg(ss_net_paid)#3812) AS mergedValue#4188], Statistics(sizeInBytes=32.0 B)
:  :  +- Aggregate [count(1) AS count(1)#3808L, cast((avg(UnscaledValue(ss_ext_discount_amt#4081)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#3810, cast((avg(UnscaledValue(ss_net_paid#4087)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#3812], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :     +- Project [ss_ext_discount_amt#4081, ss_net_paid#4087], Statistics(sizeInBytes=22.9 MiB)
:  :        +- Filter (isnotnull(ss_quantity#4077) AND ((ss_quantity#4077 >= 81) AND (ss_quantity#4077 <= 100))), Statistics(sizeInBytes=141.1 MiB)
:  :           +- Relation default.store_sales[ss_sold_date_sk#4067,ss_sold_time_sk#4068,ss_item_sk#4069,ss_customer_sk#4070,ss_cdemo_sk#4071,ss_hdemo_sk#4072,ss_addr_sk#4073,ss_store_sk#4074,ss_promo_sk#4075,ss_ticket_number#4076,ss_quantity#4077,ss_wholesale_cost#4078,ss_list_price#4079,ss_sales_price#4080,ss_ext_discount_amt#4081,ss_ext_sales_price#4082,ss_ext_wholesale_cost#4083,ss_ext_list_price#4084,ss_ext_tax#4085,ss_coupon_amt#4086,ss_net_paid#4087,ss_net_paid_inc_tax#4088,ss_net_profit#4089] parquet, Statistics(sizeInBytes=141.1 MiB)
:  +- Project [named_struct(count(1), count(1)#3808L, avg(ss_ext_discount_amt), avg(ss_ext_discount_amt)#3810, avg(ss_net_paid), avg(ss_net_paid)#3812) AS mergedValue#4188], Statistics(sizeInBytes=32.0 B)
:     +- Aggregate [count(1) AS count(1)#3808L, cast((avg(UnscaledValue(ss_ext_discount_amt#4081)) / 100.0) as decimal(11,6)) AS avg(ss_ext_discount_amt)#3810, cast((avg(UnscaledValue(ss_net_paid#4087)) / 100.0) as decimal(11,6)) AS avg(ss_net_paid)#3812], Statistics(sizeInBytes=32.0 B, rowCount=1)
:        +- Project [ss_ext_discount_amt#4081, ss_net_paid#4087], Statistics(sizeInBytes=22.9 MiB)
:           +- Filter (isnotnull(ss_quantity#4077) AND ((ss_quantity#4077 >= 81) AND (ss_quantity#4077 <= 100))), Statistics(sizeInBytes=141.1 MiB)
:              +- Relation default.store_sales[ss_sold_date_sk#4067,ss_sold_time_sk#4068,ss_item_sk#4069,ss_customer_sk#4070,ss_cdemo_sk#4071,ss_hdemo_sk#4072,ss_addr_sk#4073,ss_store_sk#4074,ss_promo_sk#4075,ss_ticket_number#4076,ss_quantity#4077,ss_wholesale_cost#4078,ss_list_price#4079,ss_sales_price#4080,ss_ext_discount_amt#4081,ss_ext_sales_price#4082,ss_ext_wholesale_cost#4083,ss_ext_list_price#4084,ss_ext_tax#4085,ss_coupon_amt#4086,ss_net_paid#4087,ss_net_paid_inc_tax#4088,ss_net_profit#4089] parquet, Statistics(sizeInBytes=141.1 MiB)
+- Filter (isnotnull(r_reason_sk#3780) AND (r_reason_sk#3780 = 1)), Statistics(sizeInBytes=54.9 KiB)
   +- Relation default.reason[r_reason_sk#3780,r_reason_id#3781,r_reason_desc#3782] parquet, Statistics(sizeInBytes=54.9 KiB)

==== q11 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=2.7 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.54E+73 B)
   +- Sort [customer_preferred_cust_flag#4489 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.54E+73 B)
      +- Project [customer_preferred_cust_flag#4489], Statistics(sizeInBytes=1.54E+73 B)
         +- Join Inner, ((customer_id#4416 = customer_id#4506) AND (CASE WHEN (year_total#4434 > 0.00) THEN CheckOverflow((promote_precision(year_total#4514) / promote_precision(year_total#4434)), DecimalType(38,20)) END > CASE WHEN (year_total#4424 > 0.00) THEN CheckOverflow((promote_precision(year_total#4494) / promote_precision(year_total#4424)), DecimalType(38,20)) END)), Statistics(sizeInBytes=5.49E+73 B)
            :- Project [customer_id#4416, year_total#4424, customer_preferred_cust_flag#4489, year_total#4494, year_total#4434], Statistics(sizeInBytes=3.83E+55 B)
            :  +- Join Inner, (customer_id#4416 = customer_id#4426), Statistics(sizeInBytes=4.89E+55 B)
            :     :- Project [customer_id#4416, year_total#4424, customer_preferred_cust_flag#4489, year_total#4494], Statistics(sizeInBytes=3.41E+37 B)
            :     :  +- Join Inner, (customer_id#4486 = customer_id#4416), Statistics(sizeInBytes=4.48E+37 B)
            :     :     :- Filter (isnotnull(year_total#4424) AND (year_total#4424 > 0.00)), Statistics(sizeInBytes=4.7 EiB)
            :     :     :  +- Aggregate [c_customer_id#82, c_first_name#89, c_last_name#90, d_year#30, c_preferred_cust_flag#91, c_birth_country#95, c_login#96, c_email_address#97], [c_customer_id#82 AS customer_id#4416, MakeDecimal(sum(UnscaledValue(CheckOverflow((promote_precision(cast(ss_ext_list_price#431 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#428 as decimal(8,2)))), DecimalType(8,2)))),18,2) AS year_total#4424], Statistics(sizeInBytes=4.7 EiB)
            :     :     :     +- Project [c_customer_id#82, c_first_name#89, c_last_name#90, c_preferred_cust_flag#91, c_birth_country#95, c_login#96, c_email_address#97, ss_ext_discount_amt#428, ss_ext_list_price#431, d_year#30], Statistics(sizeInBytes=21.7 EiB)
            :     :     :        +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=22.7 EiB)
            :     :     :           :- Project [c_customer_id#82, c_first_name#89, c_last_name#90, c_preferred_cust_flag#91, c_birth_country#95, c_login#96, c_email_address#97, ss_sold_date_sk#414, ss_ext_discount_amt#428, ss_ext_list_price#431], Statistics(sizeInBytes=165.9 TiB)
            :     :     :           :  +- Join Inner, (c_customer_sk#81 = ss_customer_sk#417), Statistics(sizeInBytes=173.8 TiB)
            :     :     :           :     :- Project [c_customer_sk#81, c_customer_id#82, c_first_name#89, c_last_name#90, c_preferred_cust_flag#91, c_birth_country#95, c_login#96, c_email_address#97], Statistics(sizeInBytes=5.7 MiB)
            :     :     :           :     :  +- Filter (isnotnull(c_customer_sk#81) AND isnotnull(c_customer_id#82)), Statistics(sizeInBytes=7.8 MiB)
            :     :     :           :     :     +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
            :     :     :           :     +- Project [ss_sold_date_sk#414, ss_customer_sk#417, ss_ext_discount_amt#428, ss_ext_list_price#431], Statistics(sizeInBytes=30.5 MiB)
            :     :     :           :        +- Filter (isnotnull(ss_customer_sk#417) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
            :     :     :           :           +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     :     :           +- Project [d_date_sk#24, d_year#30], Statistics(sizeInBytes=140.4 KiB)
            :     :     :              +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2001)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :     :     :                 +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :     +- Aggregate [c_customer_id#4995, c_first_name#5002, c_last_name#5003, d_year#5041, c_preferred_cust_flag#5004, c_birth_country#5008, c_login#5009, c_email_address#5010], [c_customer_id#4995 AS customer_id#4486, c_preferred_cust_flag#5004 AS customer_preferred_cust_flag#4489, MakeDecimal(sum(UnscaledValue(CheckOverflow((promote_precision(cast(ss_ext_list_price#5029 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#5026 as decimal(8,2)))), DecimalType(8,2)))),18,2) AS year_total#4494], Statistics(sizeInBytes=7.2 EiB)
            :     :        +- Project [c_customer_id#4995, c_first_name#5002, c_last_name#5003, c_preferred_cust_flag#5004, c_birth_country#5008, c_login#5009, c_email_address#5010, ss_ext_discount_amt#5026, ss_ext_list_price#5029, d_year#5041], Statistics(sizeInBytes=21.7 EiB)
            :     :           +- Join Inner, (ss_sold_date_sk#5012 = d_date_sk#5035), Statistics(sizeInBytes=22.7 EiB)
            :     :              :- Project [c_customer_id#4995, c_first_name#5002, c_last_name#5003, c_preferred_cust_flag#5004, c_birth_country#5008, c_login#5009, c_email_address#5010, ss_sold_date_sk#5012, ss_ext_discount_amt#5026, ss_ext_list_price#5029], Statistics(sizeInBytes=165.9 TiB)
            :     :              :  +- Join Inner, (c_customer_sk#4994 = ss_customer_sk#5015), Statistics(sizeInBytes=173.8 TiB)
            :     :              :     :- Project [c_customer_sk#4994, c_customer_id#4995, c_first_name#5002, c_last_name#5003, c_preferred_cust_flag#5004, c_birth_country#5008, c_login#5009, c_email_address#5010], Statistics(sizeInBytes=5.7 MiB)
            :     :              :     :  +- Filter (isnotnull(c_customer_sk#4994) AND isnotnull(c_customer_id#4995)), Statistics(sizeInBytes=7.8 MiB)
            :     :              :     :     +- Relation default.customer[c_customer_sk#4994,c_customer_id#4995,c_current_cdemo_sk#4996,c_current_hdemo_sk#4997,c_current_addr_sk#4998,c_first_shipto_date_sk#4999,c_first_sales_date_sk#5000,c_salutation#5001,c_first_name#5002,c_last_name#5003,c_preferred_cust_flag#5004,c_birth_day#5005,c_birth_month#5006,c_birth_year#5007,c_birth_country#5008,c_login#5009,c_email_address#5010,c_last_review_date#5011] parquet, Statistics(sizeInBytes=7.8 MiB)
            :     :              :     +- Project [ss_sold_date_sk#5012, ss_customer_sk#5015, ss_ext_discount_amt#5026, ss_ext_list_price#5029], Statistics(sizeInBytes=30.5 MiB)
            :     :              :        +- Filter (isnotnull(ss_customer_sk#5015) AND isnotnull(ss_sold_date_sk#5012)), Statistics(sizeInBytes=141.1 MiB)
            :     :              :           +- Relation default.store_sales[ss_sold_date_sk#5012,ss_sold_time_sk#5013,ss_item_sk#5014,ss_customer_sk#5015,ss_cdemo_sk#5016,ss_hdemo_sk#5017,ss_addr_sk#5018,ss_store_sk#5019,ss_promo_sk#5020,ss_ticket_number#5021,ss_quantity#5022,ss_wholesale_cost#5023,ss_list_price#5024,ss_sales_price#5025,ss_ext_discount_amt#5026,ss_ext_sales_price#5027,ss_ext_wholesale_cost#5028,ss_ext_list_price#5029,ss_ext_tax#5030,ss_coupon_amt#5031,ss_net_paid#5032,ss_net_paid_inc_tax#5033,ss_net_profit#5034] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     :              +- Project [d_date_sk#5035, d_year#5041], Statistics(sizeInBytes=140.4 KiB)
            :     :                 +- Filter ((isnotnull(d_year#5041) AND (d_year#5041 = 2002)) AND isnotnull(d_date_sk#5035)), Statistics(sizeInBytes=2.5 MiB)
            :     :                    +- Relation default.date_dim[d_date_sk#5035,d_date_id#5036,d_date#5037,d_month_seq#5038,d_week_seq#5039,d_quarter_seq#5040,d_year#5041,d_dow#5042,d_moy#5043,d_dom#5044,d_qoy#5045,d_fy_year#5046,d_fy_quarter_seq#5047,d_fy_week_seq#5048,d_day_name#5049,d_quarter_name#5050,d_holiday#5051,d_weekend#5052,d_following_holiday#5053,d_first_dom#5054,d_last_dom#5055,d_same_day_ly#5056,d_same_day_lq#5057,d_current_day#5058,d_current_week#5059,d_current_month#5060,d_current_quarter#5061,d_current_year#5062] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     +- Filter (isnotnull(year_total#4434) AND (year_total#4434 > 0.00)), Statistics(sizeInBytes=1273.8 PiB)
            :        +- Aggregate [c_customer_id#5223, c_first_name#5230, c_last_name#5231, c_preferred_cust_flag#5232, c_birth_country#5236, c_login#5237, c_email_address#5238, d_year#5280], [c_customer_id#5223 AS customer_id#4426, MakeDecimal(sum(UnscaledValue(CheckOverflow((promote_precision(cast(ws_ext_list_price#5265 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#5262 as decimal(8,2)))), DecimalType(8,2)))),18,2) AS year_total#4434], Statistics(sizeInBytes=1273.8 PiB)
            :           +- Project [c_customer_id#5223, c_first_name#5230, c_last_name#5231, c_preferred_cust_flag#5232, c_birth_country#5236, c_login#5237, c_email_address#5238, ws_ext_discount_amt#5262, ws_ext_list_price#5265, d_year#5280], Statistics(sizeInBytes=5.8 EiB)
            :              +- Join Inner, (ws_sold_date_sk#5240 = d_date_sk#5274), Statistics(sizeInBytes=6.1 EiB)
            :                 :- Project [c_customer_id#5223, c_first_name#5230, c_last_name#5231, c_preferred_cust_flag#5232, c_birth_country#5236, c_login#5237, c_email_address#5238, ws_sold_date_sk#5240, ws_ext_discount_amt#5262, ws_ext_list_price#5265], Statistics(sizeInBytes=44.4 TiB)
            :                 :  +- Join Inner, (c_customer_sk#5222 = ws_bill_customer_sk#5244), Statistics(sizeInBytes=46.5 TiB)
            :                 :     :- Project [c_customer_sk#5222, c_customer_id#5223, c_first_name#5230, c_last_name#5231, c_preferred_cust_flag#5232, c_birth_country#5236, c_login#5237, c_email_address#5238], Statistics(sizeInBytes=5.7 MiB)
            :                 :     :  +- Filter (isnotnull(c_customer_sk#5222) AND isnotnull(c_customer_id#5223)), Statistics(sizeInBytes=7.8 MiB)
            :                 :     :     +- Relation default.customer[c_customer_sk#5222,c_customer_id#5223,c_current_cdemo_sk#5224,c_current_hdemo_sk#5225,c_current_addr_sk#5226,c_first_shipto_date_sk#5227,c_first_sales_date_sk#5228,c_salutation#5229,c_first_name#5230,c_last_name#5231,c_preferred_cust_flag#5232,c_birth_day#5233,c_birth_month#5234,c_birth_year#5235,c_birth_country#5236,c_login#5237,c_email_address#5238,c_last_review_date#5239] parquet, Statistics(sizeInBytes=7.8 MiB)
            :                 :     +- Project [ws_sold_date_sk#5240, ws_bill_customer_sk#5244, ws_ext_discount_amt#5262, ws_ext_list_price#5265], Statistics(sizeInBytes=8.2 MiB)
            :                 :        +- Filter (isnotnull(ws_bill_customer_sk#5244) AND isnotnull(ws_sold_date_sk#5240)), Statistics(sizeInBytes=52.0 MiB)
            :                 :           +- Relation default.web_sales[ws_sold_date_sk#5240,ws_sold_time_sk#5241,ws_ship_date_sk#5242,ws_item_sk#5243,ws_bill_customer_sk#5244,ws_bill_cdemo_sk#5245,ws_bill_hdemo_sk#5246,ws_bill_addr_sk#5247,ws_ship_customer_sk#5248,ws_ship_cdemo_sk#5249,ws_ship_hdemo_sk#5250,ws_ship_addr_sk#5251,ws_web_page_sk#5252,ws_web_site_sk#5253,ws_ship_mode_sk#5254,ws_warehouse_sk#5255,ws_promo_sk#5256,ws_order_number#5257,ws_quantity#5258,ws_wholesale_cost#5259,ws_list_price#5260,ws_sales_price#5261,ws_ext_discount_amt#5262,ws_ext_sales_price#5263,ws_ext_wholesale_cost#5264,ws_ext_list_price#5265,ws_ext_tax#5266,ws_coupon_amt#5267,ws_ext_ship_cost#5268,ws_net_paid#5269,ws_net_paid_inc_tax#5270,ws_net_paid_inc_ship#5271,ws_net_paid_inc_ship_tax#5272,ws_net_profit#5273] parquet, Statistics(sizeInBytes=52.0 MiB)
            :                 +- Project [d_date_sk#5274, d_year#5280], Statistics(sizeInBytes=140.4 KiB)
            :                    +- Filter ((isnotnull(d_year#5280) AND (d_year#5280 = 2001)) AND isnotnull(d_date_sk#5274)), Statistics(sizeInBytes=2.5 MiB)
            :                       +- Relation default.date_dim[d_date_sk#5274,d_date_id#5275,d_date#5276,d_month_seq#5277,d_week_seq#5278,d_quarter_seq#5279,d_year#5280,d_dow#5281,d_moy#5282,d_dom#5283,d_qoy#5284,d_fy_year#5285,d_fy_quarter_seq#5286,d_fy_week_seq#5287,d_day_name#5288,d_quarter_name#5289,d_holiday#5290,d_weekend#5291,d_following_holiday#5292,d_first_dom#5293,d_last_dom#5294,d_same_day_ly#5295,d_same_day_lq#5296,d_current_day#5297,d_current_week#5298,d_current_month#5299,d_current_quarter#5300,d_current_year#5301] parquet, Statistics(sizeInBytes=2.5 MiB)
            +- Aggregate [c_customer_id#5382, c_first_name#5389, c_last_name#5390, c_preferred_cust_flag#5391, c_birth_country#5395, c_login#5396, c_email_address#5397, d_year#5439], [c_customer_id#5382 AS customer_id#4506, MakeDecimal(sum(UnscaledValue(CheckOverflow((promote_precision(cast(ws_ext_list_price#5424 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#5421 as decimal(8,2)))), DecimalType(8,2)))),18,2) AS year_total#4514], Statistics(sizeInBytes=1273.8 PiB)
               +- Project [c_customer_id#5382, c_first_name#5389, c_last_name#5390, c_preferred_cust_flag#5391, c_birth_country#5395, c_login#5396, c_email_address#5397, ws_ext_discount_amt#5421, ws_ext_list_price#5424, d_year#5439], Statistics(sizeInBytes=5.8 EiB)
                  +- Join Inner, (ws_sold_date_sk#5399 = d_date_sk#5433), Statistics(sizeInBytes=6.1 EiB)
                     :- Project [c_customer_id#5382, c_first_name#5389, c_last_name#5390, c_preferred_cust_flag#5391, c_birth_country#5395, c_login#5396, c_email_address#5397, ws_sold_date_sk#5399, ws_ext_discount_amt#5421, ws_ext_list_price#5424], Statistics(sizeInBytes=44.4 TiB)
                     :  +- Join Inner, (c_customer_sk#5381 = ws_bill_customer_sk#5403), Statistics(sizeInBytes=46.5 TiB)
                     :     :- Project [c_customer_sk#5381, c_customer_id#5382, c_first_name#5389, c_last_name#5390, c_preferred_cust_flag#5391, c_birth_country#5395, c_login#5396, c_email_address#5397], Statistics(sizeInBytes=5.7 MiB)
                     :     :  +- Filter (isnotnull(c_customer_sk#5381) AND isnotnull(c_customer_id#5382)), Statistics(sizeInBytes=7.8 MiB)
                     :     :     +- Relation default.customer[c_customer_sk#5381,c_customer_id#5382,c_current_cdemo_sk#5383,c_current_hdemo_sk#5384,c_current_addr_sk#5385,c_first_shipto_date_sk#5386,c_first_sales_date_sk#5387,c_salutation#5388,c_first_name#5389,c_last_name#5390,c_preferred_cust_flag#5391,c_birth_day#5392,c_birth_month#5393,c_birth_year#5394,c_birth_country#5395,c_login#5396,c_email_address#5397,c_last_review_date#5398] parquet, Statistics(sizeInBytes=7.8 MiB)
                     :     +- Project [ws_sold_date_sk#5399, ws_bill_customer_sk#5403, ws_ext_discount_amt#5421, ws_ext_list_price#5424], Statistics(sizeInBytes=8.2 MiB)
                     :        +- Filter (isnotnull(ws_bill_customer_sk#5403) AND isnotnull(ws_sold_date_sk#5399)), Statistics(sizeInBytes=52.0 MiB)
                     :           +- Relation default.web_sales[ws_sold_date_sk#5399,ws_sold_time_sk#5400,ws_ship_date_sk#5401,ws_item_sk#5402,ws_bill_customer_sk#5403,ws_bill_cdemo_sk#5404,ws_bill_hdemo_sk#5405,ws_bill_addr_sk#5406,ws_ship_customer_sk#5407,ws_ship_cdemo_sk#5408,ws_ship_hdemo_sk#5409,ws_ship_addr_sk#5410,ws_web_page_sk#5411,ws_web_site_sk#5412,ws_ship_mode_sk#5413,ws_warehouse_sk#5414,ws_promo_sk#5415,ws_order_number#5416,ws_quantity#5417,ws_wholesale_cost#5418,ws_list_price#5419,ws_sales_price#5420,ws_ext_discount_amt#5421,ws_ext_sales_price#5422,ws_ext_wholesale_cost#5423,ws_ext_list_price#5424,ws_ext_tax#5425,ws_coupon_amt#5426,ws_ext_ship_cost#5427,ws_net_paid#5428,ws_net_paid_inc_tax#5429,ws_net_paid_inc_ship#5430,ws_net_paid_inc_ship_tax#5431,ws_net_profit#5432] parquet, Statistics(sizeInBytes=52.0 MiB)
                     +- Project [d_date_sk#5433, d_year#5439], Statistics(sizeInBytes=140.4 KiB)
                        +- Filter ((isnotnull(d_year#5439) AND (d_year#5439 = 2002)) AND isnotnull(d_date_sk#5433)), Statistics(sizeInBytes=2.5 MiB)
                           +- Relation default.date_dim[d_date_sk#5433,d_date_id#5434,d_date#5435,d_month_seq#5436,d_week_seq#5437,d_quarter_seq#5438,d_year#5439,d_dow#5440,d_moy#5441,d_dom#5442,d_qoy#5443,d_fy_year#5444,d_fy_quarter_seq#5445,d_fy_week_seq#5446,d_day_name#5447,d_quarter_name#5448,d_holiday#5449,d_weekend#5450,d_following_holiday#5451,d_first_dom#5452,d_last_dom#5453,d_same_day_ly#5454,d_same_day_lq#5455,d_current_day#5456,d_current_week#5457,d_current_month#5458,d_current_quarter#5459,d_current_year#5460] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q12 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=9.8 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=559.2 PiB)
   +- Project [i_item_desc#441, i_category#449, i_class#447, i_current_price#442, itemrevenue#5529, revenueratio#5530], Statistics(sizeInBytes=559.2 PiB)
      +- Sort [i_category#449 ASC NULLS FIRST, i_class#447 ASC NULLS FIRST, i_item_id#438 ASC NULLS FIRST, i_item_desc#441 ASC NULLS FIRST, revenueratio#5530 ASC NULLS FIRST], true, Statistics(sizeInBytes=671.0 PiB)
         +- Project [i_item_desc#441, i_category#449, i_class#447, i_current_price#442, itemrevenue#5529, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(_w0#5535) * 100.00), DecimalType(21,2)) as decimal(27,2))) / promote_precision(_we0#5537)), DecimalType(38,17)) AS revenueratio#5530, i_item_id#438], Statistics(sizeInBytes=671.0 PiB)
            +- Window [sum(_w1#5536) windowspecdefinition(i_class#447, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#5537], [i_class#447], Statistics(sizeInBytes=760.5 PiB)
               +- Aggregate [i_item_id#438, i_item_desc#441, i_category#449, i_class#447, i_current_price#442], [i_item_desc#441, i_category#449, i_class#447, i_current_price#442, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#186)),17,2) AS itemrevenue#5529, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#186)),17,2) AS _w0#5535, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#186)),17,2) AS _w1#5536, i_item_id#438], Statistics(sizeInBytes=671.0 PiB)
                  +- Project [ws_ext_sales_price#186, i_item_id#438, i_item_desc#441, i_current_price#442, i_class#447, i_category#449], Statistics(sizeInBytes=581.5 PiB)
                     +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#24), Statistics(sizeInBytes=626.3 PiB)
                        :- Project [ws_sold_date_sk#163, ws_ext_sales_price#186, i_item_id#438, i_item_desc#441, i_current_price#442, i_class#447, i_category#449], Statistics(sizeInBytes=5.9 TiB)
                        :  +- Join Inner, (ws_item_sk#166 = i_item_sk#437), Statistics(sizeInBytes=6.4 TiB)
                        :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_ext_sales_price#186], Statistics(sizeInBytes=6.1 MiB)
                        :     :  +- Filter (isnotnull(ws_item_sk#166) AND isnotnull(ws_sold_date_sk#163)), Statistics(sizeInBytes=52.0 MiB)
                        :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                        :     +- Project [i_item_sk#437, i_item_id#438, i_item_desc#441, i_current_price#442, i_class#447, i_category#449], Statistics(sizeInBytes=1069.6 KiB)
                        :        +- Filter (i_category#449 IN (Sports                                            ,Books                                             ,Home                                              ) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
                        :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
                        +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                           +- Filter ((isnotnull(d_date#26) AND ((d_date#26 >= 1999-02-22) AND (d_date#26 <= 1999-03-24))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q13 ====
== Optimized Logical Plan ==
Aggregate [avg(ss_quantity#424) AS avg(ss_quantity)#5561, cast((avg(UnscaledValue(ss_ext_sales_price#429)) / 100.0) as decimal(11,6)) AS avg(ss_ext_sales_price)#5562, cast((avg(UnscaledValue(ss_ext_wholesale_cost#430)) / 100.0) as decimal(11,6)) AS avg(ss_ext_wholesale_cost)#5563, MakeDecimal(sum(UnscaledValue(ss_ext_wholesale_cost#430)),17,2) AS sum(ss_ext_wholesale_cost)#5564], Statistics(sizeInBytes=40.0 B, rowCount=1)
+- Project [ss_quantity#424, ss_ext_sales_price#429, ss_ext_wholesale_cost#430], Statistics(sizeInBytes=2.69E+32 B)
   +- Join Inner, ((ss_hdemo_sk#419 = hd_demo_sk#5551) AND (((((((cd_marital_status#3635 = M) AND (cd_education_status#3636 = Advanced Degree     )) AND (ss_sales_price#427 >= 100.00)) AND (ss_sales_price#427 <= 150.00)) AND (hd_dep_count#5554 = 3)) OR (((((cd_marital_status#3635 = S) AND (cd_education_status#3636 = College             )) AND (ss_sales_price#427 >= 50.00)) AND (ss_sales_price#427 <= 100.00)) AND (hd_dep_count#5554 = 1))) OR (((((cd_marital_status#3635 = W) AND (cd_education_status#3636 = 2 yr Degree         )) AND (ss_sales_price#427 >= 150.00)) AND (ss_sales_price#427 <= 200.00)) AND (hd_dep_count#5554 = 1)))), Statistics(sizeInBytes=8.47E+32 B)
      :- Project [ss_hdemo_sk#419, ss_quantity#424, ss_sales_price#427, ss_ext_sales_price#429, ss_ext_wholesale_cost#430, cd_marital_status#3635, cd_education_status#3636], Statistics(sizeInBytes=1.07E+28 B)
      :  +- Join Inner, (((((((cd_marital_status#3635 = M) AND (cd_education_status#3636 = Advanced Degree     )) AND (ss_sales_price#427 >= 100.00)) AND (ss_sales_price#427 <= 150.00)) OR ((((cd_marital_status#3635 = S) AND (cd_education_status#3636 = College             )) AND (ss_sales_price#427 >= 50.00)) AND (ss_sales_price#427 <= 100.00))) OR ((((cd_marital_status#3635 = W) AND (cd_education_status#3636 = 2 yr Degree         )) AND (ss_sales_price#427 >= 150.00)) AND (ss_sales_price#427 <= 200.00))) AND (cd_demo_sk#3633 = ss_cdemo_sk#418)), Statistics(sizeInBytes=1.18E+28 B)
      :     :- Project [ss_cdemo_sk#418, ss_hdemo_sk#419, ss_quantity#424, ss_sales_price#427, ss_ext_sales_price#429, ss_ext_wholesale_cost#430], Statistics(sizeInBytes=3.01E+21 B)
      :     :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=3.56E+21 B)
      :     :     :- Project [ss_sold_date_sk#414, ss_cdemo_sk#418, ss_hdemo_sk#419, ss_quantity#424, ss_sales_price#427, ss_ext_sales_price#429, ss_ext_wholesale_cost#430], Statistics(sizeInBytes=29.3 PiB)
      :     :     :  +- Join Inner, ((ss_addr_sk#420 = ca_address_sk#3717) AND ((((ca_state#3725 IN (TX,OH) AND (ss_net_profit#436 >= 100.00)) AND (ss_net_profit#436 <= 200.00)) OR ((ca_state#3725 IN (OR,NM,KY) AND (ss_net_profit#436 >= 150.00)) AND (ss_net_profit#436 <= 300.00))) OR ((ca_state#3725 IN (VA,TX,MS) AND (ss_net_profit#436 >= 50.00)) AND (ss_net_profit#436 <= 250.00)))), Statistics(sizeInBytes=51.4 PiB)
      :     :     :     :- Project [ss_sold_date_sk#414, ss_cdemo_sk#418, ss_hdemo_sk#419, ss_addr_sk#420, ss_quantity#424, ss_sales_price#427, ss_ext_sales_price#429, ss_ext_wholesale_cost#430, ss_net_profit#436], Statistics(sizeInBytes=156.3 GiB)
      :     :     :     :  +- Join Inner, (s_store_sk#52 = ss_store_sk#421), Statistics(sizeInBytes=177.2 GiB)
      :     :     :     :     :- Project [ss_sold_date_sk#414, ss_cdemo_sk#418, ss_hdemo_sk#419, ss_addr_sk#420, ss_store_sk#421, ss_quantity#424, ss_sales_price#427, ss_ext_sales_price#429, ss_ext_wholesale_cost#430, ss_net_profit#436], Statistics(sizeInBytes=61.0 MiB)
      :     :     :     :     :  +- Filter (((isnotnull(ss_store_sk#421) AND (((isnotnull(ss_addr_sk#420) AND isnotnull(ss_sold_date_sk#414)) AND isnotnull(ss_cdemo_sk#418)) AND isnotnull(ss_hdemo_sk#419))) AND ((((ss_net_profit#436 >= 100.00) AND (ss_net_profit#436 <= 200.00)) OR ((ss_net_profit#436 >= 150.00) AND (ss_net_profit#436 <= 300.00))) OR ((ss_net_profit#436 >= 50.00) AND (ss_net_profit#436 <= 250.00)))) AND ((((ss_sales_price#427 >= 100.00) AND (ss_sales_price#427 <= 150.00)) OR ((ss_sales_price#427 >= 50.00) AND (ss_sales_price#427 <= 100.00))) OR ((ss_sales_price#427 >= 150.00) AND (ss_sales_price#427 <= 200.00)))), Statistics(sizeInBytes=141.1 MiB)
      :     :     :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
      :     :     :     :     +- Project [s_store_sk#52], Statistics(sizeInBytes=2.9 KiB)
      :     :     :     :        +- Filter isnotnull(s_store_sk#52), Statistics(sizeInBytes=101.7 KiB)
      :     :     :     :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
      :     :     :     +- Project [ca_address_sk#3717, ca_state#3725], Statistics(sizeInBytes=336.4 KiB)
      :     :     :        +- Filter (((isnotnull(ca_country#3727) AND (ca_country#3727 = United States)) AND isnotnull(ca_address_sk#3717)) AND ((ca_state#3725 IN (TX,OH) OR ca_state#3725 IN (OR,NM,KY)) OR ca_state#3725 IN (VA,TX,MS))), Statistics(sizeInBytes=2.5 MiB)
      :     :     :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
      :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
      :     :        +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2001)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
      :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
      :     +- Project [cd_demo_sk#3633, cd_marital_status#3635, cd_education_status#3636], Statistics(sizeInBytes=3.7 MiB)
      :        +- Filter (isnotnull(cd_demo_sk#3633) AND ((((cd_marital_status#3635 = M) AND (cd_education_status#3636 = Advanced Degree     )) OR ((cd_marital_status#3635 = S) AND (cd_education_status#3636 = College             ))) OR ((cd_marital_status#3635 = W) AND (cd_education_status#3636 = 2 yr Degree         )))), Statistics(sizeInBytes=7.7 MiB)
      :           +- Relation default.customer_demographics[cd_demo_sk#3633,cd_gender#3634,cd_marital_status#3635,cd_education_status#3636,cd_purchase_estimate#3637,cd_credit_rating#3638,cd_dep_count#3639,cd_dep_employed_count#3640,cd_dep_college_count#3641] parquet, Statistics(sizeInBytes=7.7 MiB)
      +- Project [hd_demo_sk#5551, hd_dep_count#5554], Statistics(sizeInBytes=77.4 KiB)
         +- Filter (isnotnull(hd_demo_sk#5551) AND ((hd_dep_count#5554 = 3) OR (hd_dep_count#5554 = 1))), Statistics(sizeInBytes=212.8 KiB)
            +- Relation default.household_demographics[hd_demo_sk#5551,hd_income_band_sk#5552,hd_buy_potential#5553,hd_dep_count#5554,hd_vehicle_count#5555] parquet, Statistics(sizeInBytes=212.8 KiB)


==== q14a ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=6.3 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=8.2 EiB)
   +- Sort [channel#6219 ASC NULLS FIRST, i_brand_id#6220 ASC NULLS FIRST, i_class_id#6221 ASC NULLS FIRST, i_category_id#6222 ASC NULLS FIRST], true, Statistics(sizeInBytes=8.2 EiB)
      +- Aggregate [channel#6219, i_brand_id#6220, i_class_id#6221, i_category_id#6222, spark_grouping_id#6218L], [channel#6219, i_brand_id#6220, i_class_id#6221, i_category_id#6222, sum(sales#5605) AS sum(sales)#6209, sum(number_sales#5606L) AS sum(number_sales)#6210L], Statistics(sizeInBytes=8.2 EiB)
         +- Expand [[sales#5605, number_sales#5606L, channel#6214, i_brand_id#6215, i_class_id#6216, i_category_id#6217, 0], [sales#5605, number_sales#5606L, channel#6214, i_brand_id#6215, i_class_id#6216, null, 1], [sales#5605, number_sales#5606L, channel#6214, i_brand_id#6215, null, null, 3], [sales#5605, number_sales#5606L, channel#6214, null, null, null, 7], [sales#5605, number_sales#5606L, null, null, null, null, 15]], [sales#5605, number_sales#5606L, channel#6219, i_brand_id#6220, i_class_id#6221, i_category_id#6222, spark_grouping_id#6218L], Statistics(sizeInBytes=9.2 EiB)
            +- Union false, false, Statistics(sizeInBytes=1670.8 PiB)
               :- Project [sales#5605, number_sales#5606L, store AS channel#6214, i_brand_id#5960 AS i_brand_id#6215, i_class_id#5962 AS i_class_id#6216, i_category_id#5964 AS i_category_id#6217], Statistics(sizeInBytes=922.3 PiB)
               :  +- Filter (isnotnull(sales#5605) AND (cast(sales#5605 as decimal(32,6)) > cast(scalar-subquery#5608 [] as decimal(32,6)))), Statistics(sizeInBytes=634.1 PiB)
               :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(quantity#5623 as decimal(12,2))) * promote_precision(cast(list_price#5624 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#5629], Statistics(sizeInBytes=24.0 B, rowCount=1)
               :     :     +- Union false, false, Statistics(sizeInBytes=3.0 TiB)
               :     :        :- Project [ss_quantity#5765 AS quantity#5623, ss_list_price#5767 AS list_price#5624], Statistics(sizeInBytes=1720.7 GiB)
               :     :        :  +- Join Inner, (ss_sold_date_sk#5755 = d_date_sk#5778), Statistics(sizeInBytes=2.4 TiB)
               :     :        :     :- Project [ss_sold_date_sk#5755, ss_quantity#5765, ss_list_price#5767], Statistics(sizeInBytes=22.9 MiB)
               :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#5755), Statistics(sizeInBytes=141.1 MiB)
               :     :        :     :     +- Relation default.store_sales[ss_sold_date_sk#5755,ss_sold_time_sk#5756,ss_item_sk#5757,ss_customer_sk#5758,ss_cdemo_sk#5759,ss_hdemo_sk#5760,ss_addr_sk#5761,ss_store_sk#5762,ss_promo_sk#5763,ss_ticket_number#5764,ss_quantity#5765,ss_wholesale_cost#5766,ss_list_price#5767,ss_sales_price#5768,ss_ext_discount_amt#5769,ss_ext_sales_price#5770,ss_ext_wholesale_cost#5771,ss_ext_list_price#5772,ss_ext_tax#5773,ss_coupon_amt#5774,ss_net_paid#5775,ss_net_paid_inc_tax#5776,ss_net_profit#5777] parquet, Statistics(sizeInBytes=141.1 MiB)
               :     :        :     +- Project [d_date_sk#5778], Statistics(sizeInBytes=105.3 KiB)
               :     :        :        +- Filter ((isnotnull(d_year#5784) AND ((d_year#5784 >= 1999) AND (d_year#5784 <= 2001))) AND isnotnull(d_date_sk#5778)), Statistics(sizeInBytes=2.5 MiB)
               :     :        :           +- Relation default.date_dim[d_date_sk#5778,d_date_id#5779,d_date#5780,d_month_seq#5781,d_week_seq#5782,d_quarter_seq#5783,d_year#5784,d_dow#5785,d_moy#5786,d_dom#5787,d_qoy#5788,d_fy_year#5789,d_fy_quarter_seq#5790,d_fy_week_seq#5791,d_day_name#5792,d_quarter_name#5793,d_holiday#5794,d_weekend#5795,d_following_holiday#5796,d_first_dom#5797,d_last_dom#5798,d_same_day_ly#5799,d_same_day_lq#5800,d_current_day#5801,d_current_week#5802,d_current_month#5803,d_current_quarter#5804,d_current_year#5805] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     :        :- Project [cs_quantity#5824 AS quantity#5625, cs_list_price#5826 AS list_price#5626], Statistics(sizeInBytes=936.4 GiB)
               :     :        :  +- Join Inner, (cs_sold_date_sk#5806 = d_date_sk#5840), Statistics(sizeInBytes=1311.0 GiB)
               :     :        :     :- Project [cs_sold_date_sk#5806, cs_quantity#5824, cs_list_price#5826], Statistics(sizeInBytes=12.4 MiB)
               :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#5806), Statistics(sizeInBytes=105.8 MiB)
               :     :        :     :     +- Relation default.catalog_sales[cs_sold_date_sk#5806,cs_sold_time_sk#5807,cs_ship_date_sk#5808,cs_bill_customer_sk#5809,cs_bill_cdemo_sk#5810,cs_bill_hdemo_sk#5811,cs_bill_addr_sk#5812,cs_ship_customer_sk#5813,cs_ship_cdemo_sk#5814,cs_ship_hdemo_sk#5815,cs_ship_addr_sk#5816,cs_call_center_sk#5817,cs_catalog_page_sk#5818,cs_ship_mode_sk#5819,cs_warehouse_sk#5820,cs_item_sk#5821,cs_promo_sk#5822,cs_order_number#5823,cs_quantity#5824,cs_wholesale_cost#5825,cs_list_price#5826,cs_sales_price#5827,cs_ext_discount_amt#5828,cs_ext_sales_price#5829,cs_ext_wholesale_cost#5830,cs_ext_list_price#5831,cs_ext_tax#5832,cs_coupon_amt#5833,cs_ext_ship_cost#5834,cs_net_paid#5835,cs_net_paid_inc_tax#5836,cs_net_paid_inc_ship#5837,cs_net_paid_inc_ship_tax#5838,cs_net_profit#5839] parquet, Statistics(sizeInBytes=105.8 MiB)
               :     :        :     +- Project [d_date_sk#5840], Statistics(sizeInBytes=105.3 KiB)
               :     :        :        +- Filter ((isnotnull(d_year#5846) AND ((d_year#5846 >= 1999) AND (d_year#5846 <= 2001))) AND isnotnull(d_date_sk#5840)), Statistics(sizeInBytes=2.5 MiB)
               :     :        :           +- Relation default.date_dim[d_date_sk#5840,d_date_id#5841,d_date#5842,d_month_seq#5843,d_week_seq#5844,d_quarter_seq#5845,d_year#5846,d_dow#5847,d_moy#5848,d_dom#5849,d_qoy#5850,d_fy_year#5851,d_fy_quarter_seq#5852,d_fy_week_seq#5853,d_day_name#5854,d_quarter_name#5855,d_holiday#5856,d_weekend#5857,d_following_holiday#5858,d_first_dom#5859,d_last_dom#5860,d_same_day_ly#5861,d_same_day_lq#5862,d_current_day#5863,d_current_week#5864,d_current_month#5865,d_current_quarter#5866,d_current_year#5867] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     :        +- Project [ws_quantity#5886 AS quantity#5627, ws_list_price#5888 AS list_price#5628], Statistics(sizeInBytes=460.0 GiB)
               :     :           +- Join Inner, (ws_sold_date_sk#5868 = d_date_sk#5902), Statistics(sizeInBytes=644.0 GiB)
               :     :              :- Project [ws_sold_date_sk#5868, ws_quantity#5886, ws_list_price#5888], Statistics(sizeInBytes=6.1 MiB)
               :     :              :  +- Filter isnotnull(ws_sold_date_sk#5868), Statistics(sizeInBytes=52.0 MiB)
               :     :              :     +- Relation default.web_sales[ws_sold_date_sk#5868,ws_sold_time_sk#5869,ws_ship_date_sk#5870,ws_item_sk#5871,ws_bill_customer_sk#5872,ws_bill_cdemo_sk#5873,ws_bill_hdemo_sk#5874,ws_bill_addr_sk#5875,ws_ship_customer_sk#5876,ws_ship_cdemo_sk#5877,ws_ship_hdemo_sk#5878,ws_ship_addr_sk#5879,ws_web_page_sk#5880,ws_web_site_sk#5881,ws_ship_mode_sk#5882,ws_warehouse_sk#5883,ws_promo_sk#5884,ws_order_number#5885,ws_quantity#5886,ws_wholesale_cost#5887,ws_list_price#5888,ws_sales_price#5889,ws_ext_discount_amt#5890,ws_ext_sales_price#5891,ws_ext_wholesale_cost#5892,ws_ext_list_price#5893,ws_ext_tax#5894,ws_coupon_amt#5895,ws_ext_ship_cost#5896,ws_net_paid#5897,ws_net_paid_inc_tax#5898,ws_net_paid_inc_ship#5899,ws_net_paid_inc_ship_tax#5900,ws_net_profit#5901] parquet, Statistics(sizeInBytes=52.0 MiB)
               :     :              +- Project [d_date_sk#5902], Statistics(sizeInBytes=105.3 KiB)
               :     :                 +- Filter ((isnotnull(d_year#5908) AND ((d_year#5908 >= 1999) AND (d_year#5908 <= 2001))) AND isnotnull(d_date_sk#5902)), Statistics(sizeInBytes=2.5 MiB)
               :     :                    +- Relation default.date_dim[d_date_sk#5902,d_date_id#5903,d_date#5904,d_month_seq#5905,d_week_seq#5906,d_quarter_seq#5907,d_year#5908,d_dow#5909,d_moy#5910,d_dom#5911,d_qoy#5912,d_fy_year#5913,d_fy_quarter_seq#5914,d_fy_week_seq#5915,d_day_name#5916,d_quarter_name#5917,d_holiday#5918,d_weekend#5919,d_following_holiday#5920,d_first_dom#5921,d_last_dom#5922,d_same_day_ly#5923,d_same_day_lq#5924,d_current_day#5925,d_current_week#5926,d_current_month#5927,d_current_quarter#5928,d_current_year#5929] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     +- Aggregate [i_brand_id#5960, i_class_id#5962, i_category_id#5964], [i_brand_id#5960, i_class_id#5962, i_category_id#5964, sum(CheckOverflow((promote_precision(cast(ss_quantity#5940 as decimal(12,2))) * promote_precision(cast(ss_list_price#5942 as decimal(12,2)))), DecimalType(18,2))) AS sales#5605, count(1) AS number_sales#5606L], Statistics(sizeInBytes=634.1 PiB)
               :        +- Project [ss_quantity#5940, ss_list_price#5942, i_brand_id#5960, i_class_id#5962, i_category_id#5964], Statistics(sizeInBytes=461.2 PiB)
               :           +- Join Inner, (ss_sold_date_sk#5930 = d_date_sk#5975), Statistics(sizeInBytes=576.5 PiB)
               :              :- Project [ss_sold_date_sk#5930, ss_quantity#5940, ss_list_price#5942, i_brand_id#5960, i_class_id#5962, i_category_id#5964], Statistics(sizeInBytes=5.5 TiB)
               :              :  +- Join Inner, (ss_item_sk#5932 = i_item_sk#5953), Statistics(sizeInBytes=6.7 TiB)
               :              :     :- Join LeftSemi, (ss_item_sk#5932 = ss_item_sk#5622), Statistics(sizeInBytes=26.7 MiB)
               :              :     :  :- Project [ss_sold_date_sk#5930, ss_item_sk#5932, ss_quantity#5940, ss_list_price#5942], Statistics(sizeInBytes=26.7 MiB)
               :              :     :  :  +- Filter (isnotnull(ss_item_sk#5932) AND isnotnull(ss_sold_date_sk#5930)), Statistics(sizeInBytes=141.1 MiB)
               :              :     :  :     +- Relation default.store_sales[ss_sold_date_sk#5930,ss_sold_time_sk#5931,ss_item_sk#5932,ss_customer_sk#5933,ss_cdemo_sk#5934,ss_hdemo_sk#5935,ss_addr_sk#5936,ss_store_sk#5937,ss_promo_sk#5938,ss_ticket_number#5939,ss_quantity#5940,ss_wholesale_cost#5941,ss_list_price#5942,ss_sales_price#5943,ss_ext_discount_amt#5944,ss_ext_sales_price#5945,ss_ext_wholesale_cost#5946,ss_ext_list_price#5947,ss_ext_tax#5948,ss_coupon_amt#5949,ss_net_paid#5950,ss_net_paid_inc_tax#5951,ss_net_profit#5952] parquet, Statistics(sizeInBytes=141.1 MiB)
               :              :     :  +- Project [i_item_sk#437 AS ss_item_sk#5622], Statistics(sizeInBytes=2.13E+22 B)
               :              :     :     +- Join Inner, (((i_brand_id#444 = brand_id#5619) AND (i_class_id#446 = class_id#5620)) AND (i_category_id#448 = category_id#5621)), Statistics(sizeInBytes=6.38E+22 B)
               :              :     :        :- Project [i_item_sk#437, i_brand_id#444, i_class_id#446, i_category_id#448], Statistics(sizeInBytes=256.7 KiB)
               :              :     :        :  +- Filter ((isnotnull(i_brand_id#444) AND isnotnull(i_class_id#446)) AND isnotnull(i_category_id#448)), Statistics(sizeInBytes=3.1 MiB)
               :              :     :        :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :     :        +- Join LeftSemi, (((brand_id#5619 <=> i_brand_id#5712) AND (class_id#5620 <=> i_class_id#5714)) AND (category_id#5621 <=> i_category_id#5716)), Statistics(sizeInBytes=215.7 PiB)
               :              :     :           :- Aggregate [brand_id#5619, class_id#5620, category_id#5621], [brand_id#5619, class_id#5620, category_id#5621], Statistics(sizeInBytes=215.7 PiB)
               :              :     :           :  +- Project [i_brand_id#5640 AS brand_id#5619, i_class_id#5642 AS class_id#5620, i_category_id#5644 AS category_id#5621], Statistics(sizeInBytes=215.7 PiB)
               :              :     :           :     +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=302.0 PiB)
               :              :     :           :        :- Project [ss_sold_date_sk#414, i_brand_id#5640, i_class_id#5642, i_category_id#5644], Statistics(sizeInBytes=2.9 TiB)
               :              :     :           :        :  +- Join Inner, (ss_item_sk#416 = i_item_sk#5633), Statistics(sizeInBytes=3.8 TiB)
               :              :     :           :        :     :- Project [ss_sold_date_sk#414, ss_item_sk#416], Statistics(sizeInBytes=15.3 MiB)
               :              :     :           :        :     :  +- Filter (isnotnull(ss_item_sk#416) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
               :              :     :           :        :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               :              :     :           :        :     +- Join LeftSemi, (((i_brand_id#5640 <=> i_brand_id#5662) AND (i_class_id#5642 <=> i_class_id#5664)) AND (i_category_id#5644 <=> i_category_id#5666)), Statistics(sizeInBytes=256.7 KiB)
               :              :     :           :        :        :- Project [i_item_sk#5633, i_brand_id#5640, i_class_id#5642, i_category_id#5644], Statistics(sizeInBytes=256.7 KiB)
               :              :     :           :        :        :  +- Filter (isnotnull(i_item_sk#5633) AND ((isnotnull(i_brand_id#5640) AND isnotnull(i_class_id#5642)) AND isnotnull(i_category_id#5644))), Statistics(sizeInBytes=3.1 MiB)
               :              :     :           :        :        :     +- Relation default.item[i_item_sk#5633,i_item_id#5634,i_rec_start_date#5635,i_rec_end_date#5636,i_item_desc#5637,i_current_price#5638,i_wholesale_cost#5639,i_brand_id#5640,i_brand#5641,i_class_id#5642,i_class#5643,i_category_id#5644,i_category#5645,i_manufact_id#5646,i_manufact#5647,i_size#5648,i_formulation#5649,i_color#5650,i_units#5651,i_container#5652,i_manager_id#5653,i_product_name#5654] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :     :           :        :        +- Project [i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=117.4 PiB)
               :              :     :           :        :           +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#5677), Statistics(sizeInBytes=164.3 PiB)
               :              :     :           :        :              :- Project [cs_sold_date_sk#197, i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=1597.9 GiB)
               :              :     :           :        :              :  +- Join Inner, (cs_item_sk#212 = i_item_sk#5655), Statistics(sizeInBytes=2.1 TiB)
               :              :     :           :        :              :     :- Project [cs_sold_date_sk#197, cs_item_sk#212], Statistics(sizeInBytes=8.3 MiB)
               :              :     :           :        :              :     :  +- Filter (isnotnull(cs_item_sk#212) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
               :              :     :           :        :              :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
               :              :     :           :        :              :     +- Project [i_item_sk#5655, i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=256.7 KiB)
               :              :     :           :        :              :        +- Filter isnotnull(i_item_sk#5655), Statistics(sizeInBytes=3.1 MiB)
               :              :     :           :        :              :           +- Relation default.item[i_item_sk#5655,i_item_id#5656,i_rec_start_date#5657,i_rec_end_date#5658,i_item_desc#5659,i_current_price#5660,i_wholesale_cost#5661,i_brand_id#5662,i_brand#5663,i_class_id#5664,i_class#5665,i_category_id#5666,i_category#5667,i_manufact_id#5668,i_manufact#5669,i_size#5670,i_formulation#5671,i_color#5672,i_units#5673,i_container#5674,i_manager_id#5675,i_product_name#5676] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :     :           :        :              +- Project [d_date_sk#5677], Statistics(sizeInBytes=105.3 KiB)
               :              :     :           :        :                 +- Filter ((isnotnull(d_year#5683) AND ((d_year#5683 >= 1999) AND (d_year#5683 <= 2001))) AND isnotnull(d_date_sk#5677)), Statistics(sizeInBytes=2.5 MiB)
               :              :     :           :        :                    +- Relation default.date_dim[d_date_sk#5677,d_date_id#5678,d_date#5679,d_month_seq#5680,d_week_seq#5681,d_quarter_seq#5682,d_year#5683,d_dow#5684,d_moy#5685,d_dom#5686,d_qoy#5687,d_fy_year#5688,d_fy_quarter_seq#5689,d_fy_week_seq#5690,d_day_name#5691,d_quarter_name#5692,d_holiday#5693,d_weekend#5694,d_following_holiday#5695,d_first_dom#5696,d_last_dom#5697,d_same_day_ly#5698,d_same_day_lq#5699,d_current_day#5700,d_current_week#5701,d_current_month#5702,d_current_quarter#5703,d_current_year#5704] parquet, Statistics(sizeInBytes=2.5 MiB)
               :              :     :           :        +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :              :     :           :           +- Filter ((isnotnull(d_year#30) AND ((d_year#30 >= 1999) AND (d_year#30 <= 2001))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :              :     :           :              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :              :     :           +- Project [i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=57.7 PiB)
               :              :     :              +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#5727), Statistics(sizeInBytes=80.7 PiB)
               :              :     :                 :- Project [ws_sold_date_sk#163, i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=784.9 GiB)
               :              :     :                 :  +- Join Inner, (ws_item_sk#166 = i_item_sk#5705), Statistics(sizeInBytes=1046.6 GiB)
               :              :     :                 :     :- Project [ws_sold_date_sk#163, ws_item_sk#166], Statistics(sizeInBytes=4.1 MiB)
               :              :     :                 :     :  +- Filter (isnotnull(ws_item_sk#166) AND isnotnull(ws_sold_date_sk#163)), Statistics(sizeInBytes=52.0 MiB)
               :              :     :                 :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
               :              :     :                 :     +- Project [i_item_sk#5705, i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=256.7 KiB)
               :              :     :                 :        +- Filter isnotnull(i_item_sk#5705), Statistics(sizeInBytes=3.1 MiB)
               :              :     :                 :           +- Relation default.item[i_item_sk#5705,i_item_id#5706,i_rec_start_date#5707,i_rec_end_date#5708,i_item_desc#5709,i_current_price#5710,i_wholesale_cost#5711,i_brand_id#5712,i_brand#5713,i_class_id#5714,i_class#5715,i_category_id#5716,i_category#5717,i_manufact_id#5718,i_manufact#5719,i_size#5720,i_formulation#5721,i_color#5722,i_units#5723,i_container#5724,i_manager_id#5725,i_product_name#5726] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :     :                 +- Project [d_date_sk#5727], Statistics(sizeInBytes=105.3 KiB)
               :              :     :                    +- Filter ((isnotnull(d_year#5733) AND ((d_year#5733 >= 1999) AND (d_year#5733 <= 2001))) AND isnotnull(d_date_sk#5727)), Statistics(sizeInBytes=2.5 MiB)
               :              :     :                       +- Relation default.date_dim[d_date_sk#5727,d_date_id#5728,d_date#5729,d_month_seq#5730,d_week_seq#5731,d_quarter_seq#5732,d_year#5733,d_dow#5734,d_moy#5735,d_dom#5736,d_qoy#5737,d_fy_year#5738,d_fy_quarter_seq#5739,d_fy_week_seq#5740,d_day_name#5741,d_quarter_name#5742,d_holiday#5743,d_weekend#5744,d_following_holiday#5745,d_first_dom#5746,d_last_dom#5747,d_same_day_ly#5748,d_same_day_lq#5749,d_current_day#5750,d_current_week#5751,d_current_month#5752,d_current_quarter#5753,d_current_year#5754] parquet, Statistics(sizeInBytes=2.5 MiB)
               :              :     +- Join LeftSemi, (i_item_sk#5953 = ss_item_sk#5622), Statistics(sizeInBytes=256.7 KiB)
               :              :        :- Project [i_item_sk#5953, i_brand_id#5960, i_class_id#5962, i_category_id#5964], Statistics(sizeInBytes=256.7 KiB)
               :              :        :  +- Filter isnotnull(i_item_sk#5953), Statistics(sizeInBytes=3.1 MiB)
               :              :        :     +- Relation default.item[i_item_sk#5953,i_item_id#5954,i_rec_start_date#5955,i_rec_end_date#5956,i_item_desc#5957,i_current_price#5958,i_wholesale_cost#5959,i_brand_id#5960,i_brand#5961,i_class_id#5962,i_class#5963,i_category_id#5964,i_category#5965,i_manufact_id#5966,i_manufact#5967,i_size#5968,i_formulation#5969,i_color#5970,i_units#5971,i_container#5972,i_manager_id#5973,i_product_name#5974] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :        +- Project [i_item_sk#437 AS ss_item_sk#5622], Statistics(sizeInBytes=2.13E+22 B)
               :              :           +- Join Inner, (((i_brand_id#444 = brand_id#5619) AND (i_class_id#446 = class_id#5620)) AND (i_category_id#448 = category_id#5621)), Statistics(sizeInBytes=6.38E+22 B)
               :              :              :- Project [i_item_sk#437, i_brand_id#444, i_class_id#446, i_category_id#448], Statistics(sizeInBytes=256.7 KiB)
               :              :              :  +- Filter ((isnotnull(i_brand_id#444) AND isnotnull(i_class_id#446)) AND isnotnull(i_category_id#448)), Statistics(sizeInBytes=3.1 MiB)
               :              :              :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :              +- Join LeftSemi, (((brand_id#5619 <=> i_brand_id#5712) AND (class_id#5620 <=> i_class_id#5714)) AND (category_id#5621 <=> i_category_id#5716)), Statistics(sizeInBytes=215.7 PiB)
               :              :                 :- Aggregate [brand_id#5619, class_id#5620, category_id#5621], [brand_id#5619, class_id#5620, category_id#5621], Statistics(sizeInBytes=215.7 PiB)
               :              :                 :  +- Project [i_brand_id#5640 AS brand_id#5619, i_class_id#5642 AS class_id#5620, i_category_id#5644 AS category_id#5621], Statistics(sizeInBytes=215.7 PiB)
               :              :                 :     +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=302.0 PiB)
               :              :                 :        :- Project [ss_sold_date_sk#414, i_brand_id#5640, i_class_id#5642, i_category_id#5644], Statistics(sizeInBytes=2.9 TiB)
               :              :                 :        :  +- Join Inner, (ss_item_sk#416 = i_item_sk#5633), Statistics(sizeInBytes=3.8 TiB)
               :              :                 :        :     :- Project [ss_sold_date_sk#414, ss_item_sk#416], Statistics(sizeInBytes=15.3 MiB)
               :              :                 :        :     :  +- Filter (isnotnull(ss_item_sk#416) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
               :              :                 :        :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               :              :                 :        :     +- Join LeftSemi, (((i_brand_id#5640 <=> i_brand_id#5662) AND (i_class_id#5642 <=> i_class_id#5664)) AND (i_category_id#5644 <=> i_category_id#5666)), Statistics(sizeInBytes=256.7 KiB)
               :              :                 :        :        :- Project [i_item_sk#5633, i_brand_id#5640, i_class_id#5642, i_category_id#5644], Statistics(sizeInBytes=256.7 KiB)
               :              :                 :        :        :  +- Filter (isnotnull(i_item_sk#5633) AND ((isnotnull(i_brand_id#5640) AND isnotnull(i_class_id#5642)) AND isnotnull(i_category_id#5644))), Statistics(sizeInBytes=3.1 MiB)
               :              :                 :        :        :     +- Relation default.item[i_item_sk#5633,i_item_id#5634,i_rec_start_date#5635,i_rec_end_date#5636,i_item_desc#5637,i_current_price#5638,i_wholesale_cost#5639,i_brand_id#5640,i_brand#5641,i_class_id#5642,i_class#5643,i_category_id#5644,i_category#5645,i_manufact_id#5646,i_manufact#5647,i_size#5648,i_formulation#5649,i_color#5650,i_units#5651,i_container#5652,i_manager_id#5653,i_product_name#5654] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :                 :        :        +- Project [i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=117.4 PiB)
               :              :                 :        :           +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#5677), Statistics(sizeInBytes=164.3 PiB)
               :              :                 :        :              :- Project [cs_sold_date_sk#197, i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=1597.9 GiB)
               :              :                 :        :              :  +- Join Inner, (cs_item_sk#212 = i_item_sk#5655), Statistics(sizeInBytes=2.1 TiB)
               :              :                 :        :              :     :- Project [cs_sold_date_sk#197, cs_item_sk#212], Statistics(sizeInBytes=8.3 MiB)
               :              :                 :        :              :     :  +- Filter (isnotnull(cs_item_sk#212) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
               :              :                 :        :              :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
               :              :                 :        :              :     +- Project [i_item_sk#5655, i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=256.7 KiB)
               :              :                 :        :              :        +- Filter isnotnull(i_item_sk#5655), Statistics(sizeInBytes=3.1 MiB)
               :              :                 :        :              :           +- Relation default.item[i_item_sk#5655,i_item_id#5656,i_rec_start_date#5657,i_rec_end_date#5658,i_item_desc#5659,i_current_price#5660,i_wholesale_cost#5661,i_brand_id#5662,i_brand#5663,i_class_id#5664,i_class#5665,i_category_id#5666,i_category#5667,i_manufact_id#5668,i_manufact#5669,i_size#5670,i_formulation#5671,i_color#5672,i_units#5673,i_container#5674,i_manager_id#5675,i_product_name#5676] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :                 :        :              +- Project [d_date_sk#5677], Statistics(sizeInBytes=105.3 KiB)
               :              :                 :        :                 +- Filter ((isnotnull(d_year#5683) AND ((d_year#5683 >= 1999) AND (d_year#5683 <= 2001))) AND isnotnull(d_date_sk#5677)), Statistics(sizeInBytes=2.5 MiB)
               :              :                 :        :                    +- Relation default.date_dim[d_date_sk#5677,d_date_id#5678,d_date#5679,d_month_seq#5680,d_week_seq#5681,d_quarter_seq#5682,d_year#5683,d_dow#5684,d_moy#5685,d_dom#5686,d_qoy#5687,d_fy_year#5688,d_fy_quarter_seq#5689,d_fy_week_seq#5690,d_day_name#5691,d_quarter_name#5692,d_holiday#5693,d_weekend#5694,d_following_holiday#5695,d_first_dom#5696,d_last_dom#5697,d_same_day_ly#5698,d_same_day_lq#5699,d_current_day#5700,d_current_week#5701,d_current_month#5702,d_current_quarter#5703,d_current_year#5704] parquet, Statistics(sizeInBytes=2.5 MiB)
               :              :                 :        +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :              :                 :           +- Filter ((isnotnull(d_year#30) AND ((d_year#30 >= 1999) AND (d_year#30 <= 2001))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :              :                 :              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :              :                 +- Project [i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=57.7 PiB)
               :              :                    +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#5727), Statistics(sizeInBytes=80.7 PiB)
               :              :                       :- Project [ws_sold_date_sk#163, i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=784.9 GiB)
               :              :                       :  +- Join Inner, (ws_item_sk#166 = i_item_sk#5705), Statistics(sizeInBytes=1046.6 GiB)
               :              :                       :     :- Project [ws_sold_date_sk#163, ws_item_sk#166], Statistics(sizeInBytes=4.1 MiB)
               :              :                       :     :  +- Filter (isnotnull(ws_item_sk#166) AND isnotnull(ws_sold_date_sk#163)), Statistics(sizeInBytes=52.0 MiB)
               :              :                       :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
               :              :                       :     +- Project [i_item_sk#5705, i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=256.7 KiB)
               :              :                       :        +- Filter isnotnull(i_item_sk#5705), Statistics(sizeInBytes=3.1 MiB)
               :              :                       :           +- Relation default.item[i_item_sk#5705,i_item_id#5706,i_rec_start_date#5707,i_rec_end_date#5708,i_item_desc#5709,i_current_price#5710,i_wholesale_cost#5711,i_brand_id#5712,i_brand#5713,i_class_id#5714,i_class#5715,i_category_id#5716,i_category#5717,i_manufact_id#5718,i_manufact#5719,i_size#5720,i_formulation#5721,i_color#5722,i_units#5723,i_container#5724,i_manager_id#5725,i_product_name#5726] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :                       +- Project [d_date_sk#5727], Statistics(sizeInBytes=105.3 KiB)
               :              :                          +- Filter ((isnotnull(d_year#5733) AND ((d_year#5733 >= 1999) AND (d_year#5733 <= 2001))) AND isnotnull(d_date_sk#5727)), Statistics(sizeInBytes=2.5 MiB)
               :              :                             +- Relation default.date_dim[d_date_sk#5727,d_date_id#5728,d_date#5729,d_month_seq#5730,d_week_seq#5731,d_quarter_seq#5732,d_year#5733,d_dow#5734,d_moy#5735,d_dom#5736,d_qoy#5737,d_fy_year#5738,d_fy_quarter_seq#5739,d_fy_week_seq#5740,d_day_name#5741,d_quarter_name#5742,d_holiday#5743,d_weekend#5744,d_following_holiday#5745,d_first_dom#5746,d_last_dom#5747,d_same_day_ly#5748,d_same_day_lq#5749,d_current_day#5750,d_current_week#5751,d_current_month#5752,d_current_quarter#5753,d_current_year#5754] parquet, Statistics(sizeInBytes=2.5 MiB)
               :              +- Project [d_date_sk#5975], Statistics(sizeInBytes=105.3 KiB)
               :                 +- Filter (((isnotnull(d_year#5981) AND isnotnull(d_moy#5983)) AND ((d_year#5981 = 2001) AND (d_moy#5983 = 11))) AND isnotnull(d_date_sk#5975)), Statistics(sizeInBytes=2.5 MiB)
               :                    +- Relation default.date_dim[d_date_sk#5975,d_date_id#5976,d_date#5977,d_month_seq#5978,d_week_seq#5979,d_quarter_seq#5980,d_year#5981,d_dow#5982,d_moy#5983,d_dom#5984,d_qoy#5985,d_fy_year#5986,d_fy_quarter_seq#5987,d_fy_week_seq#5988,d_day_name#5989,d_quarter_name#5990,d_holiday#5991,d_weekend#5992,d_following_holiday#5993,d_first_dom#5994,d_last_dom#5995,d_same_day_ly#5996,d_same_day_lq#5997,d_current_day#5998,d_current_week#5999,d_current_month#6000,d_current_quarter#6001,d_current_year#6002] parquet, Statistics(sizeInBytes=2.5 MiB)
               :- Project [sales#5610, number_sales#5611L, catalog AS channel#6232, i_brand_id#6044, i_class_id#6046, i_category_id#6048], Statistics(sizeInBytes=501.9 PiB)
               :  +- Filter (isnotnull(sales#5610) AND (cast(sales#5610 as decimal(32,6)) > cast(scalar-subquery#5613 [] as decimal(32,6)))), Statistics(sizeInBytes=345.1 PiB)
               :     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(quantity#5623 as decimal(12,2))) * promote_precision(cast(list_price#5624 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#5629], Statistics(sizeInBytes=24.0 B, rowCount=1)
               :     :     +- Union false, false, Statistics(sizeInBytes=3.0 TiB)
               :     :        :- Project [ss_quantity#5765 AS quantity#5623, ss_list_price#5767 AS list_price#5624], Statistics(sizeInBytes=1720.7 GiB)
               :     :        :  +- Join Inner, (ss_sold_date_sk#5755 = d_date_sk#5778), Statistics(sizeInBytes=2.4 TiB)
               :     :        :     :- Project [ss_sold_date_sk#5755, ss_quantity#5765, ss_list_price#5767], Statistics(sizeInBytes=22.9 MiB)
               :     :        :     :  +- Filter isnotnull(ss_sold_date_sk#5755), Statistics(sizeInBytes=141.1 MiB)
               :     :        :     :     +- Relation default.store_sales[ss_sold_date_sk#5755,ss_sold_time_sk#5756,ss_item_sk#5757,ss_customer_sk#5758,ss_cdemo_sk#5759,ss_hdemo_sk#5760,ss_addr_sk#5761,ss_store_sk#5762,ss_promo_sk#5763,ss_ticket_number#5764,ss_quantity#5765,ss_wholesale_cost#5766,ss_list_price#5767,ss_sales_price#5768,ss_ext_discount_amt#5769,ss_ext_sales_price#5770,ss_ext_wholesale_cost#5771,ss_ext_list_price#5772,ss_ext_tax#5773,ss_coupon_amt#5774,ss_net_paid#5775,ss_net_paid_inc_tax#5776,ss_net_profit#5777] parquet, Statistics(sizeInBytes=141.1 MiB)
               :     :        :     +- Project [d_date_sk#5778], Statistics(sizeInBytes=105.3 KiB)
               :     :        :        +- Filter ((isnotnull(d_year#5784) AND ((d_year#5784 >= 1999) AND (d_year#5784 <= 2001))) AND isnotnull(d_date_sk#5778)), Statistics(sizeInBytes=2.5 MiB)
               :     :        :           +- Relation default.date_dim[d_date_sk#5778,d_date_id#5779,d_date#5780,d_month_seq#5781,d_week_seq#5782,d_quarter_seq#5783,d_year#5784,d_dow#5785,d_moy#5786,d_dom#5787,d_qoy#5788,d_fy_year#5789,d_fy_quarter_seq#5790,d_fy_week_seq#5791,d_day_name#5792,d_quarter_name#5793,d_holiday#5794,d_weekend#5795,d_following_holiday#5796,d_first_dom#5797,d_last_dom#5798,d_same_day_ly#5799,d_same_day_lq#5800,d_current_day#5801,d_current_week#5802,d_current_month#5803,d_current_quarter#5804,d_current_year#5805] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     :        :- Project [cs_quantity#5824 AS quantity#5625, cs_list_price#5826 AS list_price#5626], Statistics(sizeInBytes=936.4 GiB)
               :     :        :  +- Join Inner, (cs_sold_date_sk#5806 = d_date_sk#5840), Statistics(sizeInBytes=1311.0 GiB)
               :     :        :     :- Project [cs_sold_date_sk#5806, cs_quantity#5824, cs_list_price#5826], Statistics(sizeInBytes=12.4 MiB)
               :     :        :     :  +- Filter isnotnull(cs_sold_date_sk#5806), Statistics(sizeInBytes=105.8 MiB)
               :     :        :     :     +- Relation default.catalog_sales[cs_sold_date_sk#5806,cs_sold_time_sk#5807,cs_ship_date_sk#5808,cs_bill_customer_sk#5809,cs_bill_cdemo_sk#5810,cs_bill_hdemo_sk#5811,cs_bill_addr_sk#5812,cs_ship_customer_sk#5813,cs_ship_cdemo_sk#5814,cs_ship_hdemo_sk#5815,cs_ship_addr_sk#5816,cs_call_center_sk#5817,cs_catalog_page_sk#5818,cs_ship_mode_sk#5819,cs_warehouse_sk#5820,cs_item_sk#5821,cs_promo_sk#5822,cs_order_number#5823,cs_quantity#5824,cs_wholesale_cost#5825,cs_list_price#5826,cs_sales_price#5827,cs_ext_discount_amt#5828,cs_ext_sales_price#5829,cs_ext_wholesale_cost#5830,cs_ext_list_price#5831,cs_ext_tax#5832,cs_coupon_amt#5833,cs_ext_ship_cost#5834,cs_net_paid#5835,cs_net_paid_inc_tax#5836,cs_net_paid_inc_ship#5837,cs_net_paid_inc_ship_tax#5838,cs_net_profit#5839] parquet, Statistics(sizeInBytes=105.8 MiB)
               :     :        :     +- Project [d_date_sk#5840], Statistics(sizeInBytes=105.3 KiB)
               :     :        :        +- Filter ((isnotnull(d_year#5846) AND ((d_year#5846 >= 1999) AND (d_year#5846 <= 2001))) AND isnotnull(d_date_sk#5840)), Statistics(sizeInBytes=2.5 MiB)
               :     :        :           +- Relation default.date_dim[d_date_sk#5840,d_date_id#5841,d_date#5842,d_month_seq#5843,d_week_seq#5844,d_quarter_seq#5845,d_year#5846,d_dow#5847,d_moy#5848,d_dom#5849,d_qoy#5850,d_fy_year#5851,d_fy_quarter_seq#5852,d_fy_week_seq#5853,d_day_name#5854,d_quarter_name#5855,d_holiday#5856,d_weekend#5857,d_following_holiday#5858,d_first_dom#5859,d_last_dom#5860,d_same_day_ly#5861,d_same_day_lq#5862,d_current_day#5863,d_current_week#5864,d_current_month#5865,d_current_quarter#5866,d_current_year#5867] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     :        +- Project [ws_quantity#5886 AS quantity#5627, ws_list_price#5888 AS list_price#5628], Statistics(sizeInBytes=460.0 GiB)
               :     :           +- Join Inner, (ws_sold_date_sk#5868 = d_date_sk#5902), Statistics(sizeInBytes=644.0 GiB)
               :     :              :- Project [ws_sold_date_sk#5868, ws_quantity#5886, ws_list_price#5888], Statistics(sizeInBytes=6.1 MiB)
               :     :              :  +- Filter isnotnull(ws_sold_date_sk#5868), Statistics(sizeInBytes=52.0 MiB)
               :     :              :     +- Relation default.web_sales[ws_sold_date_sk#5868,ws_sold_time_sk#5869,ws_ship_date_sk#5870,ws_item_sk#5871,ws_bill_customer_sk#5872,ws_bill_cdemo_sk#5873,ws_bill_hdemo_sk#5874,ws_bill_addr_sk#5875,ws_ship_customer_sk#5876,ws_ship_cdemo_sk#5877,ws_ship_hdemo_sk#5878,ws_ship_addr_sk#5879,ws_web_page_sk#5880,ws_web_site_sk#5881,ws_ship_mode_sk#5882,ws_warehouse_sk#5883,ws_promo_sk#5884,ws_order_number#5885,ws_quantity#5886,ws_wholesale_cost#5887,ws_list_price#5888,ws_sales_price#5889,ws_ext_discount_amt#5890,ws_ext_sales_price#5891,ws_ext_wholesale_cost#5892,ws_ext_list_price#5893,ws_ext_tax#5894,ws_coupon_amt#5895,ws_ext_ship_cost#5896,ws_net_paid#5897,ws_net_paid_inc_tax#5898,ws_net_paid_inc_ship#5899,ws_net_paid_inc_ship_tax#5900,ws_net_profit#5901] parquet, Statistics(sizeInBytes=52.0 MiB)
               :     :              +- Project [d_date_sk#5902], Statistics(sizeInBytes=105.3 KiB)
               :     :                 +- Filter ((isnotnull(d_year#5908) AND ((d_year#5908 >= 1999) AND (d_year#5908 <= 2001))) AND isnotnull(d_date_sk#5902)), Statistics(sizeInBytes=2.5 MiB)
               :     :                    +- Relation default.date_dim[d_date_sk#5902,d_date_id#5903,d_date#5904,d_month_seq#5905,d_week_seq#5906,d_quarter_seq#5907,d_year#5908,d_dow#5909,d_moy#5910,d_dom#5911,d_qoy#5912,d_fy_year#5913,d_fy_quarter_seq#5914,d_fy_week_seq#5915,d_day_name#5916,d_quarter_name#5917,d_holiday#5918,d_weekend#5919,d_following_holiday#5920,d_first_dom#5921,d_last_dom#5922,d_same_day_ly#5923,d_same_day_lq#5924,d_current_day#5925,d_current_week#5926,d_current_month#5927,d_current_quarter#5928,d_current_year#5929] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     +- Aggregate [i_brand_id#6044, i_class_id#6046, i_category_id#6048], [i_brand_id#6044, i_class_id#6046, i_category_id#6048, sum(CheckOverflow((promote_precision(cast(cs_quantity#6021 as decimal(12,2))) * promote_precision(cast(cs_list_price#6023 as decimal(12,2)))), DecimalType(18,2))) AS sales#5610, count(1) AS number_sales#5611L], Statistics(sizeInBytes=345.1 PiB)
               :        +- Project [cs_quantity#6021, cs_list_price#6023, i_brand_id#6044, i_class_id#6046, i_category_id#6048], Statistics(sizeInBytes=251.0 PiB)
               :           +- Join Inner, (cs_sold_date_sk#6003 = d_date_sk#6059), Statistics(sizeInBytes=313.7 PiB)
               :              :- Project [cs_sold_date_sk#6003, cs_quantity#6021, cs_list_price#6023, i_brand_id#6044, i_class_id#6046, i_category_id#6048], Statistics(sizeInBytes=3.0 TiB)
               :              :  +- Join Inner, (cs_item_sk#6018 = i_item_sk#6037), Statistics(sizeInBytes=3.6 TiB)
               :              :     :- Join LeftSemi, (cs_item_sk#6018 = ss_item_sk#5622), Statistics(sizeInBytes=14.5 MiB)
               :              :     :  :- Project [cs_sold_date_sk#6003, cs_item_sk#6018, cs_quantity#6021, cs_list_price#6023], Statistics(sizeInBytes=14.5 MiB)
               :              :     :  :  +- Filter (isnotnull(cs_item_sk#6018) AND isnotnull(cs_sold_date_sk#6003)), Statistics(sizeInBytes=105.8 MiB)
               :              :     :  :     +- Relation default.catalog_sales[cs_sold_date_sk#6003,cs_sold_time_sk#6004,cs_ship_date_sk#6005,cs_bill_customer_sk#6006,cs_bill_cdemo_sk#6007,cs_bill_hdemo_sk#6008,cs_bill_addr_sk#6009,cs_ship_customer_sk#6010,cs_ship_cdemo_sk#6011,cs_ship_hdemo_sk#6012,cs_ship_addr_sk#6013,cs_call_center_sk#6014,cs_catalog_page_sk#6015,cs_ship_mode_sk#6016,cs_warehouse_sk#6017,cs_item_sk#6018,cs_promo_sk#6019,cs_order_number#6020,cs_quantity#6021,cs_wholesale_cost#6022,cs_list_price#6023,cs_sales_price#6024,cs_ext_discount_amt#6025,cs_ext_sales_price#6026,cs_ext_wholesale_cost#6027,cs_ext_list_price#6028,cs_ext_tax#6029,cs_coupon_amt#6030,cs_ext_ship_cost#6031,cs_net_paid#6032,cs_net_paid_inc_tax#6033,cs_net_paid_inc_ship#6034,cs_net_paid_inc_ship_tax#6035,cs_net_profit#6036] parquet, Statistics(sizeInBytes=105.8 MiB)
               :              :     :  +- Project [i_item_sk#437 AS ss_item_sk#5622], Statistics(sizeInBytes=2.13E+22 B)
               :              :     :     +- Join Inner, (((i_brand_id#444 = brand_id#5619) AND (i_class_id#446 = class_id#5620)) AND (i_category_id#448 = category_id#5621)), Statistics(sizeInBytes=6.38E+22 B)
               :              :     :        :- Project [i_item_sk#437, i_brand_id#444, i_class_id#446, i_category_id#448], Statistics(sizeInBytes=256.7 KiB)
               :              :     :        :  +- Filter ((isnotnull(i_brand_id#444) AND isnotnull(i_class_id#446)) AND isnotnull(i_category_id#448)), Statistics(sizeInBytes=3.1 MiB)
               :              :     :        :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :     :        +- Join LeftSemi, (((brand_id#5619 <=> i_brand_id#5712) AND (class_id#5620 <=> i_class_id#5714)) AND (category_id#5621 <=> i_category_id#5716)), Statistics(sizeInBytes=215.7 PiB)
               :              :     :           :- Aggregate [brand_id#5619, class_id#5620, category_id#5621], [brand_id#5619, class_id#5620, category_id#5621], Statistics(sizeInBytes=215.7 PiB)
               :              :     :           :  +- Project [i_brand_id#5640 AS brand_id#5619, i_class_id#5642 AS class_id#5620, i_category_id#5644 AS category_id#5621], Statistics(sizeInBytes=215.7 PiB)
               :              :     :           :     +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=302.0 PiB)
               :              :     :           :        :- Project [ss_sold_date_sk#414, i_brand_id#5640, i_class_id#5642, i_category_id#5644], Statistics(sizeInBytes=2.9 TiB)
               :              :     :           :        :  +- Join Inner, (ss_item_sk#416 = i_item_sk#5633), Statistics(sizeInBytes=3.8 TiB)
               :              :     :           :        :     :- Project [ss_sold_date_sk#414, ss_item_sk#416], Statistics(sizeInBytes=15.3 MiB)
               :              :     :           :        :     :  +- Filter (isnotnull(ss_item_sk#416) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
               :              :     :           :        :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               :              :     :           :        :     +- Join LeftSemi, (((i_brand_id#5640 <=> i_brand_id#5662) AND (i_class_id#5642 <=> i_class_id#5664)) AND (i_category_id#5644 <=> i_category_id#5666)), Statistics(sizeInBytes=256.7 KiB)
               :              :     :           :        :        :- Project [i_item_sk#5633, i_brand_id#5640, i_class_id#5642, i_category_id#5644], Statistics(sizeInBytes=256.7 KiB)
               :              :     :           :        :        :  +- Filter (isnotnull(i_item_sk#5633) AND ((isnotnull(i_brand_id#5640) AND isnotnull(i_class_id#5642)) AND isnotnull(i_category_id#5644))), Statistics(sizeInBytes=3.1 MiB)
               :              :     :           :        :        :     +- Relation default.item[i_item_sk#5633,i_item_id#5634,i_rec_start_date#5635,i_rec_end_date#5636,i_item_desc#5637,i_current_price#5638,i_wholesale_cost#5639,i_brand_id#5640,i_brand#5641,i_class_id#5642,i_class#5643,i_category_id#5644,i_category#5645,i_manufact_id#5646,i_manufact#5647,i_size#5648,i_formulation#5649,i_color#5650,i_units#5651,i_container#5652,i_manager_id#5653,i_product_name#5654] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :     :           :        :        +- Project [i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=117.4 PiB)
               :              :     :           :        :           +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#5677), Statistics(sizeInBytes=164.3 PiB)
               :              :     :           :        :              :- Project [cs_sold_date_sk#197, i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=1597.9 GiB)
               :              :     :           :        :              :  +- Join Inner, (cs_item_sk#212 = i_item_sk#5655), Statistics(sizeInBytes=2.1 TiB)
               :              :     :           :        :              :     :- Project [cs_sold_date_sk#197, cs_item_sk#212], Statistics(sizeInBytes=8.3 MiB)
               :              :     :           :        :              :     :  +- Filter (isnotnull(cs_item_sk#212) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
               :              :     :           :        :              :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
               :              :     :           :        :              :     +- Project [i_item_sk#5655, i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=256.7 KiB)
               :              :     :           :        :              :        +- Filter isnotnull(i_item_sk#5655), Statistics(sizeInBytes=3.1 MiB)
               :              :     :           :        :              :           +- Relation default.item[i_item_sk#5655,i_item_id#5656,i_rec_start_date#5657,i_rec_end_date#5658,i_item_desc#5659,i_current_price#5660,i_wholesale_cost#5661,i_brand_id#5662,i_brand#5663,i_class_id#5664,i_class#5665,i_category_id#5666,i_category#5667,i_manufact_id#5668,i_manufact#5669,i_size#5670,i_formulation#5671,i_color#5672,i_units#5673,i_container#5674,i_manager_id#5675,i_product_name#5676] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :     :           :        :              +- Project [d_date_sk#5677], Statistics(sizeInBytes=105.3 KiB)
               :              :     :           :        :                 +- Filter ((isnotnull(d_year#5683) AND ((d_year#5683 >= 1999) AND (d_year#5683 <= 2001))) AND isnotnull(d_date_sk#5677)), Statistics(sizeInBytes=2.5 MiB)
               :              :     :           :        :                    +- Relation default.date_dim[d_date_sk#5677,d_date_id#5678,d_date#5679,d_month_seq#5680,d_week_seq#5681,d_quarter_seq#5682,d_year#5683,d_dow#5684,d_moy#5685,d_dom#5686,d_qoy#5687,d_fy_year#5688,d_fy_quarter_seq#5689,d_fy_week_seq#5690,d_day_name#5691,d_quarter_name#5692,d_holiday#5693,d_weekend#5694,d_following_holiday#5695,d_first_dom#5696,d_last_dom#5697,d_same_day_ly#5698,d_same_day_lq#5699,d_current_day#5700,d_current_week#5701,d_current_month#5702,d_current_quarter#5703,d_current_year#5704] parquet, Statistics(sizeInBytes=2.5 MiB)
               :              :     :           :        +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :              :     :           :           +- Filter ((isnotnull(d_year#30) AND ((d_year#30 >= 1999) AND (d_year#30 <= 2001))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :              :     :           :              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :              :     :           +- Project [i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=57.7 PiB)
               :              :     :              +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#5727), Statistics(sizeInBytes=80.7 PiB)
               :              :     :                 :- Project [ws_sold_date_sk#163, i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=784.9 GiB)
               :              :     :                 :  +- Join Inner, (ws_item_sk#166 = i_item_sk#5705), Statistics(sizeInBytes=1046.6 GiB)
               :              :     :                 :     :- Project [ws_sold_date_sk#163, ws_item_sk#166], Statistics(sizeInBytes=4.1 MiB)
               :              :     :                 :     :  +- Filter (isnotnull(ws_item_sk#166) AND isnotnull(ws_sold_date_sk#163)), Statistics(sizeInBytes=52.0 MiB)
               :              :     :                 :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
               :              :     :                 :     +- Project [i_item_sk#5705, i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=256.7 KiB)
               :              :     :                 :        +- Filter isnotnull(i_item_sk#5705), Statistics(sizeInBytes=3.1 MiB)
               :              :     :                 :           +- Relation default.item[i_item_sk#5705,i_item_id#5706,i_rec_start_date#5707,i_rec_end_date#5708,i_item_desc#5709,i_current_price#5710,i_wholesale_cost#5711,i_brand_id#5712,i_brand#5713,i_class_id#5714,i_class#5715,i_category_id#5716,i_category#5717,i_manufact_id#5718,i_manufact#5719,i_size#5720,i_formulation#5721,i_color#5722,i_units#5723,i_container#5724,i_manager_id#5725,i_product_name#5726] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :     :                 +- Project [d_date_sk#5727], Statistics(sizeInBytes=105.3 KiB)
               :              :     :                    +- Filter ((isnotnull(d_year#5733) AND ((d_year#5733 >= 1999) AND (d_year#5733 <= 2001))) AND isnotnull(d_date_sk#5727)), Statistics(sizeInBytes=2.5 MiB)
               :              :     :                       +- Relation default.date_dim[d_date_sk#5727,d_date_id#5728,d_date#5729,d_month_seq#5730,d_week_seq#5731,d_quarter_seq#5732,d_year#5733,d_dow#5734,d_moy#5735,d_dom#5736,d_qoy#5737,d_fy_year#5738,d_fy_quarter_seq#5739,d_fy_week_seq#5740,d_day_name#5741,d_quarter_name#5742,d_holiday#5743,d_weekend#5744,d_following_holiday#5745,d_first_dom#5746,d_last_dom#5747,d_same_day_ly#5748,d_same_day_lq#5749,d_current_day#5750,d_current_week#5751,d_current_month#5752,d_current_quarter#5753,d_current_year#5754] parquet, Statistics(sizeInBytes=2.5 MiB)
               :              :     +- Join LeftSemi, (i_item_sk#6037 = ss_item_sk#5622), Statistics(sizeInBytes=256.7 KiB)
               :              :        :- Project [i_item_sk#6037, i_brand_id#6044, i_class_id#6046, i_category_id#6048], Statistics(sizeInBytes=256.7 KiB)
               :              :        :  +- Filter isnotnull(i_item_sk#6037), Statistics(sizeInBytes=3.1 MiB)
               :              :        :     +- Relation default.item[i_item_sk#6037,i_item_id#6038,i_rec_start_date#6039,i_rec_end_date#6040,i_item_desc#6041,i_current_price#6042,i_wholesale_cost#6043,i_brand_id#6044,i_brand#6045,i_class_id#6046,i_class#6047,i_category_id#6048,i_category#6049,i_manufact_id#6050,i_manufact#6051,i_size#6052,i_formulation#6053,i_color#6054,i_units#6055,i_container#6056,i_manager_id#6057,i_product_name#6058] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :        +- Project [i_item_sk#437 AS ss_item_sk#5622], Statistics(sizeInBytes=2.13E+22 B)
               :              :           +- Join Inner, (((i_brand_id#444 = brand_id#5619) AND (i_class_id#446 = class_id#5620)) AND (i_category_id#448 = category_id#5621)), Statistics(sizeInBytes=6.38E+22 B)
               :              :              :- Project [i_item_sk#437, i_brand_id#444, i_class_id#446, i_category_id#448], Statistics(sizeInBytes=256.7 KiB)
               :              :              :  +- Filter ((isnotnull(i_brand_id#444) AND isnotnull(i_class_id#446)) AND isnotnull(i_category_id#448)), Statistics(sizeInBytes=3.1 MiB)
               :              :              :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :              +- Join LeftSemi, (((brand_id#5619 <=> i_brand_id#5712) AND (class_id#5620 <=> i_class_id#5714)) AND (category_id#5621 <=> i_category_id#5716)), Statistics(sizeInBytes=215.7 PiB)
               :              :                 :- Aggregate [brand_id#5619, class_id#5620, category_id#5621], [brand_id#5619, class_id#5620, category_id#5621], Statistics(sizeInBytes=215.7 PiB)
               :              :                 :  +- Project [i_brand_id#5640 AS brand_id#5619, i_class_id#5642 AS class_id#5620, i_category_id#5644 AS category_id#5621], Statistics(sizeInBytes=215.7 PiB)
               :              :                 :     +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=302.0 PiB)
               :              :                 :        :- Project [ss_sold_date_sk#414, i_brand_id#5640, i_class_id#5642, i_category_id#5644], Statistics(sizeInBytes=2.9 TiB)
               :              :                 :        :  +- Join Inner, (ss_item_sk#416 = i_item_sk#5633), Statistics(sizeInBytes=3.8 TiB)
               :              :                 :        :     :- Project [ss_sold_date_sk#414, ss_item_sk#416], Statistics(sizeInBytes=15.3 MiB)
               :              :                 :        :     :  +- Filter (isnotnull(ss_item_sk#416) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
               :              :                 :        :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               :              :                 :        :     +- Join LeftSemi, (((i_brand_id#5640 <=> i_brand_id#5662) AND (i_class_id#5642 <=> i_class_id#5664)) AND (i_category_id#5644 <=> i_category_id#5666)), Statistics(sizeInBytes=256.7 KiB)
               :              :                 :        :        :- Project [i_item_sk#5633, i_brand_id#5640, i_class_id#5642, i_category_id#5644], Statistics(sizeInBytes=256.7 KiB)
               :              :                 :        :        :  +- Filter (isnotnull(i_item_sk#5633) AND ((isnotnull(i_brand_id#5640) AND isnotnull(i_class_id#5642)) AND isnotnull(i_category_id#5644))), Statistics(sizeInBytes=3.1 MiB)
               :              :                 :        :        :     +- Relation default.item[i_item_sk#5633,i_item_id#5634,i_rec_start_date#5635,i_rec_end_date#5636,i_item_desc#5637,i_current_price#5638,i_wholesale_cost#5639,i_brand_id#5640,i_brand#5641,i_class_id#5642,i_class#5643,i_category_id#5644,i_category#5645,i_manufact_id#5646,i_manufact#5647,i_size#5648,i_formulation#5649,i_color#5650,i_units#5651,i_container#5652,i_manager_id#5653,i_product_name#5654] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :                 :        :        +- Project [i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=117.4 PiB)
               :              :                 :        :           +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#5677), Statistics(sizeInBytes=164.3 PiB)
               :              :                 :        :              :- Project [cs_sold_date_sk#197, i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=1597.9 GiB)
               :              :                 :        :              :  +- Join Inner, (cs_item_sk#212 = i_item_sk#5655), Statistics(sizeInBytes=2.1 TiB)
               :              :                 :        :              :     :- Project [cs_sold_date_sk#197, cs_item_sk#212], Statistics(sizeInBytes=8.3 MiB)
               :              :                 :        :              :     :  +- Filter (isnotnull(cs_item_sk#212) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
               :              :                 :        :              :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
               :              :                 :        :              :     +- Project [i_item_sk#5655, i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=256.7 KiB)
               :              :                 :        :              :        +- Filter isnotnull(i_item_sk#5655), Statistics(sizeInBytes=3.1 MiB)
               :              :                 :        :              :           +- Relation default.item[i_item_sk#5655,i_item_id#5656,i_rec_start_date#5657,i_rec_end_date#5658,i_item_desc#5659,i_current_price#5660,i_wholesale_cost#5661,i_brand_id#5662,i_brand#5663,i_class_id#5664,i_class#5665,i_category_id#5666,i_category#5667,i_manufact_id#5668,i_manufact#5669,i_size#5670,i_formulation#5671,i_color#5672,i_units#5673,i_container#5674,i_manager_id#5675,i_product_name#5676] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :                 :        :              +- Project [d_date_sk#5677], Statistics(sizeInBytes=105.3 KiB)
               :              :                 :        :                 +- Filter ((isnotnull(d_year#5683) AND ((d_year#5683 >= 1999) AND (d_year#5683 <= 2001))) AND isnotnull(d_date_sk#5677)), Statistics(sizeInBytes=2.5 MiB)
               :              :                 :        :                    +- Relation default.date_dim[d_date_sk#5677,d_date_id#5678,d_date#5679,d_month_seq#5680,d_week_seq#5681,d_quarter_seq#5682,d_year#5683,d_dow#5684,d_moy#5685,d_dom#5686,d_qoy#5687,d_fy_year#5688,d_fy_quarter_seq#5689,d_fy_week_seq#5690,d_day_name#5691,d_quarter_name#5692,d_holiday#5693,d_weekend#5694,d_following_holiday#5695,d_first_dom#5696,d_last_dom#5697,d_same_day_ly#5698,d_same_day_lq#5699,d_current_day#5700,d_current_week#5701,d_current_month#5702,d_current_quarter#5703,d_current_year#5704] parquet, Statistics(sizeInBytes=2.5 MiB)
               :              :                 :        +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :              :                 :           +- Filter ((isnotnull(d_year#30) AND ((d_year#30 >= 1999) AND (d_year#30 <= 2001))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :              :                 :              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :              :                 +- Project [i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=57.7 PiB)
               :              :                    +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#5727), Statistics(sizeInBytes=80.7 PiB)
               :              :                       :- Project [ws_sold_date_sk#163, i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=784.9 GiB)
               :              :                       :  +- Join Inner, (ws_item_sk#166 = i_item_sk#5705), Statistics(sizeInBytes=1046.6 GiB)
               :              :                       :     :- Project [ws_sold_date_sk#163, ws_item_sk#166], Statistics(sizeInBytes=4.1 MiB)
               :              :                       :     :  +- Filter (isnotnull(ws_item_sk#166) AND isnotnull(ws_sold_date_sk#163)), Statistics(sizeInBytes=52.0 MiB)
               :              :                       :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
               :              :                       :     +- Project [i_item_sk#5705, i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=256.7 KiB)
               :              :                       :        +- Filter isnotnull(i_item_sk#5705), Statistics(sizeInBytes=3.1 MiB)
               :              :                       :           +- Relation default.item[i_item_sk#5705,i_item_id#5706,i_rec_start_date#5707,i_rec_end_date#5708,i_item_desc#5709,i_current_price#5710,i_wholesale_cost#5711,i_brand_id#5712,i_brand#5713,i_class_id#5714,i_class#5715,i_category_id#5716,i_category#5717,i_manufact_id#5718,i_manufact#5719,i_size#5720,i_formulation#5721,i_color#5722,i_units#5723,i_container#5724,i_manager_id#5725,i_product_name#5726] parquet, Statistics(sizeInBytes=3.1 MiB)
               :              :                       +- Project [d_date_sk#5727], Statistics(sizeInBytes=105.3 KiB)
               :              :                          +- Filter ((isnotnull(d_year#5733) AND ((d_year#5733 >= 1999) AND (d_year#5733 <= 2001))) AND isnotnull(d_date_sk#5727)), Statistics(sizeInBytes=2.5 MiB)
               :              :                             +- Relation default.date_dim[d_date_sk#5727,d_date_id#5728,d_date#5729,d_month_seq#5730,d_week_seq#5731,d_quarter_seq#5732,d_year#5733,d_dow#5734,d_moy#5735,d_dom#5736,d_qoy#5737,d_fy_year#5738,d_fy_quarter_seq#5739,d_fy_week_seq#5740,d_day_name#5741,d_quarter_name#5742,d_holiday#5743,d_weekend#5744,d_following_holiday#5745,d_first_dom#5746,d_last_dom#5747,d_same_day_ly#5748,d_same_day_lq#5749,d_current_day#5750,d_current_week#5751,d_current_month#5752,d_current_quarter#5753,d_current_year#5754] parquet, Statistics(sizeInBytes=2.5 MiB)
               :              +- Project [d_date_sk#6059], Statistics(sizeInBytes=105.3 KiB)
               :                 +- Filter (((isnotnull(d_year#6065) AND isnotnull(d_moy#6067)) AND ((d_year#6065 = 2001) AND (d_moy#6067 = 11))) AND isnotnull(d_date_sk#6059)), Statistics(sizeInBytes=2.5 MiB)
               :                    +- Relation default.date_dim[d_date_sk#6059,d_date_id#6060,d_date#6061,d_month_seq#6062,d_week_seq#6063,d_quarter_seq#6064,d_year#6065,d_dow#6066,d_moy#6067,d_dom#6068,d_qoy#6069,d_fy_year#6070,d_fy_quarter_seq#6071,d_fy_week_seq#6072,d_day_name#6073,d_quarter_name#6074,d_holiday#6075,d_weekend#6076,d_following_holiday#6077,d_first_dom#6078,d_last_dom#6079,d_same_day_ly#6080,d_same_day_lq#6081,d_current_day#6082,d_current_week#6083,d_current_month#6084,d_current_quarter#6085,d_current_year#6086] parquet, Statistics(sizeInBytes=2.5 MiB)
               +- Project [sales#5615, number_sales#5616L, web AS channel#6236, i_brand_id#6128, i_class_id#6130, i_category_id#6132], Statistics(sizeInBytes=246.6 PiB)
                  +- Filter (isnotnull(sales#5615) AND (cast(sales#5615 as decimal(32,6)) > cast(scalar-subquery#5618 [] as decimal(32,6)))), Statistics(sizeInBytes=169.5 PiB)
                     :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(quantity#5623 as decimal(12,2))) * promote_precision(cast(list_price#5624 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#5629], Statistics(sizeInBytes=24.0 B, rowCount=1)
                     :     +- Union false, false, Statistics(sizeInBytes=3.0 TiB)
                     :        :- Project [ss_quantity#5765 AS quantity#5623, ss_list_price#5767 AS list_price#5624], Statistics(sizeInBytes=1720.7 GiB)
                     :        :  +- Join Inner, (ss_sold_date_sk#5755 = d_date_sk#5778), Statistics(sizeInBytes=2.4 TiB)
                     :        :     :- Project [ss_sold_date_sk#5755, ss_quantity#5765, ss_list_price#5767], Statistics(sizeInBytes=22.9 MiB)
                     :        :     :  +- Filter isnotnull(ss_sold_date_sk#5755), Statistics(sizeInBytes=141.1 MiB)
                     :        :     :     +- Relation default.store_sales[ss_sold_date_sk#5755,ss_sold_time_sk#5756,ss_item_sk#5757,ss_customer_sk#5758,ss_cdemo_sk#5759,ss_hdemo_sk#5760,ss_addr_sk#5761,ss_store_sk#5762,ss_promo_sk#5763,ss_ticket_number#5764,ss_quantity#5765,ss_wholesale_cost#5766,ss_list_price#5767,ss_sales_price#5768,ss_ext_discount_amt#5769,ss_ext_sales_price#5770,ss_ext_wholesale_cost#5771,ss_ext_list_price#5772,ss_ext_tax#5773,ss_coupon_amt#5774,ss_net_paid#5775,ss_net_paid_inc_tax#5776,ss_net_profit#5777] parquet, Statistics(sizeInBytes=141.1 MiB)
                     :        :     +- Project [d_date_sk#5778], Statistics(sizeInBytes=105.3 KiB)
                     :        :        +- Filter ((isnotnull(d_year#5784) AND ((d_year#5784 >= 1999) AND (d_year#5784 <= 2001))) AND isnotnull(d_date_sk#5778)), Statistics(sizeInBytes=2.5 MiB)
                     :        :           +- Relation default.date_dim[d_date_sk#5778,d_date_id#5779,d_date#5780,d_month_seq#5781,d_week_seq#5782,d_quarter_seq#5783,d_year#5784,d_dow#5785,d_moy#5786,d_dom#5787,d_qoy#5788,d_fy_year#5789,d_fy_quarter_seq#5790,d_fy_week_seq#5791,d_day_name#5792,d_quarter_name#5793,d_holiday#5794,d_weekend#5795,d_following_holiday#5796,d_first_dom#5797,d_last_dom#5798,d_same_day_ly#5799,d_same_day_lq#5800,d_current_day#5801,d_current_week#5802,d_current_month#5803,d_current_quarter#5804,d_current_year#5805] parquet, Statistics(sizeInBytes=2.5 MiB)
                     :        :- Project [cs_quantity#5824 AS quantity#5625, cs_list_price#5826 AS list_price#5626], Statistics(sizeInBytes=936.4 GiB)
                     :        :  +- Join Inner, (cs_sold_date_sk#5806 = d_date_sk#5840), Statistics(sizeInBytes=1311.0 GiB)
                     :        :     :- Project [cs_sold_date_sk#5806, cs_quantity#5824, cs_list_price#5826], Statistics(sizeInBytes=12.4 MiB)
                     :        :     :  +- Filter isnotnull(cs_sold_date_sk#5806), Statistics(sizeInBytes=105.8 MiB)
                     :        :     :     +- Relation default.catalog_sales[cs_sold_date_sk#5806,cs_sold_time_sk#5807,cs_ship_date_sk#5808,cs_bill_customer_sk#5809,cs_bill_cdemo_sk#5810,cs_bill_hdemo_sk#5811,cs_bill_addr_sk#5812,cs_ship_customer_sk#5813,cs_ship_cdemo_sk#5814,cs_ship_hdemo_sk#5815,cs_ship_addr_sk#5816,cs_call_center_sk#5817,cs_catalog_page_sk#5818,cs_ship_mode_sk#5819,cs_warehouse_sk#5820,cs_item_sk#5821,cs_promo_sk#5822,cs_order_number#5823,cs_quantity#5824,cs_wholesale_cost#5825,cs_list_price#5826,cs_sales_price#5827,cs_ext_discount_amt#5828,cs_ext_sales_price#5829,cs_ext_wholesale_cost#5830,cs_ext_list_price#5831,cs_ext_tax#5832,cs_coupon_amt#5833,cs_ext_ship_cost#5834,cs_net_paid#5835,cs_net_paid_inc_tax#5836,cs_net_paid_inc_ship#5837,cs_net_paid_inc_ship_tax#5838,cs_net_profit#5839] parquet, Statistics(sizeInBytes=105.8 MiB)
                     :        :     +- Project [d_date_sk#5840], Statistics(sizeInBytes=105.3 KiB)
                     :        :        +- Filter ((isnotnull(d_year#5846) AND ((d_year#5846 >= 1999) AND (d_year#5846 <= 2001))) AND isnotnull(d_date_sk#5840)), Statistics(sizeInBytes=2.5 MiB)
                     :        :           +- Relation default.date_dim[d_date_sk#5840,d_date_id#5841,d_date#5842,d_month_seq#5843,d_week_seq#5844,d_quarter_seq#5845,d_year#5846,d_dow#5847,d_moy#5848,d_dom#5849,d_qoy#5850,d_fy_year#5851,d_fy_quarter_seq#5852,d_fy_week_seq#5853,d_day_name#5854,d_quarter_name#5855,d_holiday#5856,d_weekend#5857,d_following_holiday#5858,d_first_dom#5859,d_last_dom#5860,d_same_day_ly#5861,d_same_day_lq#5862,d_current_day#5863,d_current_week#5864,d_current_month#5865,d_current_quarter#5866,d_current_year#5867] parquet, Statistics(sizeInBytes=2.5 MiB)
                     :        +- Project [ws_quantity#5886 AS quantity#5627, ws_list_price#5888 AS list_price#5628], Statistics(sizeInBytes=460.0 GiB)
                     :           +- Join Inner, (ws_sold_date_sk#5868 = d_date_sk#5902), Statistics(sizeInBytes=644.0 GiB)
                     :              :- Project [ws_sold_date_sk#5868, ws_quantity#5886, ws_list_price#5888], Statistics(sizeInBytes=6.1 MiB)
                     :              :  +- Filter isnotnull(ws_sold_date_sk#5868), Statistics(sizeInBytes=52.0 MiB)
                     :              :     +- Relation default.web_sales[ws_sold_date_sk#5868,ws_sold_time_sk#5869,ws_ship_date_sk#5870,ws_item_sk#5871,ws_bill_customer_sk#5872,ws_bill_cdemo_sk#5873,ws_bill_hdemo_sk#5874,ws_bill_addr_sk#5875,ws_ship_customer_sk#5876,ws_ship_cdemo_sk#5877,ws_ship_hdemo_sk#5878,ws_ship_addr_sk#5879,ws_web_page_sk#5880,ws_web_site_sk#5881,ws_ship_mode_sk#5882,ws_warehouse_sk#5883,ws_promo_sk#5884,ws_order_number#5885,ws_quantity#5886,ws_wholesale_cost#5887,ws_list_price#5888,ws_sales_price#5889,ws_ext_discount_amt#5890,ws_ext_sales_price#5891,ws_ext_wholesale_cost#5892,ws_ext_list_price#5893,ws_ext_tax#5894,ws_coupon_amt#5895,ws_ext_ship_cost#5896,ws_net_paid#5897,ws_net_paid_inc_tax#5898,ws_net_paid_inc_ship#5899,ws_net_paid_inc_ship_tax#5900,ws_net_profit#5901] parquet, Statistics(sizeInBytes=52.0 MiB)
                     :              +- Project [d_date_sk#5902], Statistics(sizeInBytes=105.3 KiB)
                     :                 +- Filter ((isnotnull(d_year#5908) AND ((d_year#5908 >= 1999) AND (d_year#5908 <= 2001))) AND isnotnull(d_date_sk#5902)), Statistics(sizeInBytes=2.5 MiB)
                     :                    +- Relation default.date_dim[d_date_sk#5902,d_date_id#5903,d_date#5904,d_month_seq#5905,d_week_seq#5906,d_quarter_seq#5907,d_year#5908,d_dow#5909,d_moy#5910,d_dom#5911,d_qoy#5912,d_fy_year#5913,d_fy_quarter_seq#5914,d_fy_week_seq#5915,d_day_name#5916,d_quarter_name#5917,d_holiday#5918,d_weekend#5919,d_following_holiday#5920,d_first_dom#5921,d_last_dom#5922,d_same_day_ly#5923,d_same_day_lq#5924,d_current_day#5925,d_current_week#5926,d_current_month#5927,d_current_quarter#5928,d_current_year#5929] parquet, Statistics(sizeInBytes=2.5 MiB)
                     +- Aggregate [i_brand_id#6128, i_class_id#6130, i_category_id#6132], [i_brand_id#6128, i_class_id#6130, i_category_id#6132, sum(CheckOverflow((promote_precision(cast(ws_quantity#6105 as decimal(12,2))) * promote_precision(cast(ws_list_price#6107 as decimal(12,2)))), DecimalType(18,2))) AS sales#5615, count(1) AS number_sales#5616L], Statistics(sizeInBytes=169.5 PiB)
                        +- Project [ws_quantity#6105, ws_list_price#6107, i_brand_id#6128, i_class_id#6130, i_category_id#6132], Statistics(sizeInBytes=123.3 PiB)
                           +- Join Inner, (ws_sold_date_sk#6087 = d_date_sk#6143), Statistics(sizeInBytes=154.1 PiB)
                              :- Project [ws_sold_date_sk#6087, ws_quantity#6105, ws_list_price#6107, i_brand_id#6128, i_class_id#6130, i_category_id#6132], Statistics(sizeInBytes=1498.5 GiB)
                              :  +- Join Inner, (ws_item_sk#6090 = i_item_sk#6121), Statistics(sizeInBytes=1831.5 GiB)
                              :     :- Join LeftSemi, (ws_item_sk#6090 = ss_item_sk#5622), Statistics(sizeInBytes=7.1 MiB)
                              :     :  :- Project [ws_sold_date_sk#6087, ws_item_sk#6090, ws_quantity#6105, ws_list_price#6107], Statistics(sizeInBytes=7.1 MiB)
                              :     :  :  +- Filter (isnotnull(ws_item_sk#6090) AND isnotnull(ws_sold_date_sk#6087)), Statistics(sizeInBytes=52.0 MiB)
                              :     :  :     +- Relation default.web_sales[ws_sold_date_sk#6087,ws_sold_time_sk#6088,ws_ship_date_sk#6089,ws_item_sk#6090,ws_bill_customer_sk#6091,ws_bill_cdemo_sk#6092,ws_bill_hdemo_sk#6093,ws_bill_addr_sk#6094,ws_ship_customer_sk#6095,ws_ship_cdemo_sk#6096,ws_ship_hdemo_sk#6097,ws_ship_addr_sk#6098,ws_web_page_sk#6099,ws_web_site_sk#6100,ws_ship_mode_sk#6101,ws_warehouse_sk#6102,ws_promo_sk#6103,ws_order_number#6104,ws_quantity#6105,ws_wholesale_cost#6106,ws_list_price#6107,ws_sales_price#6108,ws_ext_discount_amt#6109,ws_ext_sales_price#6110,ws_ext_wholesale_cost#6111,ws_ext_list_price#6112,ws_ext_tax#6113,ws_coupon_amt#6114,ws_ext_ship_cost#6115,ws_net_paid#6116,ws_net_paid_inc_tax#6117,ws_net_paid_inc_ship#6118,ws_net_paid_inc_ship_tax#6119,ws_net_profit#6120] parquet, Statistics(sizeInBytes=52.0 MiB)
                              :     :  +- Project [i_item_sk#437 AS ss_item_sk#5622], Statistics(sizeInBytes=2.13E+22 B)
                              :     :     +- Join Inner, (((i_brand_id#444 = brand_id#5619) AND (i_class_id#446 = class_id#5620)) AND (i_category_id#448 = category_id#5621)), Statistics(sizeInBytes=6.38E+22 B)
                              :     :        :- Project [i_item_sk#437, i_brand_id#444, i_class_id#446, i_category_id#448], Statistics(sizeInBytes=256.7 KiB)
                              :     :        :  +- Filter ((isnotnull(i_brand_id#444) AND isnotnull(i_class_id#446)) AND isnotnull(i_category_id#448)), Statistics(sizeInBytes=3.1 MiB)
                              :     :        :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
                              :     :        +- Join LeftSemi, (((brand_id#5619 <=> i_brand_id#5712) AND (class_id#5620 <=> i_class_id#5714)) AND (category_id#5621 <=> i_category_id#5716)), Statistics(sizeInBytes=215.7 PiB)
                              :     :           :- Aggregate [brand_id#5619, class_id#5620, category_id#5621], [brand_id#5619, class_id#5620, category_id#5621], Statistics(sizeInBytes=215.7 PiB)
                              :     :           :  +- Project [i_brand_id#5640 AS brand_id#5619, i_class_id#5642 AS class_id#5620, i_category_id#5644 AS category_id#5621], Statistics(sizeInBytes=215.7 PiB)
                              :     :           :     +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=302.0 PiB)
                              :     :           :        :- Project [ss_sold_date_sk#414, i_brand_id#5640, i_class_id#5642, i_category_id#5644], Statistics(sizeInBytes=2.9 TiB)
                              :     :           :        :  +- Join Inner, (ss_item_sk#416 = i_item_sk#5633), Statistics(sizeInBytes=3.8 TiB)
                              :     :           :        :     :- Project [ss_sold_date_sk#414, ss_item_sk#416], Statistics(sizeInBytes=15.3 MiB)
                              :     :           :        :     :  +- Filter (isnotnull(ss_item_sk#416) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
                              :     :           :        :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                              :     :           :        :     +- Join LeftSemi, (((i_brand_id#5640 <=> i_brand_id#5662) AND (i_class_id#5642 <=> i_class_id#5664)) AND (i_category_id#5644 <=> i_category_id#5666)), Statistics(sizeInBytes=256.7 KiB)
                              :     :           :        :        :- Project [i_item_sk#5633, i_brand_id#5640, i_class_id#5642, i_category_id#5644], Statistics(sizeInBytes=256.7 KiB)
                              :     :           :        :        :  +- Filter (isnotnull(i_item_sk#5633) AND ((isnotnull(i_brand_id#5640) AND isnotnull(i_class_id#5642)) AND isnotnull(i_category_id#5644))), Statistics(sizeInBytes=3.1 MiB)
                              :     :           :        :        :     +- Relation default.item[i_item_sk#5633,i_item_id#5634,i_rec_start_date#5635,i_rec_end_date#5636,i_item_desc#5637,i_current_price#5638,i_wholesale_cost#5639,i_brand_id#5640,i_brand#5641,i_class_id#5642,i_class#5643,i_category_id#5644,i_category#5645,i_manufact_id#5646,i_manufact#5647,i_size#5648,i_formulation#5649,i_color#5650,i_units#5651,i_container#5652,i_manager_id#5653,i_product_name#5654] parquet, Statistics(sizeInBytes=3.1 MiB)
                              :     :           :        :        +- Project [i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=117.4 PiB)
                              :     :           :        :           +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#5677), Statistics(sizeInBytes=164.3 PiB)
                              :     :           :        :              :- Project [cs_sold_date_sk#197, i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=1597.9 GiB)
                              :     :           :        :              :  +- Join Inner, (cs_item_sk#212 = i_item_sk#5655), Statistics(sizeInBytes=2.1 TiB)
                              :     :           :        :              :     :- Project [cs_sold_date_sk#197, cs_item_sk#212], Statistics(sizeInBytes=8.3 MiB)
                              :     :           :        :              :     :  +- Filter (isnotnull(cs_item_sk#212) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
                              :     :           :        :              :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
                              :     :           :        :              :     +- Project [i_item_sk#5655, i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=256.7 KiB)
                              :     :           :        :              :        +- Filter isnotnull(i_item_sk#5655), Statistics(sizeInBytes=3.1 MiB)
                              :     :           :        :              :           +- Relation default.item[i_item_sk#5655,i_item_id#5656,i_rec_start_date#5657,i_rec_end_date#5658,i_item_desc#5659,i_current_price#5660,i_wholesale_cost#5661,i_brand_id#5662,i_brand#5663,i_class_id#5664,i_class#5665,i_category_id#5666,i_category#5667,i_manufact_id#5668,i_manufact#5669,i_size#5670,i_formulation#5671,i_color#5672,i_units#5673,i_container#5674,i_manager_id#5675,i_product_name#5676] parquet, Statistics(sizeInBytes=3.1 MiB)
                              :     :           :        :              +- Project [d_date_sk#5677], Statistics(sizeInBytes=105.3 KiB)
                              :     :           :        :                 +- Filter ((isnotnull(d_year#5683) AND ((d_year#5683 >= 1999) AND (d_year#5683 <= 2001))) AND isnotnull(d_date_sk#5677)), Statistics(sizeInBytes=2.5 MiB)
                              :     :           :        :                    +- Relation default.date_dim[d_date_sk#5677,d_date_id#5678,d_date#5679,d_month_seq#5680,d_week_seq#5681,d_quarter_seq#5682,d_year#5683,d_dow#5684,d_moy#5685,d_dom#5686,d_qoy#5687,d_fy_year#5688,d_fy_quarter_seq#5689,d_fy_week_seq#5690,d_day_name#5691,d_quarter_name#5692,d_holiday#5693,d_weekend#5694,d_following_holiday#5695,d_first_dom#5696,d_last_dom#5697,d_same_day_ly#5698,d_same_day_lq#5699,d_current_day#5700,d_current_week#5701,d_current_month#5702,d_current_quarter#5703,d_current_year#5704] parquet, Statistics(sizeInBytes=2.5 MiB)
                              :     :           :        +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                              :     :           :           +- Filter ((isnotnull(d_year#30) AND ((d_year#30 >= 1999) AND (d_year#30 <= 2001))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                              :     :           :              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                              :     :           +- Project [i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=57.7 PiB)
                              :     :              +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#5727), Statistics(sizeInBytes=80.7 PiB)
                              :     :                 :- Project [ws_sold_date_sk#163, i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=784.9 GiB)
                              :     :                 :  +- Join Inner, (ws_item_sk#166 = i_item_sk#5705), Statistics(sizeInBytes=1046.6 GiB)
                              :     :                 :     :- Project [ws_sold_date_sk#163, ws_item_sk#166], Statistics(sizeInBytes=4.1 MiB)
                              :     :                 :     :  +- Filter (isnotnull(ws_item_sk#166) AND isnotnull(ws_sold_date_sk#163)), Statistics(sizeInBytes=52.0 MiB)
                              :     :                 :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                              :     :                 :     +- Project [i_item_sk#5705, i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=256.7 KiB)
                              :     :                 :        +- Filter isnotnull(i_item_sk#5705), Statistics(sizeInBytes=3.1 MiB)
                              :     :                 :           +- Relation default.item[i_item_sk#5705,i_item_id#5706,i_rec_start_date#5707,i_rec_end_date#5708,i_item_desc#5709,i_current_price#5710,i_wholesale_cost#5711,i_brand_id#5712,i_brand#5713,i_class_id#5714,i_class#5715,i_category_id#5716,i_category#5717,i_manufact_id#5718,i_manufact#5719,i_size#5720,i_formulation#5721,i_color#5722,i_units#5723,i_container#5724,i_manager_id#5725,i_product_name#5726] parquet, Statistics(sizeInBytes=3.1 MiB)
                              :     :                 +- Project [d_date_sk#5727], Statistics(sizeInBytes=105.3 KiB)
                              :     :                    +- Filter ((isnotnull(d_year#5733) AND ((d_year#5733 >= 1999) AND (d_year#5733 <= 2001))) AND isnotnull(d_date_sk#5727)), Statistics(sizeInBytes=2.5 MiB)
                              :     :                       +- Relation default.date_dim[d_date_sk#5727,d_date_id#5728,d_date#5729,d_month_seq#5730,d_week_seq#5731,d_quarter_seq#5732,d_year#5733,d_dow#5734,d_moy#5735,d_dom#5736,d_qoy#5737,d_fy_year#5738,d_fy_quarter_seq#5739,d_fy_week_seq#5740,d_day_name#5741,d_quarter_name#5742,d_holiday#5743,d_weekend#5744,d_following_holiday#5745,d_first_dom#5746,d_last_dom#5747,d_same_day_ly#5748,d_same_day_lq#5749,d_current_day#5750,d_current_week#5751,d_current_month#5752,d_current_quarter#5753,d_current_year#5754] parquet, Statistics(sizeInBytes=2.5 MiB)
                              :     +- Join LeftSemi, (i_item_sk#6121 = ss_item_sk#5622), Statistics(sizeInBytes=256.7 KiB)
                              :        :- Project [i_item_sk#6121, i_brand_id#6128, i_class_id#6130, i_category_id#6132], Statistics(sizeInBytes=256.7 KiB)
                              :        :  +- Filter isnotnull(i_item_sk#6121), Statistics(sizeInBytes=3.1 MiB)
                              :        :     +- Relation default.item[i_item_sk#6121,i_item_id#6122,i_rec_start_date#6123,i_rec_end_date#6124,i_item_desc#6125,i_current_price#6126,i_wholesale_cost#6127,i_brand_id#6128,i_brand#6129,i_class_id#6130,i_class#6131,i_category_id#6132,i_category#6133,i_manufact_id#6134,i_manufact#6135,i_size#6136,i_formulation#6137,i_color#6138,i_units#6139,i_container#6140,i_manager_id#6141,i_product_name#6142] parquet, Statistics(sizeInBytes=3.1 MiB)
                              :        +- Project [i_item_sk#437 AS ss_item_sk#5622], Statistics(sizeInBytes=2.13E+22 B)
                              :           +- Join Inner, (((i_brand_id#444 = brand_id#5619) AND (i_class_id#446 = class_id#5620)) AND (i_category_id#448 = category_id#5621)), Statistics(sizeInBytes=6.38E+22 B)
                              :              :- Project [i_item_sk#437, i_brand_id#444, i_class_id#446, i_category_id#448], Statistics(sizeInBytes=256.7 KiB)
                              :              :  +- Filter ((isnotnull(i_brand_id#444) AND isnotnull(i_class_id#446)) AND isnotnull(i_category_id#448)), Statistics(sizeInBytes=3.1 MiB)
                              :              :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
                              :              +- Join LeftSemi, (((brand_id#5619 <=> i_brand_id#5712) AND (class_id#5620 <=> i_class_id#5714)) AND (category_id#5621 <=> i_category_id#5716)), Statistics(sizeInBytes=215.7 PiB)
                              :                 :- Aggregate [brand_id#5619, class_id#5620, category_id#5621], [brand_id#5619, class_id#5620, category_id#5621], Statistics(sizeInBytes=215.7 PiB)
                              :                 :  +- Project [i_brand_id#5640 AS brand_id#5619, i_class_id#5642 AS class_id#5620, i_category_id#5644 AS category_id#5621], Statistics(sizeInBytes=215.7 PiB)
                              :                 :     +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=302.0 PiB)
                              :                 :        :- Project [ss_sold_date_sk#414, i_brand_id#5640, i_class_id#5642, i_category_id#5644], Statistics(sizeInBytes=2.9 TiB)
                              :                 :        :  +- Join Inner, (ss_item_sk#416 = i_item_sk#5633), Statistics(sizeInBytes=3.8 TiB)
                              :                 :        :     :- Project [ss_sold_date_sk#414, ss_item_sk#416], Statistics(sizeInBytes=15.3 MiB)
                              :                 :        :     :  +- Filter (isnotnull(ss_item_sk#416) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
                              :                 :        :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                              :                 :        :     +- Join LeftSemi, (((i_brand_id#5640 <=> i_brand_id#5662) AND (i_class_id#5642 <=> i_class_id#5664)) AND (i_category_id#5644 <=> i_category_id#5666)), Statistics(sizeInBytes=256.7 KiB)
                              :                 :        :        :- Project [i_item_sk#5633, i_brand_id#5640, i_class_id#5642, i_category_id#5644], Statistics(sizeInBytes=256.7 KiB)
                              :                 :        :        :  +- Filter (isnotnull(i_item_sk#5633) AND ((isnotnull(i_brand_id#5640) AND isnotnull(i_class_id#5642)) AND isnotnull(i_category_id#5644))), Statistics(sizeInBytes=3.1 MiB)
                              :                 :        :        :     +- Relation default.item[i_item_sk#5633,i_item_id#5634,i_rec_start_date#5635,i_rec_end_date#5636,i_item_desc#5637,i_current_price#5638,i_wholesale_cost#5639,i_brand_id#5640,i_brand#5641,i_class_id#5642,i_class#5643,i_category_id#5644,i_category#5645,i_manufact_id#5646,i_manufact#5647,i_size#5648,i_formulation#5649,i_color#5650,i_units#5651,i_container#5652,i_manager_id#5653,i_product_name#5654] parquet, Statistics(sizeInBytes=3.1 MiB)
                              :                 :        :        +- Project [i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=117.4 PiB)
                              :                 :        :           +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#5677), Statistics(sizeInBytes=164.3 PiB)
                              :                 :        :              :- Project [cs_sold_date_sk#197, i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=1597.9 GiB)
                              :                 :        :              :  +- Join Inner, (cs_item_sk#212 = i_item_sk#5655), Statistics(sizeInBytes=2.1 TiB)
                              :                 :        :              :     :- Project [cs_sold_date_sk#197, cs_item_sk#212], Statistics(sizeInBytes=8.3 MiB)
                              :                 :        :              :     :  +- Filter (isnotnull(cs_item_sk#212) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
                              :                 :        :              :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
                              :                 :        :              :     +- Project [i_item_sk#5655, i_brand_id#5662, i_class_id#5664, i_category_id#5666], Statistics(sizeInBytes=256.7 KiB)
                              :                 :        :              :        +- Filter isnotnull(i_item_sk#5655), Statistics(sizeInBytes=3.1 MiB)
                              :                 :        :              :           +- Relation default.item[i_item_sk#5655,i_item_id#5656,i_rec_start_date#5657,i_rec_end_date#5658,i_item_desc#5659,i_current_price#5660,i_wholesale_cost#5661,i_brand_id#5662,i_brand#5663,i_class_id#5664,i_class#5665,i_category_id#5666,i_category#5667,i_manufact_id#5668,i_manufact#5669,i_size#5670,i_formulation#5671,i_color#5672,i_units#5673,i_container#5674,i_manager_id#5675,i_product_name#5676] parquet, Statistics(sizeInBytes=3.1 MiB)
                              :                 :        :              +- Project [d_date_sk#5677], Statistics(sizeInBytes=105.3 KiB)
                              :                 :        :                 +- Filter ((isnotnull(d_year#5683) AND ((d_year#5683 >= 1999) AND (d_year#5683 <= 2001))) AND isnotnull(d_date_sk#5677)), Statistics(sizeInBytes=2.5 MiB)
                              :                 :        :                    +- Relation default.date_dim[d_date_sk#5677,d_date_id#5678,d_date#5679,d_month_seq#5680,d_week_seq#5681,d_quarter_seq#5682,d_year#5683,d_dow#5684,d_moy#5685,d_dom#5686,d_qoy#5687,d_fy_year#5688,d_fy_quarter_seq#5689,d_fy_week_seq#5690,d_day_name#5691,d_quarter_name#5692,d_holiday#5693,d_weekend#5694,d_following_holiday#5695,d_first_dom#5696,d_last_dom#5697,d_same_day_ly#5698,d_same_day_lq#5699,d_current_day#5700,d_current_week#5701,d_current_month#5702,d_current_quarter#5703,d_current_year#5704] parquet, Statistics(sizeInBytes=2.5 MiB)
                              :                 :        +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                              :                 :           +- Filter ((isnotnull(d_year#30) AND ((d_year#30 >= 1999) AND (d_year#30 <= 2001))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                              :                 :              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                              :                 +- Project [i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=57.7 PiB)
                              :                    +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#5727), Statistics(sizeInBytes=80.7 PiB)
                              :                       :- Project [ws_sold_date_sk#163, i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=784.9 GiB)
                              :                       :  +- Join Inner, (ws_item_sk#166 = i_item_sk#5705), Statistics(sizeInBytes=1046.6 GiB)
                              :                       :     :- Project [ws_sold_date_sk#163, ws_item_sk#166], Statistics(sizeInBytes=4.1 MiB)
                              :                       :     :  +- Filter (isnotnull(ws_item_sk#166) AND isnotnull(ws_sold_date_sk#163)), Statistics(sizeInBytes=52.0 MiB)
                              :                       :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                              :                       :     +- Project [i_item_sk#5705, i_brand_id#5712, i_class_id#5714, i_category_id#5716], Statistics(sizeInBytes=256.7 KiB)
                              :                       :        +- Filter isnotnull(i_item_sk#5705), Statistics(sizeInBytes=3.1 MiB)
                              :                       :           +- Relation default.item[i_item_sk#5705,i_item_id#5706,i_rec_start_date#5707,i_rec_end_date#5708,i_item_desc#5709,i_current_price#5710,i_wholesale_cost#5711,i_brand_id#5712,i_brand#5713,i_class_id#5714,i_class#5715,i_category_id#5716,i_category#5717,i_manufact_id#5718,i_manufact#5719,i_size#5720,i_formulation#5721,i_color#5722,i_units#5723,i_container#5724,i_manager_id#5725,i_product_name#5726] parquet, Statistics(sizeInBytes=3.1 MiB)
                              :                       +- Project [d_date_sk#5727], Statistics(sizeInBytes=105.3 KiB)
                              :                          +- Filter ((isnotnull(d_year#5733) AND ((d_year#5733 >= 1999) AND (d_year#5733 <= 2001))) AND isnotnull(d_date_sk#5727)), Statistics(sizeInBytes=2.5 MiB)
                              :                             +- Relation default.date_dim[d_date_sk#5727,d_date_id#5728,d_date#5729,d_month_seq#5730,d_week_seq#5731,d_quarter_seq#5732,d_year#5733,d_dow#5734,d_moy#5735,d_dom#5736,d_qoy#5737,d_fy_year#5738,d_fy_quarter_seq#5739,d_fy_week_seq#5740,d_day_name#5741,d_quarter_name#5742,d_holiday#5743,d_weekend#5744,d_following_holiday#5745,d_first_dom#5746,d_last_dom#5747,d_same_day_ly#5748,d_same_day_lq#5749,d_current_day#5750,d_current_week#5751,d_current_month#5752,d_current_quarter#5753,d_current_year#5754] parquet, Statistics(sizeInBytes=2.5 MiB)
                              +- Project [d_date_sk#6143], Statistics(sizeInBytes=105.3 KiB)
                                 +- Filter (((isnotnull(d_year#6149) AND isnotnull(d_moy#6151)) AND ((d_year#6149 = 2001) AND (d_moy#6151 = 11))) AND isnotnull(d_date_sk#6143)), Statistics(sizeInBytes=2.5 MiB)
                                    +- Relation default.date_dim[d_date_sk#6143,d_date_id#6144,d_date#6145,d_month_seq#6146,d_week_seq#6147,d_quarter_seq#6148,d_year#6149,d_dow#6150,d_moy#6151,d_dom#6152,d_qoy#6153,d_fy_year#6154,d_fy_quarter_seq#6155,d_fy_week_seq#6156,d_day_name#6157,d_quarter_name#6158,d_holiday#6159,d_weekend#6160,d_following_holiday#6161,d_first_dom#6162,d_last_dom#6163,d_same_day_ly#6164,d_same_day_lq#6165,d_current_day#6166,d_current_week#6167,d_current_month#6168,d_current_quarter#6169,d_current_year#6170] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q14b ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=11.7 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.08E+36 B)
   +- Sort [i_brand_id#6791 ASC NULLS FIRST, i_class_id#6793 ASC NULLS FIRST, i_category_id#6795 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.08E+36 B)
      +- Join Inner, (((i_brand_id#6791 = i_brand_id#6864) AND (i_class_id#6793 = i_class_id#6866)) AND (i_category_id#6795 = i_category_id#6868)), Statistics(sizeInBytes=1.08E+36 B)
         :- Filter (isnotnull(sales#6440) AND (cast(sales#6440 as decimal(32,6)) > cast(scalar-subquery#6444 [] as decimal(32,6)))), Statistics(sizeInBytes=922.3 PiB)
         :  :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(quantity#6455 as decimal(12,2))) * promote_precision(cast(list_price#6456 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#6461], Statistics(sizeInBytes=24.0 B, rowCount=1)
         :  :     +- Union false, false, Statistics(sizeInBytes=3.0 TiB)
         :  :        :- Project [ss_quantity#6596 AS quantity#6455, ss_list_price#6598 AS list_price#6456], Statistics(sizeInBytes=1720.7 GiB)
         :  :        :  +- Join Inner, (ss_sold_date_sk#6586 = d_date_sk#6609), Statistics(sizeInBytes=2.4 TiB)
         :  :        :     :- Project [ss_sold_date_sk#6586, ss_quantity#6596, ss_list_price#6598], Statistics(sizeInBytes=22.9 MiB)
         :  :        :     :  +- Filter isnotnull(ss_sold_date_sk#6586), Statistics(sizeInBytes=141.1 MiB)
         :  :        :     :     +- Relation default.store_sales[ss_sold_date_sk#6586,ss_sold_time_sk#6587,ss_item_sk#6588,ss_customer_sk#6589,ss_cdemo_sk#6590,ss_hdemo_sk#6591,ss_addr_sk#6592,ss_store_sk#6593,ss_promo_sk#6594,ss_ticket_number#6595,ss_quantity#6596,ss_wholesale_cost#6597,ss_list_price#6598,ss_sales_price#6599,ss_ext_discount_amt#6600,ss_ext_sales_price#6601,ss_ext_wholesale_cost#6602,ss_ext_list_price#6603,ss_ext_tax#6604,ss_coupon_amt#6605,ss_net_paid#6606,ss_net_paid_inc_tax#6607,ss_net_profit#6608] parquet, Statistics(sizeInBytes=141.1 MiB)
         :  :        :     +- Project [d_date_sk#6609], Statistics(sizeInBytes=105.3 KiB)
         :  :        :        +- Filter ((isnotnull(d_year#6615) AND ((d_year#6615 >= 1999) AND (d_year#6615 <= 2001))) AND isnotnull(d_date_sk#6609)), Statistics(sizeInBytes=2.5 MiB)
         :  :        :           +- Relation default.date_dim[d_date_sk#6609,d_date_id#6610,d_date#6611,d_month_seq#6612,d_week_seq#6613,d_quarter_seq#6614,d_year#6615,d_dow#6616,d_moy#6617,d_dom#6618,d_qoy#6619,d_fy_year#6620,d_fy_quarter_seq#6621,d_fy_week_seq#6622,d_day_name#6623,d_quarter_name#6624,d_holiday#6625,d_weekend#6626,d_following_holiday#6627,d_first_dom#6628,d_last_dom#6629,d_same_day_ly#6630,d_same_day_lq#6631,d_current_day#6632,d_current_week#6633,d_current_month#6634,d_current_quarter#6635,d_current_year#6636] parquet, Statistics(sizeInBytes=2.5 MiB)
         :  :        :- Project [cs_quantity#6655 AS quantity#6457, cs_list_price#6657 AS list_price#6458], Statistics(sizeInBytes=936.4 GiB)
         :  :        :  +- Join Inner, (cs_sold_date_sk#6637 = d_date_sk#6671), Statistics(sizeInBytes=1311.0 GiB)
         :  :        :     :- Project [cs_sold_date_sk#6637, cs_quantity#6655, cs_list_price#6657], Statistics(sizeInBytes=12.4 MiB)
         :  :        :     :  +- Filter isnotnull(cs_sold_date_sk#6637), Statistics(sizeInBytes=105.8 MiB)
         :  :        :     :     +- Relation default.catalog_sales[cs_sold_date_sk#6637,cs_sold_time_sk#6638,cs_ship_date_sk#6639,cs_bill_customer_sk#6640,cs_bill_cdemo_sk#6641,cs_bill_hdemo_sk#6642,cs_bill_addr_sk#6643,cs_ship_customer_sk#6644,cs_ship_cdemo_sk#6645,cs_ship_hdemo_sk#6646,cs_ship_addr_sk#6647,cs_call_center_sk#6648,cs_catalog_page_sk#6649,cs_ship_mode_sk#6650,cs_warehouse_sk#6651,cs_item_sk#6652,cs_promo_sk#6653,cs_order_number#6654,cs_quantity#6655,cs_wholesale_cost#6656,cs_list_price#6657,cs_sales_price#6658,cs_ext_discount_amt#6659,cs_ext_sales_price#6660,cs_ext_wholesale_cost#6661,cs_ext_list_price#6662,cs_ext_tax#6663,cs_coupon_amt#6664,cs_ext_ship_cost#6665,cs_net_paid#6666,cs_net_paid_inc_tax#6667,cs_net_paid_inc_ship#6668,cs_net_paid_inc_ship_tax#6669,cs_net_profit#6670] parquet, Statistics(sizeInBytes=105.8 MiB)
         :  :        :     +- Project [d_date_sk#6671], Statistics(sizeInBytes=105.3 KiB)
         :  :        :        +- Filter ((isnotnull(d_year#6677) AND ((d_year#6677 >= 1999) AND (d_year#6677 <= 2001))) AND isnotnull(d_date_sk#6671)), Statistics(sizeInBytes=2.5 MiB)
         :  :        :           +- Relation default.date_dim[d_date_sk#6671,d_date_id#6672,d_date#6673,d_month_seq#6674,d_week_seq#6675,d_quarter_seq#6676,d_year#6677,d_dow#6678,d_moy#6679,d_dom#6680,d_qoy#6681,d_fy_year#6682,d_fy_quarter_seq#6683,d_fy_week_seq#6684,d_day_name#6685,d_quarter_name#6686,d_holiday#6687,d_weekend#6688,d_following_holiday#6689,d_first_dom#6690,d_last_dom#6691,d_same_day_ly#6692,d_same_day_lq#6693,d_current_day#6694,d_current_week#6695,d_current_month#6696,d_current_quarter#6697,d_current_year#6698] parquet, Statistics(sizeInBytes=2.5 MiB)
         :  :        +- Project [ws_quantity#6717 AS quantity#6459, ws_list_price#6719 AS list_price#6460], Statistics(sizeInBytes=460.0 GiB)
         :  :           +- Join Inner, (ws_sold_date_sk#6699 = d_date_sk#6733), Statistics(sizeInBytes=644.0 GiB)
         :  :              :- Project [ws_sold_date_sk#6699, ws_quantity#6717, ws_list_price#6719], Statistics(sizeInBytes=6.1 MiB)
         :  :              :  +- Filter isnotnull(ws_sold_date_sk#6699), Statistics(sizeInBytes=52.0 MiB)
         :  :              :     +- Relation default.web_sales[ws_sold_date_sk#6699,ws_sold_time_sk#6700,ws_ship_date_sk#6701,ws_item_sk#6702,ws_bill_customer_sk#6703,ws_bill_cdemo_sk#6704,ws_bill_hdemo_sk#6705,ws_bill_addr_sk#6706,ws_ship_customer_sk#6707,ws_ship_cdemo_sk#6708,ws_ship_hdemo_sk#6709,ws_ship_addr_sk#6710,ws_web_page_sk#6711,ws_web_site_sk#6712,ws_ship_mode_sk#6713,ws_warehouse_sk#6714,ws_promo_sk#6715,ws_order_number#6716,ws_quantity#6717,ws_wholesale_cost#6718,ws_list_price#6719,ws_sales_price#6720,ws_ext_discount_amt#6721,ws_ext_sales_price#6722,ws_ext_wholesale_cost#6723,ws_ext_list_price#6724,ws_ext_tax#6725,ws_coupon_amt#6726,ws_ext_ship_cost#6727,ws_net_paid#6728,ws_net_paid_inc_tax#6729,ws_net_paid_inc_ship#6730,ws_net_paid_inc_ship_tax#6731,ws_net_profit#6732] parquet, Statistics(sizeInBytes=52.0 MiB)
         :  :              +- Project [d_date_sk#6733], Statistics(sizeInBytes=105.3 KiB)
         :  :                 +- Filter ((isnotnull(d_year#6739) AND ((d_year#6739 >= 1999) AND (d_year#6739 <= 2001))) AND isnotnull(d_date_sk#6733)), Statistics(sizeInBytes=2.5 MiB)
         :  :                    +- Relation default.date_dim[d_date_sk#6733,d_date_id#6734,d_date#6735,d_month_seq#6736,d_week_seq#6737,d_quarter_seq#6738,d_year#6739,d_dow#6740,d_moy#6741,d_dom#6742,d_qoy#6743,d_fy_year#6744,d_fy_quarter_seq#6745,d_fy_week_seq#6746,d_day_name#6747,d_quarter_name#6748,d_holiday#6749,d_weekend#6750,d_following_holiday#6751,d_first_dom#6752,d_last_dom#6753,d_same_day_ly#6754,d_same_day_lq#6755,d_current_day#6756,d_current_week#6757,d_current_month#6758,d_current_quarter#6759,d_current_year#6760] parquet, Statistics(sizeInBytes=2.5 MiB)
         :  +- Aggregate [i_brand_id#6791, i_class_id#6793, i_category_id#6795], [store AS channel#6439, i_brand_id#6791, i_class_id#6793, i_category_id#6795, sum(CheckOverflow((promote_precision(cast(ss_quantity#6771 as decimal(12,2))) * promote_precision(cast(ss_list_price#6773 as decimal(12,2)))), DecimalType(18,2))) AS sales#6440, count(1) AS number_sales#6441L], Statistics(sizeInBytes=922.3 PiB)
         :     +- Project [ss_quantity#6771, ss_list_price#6773, i_brand_id#6791, i_class_id#6793, i_category_id#6795], Statistics(sizeInBytes=461.2 PiB)
         :        +- Join Inner, (ss_sold_date_sk#6761 = d_date_sk#6806), Statistics(sizeInBytes=576.5 PiB)
         :           :- Project [ss_sold_date_sk#6761, ss_quantity#6771, ss_list_price#6773, i_brand_id#6791, i_class_id#6793, i_category_id#6795], Statistics(sizeInBytes=5.5 TiB)
         :           :  +- Join Inner, (ss_item_sk#6763 = i_item_sk#6784), Statistics(sizeInBytes=6.7 TiB)
         :           :     :- Join LeftSemi, (ss_item_sk#6763 = ss_item_sk#6454), Statistics(sizeInBytes=26.7 MiB)
         :           :     :  :- Project [ss_sold_date_sk#6761, ss_item_sk#6763, ss_quantity#6771, ss_list_price#6773], Statistics(sizeInBytes=26.7 MiB)
         :           :     :  :  +- Filter (isnotnull(ss_item_sk#6763) AND isnotnull(ss_sold_date_sk#6761)), Statistics(sizeInBytes=141.1 MiB)
         :           :     :  :     +- Relation default.store_sales[ss_sold_date_sk#6761,ss_sold_time_sk#6762,ss_item_sk#6763,ss_customer_sk#6764,ss_cdemo_sk#6765,ss_hdemo_sk#6766,ss_addr_sk#6767,ss_store_sk#6768,ss_promo_sk#6769,ss_ticket_number#6770,ss_quantity#6771,ss_wholesale_cost#6772,ss_list_price#6773,ss_sales_price#6774,ss_ext_discount_amt#6775,ss_ext_sales_price#6776,ss_ext_wholesale_cost#6777,ss_ext_list_price#6778,ss_ext_tax#6779,ss_coupon_amt#6780,ss_net_paid#6781,ss_net_paid_inc_tax#6782,ss_net_profit#6783] parquet, Statistics(sizeInBytes=141.1 MiB)
         :           :     :  +- Project [i_item_sk#437 AS ss_item_sk#6454], Statistics(sizeInBytes=2.13E+22 B)
         :           :     :     +- Join Inner, (((i_brand_id#444 = brand_id#6451) AND (i_class_id#446 = class_id#6452)) AND (i_category_id#448 = category_id#6453)), Statistics(sizeInBytes=6.38E+22 B)
         :           :     :        :- Project [i_item_sk#437, i_brand_id#444, i_class_id#446, i_category_id#448], Statistics(sizeInBytes=256.7 KiB)
         :           :     :        :  +- Filter ((isnotnull(i_brand_id#444) AND isnotnull(i_class_id#446)) AND isnotnull(i_category_id#448)), Statistics(sizeInBytes=3.1 MiB)
         :           :     :        :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
         :           :     :        +- Join LeftSemi, (((brand_id#6451 <=> i_brand_id#6543) AND (class_id#6452 <=> i_class_id#6545)) AND (category_id#6453 <=> i_category_id#6547)), Statistics(sizeInBytes=215.7 PiB)
         :           :     :           :- Aggregate [brand_id#6451, class_id#6452, category_id#6453], [brand_id#6451, class_id#6452, category_id#6453], Statistics(sizeInBytes=215.7 PiB)
         :           :     :           :  +- Project [i_brand_id#6471 AS brand_id#6451, i_class_id#6473 AS class_id#6452, i_category_id#6475 AS category_id#6453], Statistics(sizeInBytes=215.7 PiB)
         :           :     :           :     +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=302.0 PiB)
         :           :     :           :        :- Project [ss_sold_date_sk#414, i_brand_id#6471, i_class_id#6473, i_category_id#6475], Statistics(sizeInBytes=2.9 TiB)
         :           :     :           :        :  +- Join Inner, (ss_item_sk#416 = i_item_sk#6464), Statistics(sizeInBytes=3.8 TiB)
         :           :     :           :        :     :- Project [ss_sold_date_sk#414, ss_item_sk#416], Statistics(sizeInBytes=15.3 MiB)
         :           :     :           :        :     :  +- Filter (isnotnull(ss_item_sk#416) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
         :           :     :           :        :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
         :           :     :           :        :     +- Join LeftSemi, (((i_brand_id#6471 <=> i_brand_id#6493) AND (i_class_id#6473 <=> i_class_id#6495)) AND (i_category_id#6475 <=> i_category_id#6497)), Statistics(sizeInBytes=256.7 KiB)
         :           :     :           :        :        :- Project [i_item_sk#6464, i_brand_id#6471, i_class_id#6473, i_category_id#6475], Statistics(sizeInBytes=256.7 KiB)
         :           :     :           :        :        :  +- Filter (isnotnull(i_item_sk#6464) AND ((isnotnull(i_brand_id#6471) AND isnotnull(i_class_id#6473)) AND isnotnull(i_category_id#6475))), Statistics(sizeInBytes=3.1 MiB)
         :           :     :           :        :        :     +- Relation default.item[i_item_sk#6464,i_item_id#6465,i_rec_start_date#6466,i_rec_end_date#6467,i_item_desc#6468,i_current_price#6469,i_wholesale_cost#6470,i_brand_id#6471,i_brand#6472,i_class_id#6473,i_class#6474,i_category_id#6475,i_category#6476,i_manufact_id#6477,i_manufact#6478,i_size#6479,i_formulation#6480,i_color#6481,i_units#6482,i_container#6483,i_manager_id#6484,i_product_name#6485] parquet, Statistics(sizeInBytes=3.1 MiB)
         :           :     :           :        :        +- Project [i_brand_id#6493, i_class_id#6495, i_category_id#6497], Statistics(sizeInBytes=117.4 PiB)
         :           :     :           :        :           +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#6508), Statistics(sizeInBytes=164.3 PiB)
         :           :     :           :        :              :- Project [cs_sold_date_sk#197, i_brand_id#6493, i_class_id#6495, i_category_id#6497], Statistics(sizeInBytes=1597.9 GiB)
         :           :     :           :        :              :  +- Join Inner, (cs_item_sk#212 = i_item_sk#6486), Statistics(sizeInBytes=2.1 TiB)
         :           :     :           :        :              :     :- Project [cs_sold_date_sk#197, cs_item_sk#212], Statistics(sizeInBytes=8.3 MiB)
         :           :     :           :        :              :     :  +- Filter (isnotnull(cs_item_sk#212) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
         :           :     :           :        :              :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
         :           :     :           :        :              :     +- Project [i_item_sk#6486, i_brand_id#6493, i_class_id#6495, i_category_id#6497], Statistics(sizeInBytes=256.7 KiB)
         :           :     :           :        :              :        +- Filter isnotnull(i_item_sk#6486), Statistics(sizeInBytes=3.1 MiB)
         :           :     :           :        :              :           +- Relation default.item[i_item_sk#6486,i_item_id#6487,i_rec_start_date#6488,i_rec_end_date#6489,i_item_desc#6490,i_current_price#6491,i_wholesale_cost#6492,i_brand_id#6493,i_brand#6494,i_class_id#6495,i_class#6496,i_category_id#6497,i_category#6498,i_manufact_id#6499,i_manufact#6500,i_size#6501,i_formulation#6502,i_color#6503,i_units#6504,i_container#6505,i_manager_id#6506,i_product_name#6507] parquet, Statistics(sizeInBytes=3.1 MiB)
         :           :     :           :        :              +- Project [d_date_sk#6508], Statistics(sizeInBytes=105.3 KiB)
         :           :     :           :        :                 +- Filter ((isnotnull(d_year#6514) AND ((d_year#6514 >= 1999) AND (d_year#6514 <= 2001))) AND isnotnull(d_date_sk#6508)), Statistics(sizeInBytes=2.5 MiB)
         :           :     :           :        :                    +- Relation default.date_dim[d_date_sk#6508,d_date_id#6509,d_date#6510,d_month_seq#6511,d_week_seq#6512,d_quarter_seq#6513,d_year#6514,d_dow#6515,d_moy#6516,d_dom#6517,d_qoy#6518,d_fy_year#6519,d_fy_quarter_seq#6520,d_fy_week_seq#6521,d_day_name#6522,d_quarter_name#6523,d_holiday#6524,d_weekend#6525,d_following_holiday#6526,d_first_dom#6527,d_last_dom#6528,d_same_day_ly#6529,d_same_day_lq#6530,d_current_day#6531,d_current_week#6532,d_current_month#6533,d_current_quarter#6534,d_current_year#6535] parquet, Statistics(sizeInBytes=2.5 MiB)
         :           :     :           :        +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
         :           :     :           :           +- Filter ((isnotnull(d_year#30) AND ((d_year#30 >= 1999) AND (d_year#30 <= 2001))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
         :           :     :           :              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
         :           :     :           +- Project [i_brand_id#6543, i_class_id#6545, i_category_id#6547], Statistics(sizeInBytes=57.7 PiB)
         :           :     :              +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#6558), Statistics(sizeInBytes=80.7 PiB)
         :           :     :                 :- Project [ws_sold_date_sk#163, i_brand_id#6543, i_class_id#6545, i_category_id#6547], Statistics(sizeInBytes=784.9 GiB)
         :           :     :                 :  +- Join Inner, (ws_item_sk#166 = i_item_sk#6536), Statistics(sizeInBytes=1046.6 GiB)
         :           :     :                 :     :- Project [ws_sold_date_sk#163, ws_item_sk#166], Statistics(sizeInBytes=4.1 MiB)
         :           :     :                 :     :  +- Filter (isnotnull(ws_item_sk#166) AND isnotnull(ws_sold_date_sk#163)), Statistics(sizeInBytes=52.0 MiB)
         :           :     :                 :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
         :           :     :                 :     +- Project [i_item_sk#6536, i_brand_id#6543, i_class_id#6545, i_category_id#6547], Statistics(sizeInBytes=256.7 KiB)
         :           :     :                 :        +- Filter isnotnull(i_item_sk#6536), Statistics(sizeInBytes=3.1 MiB)
         :           :     :                 :           +- Relation default.item[i_item_sk#6536,i_item_id#6537,i_rec_start_date#6538,i_rec_end_date#6539,i_item_desc#6540,i_current_price#6541,i_wholesale_cost#6542,i_brand_id#6543,i_brand#6544,i_class_id#6545,i_class#6546,i_category_id#6547,i_category#6548,i_manufact_id#6549,i_manufact#6550,i_size#6551,i_formulation#6552,i_color#6553,i_units#6554,i_container#6555,i_manager_id#6556,i_product_name#6557] parquet, Statistics(sizeInBytes=3.1 MiB)
         :           :     :                 +- Project [d_date_sk#6558], Statistics(sizeInBytes=105.3 KiB)
         :           :     :                    +- Filter ((isnotnull(d_year#6564) AND ((d_year#6564 >= 1999) AND (d_year#6564 <= 2001))) AND isnotnull(d_date_sk#6558)), Statistics(sizeInBytes=2.5 MiB)
         :           :     :                       +- Relation default.date_dim[d_date_sk#6558,d_date_id#6559,d_date#6560,d_month_seq#6561,d_week_seq#6562,d_quarter_seq#6563,d_year#6564,d_dow#6565,d_moy#6566,d_dom#6567,d_qoy#6568,d_fy_year#6569,d_fy_quarter_seq#6570,d_fy_week_seq#6571,d_day_name#6572,d_quarter_name#6573,d_holiday#6574,d_weekend#6575,d_following_holiday#6576,d_first_dom#6577,d_last_dom#6578,d_same_day_ly#6579,d_same_day_lq#6580,d_current_day#6581,d_current_week#6582,d_current_month#6583,d_current_quarter#6584,d_current_year#6585] parquet, Statistics(sizeInBytes=2.5 MiB)
         :           :     +- Join LeftSemi, (i_item_sk#6784 = ss_item_sk#6454), Statistics(sizeInBytes=256.7 KiB)
         :           :        :- Project [i_item_sk#6784, i_brand_id#6791, i_class_id#6793, i_category_id#6795], Statistics(sizeInBytes=256.7 KiB)
         :           :        :  +- Filter (((isnotnull(i_item_sk#6784) AND isnotnull(i_brand_id#6791)) AND isnotnull(i_class_id#6793)) AND isnotnull(i_category_id#6795)), Statistics(sizeInBytes=3.1 MiB)
         :           :        :     +- Relation default.item[i_item_sk#6784,i_item_id#6785,i_rec_start_date#6786,i_rec_end_date#6787,i_item_desc#6788,i_current_price#6789,i_wholesale_cost#6790,i_brand_id#6791,i_brand#6792,i_class_id#6793,i_class#6794,i_category_id#6795,i_category#6796,i_manufact_id#6797,i_manufact#6798,i_size#6799,i_formulation#6800,i_color#6801,i_units#6802,i_container#6803,i_manager_id#6804,i_product_name#6805] parquet, Statistics(sizeInBytes=3.1 MiB)
         :           :        +- Project [i_item_sk#437 AS ss_item_sk#6454], Statistics(sizeInBytes=2.13E+22 B)
         :           :           +- Join Inner, (((i_brand_id#444 = brand_id#6451) AND (i_class_id#446 = class_id#6452)) AND (i_category_id#448 = category_id#6453)), Statistics(sizeInBytes=6.38E+22 B)
         :           :              :- Project [i_item_sk#437, i_brand_id#444, i_class_id#446, i_category_id#448], Statistics(sizeInBytes=256.7 KiB)
         :           :              :  +- Filter ((isnotnull(i_brand_id#444) AND isnotnull(i_class_id#446)) AND isnotnull(i_category_id#448)), Statistics(sizeInBytes=3.1 MiB)
         :           :              :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
         :           :              +- Join LeftSemi, (((brand_id#6451 <=> i_brand_id#6543) AND (class_id#6452 <=> i_class_id#6545)) AND (category_id#6453 <=> i_category_id#6547)), Statistics(sizeInBytes=215.7 PiB)
         :           :                 :- Aggregate [brand_id#6451, class_id#6452, category_id#6453], [brand_id#6451, class_id#6452, category_id#6453], Statistics(sizeInBytes=215.7 PiB)
         :           :                 :  +- Project [i_brand_id#6471 AS brand_id#6451, i_class_id#6473 AS class_id#6452, i_category_id#6475 AS category_id#6453], Statistics(sizeInBytes=215.7 PiB)
         :           :                 :     +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=302.0 PiB)
         :           :                 :        :- Project [ss_sold_date_sk#414, i_brand_id#6471, i_class_id#6473, i_category_id#6475], Statistics(sizeInBytes=2.9 TiB)
         :           :                 :        :  +- Join Inner, (ss_item_sk#416 = i_item_sk#6464), Statistics(sizeInBytes=3.8 TiB)
         :           :                 :        :     :- Project [ss_sold_date_sk#414, ss_item_sk#416], Statistics(sizeInBytes=15.3 MiB)
         :           :                 :        :     :  +- Filter (isnotnull(ss_item_sk#416) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
         :           :                 :        :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
         :           :                 :        :     +- Join LeftSemi, (((i_brand_id#6471 <=> i_brand_id#6493) AND (i_class_id#6473 <=> i_class_id#6495)) AND (i_category_id#6475 <=> i_category_id#6497)), Statistics(sizeInBytes=256.7 KiB)
         :           :                 :        :        :- Project [i_item_sk#6464, i_brand_id#6471, i_class_id#6473, i_category_id#6475], Statistics(sizeInBytes=256.7 KiB)
         :           :                 :        :        :  +- Filter (isnotnull(i_item_sk#6464) AND ((isnotnull(i_brand_id#6471) AND isnotnull(i_class_id#6473)) AND isnotnull(i_category_id#6475))), Statistics(sizeInBytes=3.1 MiB)
         :           :                 :        :        :     +- Relation default.item[i_item_sk#6464,i_item_id#6465,i_rec_start_date#6466,i_rec_end_date#6467,i_item_desc#6468,i_current_price#6469,i_wholesale_cost#6470,i_brand_id#6471,i_brand#6472,i_class_id#6473,i_class#6474,i_category_id#6475,i_category#6476,i_manufact_id#6477,i_manufact#6478,i_size#6479,i_formulation#6480,i_color#6481,i_units#6482,i_container#6483,i_manager_id#6484,i_product_name#6485] parquet, Statistics(sizeInBytes=3.1 MiB)
         :           :                 :        :        +- Project [i_brand_id#6493, i_class_id#6495, i_category_id#6497], Statistics(sizeInBytes=117.4 PiB)
         :           :                 :        :           +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#6508), Statistics(sizeInBytes=164.3 PiB)
         :           :                 :        :              :- Project [cs_sold_date_sk#197, i_brand_id#6493, i_class_id#6495, i_category_id#6497], Statistics(sizeInBytes=1597.9 GiB)
         :           :                 :        :              :  +- Join Inner, (cs_item_sk#212 = i_item_sk#6486), Statistics(sizeInBytes=2.1 TiB)
         :           :                 :        :              :     :- Project [cs_sold_date_sk#197, cs_item_sk#212], Statistics(sizeInBytes=8.3 MiB)
         :           :                 :        :              :     :  +- Filter (isnotnull(cs_item_sk#212) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
         :           :                 :        :              :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
         :           :                 :        :              :     +- Project [i_item_sk#6486, i_brand_id#6493, i_class_id#6495, i_category_id#6497], Statistics(sizeInBytes=256.7 KiB)
         :           :                 :        :              :        +- Filter isnotnull(i_item_sk#6486), Statistics(sizeInBytes=3.1 MiB)
         :           :                 :        :              :           +- Relation default.item[i_item_sk#6486,i_item_id#6487,i_rec_start_date#6488,i_rec_end_date#6489,i_item_desc#6490,i_current_price#6491,i_wholesale_cost#6492,i_brand_id#6493,i_brand#6494,i_class_id#6495,i_class#6496,i_category_id#6497,i_category#6498,i_manufact_id#6499,i_manufact#6500,i_size#6501,i_formulation#6502,i_color#6503,i_units#6504,i_container#6505,i_manager_id#6506,i_product_name#6507] parquet, Statistics(sizeInBytes=3.1 MiB)
         :           :                 :        :              +- Project [d_date_sk#6508], Statistics(sizeInBytes=105.3 KiB)
         :           :                 :        :                 +- Filter ((isnotnull(d_year#6514) AND ((d_year#6514 >= 1999) AND (d_year#6514 <= 2001))) AND isnotnull(d_date_sk#6508)), Statistics(sizeInBytes=2.5 MiB)
         :           :                 :        :                    +- Relation default.date_dim[d_date_sk#6508,d_date_id#6509,d_date#6510,d_month_seq#6511,d_week_seq#6512,d_quarter_seq#6513,d_year#6514,d_dow#6515,d_moy#6516,d_dom#6517,d_qoy#6518,d_fy_year#6519,d_fy_quarter_seq#6520,d_fy_week_seq#6521,d_day_name#6522,d_quarter_name#6523,d_holiday#6524,d_weekend#6525,d_following_holiday#6526,d_first_dom#6527,d_last_dom#6528,d_same_day_ly#6529,d_same_day_lq#6530,d_current_day#6531,d_current_week#6532,d_current_month#6533,d_current_quarter#6534,d_current_year#6535] parquet, Statistics(sizeInBytes=2.5 MiB)
         :           :                 :        +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
         :           :                 :           +- Filter ((isnotnull(d_year#30) AND ((d_year#30 >= 1999) AND (d_year#30 <= 2001))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
         :           :                 :              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
         :           :                 +- Project [i_brand_id#6543, i_class_id#6545, i_category_id#6547], Statistics(sizeInBytes=57.7 PiB)
         :           :                    +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#6558), Statistics(sizeInBytes=80.7 PiB)
         :           :                       :- Project [ws_sold_date_sk#163, i_brand_id#6543, i_class_id#6545, i_category_id#6547], Statistics(sizeInBytes=784.9 GiB)
         :           :                       :  +- Join Inner, (ws_item_sk#166 = i_item_sk#6536), Statistics(sizeInBytes=1046.6 GiB)
         :           :                       :     :- Project [ws_sold_date_sk#163, ws_item_sk#166], Statistics(sizeInBytes=4.1 MiB)
         :           :                       :     :  +- Filter (isnotnull(ws_item_sk#166) AND isnotnull(ws_sold_date_sk#163)), Statistics(sizeInBytes=52.0 MiB)
         :           :                       :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
         :           :                       :     +- Project [i_item_sk#6536, i_brand_id#6543, i_class_id#6545, i_category_id#6547], Statistics(sizeInBytes=256.7 KiB)
         :           :                       :        +- Filter isnotnull(i_item_sk#6536), Statistics(sizeInBytes=3.1 MiB)
         :           :                       :           +- Relation default.item[i_item_sk#6536,i_item_id#6537,i_rec_start_date#6538,i_rec_end_date#6539,i_item_desc#6540,i_current_price#6541,i_wholesale_cost#6542,i_brand_id#6543,i_brand#6544,i_class_id#6545,i_class#6546,i_category_id#6547,i_category#6548,i_manufact_id#6549,i_manufact#6550,i_size#6551,i_formulation#6552,i_color#6553,i_units#6554,i_container#6555,i_manager_id#6556,i_product_name#6557] parquet, Statistics(sizeInBytes=3.1 MiB)
         :           :                       +- Project [d_date_sk#6558], Statistics(sizeInBytes=105.3 KiB)
         :           :                          +- Filter ((isnotnull(d_year#6564) AND ((d_year#6564 >= 1999) AND (d_year#6564 <= 2001))) AND isnotnull(d_date_sk#6558)), Statistics(sizeInBytes=2.5 MiB)
         :           :                             +- Relation default.date_dim[d_date_sk#6558,d_date_id#6559,d_date#6560,d_month_seq#6561,d_week_seq#6562,d_quarter_seq#6563,d_year#6564,d_dow#6565,d_moy#6566,d_dom#6567,d_qoy#6568,d_fy_year#6569,d_fy_quarter_seq#6570,d_fy_week_seq#6571,d_day_name#6572,d_quarter_name#6573,d_holiday#6574,d_weekend#6575,d_following_holiday#6576,d_first_dom#6577,d_last_dom#6578,d_same_day_ly#6579,d_same_day_lq#6580,d_current_day#6581,d_current_week#6582,d_current_month#6583,d_current_quarter#6584,d_current_year#6585] parquet, Statistics(sizeInBytes=2.5 MiB)
         :           +- Project [d_date_sk#6806], Statistics(sizeInBytes=105.3 KiB)
         :              +- Filter ((isnotnull(d_week_seq#6810) AND (d_week_seq#6810 = scalar-subquery#6443 [])) AND isnotnull(d_date_sk#6806)), Statistics(sizeInBytes=2.5 MiB)
         :                 :  +- Project [d_week_seq#6922], Statistics(sizeInBytes=105.3 KiB)
         :                 :     +- Filter (((isnotnull(d_year#6924) AND isnotnull(d_moy#6926)) AND isnotnull(d_dom#6927)) AND (((d_year#6924 = 2000) AND (d_moy#6926 = 12)) AND (d_dom#6927 = 11))), Statistics(sizeInBytes=2.5 MiB)
         :                 :        +- Relation default.date_dim[d_date_sk#6918,d_date_id#6919,d_date#6920,d_month_seq#6921,d_week_seq#6922,d_quarter_seq#6923,d_year#6924,d_dow#6925,d_moy#6926,d_dom#6927,d_qoy#6928,d_fy_year#6929,d_fy_quarter_seq#6930,d_fy_week_seq#6931,d_day_name#6932,d_quarter_name#6933,d_holiday#6934,d_weekend#6935,d_following_holiday#6936,d_first_dom#6937,d_last_dom#6938,d_same_day_ly#6939,d_same_day_lq#6940,d_current_day#6941,d_current_week#6942,d_current_month#6943,d_current_quarter#6944,d_current_year#6945] parquet, Statistics(sizeInBytes=2.5 MiB)
         :                 +- Relation default.date_dim[d_date_sk#6806,d_date_id#6807,d_date#6808,d_month_seq#6809,d_week_seq#6810,d_quarter_seq#6811,d_year#6812,d_dow#6813,d_moy#6814,d_dom#6815,d_qoy#6816,d_fy_year#6817,d_fy_quarter_seq#6818,d_fy_week_seq#6819,d_day_name#6820,d_quarter_name#6821,d_holiday#6822,d_weekend#6823,d_following_holiday#6824,d_first_dom#6825,d_last_dom#6826,d_same_day_ly#6827,d_same_day_lq#6828,d_current_day#6829,d_current_week#6830,d_current_month#6831,d_current_quarter#6832,d_current_year#6833] parquet, Statistics(sizeInBytes=2.5 MiB)
         +- Filter (isnotnull(sales#6446) AND (cast(sales#6446 as decimal(32,6)) > cast(scalar-subquery#6450 [] as decimal(32,6)))), Statistics(sizeInBytes=922.3 PiB)
            :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(quantity#6455 as decimal(12,2))) * promote_precision(cast(list_price#6456 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#6461], Statistics(sizeInBytes=24.0 B, rowCount=1)
            :     +- Union false, false, Statistics(sizeInBytes=3.0 TiB)
            :        :- Project [ss_quantity#6596 AS quantity#6455, ss_list_price#6598 AS list_price#6456], Statistics(sizeInBytes=1720.7 GiB)
            :        :  +- Join Inner, (ss_sold_date_sk#6586 = d_date_sk#6609), Statistics(sizeInBytes=2.4 TiB)
            :        :     :- Project [ss_sold_date_sk#6586, ss_quantity#6596, ss_list_price#6598], Statistics(sizeInBytes=22.9 MiB)
            :        :     :  +- Filter isnotnull(ss_sold_date_sk#6586), Statistics(sizeInBytes=141.1 MiB)
            :        :     :     +- Relation default.store_sales[ss_sold_date_sk#6586,ss_sold_time_sk#6587,ss_item_sk#6588,ss_customer_sk#6589,ss_cdemo_sk#6590,ss_hdemo_sk#6591,ss_addr_sk#6592,ss_store_sk#6593,ss_promo_sk#6594,ss_ticket_number#6595,ss_quantity#6596,ss_wholesale_cost#6597,ss_list_price#6598,ss_sales_price#6599,ss_ext_discount_amt#6600,ss_ext_sales_price#6601,ss_ext_wholesale_cost#6602,ss_ext_list_price#6603,ss_ext_tax#6604,ss_coupon_amt#6605,ss_net_paid#6606,ss_net_paid_inc_tax#6607,ss_net_profit#6608] parquet, Statistics(sizeInBytes=141.1 MiB)
            :        :     +- Project [d_date_sk#6609], Statistics(sizeInBytes=105.3 KiB)
            :        :        +- Filter ((isnotnull(d_year#6615) AND ((d_year#6615 >= 1999) AND (d_year#6615 <= 2001))) AND isnotnull(d_date_sk#6609)), Statistics(sizeInBytes=2.5 MiB)
            :        :           +- Relation default.date_dim[d_date_sk#6609,d_date_id#6610,d_date#6611,d_month_seq#6612,d_week_seq#6613,d_quarter_seq#6614,d_year#6615,d_dow#6616,d_moy#6617,d_dom#6618,d_qoy#6619,d_fy_year#6620,d_fy_quarter_seq#6621,d_fy_week_seq#6622,d_day_name#6623,d_quarter_name#6624,d_holiday#6625,d_weekend#6626,d_following_holiday#6627,d_first_dom#6628,d_last_dom#6629,d_same_day_ly#6630,d_same_day_lq#6631,d_current_day#6632,d_current_week#6633,d_current_month#6634,d_current_quarter#6635,d_current_year#6636] parquet, Statistics(sizeInBytes=2.5 MiB)
            :        :- Project [cs_quantity#6655 AS quantity#6457, cs_list_price#6657 AS list_price#6458], Statistics(sizeInBytes=936.4 GiB)
            :        :  +- Join Inner, (cs_sold_date_sk#6637 = d_date_sk#6671), Statistics(sizeInBytes=1311.0 GiB)
            :        :     :- Project [cs_sold_date_sk#6637, cs_quantity#6655, cs_list_price#6657], Statistics(sizeInBytes=12.4 MiB)
            :        :     :  +- Filter isnotnull(cs_sold_date_sk#6637), Statistics(sizeInBytes=105.8 MiB)
            :        :     :     +- Relation default.catalog_sales[cs_sold_date_sk#6637,cs_sold_time_sk#6638,cs_ship_date_sk#6639,cs_bill_customer_sk#6640,cs_bill_cdemo_sk#6641,cs_bill_hdemo_sk#6642,cs_bill_addr_sk#6643,cs_ship_customer_sk#6644,cs_ship_cdemo_sk#6645,cs_ship_hdemo_sk#6646,cs_ship_addr_sk#6647,cs_call_center_sk#6648,cs_catalog_page_sk#6649,cs_ship_mode_sk#6650,cs_warehouse_sk#6651,cs_item_sk#6652,cs_promo_sk#6653,cs_order_number#6654,cs_quantity#6655,cs_wholesale_cost#6656,cs_list_price#6657,cs_sales_price#6658,cs_ext_discount_amt#6659,cs_ext_sales_price#6660,cs_ext_wholesale_cost#6661,cs_ext_list_price#6662,cs_ext_tax#6663,cs_coupon_amt#6664,cs_ext_ship_cost#6665,cs_net_paid#6666,cs_net_paid_inc_tax#6667,cs_net_paid_inc_ship#6668,cs_net_paid_inc_ship_tax#6669,cs_net_profit#6670] parquet, Statistics(sizeInBytes=105.8 MiB)
            :        :     +- Project [d_date_sk#6671], Statistics(sizeInBytes=105.3 KiB)
            :        :        +- Filter ((isnotnull(d_year#6677) AND ((d_year#6677 >= 1999) AND (d_year#6677 <= 2001))) AND isnotnull(d_date_sk#6671)), Statistics(sizeInBytes=2.5 MiB)
            :        :           +- Relation default.date_dim[d_date_sk#6671,d_date_id#6672,d_date#6673,d_month_seq#6674,d_week_seq#6675,d_quarter_seq#6676,d_year#6677,d_dow#6678,d_moy#6679,d_dom#6680,d_qoy#6681,d_fy_year#6682,d_fy_quarter_seq#6683,d_fy_week_seq#6684,d_day_name#6685,d_quarter_name#6686,d_holiday#6687,d_weekend#6688,d_following_holiday#6689,d_first_dom#6690,d_last_dom#6691,d_same_day_ly#6692,d_same_day_lq#6693,d_current_day#6694,d_current_week#6695,d_current_month#6696,d_current_quarter#6697,d_current_year#6698] parquet, Statistics(sizeInBytes=2.5 MiB)
            :        +- Project [ws_quantity#6717 AS quantity#6459, ws_list_price#6719 AS list_price#6460], Statistics(sizeInBytes=460.0 GiB)
            :           +- Join Inner, (ws_sold_date_sk#6699 = d_date_sk#6733), Statistics(sizeInBytes=644.0 GiB)
            :              :- Project [ws_sold_date_sk#6699, ws_quantity#6717, ws_list_price#6719], Statistics(sizeInBytes=6.1 MiB)
            :              :  +- Filter isnotnull(ws_sold_date_sk#6699), Statistics(sizeInBytes=52.0 MiB)
            :              :     +- Relation default.web_sales[ws_sold_date_sk#6699,ws_sold_time_sk#6700,ws_ship_date_sk#6701,ws_item_sk#6702,ws_bill_customer_sk#6703,ws_bill_cdemo_sk#6704,ws_bill_hdemo_sk#6705,ws_bill_addr_sk#6706,ws_ship_customer_sk#6707,ws_ship_cdemo_sk#6708,ws_ship_hdemo_sk#6709,ws_ship_addr_sk#6710,ws_web_page_sk#6711,ws_web_site_sk#6712,ws_ship_mode_sk#6713,ws_warehouse_sk#6714,ws_promo_sk#6715,ws_order_number#6716,ws_quantity#6717,ws_wholesale_cost#6718,ws_list_price#6719,ws_sales_price#6720,ws_ext_discount_amt#6721,ws_ext_sales_price#6722,ws_ext_wholesale_cost#6723,ws_ext_list_price#6724,ws_ext_tax#6725,ws_coupon_amt#6726,ws_ext_ship_cost#6727,ws_net_paid#6728,ws_net_paid_inc_tax#6729,ws_net_paid_inc_ship#6730,ws_net_paid_inc_ship_tax#6731,ws_net_profit#6732] parquet, Statistics(sizeInBytes=52.0 MiB)
            :              +- Project [d_date_sk#6733], Statistics(sizeInBytes=105.3 KiB)
            :                 +- Filter ((isnotnull(d_year#6739) AND ((d_year#6739 >= 1999) AND (d_year#6739 <= 2001))) AND isnotnull(d_date_sk#6733)), Statistics(sizeInBytes=2.5 MiB)
            :                    +- Relation default.date_dim[d_date_sk#6733,d_date_id#6734,d_date#6735,d_month_seq#6736,d_week_seq#6737,d_quarter_seq#6738,d_year#6739,d_dow#6740,d_moy#6741,d_dom#6742,d_qoy#6743,d_fy_year#6744,d_fy_quarter_seq#6745,d_fy_week_seq#6746,d_day_name#6747,d_quarter_name#6748,d_holiday#6749,d_weekend#6750,d_following_holiday#6751,d_first_dom#6752,d_last_dom#6753,d_same_day_ly#6754,d_same_day_lq#6755,d_current_day#6756,d_current_week#6757,d_current_month#6758,d_current_quarter#6759,d_current_year#6760] parquet, Statistics(sizeInBytes=2.5 MiB)
            +- Aggregate [i_brand_id#6864, i_class_id#6866, i_category_id#6868], [store AS channel#6445, i_brand_id#6864, i_class_id#6866, i_category_id#6868, sum(CheckOverflow((promote_precision(cast(ss_quantity#6844 as decimal(12,2))) * promote_precision(cast(ss_list_price#6846 as decimal(12,2)))), DecimalType(18,2))) AS sales#6446, count(1) AS number_sales#6447L], Statistics(sizeInBytes=922.3 PiB)
               +- Project [ss_quantity#6844, ss_list_price#6846, i_brand_id#6864, i_class_id#6866, i_category_id#6868], Statistics(sizeInBytes=461.2 PiB)
                  +- Join Inner, (ss_sold_date_sk#6834 = d_date_sk#6879), Statistics(sizeInBytes=576.5 PiB)
                     :- Project [ss_sold_date_sk#6834, ss_quantity#6844, ss_list_price#6846, i_brand_id#6864, i_class_id#6866, i_category_id#6868], Statistics(sizeInBytes=5.5 TiB)
                     :  +- Join Inner, (ss_item_sk#6836 = i_item_sk#6857), Statistics(sizeInBytes=6.7 TiB)
                     :     :- Join LeftSemi, (ss_item_sk#6836 = ss_item_sk#6454), Statistics(sizeInBytes=26.7 MiB)
                     :     :  :- Project [ss_sold_date_sk#6834, ss_item_sk#6836, ss_quantity#6844, ss_list_price#6846], Statistics(sizeInBytes=26.7 MiB)
                     :     :  :  +- Filter (isnotnull(ss_item_sk#6836) AND isnotnull(ss_sold_date_sk#6834)), Statistics(sizeInBytes=141.1 MiB)
                     :     :  :     +- Relation default.store_sales[ss_sold_date_sk#6834,ss_sold_time_sk#6835,ss_item_sk#6836,ss_customer_sk#6837,ss_cdemo_sk#6838,ss_hdemo_sk#6839,ss_addr_sk#6840,ss_store_sk#6841,ss_promo_sk#6842,ss_ticket_number#6843,ss_quantity#6844,ss_wholesale_cost#6845,ss_list_price#6846,ss_sales_price#6847,ss_ext_discount_amt#6848,ss_ext_sales_price#6849,ss_ext_wholesale_cost#6850,ss_ext_list_price#6851,ss_ext_tax#6852,ss_coupon_amt#6853,ss_net_paid#6854,ss_net_paid_inc_tax#6855,ss_net_profit#6856] parquet, Statistics(sizeInBytes=141.1 MiB)
                     :     :  +- Project [i_item_sk#437 AS ss_item_sk#6454], Statistics(sizeInBytes=2.13E+22 B)
                     :     :     +- Join Inner, (((i_brand_id#444 = brand_id#6451) AND (i_class_id#446 = class_id#6452)) AND (i_category_id#448 = category_id#6453)), Statistics(sizeInBytes=6.38E+22 B)
                     :     :        :- Project [i_item_sk#437, i_brand_id#444, i_class_id#446, i_category_id#448], Statistics(sizeInBytes=256.7 KiB)
                     :     :        :  +- Filter ((isnotnull(i_brand_id#444) AND isnotnull(i_class_id#446)) AND isnotnull(i_category_id#448)), Statistics(sizeInBytes=3.1 MiB)
                     :     :        :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
                     :     :        +- Join LeftSemi, (((brand_id#6451 <=> i_brand_id#6543) AND (class_id#6452 <=> i_class_id#6545)) AND (category_id#6453 <=> i_category_id#6547)), Statistics(sizeInBytes=215.7 PiB)
                     :     :           :- Aggregate [brand_id#6451, class_id#6452, category_id#6453], [brand_id#6451, class_id#6452, category_id#6453], Statistics(sizeInBytes=215.7 PiB)
                     :     :           :  +- Project [i_brand_id#6471 AS brand_id#6451, i_class_id#6473 AS class_id#6452, i_category_id#6475 AS category_id#6453], Statistics(sizeInBytes=215.7 PiB)
                     :     :           :     +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=302.0 PiB)
                     :     :           :        :- Project [ss_sold_date_sk#414, i_brand_id#6471, i_class_id#6473, i_category_id#6475], Statistics(sizeInBytes=2.9 TiB)
                     :     :           :        :  +- Join Inner, (ss_item_sk#416 = i_item_sk#6464), Statistics(sizeInBytes=3.8 TiB)
                     :     :           :        :     :- Project [ss_sold_date_sk#414, ss_item_sk#416], Statistics(sizeInBytes=15.3 MiB)
                     :     :           :        :     :  +- Filter (isnotnull(ss_item_sk#416) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
                     :     :           :        :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                     :     :           :        :     +- Join LeftSemi, (((i_brand_id#6471 <=> i_brand_id#6493) AND (i_class_id#6473 <=> i_class_id#6495)) AND (i_category_id#6475 <=> i_category_id#6497)), Statistics(sizeInBytes=256.7 KiB)
                     :     :           :        :        :- Project [i_item_sk#6464, i_brand_id#6471, i_class_id#6473, i_category_id#6475], Statistics(sizeInBytes=256.7 KiB)
                     :     :           :        :        :  +- Filter (isnotnull(i_item_sk#6464) AND ((isnotnull(i_brand_id#6471) AND isnotnull(i_class_id#6473)) AND isnotnull(i_category_id#6475))), Statistics(sizeInBytes=3.1 MiB)
                     :     :           :        :        :     +- Relation default.item[i_item_sk#6464,i_item_id#6465,i_rec_start_date#6466,i_rec_end_date#6467,i_item_desc#6468,i_current_price#6469,i_wholesale_cost#6470,i_brand_id#6471,i_brand#6472,i_class_id#6473,i_class#6474,i_category_id#6475,i_category#6476,i_manufact_id#6477,i_manufact#6478,i_size#6479,i_formulation#6480,i_color#6481,i_units#6482,i_container#6483,i_manager_id#6484,i_product_name#6485] parquet, Statistics(sizeInBytes=3.1 MiB)
                     :     :           :        :        +- Project [i_brand_id#6493, i_class_id#6495, i_category_id#6497], Statistics(sizeInBytes=117.4 PiB)
                     :     :           :        :           +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#6508), Statistics(sizeInBytes=164.3 PiB)
                     :     :           :        :              :- Project [cs_sold_date_sk#197, i_brand_id#6493, i_class_id#6495, i_category_id#6497], Statistics(sizeInBytes=1597.9 GiB)
                     :     :           :        :              :  +- Join Inner, (cs_item_sk#212 = i_item_sk#6486), Statistics(sizeInBytes=2.1 TiB)
                     :     :           :        :              :     :- Project [cs_sold_date_sk#197, cs_item_sk#212], Statistics(sizeInBytes=8.3 MiB)
                     :     :           :        :              :     :  +- Filter (isnotnull(cs_item_sk#212) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
                     :     :           :        :              :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
                     :     :           :        :              :     +- Project [i_item_sk#6486, i_brand_id#6493, i_class_id#6495, i_category_id#6497], Statistics(sizeInBytes=256.7 KiB)
                     :     :           :        :              :        +- Filter isnotnull(i_item_sk#6486), Statistics(sizeInBytes=3.1 MiB)
                     :     :           :        :              :           +- Relation default.item[i_item_sk#6486,i_item_id#6487,i_rec_start_date#6488,i_rec_end_date#6489,i_item_desc#6490,i_current_price#6491,i_wholesale_cost#6492,i_brand_id#6493,i_brand#6494,i_class_id#6495,i_class#6496,i_category_id#6497,i_category#6498,i_manufact_id#6499,i_manufact#6500,i_size#6501,i_formulation#6502,i_color#6503,i_units#6504,i_container#6505,i_manager_id#6506,i_product_name#6507] parquet, Statistics(sizeInBytes=3.1 MiB)
                     :     :           :        :              +- Project [d_date_sk#6508], Statistics(sizeInBytes=105.3 KiB)
                     :     :           :        :                 +- Filter ((isnotnull(d_year#6514) AND ((d_year#6514 >= 1999) AND (d_year#6514 <= 2001))) AND isnotnull(d_date_sk#6508)), Statistics(sizeInBytes=2.5 MiB)
                     :     :           :        :                    +- Relation default.date_dim[d_date_sk#6508,d_date_id#6509,d_date#6510,d_month_seq#6511,d_week_seq#6512,d_quarter_seq#6513,d_year#6514,d_dow#6515,d_moy#6516,d_dom#6517,d_qoy#6518,d_fy_year#6519,d_fy_quarter_seq#6520,d_fy_week_seq#6521,d_day_name#6522,d_quarter_name#6523,d_holiday#6524,d_weekend#6525,d_following_holiday#6526,d_first_dom#6527,d_last_dom#6528,d_same_day_ly#6529,d_same_day_lq#6530,d_current_day#6531,d_current_week#6532,d_current_month#6533,d_current_quarter#6534,d_current_year#6535] parquet, Statistics(sizeInBytes=2.5 MiB)
                     :     :           :        +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                     :     :           :           +- Filter ((isnotnull(d_year#30) AND ((d_year#30 >= 1999) AND (d_year#30 <= 2001))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                     :     :           :              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                     :     :           +- Project [i_brand_id#6543, i_class_id#6545, i_category_id#6547], Statistics(sizeInBytes=57.7 PiB)
                     :     :              +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#6558), Statistics(sizeInBytes=80.7 PiB)
                     :     :                 :- Project [ws_sold_date_sk#163, i_brand_id#6543, i_class_id#6545, i_category_id#6547], Statistics(sizeInBytes=784.9 GiB)
                     :     :                 :  +- Join Inner, (ws_item_sk#166 = i_item_sk#6536), Statistics(sizeInBytes=1046.6 GiB)
                     :     :                 :     :- Project [ws_sold_date_sk#163, ws_item_sk#166], Statistics(sizeInBytes=4.1 MiB)
                     :     :                 :     :  +- Filter (isnotnull(ws_item_sk#166) AND isnotnull(ws_sold_date_sk#163)), Statistics(sizeInBytes=52.0 MiB)
                     :     :                 :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                     :     :                 :     +- Project [i_item_sk#6536, i_brand_id#6543, i_class_id#6545, i_category_id#6547], Statistics(sizeInBytes=256.7 KiB)
                     :     :                 :        +- Filter isnotnull(i_item_sk#6536), Statistics(sizeInBytes=3.1 MiB)
                     :     :                 :           +- Relation default.item[i_item_sk#6536,i_item_id#6537,i_rec_start_date#6538,i_rec_end_date#6539,i_item_desc#6540,i_current_price#6541,i_wholesale_cost#6542,i_brand_id#6543,i_brand#6544,i_class_id#6545,i_class#6546,i_category_id#6547,i_category#6548,i_manufact_id#6549,i_manufact#6550,i_size#6551,i_formulation#6552,i_color#6553,i_units#6554,i_container#6555,i_manager_id#6556,i_product_name#6557] parquet, Statistics(sizeInBytes=3.1 MiB)
                     :     :                 +- Project [d_date_sk#6558], Statistics(sizeInBytes=105.3 KiB)
                     :     :                    +- Filter ((isnotnull(d_year#6564) AND ((d_year#6564 >= 1999) AND (d_year#6564 <= 2001))) AND isnotnull(d_date_sk#6558)), Statistics(sizeInBytes=2.5 MiB)
                     :     :                       +- Relation default.date_dim[d_date_sk#6558,d_date_id#6559,d_date#6560,d_month_seq#6561,d_week_seq#6562,d_quarter_seq#6563,d_year#6564,d_dow#6565,d_moy#6566,d_dom#6567,d_qoy#6568,d_fy_year#6569,d_fy_quarter_seq#6570,d_fy_week_seq#6571,d_day_name#6572,d_quarter_name#6573,d_holiday#6574,d_weekend#6575,d_following_holiday#6576,d_first_dom#6577,d_last_dom#6578,d_same_day_ly#6579,d_same_day_lq#6580,d_current_day#6581,d_current_week#6582,d_current_month#6583,d_current_quarter#6584,d_current_year#6585] parquet, Statistics(sizeInBytes=2.5 MiB)
                     :     +- Join LeftSemi, (i_item_sk#6857 = ss_item_sk#6454), Statistics(sizeInBytes=256.7 KiB)
                     :        :- Project [i_item_sk#6857, i_brand_id#6864, i_class_id#6866, i_category_id#6868], Statistics(sizeInBytes=256.7 KiB)
                     :        :  +- Filter (((isnotnull(i_item_sk#6857) AND isnotnull(i_brand_id#6864)) AND isnotnull(i_class_id#6866)) AND isnotnull(i_category_id#6868)), Statistics(sizeInBytes=3.1 MiB)
                     :        :     +- Relation default.item[i_item_sk#6857,i_item_id#6858,i_rec_start_date#6859,i_rec_end_date#6860,i_item_desc#6861,i_current_price#6862,i_wholesale_cost#6863,i_brand_id#6864,i_brand#6865,i_class_id#6866,i_class#6867,i_category_id#6868,i_category#6869,i_manufact_id#6870,i_manufact#6871,i_size#6872,i_formulation#6873,i_color#6874,i_units#6875,i_container#6876,i_manager_id#6877,i_product_name#6878] parquet, Statistics(sizeInBytes=3.1 MiB)
                     :        +- Project [i_item_sk#437 AS ss_item_sk#6454], Statistics(sizeInBytes=2.13E+22 B)
                     :           +- Join Inner, (((i_brand_id#444 = brand_id#6451) AND (i_class_id#446 = class_id#6452)) AND (i_category_id#448 = category_id#6453)), Statistics(sizeInBytes=6.38E+22 B)
                     :              :- Project [i_item_sk#437, i_brand_id#444, i_class_id#446, i_category_id#448], Statistics(sizeInBytes=256.7 KiB)
                     :              :  +- Filter ((isnotnull(i_brand_id#444) AND isnotnull(i_class_id#446)) AND isnotnull(i_category_id#448)), Statistics(sizeInBytes=3.1 MiB)
                     :              :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
                     :              +- Join LeftSemi, (((brand_id#6451 <=> i_brand_id#6543) AND (class_id#6452 <=> i_class_id#6545)) AND (category_id#6453 <=> i_category_id#6547)), Statistics(sizeInBytes=215.7 PiB)
                     :                 :- Aggregate [brand_id#6451, class_id#6452, category_id#6453], [brand_id#6451, class_id#6452, category_id#6453], Statistics(sizeInBytes=215.7 PiB)
                     :                 :  +- Project [i_brand_id#6471 AS brand_id#6451, i_class_id#6473 AS class_id#6452, i_category_id#6475 AS category_id#6453], Statistics(sizeInBytes=215.7 PiB)
                     :                 :     +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=302.0 PiB)
                     :                 :        :- Project [ss_sold_date_sk#414, i_brand_id#6471, i_class_id#6473, i_category_id#6475], Statistics(sizeInBytes=2.9 TiB)
                     :                 :        :  +- Join Inner, (ss_item_sk#416 = i_item_sk#6464), Statistics(sizeInBytes=3.8 TiB)
                     :                 :        :     :- Project [ss_sold_date_sk#414, ss_item_sk#416], Statistics(sizeInBytes=15.3 MiB)
                     :                 :        :     :  +- Filter (isnotnull(ss_item_sk#416) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
                     :                 :        :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                     :                 :        :     +- Join LeftSemi, (((i_brand_id#6471 <=> i_brand_id#6493) AND (i_class_id#6473 <=> i_class_id#6495)) AND (i_category_id#6475 <=> i_category_id#6497)), Statistics(sizeInBytes=256.7 KiB)
                     :                 :        :        :- Project [i_item_sk#6464, i_brand_id#6471, i_class_id#6473, i_category_id#6475], Statistics(sizeInBytes=256.7 KiB)
                     :                 :        :        :  +- Filter (isnotnull(i_item_sk#6464) AND ((isnotnull(i_brand_id#6471) AND isnotnull(i_class_id#6473)) AND isnotnull(i_category_id#6475))), Statistics(sizeInBytes=3.1 MiB)
                     :                 :        :        :     +- Relation default.item[i_item_sk#6464,i_item_id#6465,i_rec_start_date#6466,i_rec_end_date#6467,i_item_desc#6468,i_current_price#6469,i_wholesale_cost#6470,i_brand_id#6471,i_brand#6472,i_class_id#6473,i_class#6474,i_category_id#6475,i_category#6476,i_manufact_id#6477,i_manufact#6478,i_size#6479,i_formulation#6480,i_color#6481,i_units#6482,i_container#6483,i_manager_id#6484,i_product_name#6485] parquet, Statistics(sizeInBytes=3.1 MiB)
                     :                 :        :        +- Project [i_brand_id#6493, i_class_id#6495, i_category_id#6497], Statistics(sizeInBytes=117.4 PiB)
                     :                 :        :           +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#6508), Statistics(sizeInBytes=164.3 PiB)
                     :                 :        :              :- Project [cs_sold_date_sk#197, i_brand_id#6493, i_class_id#6495, i_category_id#6497], Statistics(sizeInBytes=1597.9 GiB)
                     :                 :        :              :  +- Join Inner, (cs_item_sk#212 = i_item_sk#6486), Statistics(sizeInBytes=2.1 TiB)
                     :                 :        :              :     :- Project [cs_sold_date_sk#197, cs_item_sk#212], Statistics(sizeInBytes=8.3 MiB)
                     :                 :        :              :     :  +- Filter (isnotnull(cs_item_sk#212) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
                     :                 :        :              :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
                     :                 :        :              :     +- Project [i_item_sk#6486, i_brand_id#6493, i_class_id#6495, i_category_id#6497], Statistics(sizeInBytes=256.7 KiB)
                     :                 :        :              :        +- Filter isnotnull(i_item_sk#6486), Statistics(sizeInBytes=3.1 MiB)
                     :                 :        :              :           +- Relation default.item[i_item_sk#6486,i_item_id#6487,i_rec_start_date#6488,i_rec_end_date#6489,i_item_desc#6490,i_current_price#6491,i_wholesale_cost#6492,i_brand_id#6493,i_brand#6494,i_class_id#6495,i_class#6496,i_category_id#6497,i_category#6498,i_manufact_id#6499,i_manufact#6500,i_size#6501,i_formulation#6502,i_color#6503,i_units#6504,i_container#6505,i_manager_id#6506,i_product_name#6507] parquet, Statistics(sizeInBytes=3.1 MiB)
                     :                 :        :              +- Project [d_date_sk#6508], Statistics(sizeInBytes=105.3 KiB)
                     :                 :        :                 +- Filter ((isnotnull(d_year#6514) AND ((d_year#6514 >= 1999) AND (d_year#6514 <= 2001))) AND isnotnull(d_date_sk#6508)), Statistics(sizeInBytes=2.5 MiB)
                     :                 :        :                    +- Relation default.date_dim[d_date_sk#6508,d_date_id#6509,d_date#6510,d_month_seq#6511,d_week_seq#6512,d_quarter_seq#6513,d_year#6514,d_dow#6515,d_moy#6516,d_dom#6517,d_qoy#6518,d_fy_year#6519,d_fy_quarter_seq#6520,d_fy_week_seq#6521,d_day_name#6522,d_quarter_name#6523,d_holiday#6524,d_weekend#6525,d_following_holiday#6526,d_first_dom#6527,d_last_dom#6528,d_same_day_ly#6529,d_same_day_lq#6530,d_current_day#6531,d_current_week#6532,d_current_month#6533,d_current_quarter#6534,d_current_year#6535] parquet, Statistics(sizeInBytes=2.5 MiB)
                     :                 :        +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                     :                 :           +- Filter ((isnotnull(d_year#30) AND ((d_year#30 >= 1999) AND (d_year#30 <= 2001))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                     :                 :              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                     :                 +- Project [i_brand_id#6543, i_class_id#6545, i_category_id#6547], Statistics(sizeInBytes=57.7 PiB)
                     :                    +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#6558), Statistics(sizeInBytes=80.7 PiB)
                     :                       :- Project [ws_sold_date_sk#163, i_brand_id#6543, i_class_id#6545, i_category_id#6547], Statistics(sizeInBytes=784.9 GiB)
                     :                       :  +- Join Inner, (ws_item_sk#166 = i_item_sk#6536), Statistics(sizeInBytes=1046.6 GiB)
                     :                       :     :- Project [ws_sold_date_sk#163, ws_item_sk#166], Statistics(sizeInBytes=4.1 MiB)
                     :                       :     :  +- Filter (isnotnull(ws_item_sk#166) AND isnotnull(ws_sold_date_sk#163)), Statistics(sizeInBytes=52.0 MiB)
                     :                       :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                     :                       :     +- Project [i_item_sk#6536, i_brand_id#6543, i_class_id#6545, i_category_id#6547], Statistics(sizeInBytes=256.7 KiB)
                     :                       :        +- Filter isnotnull(i_item_sk#6536), Statistics(sizeInBytes=3.1 MiB)
                     :                       :           +- Relation default.item[i_item_sk#6536,i_item_id#6537,i_rec_start_date#6538,i_rec_end_date#6539,i_item_desc#6540,i_current_price#6541,i_wholesale_cost#6542,i_brand_id#6543,i_brand#6544,i_class_id#6545,i_class#6546,i_category_id#6547,i_category#6548,i_manufact_id#6549,i_manufact#6550,i_size#6551,i_formulation#6552,i_color#6553,i_units#6554,i_container#6555,i_manager_id#6556,i_product_name#6557] parquet, Statistics(sizeInBytes=3.1 MiB)
                     :                       +- Project [d_date_sk#6558], Statistics(sizeInBytes=105.3 KiB)
                     :                          +- Filter ((isnotnull(d_year#6564) AND ((d_year#6564 >= 1999) AND (d_year#6564 <= 2001))) AND isnotnull(d_date_sk#6558)), Statistics(sizeInBytes=2.5 MiB)
                     :                             +- Relation default.date_dim[d_date_sk#6558,d_date_id#6559,d_date#6560,d_month_seq#6561,d_week_seq#6562,d_quarter_seq#6563,d_year#6564,d_dow#6565,d_moy#6566,d_dom#6567,d_qoy#6568,d_fy_year#6569,d_fy_quarter_seq#6570,d_fy_week_seq#6571,d_day_name#6572,d_quarter_name#6573,d_holiday#6574,d_weekend#6575,d_following_holiday#6576,d_first_dom#6577,d_last_dom#6578,d_same_day_ly#6579,d_same_day_lq#6580,d_current_day#6581,d_current_week#6582,d_current_month#6583,d_current_quarter#6584,d_current_year#6585] parquet, Statistics(sizeInBytes=2.5 MiB)
                     +- Project [d_date_sk#6879], Statistics(sizeInBytes=105.3 KiB)
                        +- Filter ((isnotnull(d_week_seq#6883) AND (d_week_seq#6883 = scalar-subquery#6449 [])) AND isnotnull(d_date_sk#6879)), Statistics(sizeInBytes=2.5 MiB)
                           :  +- Project [d_week_seq#6950], Statistics(sizeInBytes=105.3 KiB)
                           :     +- Filter (((isnotnull(d_year#6952) AND isnotnull(d_moy#6954)) AND isnotnull(d_dom#6955)) AND (((d_year#6952 = 1999) AND (d_moy#6954 = 12)) AND (d_dom#6955 = 11))), Statistics(sizeInBytes=2.5 MiB)
                           :        +- Relation default.date_dim[d_date_sk#6946,d_date_id#6947,d_date#6948,d_month_seq#6949,d_week_seq#6950,d_quarter_seq#6951,d_year#6952,d_dow#6953,d_moy#6954,d_dom#6955,d_qoy#6956,d_fy_year#6957,d_fy_quarter_seq#6958,d_fy_week_seq#6959,d_day_name#6960,d_quarter_name#6961,d_holiday#6962,d_weekend#6963,d_following_holiday#6964,d_first_dom#6965,d_last_dom#6966,d_same_day_ly#6967,d_same_day_lq#6968,d_current_day#6969,d_current_week#6970,d_current_month#6971,d_current_quarter#6972,d_current_year#6973] parquet, Statistics(sizeInBytes=2.5 MiB)
                           +- Relation default.date_dim[d_date_sk#6879,d_date_id#6880,d_date#6881,d_month_seq#6882,d_week_seq#6883,d_quarter_seq#6884,d_year#6885,d_dow#6886,d_moy#6887,d_dom#6888,d_qoy#6889,d_fy_year#6890,d_fy_quarter_seq#6891,d_fy_week_seq#6892,d_day_name#6893,d_quarter_name#6894,d_holiday#6895,d_weekend#6896,d_following_holiday#6897,d_first_dom#6898,d_last_dom#6899,d_same_day_ly#6900,d_same_day_lq#6901,d_current_day#6902,d_current_week#6903,d_current_month#6904,d_current_quarter#6905,d_current_year#6906] parquet, Statistics(sizeInBytes=2.5 MiB)

==== q15 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=3.5 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.79E+23 B)
   +- Sort [ca_zip#3726 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.79E+23 B)
      +- Aggregate [ca_zip#3726], [ca_zip#3726, MakeDecimal(sum(UnscaledValue(cs_sales_price#218)),17,2) AS sum(cs_sales_price)#7094], Statistics(sizeInBytes=1.79E+23 B)
         +- Project [cs_sales_price#218, ca_zip#3726], Statistics(sizeInBytes=1.79E+23 B)
            +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#24), Statistics(sizeInBytes=2.19E+23 B)
               :- Project [cs_sold_date_sk#197, cs_sales_price#218, ca_zip#3726], Statistics(sizeInBytes=1801.0 PiB)
               :  +- Join Inner, ((c_current_addr_sk#85 = ca_address_sk#3717) AND ((substr(ca_zip#3726, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) OR ca_state#3725 IN (CA,WA,GA)) OR (cs_sales_price#218 > 500.00))), Statistics(sizeInBytes=3.0 EiB)
               :     :- Project [cs_sold_date_sk#197, cs_sales_price#218, c_current_addr_sk#85], Statistics(sizeInBytes=5.6 TiB)
               :     :  +- Join Inner, (cs_bill_customer_sk#200 = c_customer_sk#81), Statistics(sizeInBytes=7.5 TiB)
               :     :     :- Project [cs_sold_date_sk#197, cs_bill_customer_sk#200, cs_sales_price#218], Statistics(sizeInBytes=12.4 MiB)
               :     :     :  +- Filter (isnotnull(cs_bill_customer_sk#200) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
               :     :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
               :     :     +- Project [c_customer_sk#81, c_current_addr_sk#85], Statistics(sizeInBytes=614.2 KiB)
               :     :        +- Filter (isnotnull(c_customer_sk#81) AND isnotnull(c_current_addr_sk#85)), Statistics(sizeInBytes=7.8 MiB)
               :     :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
               :     +- Project [ca_address_sk#3717, ca_state#3725, ca_zip#3726], Statistics(sizeInBytes=546.7 KiB)
               :        +- Filter isnotnull(ca_address_sk#3717), Statistics(sizeInBytes=2.5 MiB)
               :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
               +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                  +- Filter (((isnotnull(d_qoy#34) AND isnotnull(d_year#30)) AND ((d_qoy#34 = 2) AND (d_year#30 = 2001))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                     +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)

==== q16 ====
== Optimized Logical Plan ==
Aggregate [count(distinct cs_order_number#214) AS order count #7103L, MakeDecimal(sum(UnscaledValue(cs_ext_ship_cost#225)),17,2) AS total shipping cost #7104, MakeDecimal(sum(UnscaledValue(cs_net_profit#230)),17,2) AS total net profit #7105], Statistics(sizeInBytes=32.0 B, rowCount=1)
+- Project [cs_order_number#214, cs_ext_ship_cost#225, cs_net_profit#230], Statistics(sizeInBytes=215.6 EiB)
   +- Join Inner, (cs_call_center_sk#208 = cc_call_center_sk#7108), Statistics(sizeInBytes=277.2 EiB)
      :- Project [cs_call_center_sk#208, cs_order_number#214, cs_ext_ship_cost#225, cs_net_profit#230], Statistics(sizeInBytes=176.2 PiB)
      :  +- Join Inner, (cs_ship_addr_sk#207 = ca_address_sk#3717), Statistics(sizeInBytes=220.2 PiB)
      :     :- Project [cs_ship_addr_sk#207, cs_call_center_sk#208, cs_order_number#214, cs_ext_ship_cost#225, cs_net_profit#230], Statistics(sizeInBytes=1787.7 GiB)
      :     :  +- Join Inner, (cs_ship_date_sk#199 = d_date_sk#24), Statistics(sizeInBytes=2.1 TiB)
      :     :     :- Join LeftAnti, (cs_order_number#214 = cr_order_number#3307), Statistics(sizeInBytes=20.7 MiB)
      :     :     :  :- Project [cs_ship_date_sk#199, cs_ship_addr_sk#207, cs_call_center_sk#208, cs_order_number#214, cs_ext_ship_cost#225, cs_net_profit#230], Statistics(sizeInBytes=20.7 MiB)
      :     :     :  :  +- Join LeftSemi, ((cs_order_number#214 = cs_order_number#7156) AND NOT (cs_warehouse_sk#211 = cs_warehouse_sk#7153)), Statistics(sizeInBytes=22.8 MiB)
      :     :     :  :     :- Project [cs_ship_date_sk#199, cs_ship_addr_sk#207, cs_call_center_sk#208, cs_warehouse_sk#211, cs_order_number#214, cs_ext_ship_cost#225, cs_net_profit#230], Statistics(sizeInBytes=22.8 MiB)
      :     :     :  :     :  +- Filter ((isnotnull(cs_ship_date_sk#199) AND isnotnull(cs_ship_addr_sk#207)) AND isnotnull(cs_call_center_sk#208)), Statistics(sizeInBytes=105.8 MiB)
      :     :     :  :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
      :     :     :  :     +- Project [cs_warehouse_sk#7153, cs_order_number#7156], Statistics(sizeInBytes=8.3 MiB)
      :     :     :  :        +- Relation default.catalog_sales[cs_sold_date_sk#7139,cs_sold_time_sk#7140,cs_ship_date_sk#7141,cs_bill_customer_sk#7142,cs_bill_cdemo_sk#7143,cs_bill_hdemo_sk#7144,cs_bill_addr_sk#7145,cs_ship_customer_sk#7146,cs_ship_cdemo_sk#7147,cs_ship_hdemo_sk#7148,cs_ship_addr_sk#7149,cs_call_center_sk#7150,cs_catalog_page_sk#7151,cs_ship_mode_sk#7152,cs_warehouse_sk#7153,cs_item_sk#7154,cs_promo_sk#7155,cs_order_number#7156,cs_quantity#7157,cs_wholesale_cost#7158,cs_list_price#7159,cs_sales_price#7160,cs_ext_discount_amt#7161,cs_ext_sales_price#7162,cs_ext_wholesale_cost#7163,cs_ext_list_price#7164,cs_ext_tax#7165,cs_coupon_amt#7166,cs_ext_ship_cost#7167,cs_net_paid#7168,cs_net_paid_inc_tax#7169,cs_net_paid_inc_ship#7170,cs_net_paid_inc_ship_tax#7171,cs_net_profit#7172] parquet, Statistics(sizeInBytes=105.8 MiB)
      :     :     :  +- Project [cr_order_number#3307], Statistics(sizeInBytes=1015.9 KiB)
      :     :     :     +- Relation default.catalog_returns[cr_returned_date_sk#3291,cr_returned_time_sk#3292,cr_item_sk#3293,cr_refunded_customer_sk#3294,cr_refunded_cdemo_sk#3295,cr_refunded_hdemo_sk#3296,cr_refunded_addr_sk#3297,cr_returning_customer_sk#3298,cr_returning_cdemo_sk#3299,cr_returning_hdemo_sk#3300,cr_returning_addr_sk#3301,cr_call_center_sk#3302,cr_catalog_page_sk#3303,cr_ship_mode_sk#3304,cr_warehouse_sk#3305,cr_reason_sk#3306,cr_order_number#3307,cr_return_quantity#3308,cr_return_amount#3309,cr_return_tax#3310,cr_return_amt_inc_tax#3311,cr_fee#3312,cr_return_ship_cost#3313,cr_refunded_cash#3314,cr_reversed_charge#3315,cr_store_credit#3316,cr_net_loss#3317] parquet, Statistics(sizeInBytes=12.6 MiB)
      :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
      :     :        +- Filter ((isnotnull(d_date#26) AND ((d_date#26 >= 2002-02-01) AND (d_date#26 <= 2002-04-02))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
      :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
      :     +- Project [ca_address_sk#3717], Statistics(sizeInBytes=126.2 KiB)
      :        +- Filter ((isnotnull(ca_state#3725) AND (ca_state#3725 = GA)) AND isnotnull(ca_address_sk#3717)), Statistics(sizeInBytes=2.5 MiB)
      :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
      +- Project [cc_call_center_sk#7108], Statistics(sizeInBytes=1611.0 B)
         +- Filter ((isnotnull(cc_county#7133) AND (cc_county#7133 = Williamson County)) AND isnotnull(cc_call_center_sk#7108)), Statistics(sizeInBytes=58.2 KiB)
            +- Relation default.call_center[cc_call_center_sk#7108,cc_call_center_id#7109,cc_rec_start_date#7110,cc_rec_end_date#7111,cc_closed_date_sk#7112,cc_open_date_sk#7113,cc_name#7114,cc_class#7115,cc_employees#7116,cc_sq_ft#7117,cc_hours#7118,cc_manager#7119,cc_mkt_id#7120,cc_mkt_class#7121,cc_mkt_desc#7122,cc_market_manager#7123,cc_division#7124,cc_division_name#7125,cc_company#7126,cc_company_name#7127,cc_street_number#7128,cc_street_name#7129,cc_street_type#7130,cc_suite_number#7131,cc_city#7132,cc_county#7133,cc_state#7134,cc_zip#7135,cc_country#7136,cc_gmt_offset#7137,cc_tax_percentage#7138] parquet, Statistics(sizeInBytes=58.2 KiB)

==== q17 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=16.0 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=4.70E+45 B)
   +- Sort [i_item_id#438 ASC NULLS FIRST, i_item_desc#441 ASC NULLS FIRST, s_state#76 ASC NULLS FIRST], true, Statistics(sizeInBytes=4.70E+45 B)
      +- Aggregate [i_item_id#438, i_item_desc#441, s_state#76], [i_item_id#438, i_item_desc#441, s_state#76, count(ss_quantity#424) AS store_sales_quantitycount#7281L, avg(ss_quantity#424) AS store_sales_quantityave#7282, stddev_samp(cast(ss_quantity#424 as double)) AS store_sales_quantitystdev#7283, (stddev_samp(cast(ss_quantity#424 as double)) / avg(ss_quantity#424)) AS store_sales_quantitycov#7284, count(sr_return_quantity#14) AS as_store_returns_quantitycount#7285L, avg(sr_return_quantity#14) AS as_store_returns_quantityave#7286, stddev_samp(cast(sr_return_quantity#14 as double)) AS as_store_returns_quantitystdev#7287, (stddev_samp(cast(sr_return_quantity#14 as double)) / avg(sr_return_quantity#14)) AS store_returns_quantitycov#7288, count(cs_quantity#215) AS catalog_sales_quantitycount#7289L, avg(cs_quantity#215) AS catalog_sales_quantityave#7290, (stddev_samp(cast(cs_quantity#215 as double)) / avg(cs_quantity#215)) AS catalog_sales_quantitystdev#7291, (stddev_samp(cast(cs_quantity#215 as double)) / avg(cs_quantity#215)) AS catalog_sales_quantitycov#7292], Statistics(sizeInBytes=4.70E+45 B)
         +- Project [ss_quantity#424, sr_return_quantity#14, cs_quantity#215, s_state#76, i_item_id#438, i_item_desc#441], Statistics(sizeInBytes=2.29E+45 B)
            +- Join Inner, (i_item_sk#437 = ss_item_sk#416), Statistics(sizeInBytes=2.52E+45 B)
               :- Project [ss_item_sk#416, ss_quantity#424, sr_return_quantity#14, cs_quantity#215, s_state#76], Statistics(sizeInBytes=4.43E+39 B)
               :  +- Join Inner, (s_store_sk#52 = ss_store_sk#421), Statistics(sizeInBytes=5.23E+39 B)
               :     :- Project [ss_item_sk#416, ss_store_sk#421, ss_quantity#424, sr_return_quantity#14, cs_quantity#215], Statistics(sizeInBytes=6.60E+35 B)
               :     :  +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#7321), Statistics(sizeInBytes=8.48E+35 B)
               :     :     :- Project [ss_item_sk#416, ss_store_sk#421, ss_quantity#424, sr_return_quantity#14, cs_sold_date_sk#197, cs_quantity#215], Statistics(sizeInBytes=7.87E+30 B)
               :     :     :  +- Join Inner, (sr_returned_date_sk#4 = d_date_sk#7293), Statistics(sizeInBytes=9.83E+30 B)
               :     :     :     :- Project [ss_item_sk#416, ss_store_sk#421, ss_quantity#424, sr_returned_date_sk#4, sr_return_quantity#14, cs_sold_date_sk#197, cs_quantity#215], Statistics(sizeInBytes=9.12E+25 B)
               :     :     :     :  +- Join Inner, (d_date_sk#24 = ss_sold_date_sk#414), Statistics(sizeInBytes=1.11E+26 B)
               :     :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_quantity#424, sr_returned_date_sk#4, sr_return_quantity#14, cs_sold_date_sk#197, cs_quantity#215], Statistics(sizeInBytes=896.4 EiB)
               :     :     :     :     :  +- Join Inner, ((sr_customer_sk#7 = cs_bill_customer_sk#200) AND (sr_item_sk#6 = cs_item_sk#212)), Statistics(sizeInBytes=1255.0 EiB)
               :     :     :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_quantity#424, sr_returned_date_sk#4, sr_item_sk#6, sr_customer_sk#7, sr_return_quantity#14], Statistics(sizeInBytes=100.8 TiB)
               :     :     :     :     :     :  +- Join Inner, (((ss_customer_sk#417 = sr_customer_sk#7) AND (ss_item_sk#416 = sr_item_sk#6)) AND (ss_ticket_number#423 = sr_ticket_number#13)), Statistics(sizeInBytes=131.0 TiB)
               :     :     :     :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_customer_sk#417, ss_store_sk#421, ss_ticket_number#423, ss_quantity#424], Statistics(sizeInBytes=30.5 MiB)
               :     :     :     :     :     :     :  +- Filter (((isnotnull(ss_customer_sk#417) AND isnotnull(ss_item_sk#416)) AND isnotnull(ss_ticket_number#423)) AND (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421))), Statistics(sizeInBytes=141.1 MiB)
               :     :     :     :     :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               :     :     :     :     :     :     +- Project [sr_returned_date_sk#4, sr_item_sk#6, sr_customer_sk#7, sr_ticket_number#13, sr_return_quantity#14], Statistics(sizeInBytes=4.3 MiB)
               :     :     :     :     :     :        +- Filter (((isnotnull(sr_customer_sk#7) AND isnotnull(sr_item_sk#6)) AND isnotnull(sr_ticket_number#13)) AND isnotnull(sr_returned_date_sk#4)), Statistics(sizeInBytes=19.0 MiB)
               :     :     :     :     :     :           +- Relation default.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet, Statistics(sizeInBytes=19.0 MiB)
               :     :     :     :     :     +- Project [cs_sold_date_sk#197, cs_bill_customer_sk#200, cs_item_sk#212, cs_quantity#215], Statistics(sizeInBytes=12.4 MiB)
               :     :     :     :     :        +- Filter ((isnotnull(cs_bill_customer_sk#200) AND isnotnull(cs_item_sk#212)) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
               :     :     :     :     :           +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
               :     :     :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :     :     :     :        +- Filter ((isnotnull(d_quarter_name#39) AND (d_quarter_name#39 = 2001Q1)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :     :     :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     :     :     +- Project [d_date_sk#7293], Statistics(sizeInBytes=105.3 KiB)
               :     :     :        +- Filter (d_quarter_name#7308 IN (2001Q1,2001Q2,2001Q3) AND isnotnull(d_date_sk#7293)), Statistics(sizeInBytes=2.5 MiB)
               :     :     :           +- Relation default.date_dim[d_date_sk#7293,d_date_id#7294,d_date#7295,d_month_seq#7296,d_week_seq#7297,d_quarter_seq#7298,d_year#7299,d_dow#7300,d_moy#7301,d_dom#7302,d_qoy#7303,d_fy_year#7304,d_fy_quarter_seq#7305,d_fy_week_seq#7306,d_day_name#7307,d_quarter_name#7308,d_holiday#7309,d_weekend#7310,d_following_holiday#7311,d_first_dom#7312,d_last_dom#7313,d_same_day_ly#7314,d_same_day_lq#7315,d_current_day#7316,d_current_week#7317,d_current_month#7318,d_current_quarter#7319,d_current_year#7320] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     :     +- Project [d_date_sk#7321], Statistics(sizeInBytes=105.3 KiB)
               :     :        +- Filter (d_quarter_name#7336 IN (2001Q1,2001Q2,2001Q3) AND isnotnull(d_date_sk#7321)), Statistics(sizeInBytes=2.5 MiB)
               :     :           +- Relation default.date_dim[d_date_sk#7321,d_date_id#7322,d_date#7323,d_month_seq#7324,d_week_seq#7325,d_quarter_seq#7326,d_year#7327,d_dow#7328,d_moy#7329,d_dom#7330,d_qoy#7331,d_fy_year#7332,d_fy_quarter_seq#7333,d_fy_week_seq#7334,d_day_name#7335,d_quarter_name#7336,d_holiday#7337,d_weekend#7338,d_following_holiday#7339,d_first_dom#7340,d_last_dom#7341,d_same_day_ly#7342,d_same_day_lq#7343,d_current_day#7344,d_current_week#7345,d_current_month#7346,d_current_quarter#7347,d_current_year#7348] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     +- Project [s_store_sk#52, s_state#76], Statistics(sizeInBytes=7.7 KiB)
               :        +- Filter isnotnull(s_store_sk#52), Statistics(sizeInBytes=101.7 KiB)
               :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
               +- Project [i_item_sk#437, i_item_id#438, i_item_desc#441], Statistics(sizeInBytes=556.2 KiB)
                  +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
                     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)

==== q18 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=14.1 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=3.08E+42 B)
   +- Sort [ca_country#7850 ASC NULLS FIRST, ca_state#7851 ASC NULLS FIRST, ca_county#7852 ASC NULLS FIRST, i_item_id#7849 ASC NULLS FIRST], true, Statistics(sizeInBytes=3.08E+42 B)
      +- Aggregate [i_item_id#7849, ca_country#7850, ca_state#7851, ca_county#7852, spark_grouping_id#7848L], [i_item_id#7849, ca_country#7850, ca_state#7851, ca_county#7852, avg(cast(cs_quantity#215 as decimal(12,2))) AS agg1#7820, avg(cast(cs_list_price#217 as decimal(12,2))) AS agg2#7821, avg(cast(cs_coupon_amt#224 as decimal(12,2))) AS agg3#7822, avg(cast(cs_sales_price#218 as decimal(12,2))) AS agg4#7823, avg(cast(cs_net_profit#230 as decimal(12,2))) AS agg5#7824, avg(cast(c_birth_year#94 as decimal(12,2))) AS agg6#7825, avg(cast(cd_dep_count#3639 as decimal(12,2))) AS agg7#7826], Statistics(sizeInBytes=3.08E+42 B)
         +- Expand [[cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224, cs_net_profit#230, cd_dep_count#3639, c_birth_year#94, i_item_id#438, ca_country#3727, ca_state#3725, ca_county#3724, 0], [cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224, cs_net_profit#230, cd_dep_count#3639, c_birth_year#94, i_item_id#438, ca_country#3727, ca_state#3725, null, 1], [cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224, cs_net_profit#230, cd_dep_count#3639, c_birth_year#94, i_item_id#438, ca_country#3727, null, null, 3], [cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224, cs_net_profit#230, cd_dep_count#3639, c_birth_year#94, i_item_id#438, null, null, null, 7], [cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224, cs_net_profit#230, cd_dep_count#3639, c_birth_year#94, null, null, null, null, 15]], [cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224, cs_net_profit#230, cd_dep_count#3639, c_birth_year#94, i_item_id#7849, ca_country#7850, ca_state#7851, ca_county#7852, spark_grouping_id#7848L], Statistics(sizeInBytes=3.00E+42 B)
            +- Project [cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224, cs_net_profit#230, cd_dep_count#3639, c_birth_year#94, i_item_id#438, ca_country#3727, ca_state#3725, ca_county#3724], Statistics(sizeInBytes=5.65E+41 B)
               +- Join Inner, (cs_item_sk#212 = i_item_sk#437), Statistics(sizeInBytes=5.99E+41 B)
                  :- Project [cs_item_sk#212, cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224, cs_net_profit#230, cd_dep_count#3639, c_birth_year#94, ca_county#3724, ca_state#3725, ca_country#3727], Statistics(sizeInBytes=1.71E+36 B)
                  :  +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#24), Statistics(sizeInBytes=1.83E+36 B)
                  :     :- Project [cs_sold_date_sk#197, cs_item_sk#212, cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224, cs_net_profit#230, cd_dep_count#3639, c_birth_year#94, ca_county#3724, ca_state#3725, ca_country#3727], Statistics(sizeInBytes=1.69E+31 B)
                  :     :  +- Join Inner, (c_current_addr_sk#85 = ca_address_sk#3717), Statistics(sizeInBytes=1.81E+31 B)
                  :     :     :- Project [cs_sold_date_sk#197, cs_item_sk#212, cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224, cs_net_profit#230, cd_dep_count#3639, c_current_addr_sk#85, c_birth_year#94], Statistics(sizeInBytes=2.33E+25 B)
                  :     :     :  +- Join Inner, (c_current_cdemo_sk#83 = cd_demo_sk#7827), Statistics(sizeInBytes=2.62E+25 B)
                  :     :     :     :- Project [cs_sold_date_sk#197, cs_item_sk#212, cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224, cs_net_profit#230, cd_dep_count#3639, c_current_cdemo_sk#83, c_current_addr_sk#85, c_birth_year#94], Statistics(sizeInBytes=25.3 EiB)
                  :     :     :     :  +- Join Inner, (cs_bill_customer_sk#200 = c_customer_sk#81), Statistics(sizeInBytes=28.3 EiB)
                  :     :     :     :     :- Project [cs_sold_date_sk#197, cs_bill_customer_sk#200, cs_item_sk#212, cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224, cs_net_profit#230, cd_dep_count#3639], Statistics(sizeInBytes=31.4 TiB)
                  :     :     :     :     :  +- Join Inner, (cs_bill_cdemo_sk#201 = cd_demo_sk#3633), Statistics(sizeInBytes=35.6 TiB)
                  :     :     :     :     :     :- Project [cs_sold_date_sk#197, cs_bill_customer_sk#200, cs_bill_cdemo_sk#201, cs_item_sk#212, cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224, cs_net_profit#230], Statistics(sizeInBytes=31.1 MiB)
                  :     :     :     :     :     :  +- Filter ((isnotnull(cs_bill_cdemo_sk#201) AND isnotnull(cs_bill_customer_sk#200)) AND (isnotnull(cs_sold_date_sk#197) AND isnotnull(cs_item_sk#212))), Statistics(sizeInBytes=105.8 MiB)
                  :     :     :     :     :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
                  :     :     :     :     :     +- Project [cd_demo_sk#3633, cd_dep_count#3639], Statistics(sizeInBytes=1171.5 KiB)
                  :     :     :     :     :        +- Filter (((isnotnull(cd_gender#3634) AND isnotnull(cd_education_status#3636)) AND ((cd_gender#3634 = F) AND (cd_education_status#3636 = Unknown             ))) AND isnotnull(cd_demo_sk#3633)), Statistics(sizeInBytes=7.7 MiB)
                  :     :     :     :     :           +- Relation default.customer_demographics[cd_demo_sk#3633,cd_gender#3634,cd_marital_status#3635,cd_education_status#3636,cd_purchase_estimate#3637,cd_credit_rating#3638,cd_dep_count#3639,cd_dep_employed_count#3640,cd_dep_college_count#3641] parquet, Statistics(sizeInBytes=7.7 MiB)
                  :     :     :     :     +- Project [c_customer_sk#81, c_current_cdemo_sk#83, c_current_addr_sk#85, c_birth_year#94], Statistics(sizeInBytes=921.4 KiB)
                  :     :     :     :        +- Filter ((c_birth_month#93 IN (1,6,8,9,12,2) AND isnotnull(c_customer_sk#81)) AND (isnotnull(c_current_cdemo_sk#83) AND isnotnull(c_current_addr_sk#85))), Statistics(sizeInBytes=7.8 MiB)
                  :     :     :     :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
                  :     :     :     +- Project [cd_demo_sk#7827], Statistics(sizeInBytes=878.6 KiB)
                  :     :     :        +- Filter isnotnull(cd_demo_sk#7827), Statistics(sizeInBytes=7.7 MiB)
                  :     :     :           +- Relation default.customer_demographics[cd_demo_sk#7827,cd_gender#7828,cd_marital_status#7829,cd_education_status#7830,cd_purchase_estimate#7831,cd_credit_rating#7832,cd_dep_count#7833,cd_dep_employed_count#7834,cd_dep_college_count#7835] parquet, Statistics(sizeInBytes=7.7 MiB)
                  :     :     +- Project [ca_address_sk#3717, ca_county#3724, ca_state#3725, ca_country#3727], Statistics(sizeInBytes=756.9 KiB)
                  :     :        +- Filter (ca_state#3725 IN (MS,IN,ND,OK,NM,VA) AND isnotnull(ca_address_sk#3717)), Statistics(sizeInBytes=2.5 MiB)
                  :     :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
                  :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                  :        +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 1998)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                  :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                  +- Project [i_item_sk#437, i_item_id#438], Statistics(sizeInBytes=342.3 KiB)
                     +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
                        +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)

==== q19 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=6.3 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.29E+33 B)
   +- Sort [ext_price#7964 DESC NULLS LAST, brand#7963 ASC NULLS FIRST, brand_id#7962 ASC NULLS FIRST, i_manufact_id#450 ASC NULLS FIRST, i_manufact#451 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.29E+33 B)
      +- Aggregate [i_brand#445, i_brand_id#444, i_manufact_id#450, i_manufact#451], [i_brand_id#444 AS brand_id#7962, i_brand#445 AS brand#7963, i_manufact_id#450, i_manufact#451, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS ext_price#7964], Statistics(sizeInBytes=1.29E+33 B)
         +- Project [ss_ext_sales_price#429, i_brand_id#444, i_brand#445, i_manufact_id#450, i_manufact#451], Statistics(sizeInBytes=1.29E+33 B)
            +- Join Inner, (NOT (substr(ca_zip#3726, 1, 5) = substr(s_zip#77, 1, 5)) AND (ss_store_sk#421 = s_store_sk#52)), Statistics(sizeInBytes=2.25E+33 B)
               :- Project [ss_store_sk#421, ss_ext_sales_price#429, i_brand_id#444, i_brand#445, i_manufact_id#450, i_manufact#451, ca_zip#3726], Statistics(sizeInBytes=2.84E+29 B)
               :  +- Join Inner, (c_current_addr_sk#85 = ca_address_sk#3717), Statistics(sizeInBytes=3.09E+29 B)
               :     :- Project [ss_store_sk#421, ss_ext_sales_price#429, i_brand_id#444, i_brand#445, i_manufact_id#450, i_manufact#451, c_current_addr_sk#85], Statistics(sizeInBytes=8.98E+23 B)
               :     :  +- Join Inner, (ss_customer_sk#417 = c_customer_sk#81), Statistics(sizeInBytes=9.98E+23 B)
               :     :     :- Project [ss_customer_sk#417, ss_store_sk#421, ss_ext_sales_price#429, i_brand_id#444, i_brand#445, i_manufact_id#450, i_manufact#451], Statistics(sizeInBytes=1409.1 PiB)
               :     :     :  +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=1565.7 PiB)
               :     :     :     :- Project [ss_item_sk#416, ss_customer_sk#417, ss_store_sk#421, ss_ext_sales_price#429], Statistics(sizeInBytes=2.4 TiB)
               :     :     :     :  +- Join Inner, (d_date_sk#24 = ss_sold_date_sk#414), Statistics(sizeInBytes=3.1 TiB)
               :     :     :     :     :- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :     :     :     :     :  +- Filter (((isnotnull(d_moy#32) AND isnotnull(d_year#30)) AND ((d_moy#32 = 11) AND (d_year#30 = 1998))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :     :     :     :     :     +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     :     :     :     +- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_customer_sk#417, ss_store_sk#421, ss_ext_sales_price#429], Statistics(sizeInBytes=30.5 MiB)
               :     :     :     :        +- Filter (isnotnull(ss_sold_date_sk#414) AND ((isnotnull(ss_item_sk#416) AND isnotnull(ss_customer_sk#417)) AND isnotnull(ss_store_sk#421))), Statistics(sizeInBytes=141.1 MiB)
               :     :     :     :           +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               :     :     :     +- Project [i_item_sk#437, i_brand_id#444, i_brand#445, i_manufact_id#450, i_manufact#451], Statistics(sizeInBytes=641.8 KiB)
               :     :     :        +- Filter ((isnotnull(i_manager_id#457) AND (i_manager_id#457 = 8)) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
               :     :     :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
               :     :     +- Project [c_customer_sk#81, c_current_addr_sk#85], Statistics(sizeInBytes=614.2 KiB)
               :     :        +- Filter (isnotnull(c_customer_sk#81) AND isnotnull(c_current_addr_sk#85)), Statistics(sizeInBytes=7.8 MiB)
               :     :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
               :     +- Project [ca_address_sk#3717, ca_zip#3726], Statistics(sizeInBytes=336.4 KiB)
               :        +- Filter (isnotnull(ca_address_sk#3717) AND isnotnull(ca_zip#3726)), Statistics(sizeInBytes=2.5 MiB)
               :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
               +- Project [s_store_sk#52, s_zip#77], Statistics(sizeInBytes=7.7 KiB)
                  +- Filter (isnotnull(s_zip#77) AND isnotnull(s_store_sk#52)), Statistics(sizeInBytes=101.7 KiB)
                     +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)

==== q20 ==== 
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=9.8 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1138.3 PiB)
   +- Project [i_item_desc#441, i_category#449, i_class#447, i_current_price#442, itemrevenue#7976, revenueratio#7977], Statistics(sizeInBytes=1138.3 PiB)
      +- Sort [i_category#449 ASC NULLS FIRST, i_class#447 ASC NULLS FIRST, i_item_id#438 ASC NULLS FIRST, i_item_desc#441 ASC NULLS FIRST, revenueratio#7977 ASC NULLS FIRST], true, Statistics(sizeInBytes=1366.0 PiB)
         +- Project [i_item_desc#441, i_category#449, i_class#447, i_current_price#442, itemrevenue#7976, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(_w0#7982) * 100.00), DecimalType(21,2)) as decimal(27,2))) / promote_precision(_we0#7984)), DecimalType(38,17)) AS revenueratio#7977, i_item_id#438], Statistics(sizeInBytes=1366.0 PiB)
            +- Window [sum(_w1#7983) windowspecdefinition(i_class#447, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#7984], [i_class#447], Statistics(sizeInBytes=1548.1 PiB)
               +- Aggregate [i_item_id#438, i_item_desc#441, i_category#449, i_class#447, i_current_price#442], [i_item_desc#441, i_category#449, i_class#447, i_current_price#442, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#220)),17,2) AS itemrevenue#7976, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#220)),17,2) AS _w0#7982, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#220)),17,2) AS _w1#7983, i_item_id#438], Statistics(sizeInBytes=1366.0 PiB)
                  +- Project [cs_ext_sales_price#220, i_item_id#438, i_item_desc#441, i_current_price#442, i_class#447, i_category#449], Statistics(sizeInBytes=1183.8 PiB)
                     +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#24), Statistics(sizeInBytes=1274.9 PiB)
                        :- Project [cs_sold_date_sk#197, cs_ext_sales_price#220, i_item_id#438, i_item_desc#441, i_current_price#442, i_class#447, i_category#449], Statistics(sizeInBytes=12.1 TiB)
                        :  +- Join Inner, (cs_item_sk#212 = i_item_sk#437), Statistics(sizeInBytes=13.0 TiB)
                        :     :- Project [cs_sold_date_sk#197, cs_item_sk#212, cs_ext_sales_price#220], Statistics(sizeInBytes=12.4 MiB)
                        :     :  +- Filter (isnotnull(cs_item_sk#212) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
                        :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
                        :     +- Project [i_item_sk#437, i_item_id#438, i_item_desc#441, i_current_price#442, i_class#447, i_category#449], Statistics(sizeInBytes=1069.6 KiB)
                        :        +- Filter (i_category#449 IN (Sports                                            ,Books                                             ,Home                                              ) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
                        :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
                        +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                           +- Filter ((isnotnull(d_date#26) AND ((d_date#26 >= 1999-02-22) AND (d_date#26 <= 1999-03-24))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)

==== q21 ==== 
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=6.3 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=4.13E+21 B)
   +- Sort [w_warehouse_name#8011 ASC NULLS FIRST, i_item_id#438 ASC NULLS FIRST], true, Statistics(sizeInBytes=4.13E+21 B)
      +- Filter (CASE WHEN (inv_before#8003L > 0) THEN ((cast(inv_after#8004L as double) / cast(inv_before#8003L as double)) >= 0.666667) END AND CASE WHEN (inv_before#8003L > 0) THEN ((cast(inv_after#8004L as double) / cast(inv_before#8003L as double)) <= 1.5) END), Statistics(sizeInBytes=4.13E+21 B)
         +- Aggregate [w_warehouse_name#8011, i_item_id#438], [w_warehouse_name#8011, i_item_id#438, sum(CASE WHEN (d_date#26 < 2000-03-11) THEN inv_quantity_on_hand#8008 ELSE 0 END) AS inv_before#8003L, sum(CASE WHEN (d_date#26 >= 2000-03-11) THEN inv_quantity_on_hand#8008 ELSE 0 END) AS inv_after#8004L], Statistics(sizeInBytes=4.13E+21 B)
            +- Project [inv_quantity_on_hand#8008, w_warehouse_name#8011, i_item_id#438, d_date#26], Statistics(sizeInBytes=3.61E+21 B)
               +- Join Inner, (inv_date_sk#8005 = d_date_sk#24), Statistics(sizeInBytes=4.13E+21 B)
                  :- Project [inv_date_sk#8005, inv_quantity_on_hand#8008, w_warehouse_name#8011, i_item_id#438], Statistics(sizeInBytes=25.5 PiB)
                  :  +- Join Inner, (i_item_sk#437 = inv_item_sk#8006), Statistics(sizeInBytes=29.1 PiB)
                  :     :- Project [inv_date_sk#8005, inv_item_sk#8006, inv_quantity_on_hand#8008, w_warehouse_name#8011], Statistics(sizeInBytes=87.2 GiB)
                  :     :  +- Join Inner, (inv_warehouse_sk#8007 = w_warehouse_sk#8009), Statistics(sizeInBytes=104.6 GiB)
                  :     :     :- Filter (isnotnull(inv_warehouse_sk#8007) AND (isnotnull(inv_item_sk#8006) AND isnotnull(inv_date_sk#8005))), Statistics(sizeInBytes=38.2 MiB)
                  :     :     :  +- Relation default.inventory[inv_date_sk#8005,inv_item_sk#8006,inv_warehouse_sk#8007,inv_quantity_on_hand#8008] parquet, Statistics(sizeInBytes=38.2 MiB)
                  :     :     +- Project [w_warehouse_sk#8009, w_warehouse_name#8011], Statistics(sizeInBytes=2.7 KiB)
                  :     :        +- Filter isnotnull(w_warehouse_sk#8009), Statistics(sizeInBytes=20.9 KiB)
                  :     :           +- Relation default.warehouse[w_warehouse_sk#8009,w_warehouse_id#8010,w_warehouse_name#8011,w_warehouse_sq_ft#8012,w_street_number#8013,w_street_name#8014,w_street_type#8015,w_suite_number#8016,w_city#8017,w_county#8018,w_state#8019,w_zip#8020,w_country#8021,w_gmt_offset#8022] parquet, Statistics(sizeInBytes=20.9 KiB)
                  :     +- Project [i_item_sk#437, i_item_id#438], Statistics(sizeInBytes=342.3 KiB)
                  :        +- Filter ((isnotnull(i_current_price#442) AND ((i_current_price#442 >= 0.99) AND (i_current_price#442 <= 1.49))) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
                  :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
                  +- Project [d_date_sk#24, d_date#26], Statistics(sizeInBytes=140.4 KiB)
                     +- Filter ((isnotnull(d_date#26) AND ((d_date#26 >= 2000-02-10) AND (d_date#26 <= 2000-04-10))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                        +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q22 ==== 
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=9.4 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.45E+22 B)
   +- Sort [qoh#8041 ASC NULLS FIRST, i_product_name#8048 ASC NULLS FIRST, i_brand#8049 ASC NULLS FIRST, i_class#8050 ASC NULLS FIRST, i_category#8051 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.45E+22 B)
      +- Aggregate [i_product_name#8048, i_brand#8049, i_class#8050, i_category#8051, spark_grouping_id#8047L], [i_product_name#8048, i_brand#8049, i_class#8050, i_category#8051, avg(inv_quantity_on_hand#8008) AS qoh#8041], Statistics(sizeInBytes=1.45E+22 B)
         +- Expand [[inv_quantity_on_hand#8008, i_product_name#458, i_brand#445, i_class#447, i_category#449, 0], [inv_quantity_on_hand#8008, i_product_name#458, i_brand#445, i_class#447, null, 1], [inv_quantity_on_hand#8008, i_product_name#458, i_brand#445, null, null, 3], [inv_quantity_on_hand#8008, i_product_name#458, null, null, null, 7], [inv_quantity_on_hand#8008, null, null, null, null, 15]], [inv_quantity_on_hand#8008, i_product_name#8048, i_brand#8049, i_class#8050, i_category#8051, spark_grouping_id#8047L], Statistics(sizeInBytes=1.51E+22 B)
            +- Project [inv_quantity_on_hand#8008, i_product_name#458, i_brand#445, i_class#447, i_category#449], Statistics(sizeInBytes=2.78E+21 B)
               +- Join Inner, (inv_warehouse_sk#8007 = w_warehouse_sk#8009), Statistics(sizeInBytes=3.02E+21 B)
                  :- Project [inv_warehouse_sk#8007, inv_quantity_on_hand#8008, i_brand#445, i_class#447, i_category#449, i_product_name#458], Statistics(sizeInBytes=2.5 EiB)
                  :  +- Join Inner, (inv_item_sk#8006 = i_item_sk#437), Statistics(sizeInBytes=2.7 EiB)
                  :     :- Project [inv_item_sk#8006, inv_warehouse_sk#8007, inv_quantity_on_hand#8008], Statistics(sizeInBytes=2.8 TiB)
                  :     :  +- Join Inner, (inv_date_sk#8005 = d_date_sk#24), Statistics(sizeInBytes=3.9 TiB)
                  :     :     :- Filter (isnotnull(inv_date_sk#8005) AND (isnotnull(inv_item_sk#8006) AND isnotnull(inv_warehouse_sk#8007))), Statistics(sizeInBytes=38.2 MiB)
                  :     :     :  +- Relation default.inventory[inv_date_sk#8005,inv_item_sk#8006,inv_warehouse_sk#8007,inv_quantity_on_hand#8008] parquet, Statistics(sizeInBytes=38.2 MiB)
                  :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                  :     :        +- Filter ((isnotnull(d_month_seq#27) AND ((d_month_seq#27 >= 1200) AND (d_month_seq#27 <= 1211))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                  :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                  :     +- Project [i_item_sk#437, i_brand#445, i_class#447, i_category#449, i_product_name#458], Statistics(sizeInBytes=984.0 KiB)
                  :        +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
                  :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
                  +- Project [w_warehouse_sk#8009], Statistics(sizeInBytes=1052.0 B)
                     +- Filter isnotnull(w_warehouse_sk#8009), Statistics(sizeInBytes=20.9 KiB)
                        +- Relation default.warehouse[w_warehouse_sk#8009,w_warehouse_id#8010,w_warehouse_name#8011,w_warehouse_sq_ft#8012,w_street_number#8013,w_street_name#8014,w_street_type#8015,w_suite_number#8016,w_city#8017,w_county#8018,w_state#8019,w_zip#8020,w_country#8021,w_gmt_offset#8022] parquet, Statistics(sizeInBytes=20.9 KiB)


==== q23a ====
== Optimized Logical Plan ==
Aggregate [sum(sales#8067) AS sum(sales)#8247], Statistics(sizeInBytes=24.0 B, rowCount=1)
+- Union false, false, Statistics(sizeInBytes=1117.1 GiB)
   :- Project [CheckOverflow((promote_precision(cast(cs_quantity#215 as decimal(12,2))) * promote_precision(cast(cs_list_price#217 as decimal(12,2)))), DecimalType(18,2)) AS sales#8067], Statistics(sizeInBytes=749.1 GiB)
   :  +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#8175), Statistics(sizeInBytes=1311.0 GiB)
   :     :- Project [cs_sold_date_sk#197, cs_quantity#215, cs_list_price#217], Statistics(sizeInBytes=12.4 MiB)
   :     :  +- Join LeftSemi, (cs_bill_customer_sk#200 = c_customer_sk#8157), Statistics(sizeInBytes=14.5 MiB)
   :     :     :- Project [cs_sold_date_sk#197, cs_bill_customer_sk#200, cs_quantity#215, cs_list_price#217], Statistics(sizeInBytes=14.5 MiB)
   :     :     :  +- Join LeftSemi, (cs_item_sk#212 = item_sk#8074), Statistics(sizeInBytes=16.6 MiB)
   :     :     :     :- Project [cs_sold_date_sk#197, cs_bill_customer_sk#200, cs_item_sk#212, cs_quantity#215, cs_list_price#217], Statistics(sizeInBytes=16.6 MiB)
   :     :     :     :  +- Filter isnotnull(cs_sold_date_sk#197), Statistics(sizeInBytes=105.8 MiB)
   :     :     :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
   :     :     :     +- Project [item_sk#8074], Statistics(sizeInBytes=143.1 PiB)
   :     :     :        +- Filter (cnt#8076L > 4), Statistics(sizeInBytes=238.6 PiB)
   :     :     :           +- Aggregate [_groupingexpression#8249, i_item_sk#437, d_date#26], [i_item_sk#437 AS item_sk#8074, count(1) AS cnt#8076L], Statistics(sizeInBytes=238.6 PiB)
   :     :     :              +- Project [d_date#26, i_item_sk#437, substr(i_item_desc#441, 1, 30) AS _groupingexpression#8249], Statistics(sizeInBytes=429.4 PiB)
   :     :     :                 +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=477.2 PiB)
   :     :     :                    :- Project [ss_item_sk#416, d_date#26], Statistics(sizeInBytes=1427.6 GiB)
   :     :     :                    :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2.1 TiB)
   :     :     :                    :     :- Project [ss_sold_date_sk#414, ss_item_sk#416], Statistics(sizeInBytes=15.3 MiB)
   :     :     :                    :     :  +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_item_sk#416)), Statistics(sizeInBytes=141.1 MiB)
   :     :     :                    :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
   :     :     :                    :     +- Project [d_date_sk#24, d_date#26], Statistics(sizeInBytes=140.4 KiB)
   :     :     :                    :        +- Filter (d_year#30 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
   :     :     :                    :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
   :     :     :                    +- Project [i_item_sk#437, i_item_desc#441], Statistics(sizeInBytes=342.3 KiB)
   :     :     :                       +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
   :     :     :                          +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
   :     :     +- Project [c_customer_sk#8157], Statistics(sizeInBytes=4.4 TiB)
   :     :        +- Filter (isnotnull(ssales#8079) AND (cast(ssales#8079 as decimal(38,8)) > CheckOverflow((0.500000 * promote_precision(cast(scalar-subquery#8080 [] as decimal(32,6)))), DecimalType(38,8)))), Statistics(sizeInBytes=10.3 TiB)
   :     :           :  +- Aggregate [max(csales#8077) AS tpcds_cmax#8078], Statistics(sizeInBytes=24.0 B, rowCount=1)
   :     :           :     +- Aggregate [c_customer_sk#81], [sum(CheckOverflow((promote_precision(cast(ss_quantity#8093 as decimal(12,2))) * promote_precision(cast(ss_sales_price#8096 as decimal(12,2)))), DecimalType(18,2))) AS csales#8077], Statistics(sizeInBytes=829.8 PiB)
   :     :           :        +- Project [ss_quantity#8093, ss_sales_price#8096, c_customer_sk#81], Statistics(sizeInBytes=829.8 PiB)
   :     :           :           +- Join Inner, (ss_sold_date_sk#8083 = d_date_sk#8106), Statistics(sizeInBytes=1106.4 PiB)
   :     :           :              :- Project [ss_sold_date_sk#8083, ss_quantity#8093, ss_sales_price#8096, c_customer_sk#81], Statistics(sizeInBytes=10.5 TiB)
   :     :           :              :  +- Join Inner, (ss_customer_sk#8086 = c_customer_sk#81), Statistics(sizeInBytes=12.0 TiB)
   :     :           :              :     :- Project [ss_sold_date_sk#8083, ss_customer_sk#8086, ss_quantity#8093, ss_sales_price#8096], Statistics(sizeInBytes=26.7 MiB)
   :     :           :              :     :  +- Filter (isnotnull(ss_customer_sk#8086) AND isnotnull(ss_sold_date_sk#8083)), Statistics(sizeInBytes=141.1 MiB)
   :     :           :              :     :     +- Relation default.store_sales[ss_sold_date_sk#8083,ss_sold_time_sk#8084,ss_item_sk#8085,ss_customer_sk#8086,ss_cdemo_sk#8087,ss_hdemo_sk#8088,ss_addr_sk#8089,ss_store_sk#8090,ss_promo_sk#8091,ss_ticket_number#8092,ss_quantity#8093,ss_wholesale_cost#8094,ss_list_price#8095,ss_sales_price#8096,ss_ext_discount_amt#8097,ss_ext_sales_price#8098,ss_ext_wholesale_cost#8099,ss_ext_list_price#8100,ss_ext_tax#8101,ss_coupon_amt#8102,ss_net_paid#8103,ss_net_paid_inc_tax#8104,ss_net_profit#8105] parquet, Statistics(sizeInBytes=141.1 MiB)
   :     :           :              :     +- Project [c_customer_sk#81], Statistics(sizeInBytes=460.7 KiB)
   :     :           :              :        +- Filter isnotnull(c_customer_sk#81), Statistics(sizeInBytes=7.8 MiB)
   :     :           :              :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
   :     :           :              +- Project [d_date_sk#8106], Statistics(sizeInBytes=105.3 KiB)
   :     :           :                 +- Filter (d_year#8112 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#8106)), Statistics(sizeInBytes=2.5 MiB)
   :     :           :                    +- Relation default.date_dim[d_date_sk#8106,d_date_id#8107,d_date#8108,d_month_seq#8109,d_week_seq#8110,d_quarter_seq#8111,d_year#8112,d_dow#8113,d_moy#8114,d_dom#8115,d_qoy#8116,d_fy_year#8117,d_fy_quarter_seq#8118,d_fy_week_seq#8119,d_day_name#8120,d_quarter_name#8121,d_holiday#8122,d_weekend#8123,d_following_holiday#8124,d_first_dom#8125,d_last_dom#8126,d_same_day_ly#8127,d_same_day_lq#8128,d_current_day#8129,d_current_week#8130,d_current_month#8131,d_current_quarter#8132,d_current_year#8133] parquet, Statistics(sizeInBytes=2.5 MiB)
   :     :           +- Aggregate [c_customer_sk#8157], [c_customer_sk#8157, sum(CheckOverflow((promote_precision(cast(ss_quantity#8144 as decimal(12,2))) * promote_precision(cast(ss_sales_price#8147 as decimal(12,2)))), DecimalType(18,2))) AS ssales#8079], Statistics(sizeInBytes=10.3 TiB)
   :     :              +- Project [ss_quantity#8144, ss_sales_price#8147, c_customer_sk#8157], Statistics(sizeInBytes=8.8 TiB)
   :     :                 +- Join Inner, (ss_customer_sk#8137 = c_customer_sk#8157), Statistics(sizeInBytes=10.3 TiB)
   :     :                    :- Project [ss_customer_sk#8137, ss_quantity#8144, ss_sales_price#8147], Statistics(sizeInBytes=22.9 MiB)
   :     :                    :  +- Filter isnotnull(ss_customer_sk#8137), Statistics(sizeInBytes=141.1 MiB)
   :     :                    :     +- Relation default.store_sales[ss_sold_date_sk#8134,ss_sold_time_sk#8135,ss_item_sk#8136,ss_customer_sk#8137,ss_cdemo_sk#8138,ss_hdemo_sk#8139,ss_addr_sk#8140,ss_store_sk#8141,ss_promo_sk#8142,ss_ticket_number#8143,ss_quantity#8144,ss_wholesale_cost#8145,ss_list_price#8146,ss_sales_price#8147,ss_ext_discount_amt#8148,ss_ext_sales_price#8149,ss_ext_wholesale_cost#8150,ss_ext_list_price#8151,ss_ext_tax#8152,ss_coupon_amt#8153,ss_net_paid#8154,ss_net_paid_inc_tax#8155,ss_net_profit#8156] parquet, Statistics(sizeInBytes=141.1 MiB)
   :     :                    +- Project [c_customer_sk#8157], Statistics(sizeInBytes=460.7 KiB)
   :     :                       +- Filter isnotnull(c_customer_sk#8157), Statistics(sizeInBytes=7.8 MiB)
   :     :                          +- Relation default.customer[c_customer_sk#8157,c_customer_id#8158,c_current_cdemo_sk#8159,c_current_hdemo_sk#8160,c_current_addr_sk#8161,c_first_shipto_date_sk#8162,c_first_sales_date_sk#8163,c_salutation#8164,c_first_name#8165,c_last_name#8166,c_preferred_cust_flag#8167,c_birth_day#8168,c_birth_month#8169,c_birth_year#8170,c_birth_country#8171,c_login#8172,c_email_address#8173,c_last_review_date#8174] parquet, Statistics(sizeInBytes=7.8 MiB)
   :     +- Project [d_date_sk#8175], Statistics(sizeInBytes=105.3 KiB)
   :        +- Filter (((isnotnull(d_year#8181) AND isnotnull(d_moy#8183)) AND ((d_year#8181 = 2000) AND (d_moy#8183 = 2))) AND isnotnull(d_date_sk#8175)), Statistics(sizeInBytes=2.5 MiB)
   :           +- Relation default.date_dim[d_date_sk#8175,d_date_id#8176,d_date#8177,d_month_seq#8178,d_week_seq#8179,d_quarter_seq#8180,d_year#8181,d_dow#8182,d_moy#8183,d_dom#8184,d_qoy#8185,d_fy_year#8186,d_fy_quarter_seq#8187,d_fy_week_seq#8188,d_day_name#8189,d_quarter_name#8190,d_holiday#8191,d_weekend#8192,d_following_holiday#8193,d_first_dom#8194,d_last_dom#8195,d_same_day_ly#8196,d_same_day_lq#8197,d_current_day#8198,d_current_week#8199,d_current_month#8200,d_current_quarter#8201,d_current_year#8202] parquet, Statistics(sizeInBytes=2.5 MiB)
   +- Project [CheckOverflow((promote_precision(cast(ws_quantity#181 as decimal(12,2))) * promote_precision(cast(ws_list_price#183 as decimal(12,2)))), DecimalType(18,2)) AS sales#8070], Statistics(sizeInBytes=368.0 GiB)
      +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#8203), Statistics(sizeInBytes=644.0 GiB)
         :- Project [ws_sold_date_sk#163, ws_quantity#181, ws_list_price#183], Statistics(sizeInBytes=6.1 MiB)
         :  +- Join LeftSemi, (ws_bill_customer_sk#167 = c_customer_sk#8157), Statistics(sizeInBytes=7.1 MiB)
         :     :- Project [ws_sold_date_sk#163, ws_bill_customer_sk#167, ws_quantity#181, ws_list_price#183], Statistics(sizeInBytes=7.1 MiB)
         :     :  +- Join LeftSemi, (ws_item_sk#166 = item_sk#8074), Statistics(sizeInBytes=8.2 MiB)
         :     :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_bill_customer_sk#167, ws_quantity#181, ws_list_price#183], Statistics(sizeInBytes=8.2 MiB)
         :     :     :  +- Filter isnotnull(ws_sold_date_sk#163), Statistics(sizeInBytes=52.0 MiB)
         :     :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
         :     :     +- Project [item_sk#8074], Statistics(sizeInBytes=143.1 PiB)
         :     :        +- Filter (cnt#8076L > 4), Statistics(sizeInBytes=238.6 PiB)
         :     :           +- Aggregate [_groupingexpression#8249, i_item_sk#437, d_date#26], [i_item_sk#437 AS item_sk#8074, count(1) AS cnt#8076L], Statistics(sizeInBytes=238.6 PiB)
         :     :              +- Project [d_date#26, i_item_sk#437, substr(i_item_desc#441, 1, 30) AS _groupingexpression#8249], Statistics(sizeInBytes=429.4 PiB)
         :     :                 +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=477.2 PiB)
         :     :                    :- Project [ss_item_sk#416, d_date#26], Statistics(sizeInBytes=1427.6 GiB)
         :     :                    :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2.1 TiB)
         :     :                    :     :- Project [ss_sold_date_sk#414, ss_item_sk#416], Statistics(sizeInBytes=15.3 MiB)
         :     :                    :     :  +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_item_sk#416)), Statistics(sizeInBytes=141.1 MiB)
         :     :                    :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
         :     :                    :     +- Project [d_date_sk#24, d_date#26], Statistics(sizeInBytes=140.4 KiB)
         :     :                    :        +- Filter (d_year#30 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
         :     :                    :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
         :     :                    +- Project [i_item_sk#437, i_item_desc#441], Statistics(sizeInBytes=342.3 KiB)
         :     :                       +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
         :     :                          +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
         :     +- Project [c_customer_sk#8157], Statistics(sizeInBytes=4.4 TiB)
         :        +- Filter (isnotnull(ssales#8079) AND (cast(ssales#8079 as decimal(38,8)) > CheckOverflow((0.500000 * promote_precision(cast(scalar-subquery#8080 [] as decimal(32,6)))), DecimalType(38,8)))), Statistics(sizeInBytes=10.3 TiB)
         :           :  +- Aggregate [max(csales#8077) AS tpcds_cmax#8078], Statistics(sizeInBytes=24.0 B, rowCount=1)
         :           :     +- Aggregate [c_customer_sk#81], [sum(CheckOverflow((promote_precision(cast(ss_quantity#8093 as decimal(12,2))) * promote_precision(cast(ss_sales_price#8096 as decimal(12,2)))), DecimalType(18,2))) AS csales#8077], Statistics(sizeInBytes=829.8 PiB)
         :           :        +- Project [ss_quantity#8093, ss_sales_price#8096, c_customer_sk#81], Statistics(sizeInBytes=829.8 PiB)
         :           :           +- Join Inner, (ss_sold_date_sk#8083 = d_date_sk#8106), Statistics(sizeInBytes=1106.4 PiB)
         :           :              :- Project [ss_sold_date_sk#8083, ss_quantity#8093, ss_sales_price#8096, c_customer_sk#81], Statistics(sizeInBytes=10.5 TiB)
         :           :              :  +- Join Inner, (ss_customer_sk#8086 = c_customer_sk#81), Statistics(sizeInBytes=12.0 TiB)
         :           :              :     :- Project [ss_sold_date_sk#8083, ss_customer_sk#8086, ss_quantity#8093, ss_sales_price#8096], Statistics(sizeInBytes=26.7 MiB)
         :           :              :     :  +- Filter (isnotnull(ss_customer_sk#8086) AND isnotnull(ss_sold_date_sk#8083)), Statistics(sizeInBytes=141.1 MiB)
         :           :              :     :     +- Relation default.store_sales[ss_sold_date_sk#8083,ss_sold_time_sk#8084,ss_item_sk#8085,ss_customer_sk#8086,ss_cdemo_sk#8087,ss_hdemo_sk#8088,ss_addr_sk#8089,ss_store_sk#8090,ss_promo_sk#8091,ss_ticket_number#8092,ss_quantity#8093,ss_wholesale_cost#8094,ss_list_price#8095,ss_sales_price#8096,ss_ext_discount_amt#8097,ss_ext_sales_price#8098,ss_ext_wholesale_cost#8099,ss_ext_list_price#8100,ss_ext_tax#8101,ss_coupon_amt#8102,ss_net_paid#8103,ss_net_paid_inc_tax#8104,ss_net_profit#8105] parquet, Statistics(sizeInBytes=141.1 MiB)
         :           :              :     +- Project [c_customer_sk#81], Statistics(sizeInBytes=460.7 KiB)
         :           :              :        +- Filter isnotnull(c_customer_sk#81), Statistics(sizeInBytes=7.8 MiB)
         :           :              :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
         :           :              +- Project [d_date_sk#8106], Statistics(sizeInBytes=105.3 KiB)
         :           :                 +- Filter (d_year#8112 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#8106)), Statistics(sizeInBytes=2.5 MiB)
         :           :                    +- Relation default.date_dim[d_date_sk#8106,d_date_id#8107,d_date#8108,d_month_seq#8109,d_week_seq#8110,d_quarter_seq#8111,d_year#8112,d_dow#8113,d_moy#8114,d_dom#8115,d_qoy#8116,d_fy_year#8117,d_fy_quarter_seq#8118,d_fy_week_seq#8119,d_day_name#8120,d_quarter_name#8121,d_holiday#8122,d_weekend#8123,d_following_holiday#8124,d_first_dom#8125,d_last_dom#8126,d_same_day_ly#8127,d_same_day_lq#8128,d_current_day#8129,d_current_week#8130,d_current_month#8131,d_current_quarter#8132,d_current_year#8133] parquet, Statistics(sizeInBytes=2.5 MiB)
         :           +- Aggregate [c_customer_sk#8157], [c_customer_sk#8157, sum(CheckOverflow((promote_precision(cast(ss_quantity#8144 as decimal(12,2))) * promote_precision(cast(ss_sales_price#8147 as decimal(12,2)))), DecimalType(18,2))) AS ssales#8079], Statistics(sizeInBytes=10.3 TiB)
         :              +- Project [ss_quantity#8144, ss_sales_price#8147, c_customer_sk#8157], Statistics(sizeInBytes=8.8 TiB)
         :                 +- Join Inner, (ss_customer_sk#8137 = c_customer_sk#8157), Statistics(sizeInBytes=10.3 TiB)
         :                    :- Project [ss_customer_sk#8137, ss_quantity#8144, ss_sales_price#8147], Statistics(sizeInBytes=22.9 MiB)
         :                    :  +- Filter isnotnull(ss_customer_sk#8137), Statistics(sizeInBytes=141.1 MiB)
         :                    :     +- Relation default.store_sales[ss_sold_date_sk#8134,ss_sold_time_sk#8135,ss_item_sk#8136,ss_customer_sk#8137,ss_cdemo_sk#8138,ss_hdemo_sk#8139,ss_addr_sk#8140,ss_store_sk#8141,ss_promo_sk#8142,ss_ticket_number#8143,ss_quantity#8144,ss_wholesale_cost#8145,ss_list_price#8146,ss_sales_price#8147,ss_ext_discount_amt#8148,ss_ext_sales_price#8149,ss_ext_wholesale_cost#8150,ss_ext_list_price#8151,ss_ext_tax#8152,ss_coupon_amt#8153,ss_net_paid#8154,ss_net_paid_inc_tax#8155,ss_net_profit#8156] parquet, Statistics(sizeInBytes=141.1 MiB)
         :                    +- Project [c_customer_sk#8157], Statistics(sizeInBytes=460.7 KiB)
         :                       +- Filter isnotnull(c_customer_sk#8157), Statistics(sizeInBytes=7.8 MiB)
         :                          +- Relation default.customer[c_customer_sk#8157,c_customer_id#8158,c_current_cdemo_sk#8159,c_current_hdemo_sk#8160,c_current_addr_sk#8161,c_first_shipto_date_sk#8162,c_first_sales_date_sk#8163,c_salutation#8164,c_first_name#8165,c_last_name#8166,c_preferred_cust_flag#8167,c_birth_day#8168,c_birth_month#8169,c_birth_year#8170,c_birth_country#8171,c_login#8172,c_email_address#8173,c_last_review_date#8174] parquet, Statistics(sizeInBytes=7.8 MiB)
         +- Project [d_date_sk#8203], Statistics(sizeInBytes=105.3 KiB)
            +- Filter (((isnotnull(d_year#8209) AND isnotnull(d_moy#8211)) AND ((d_year#8209 = 2000) AND (d_moy#8211 = 2))) AND isnotnull(d_date_sk#8203)), Statistics(sizeInBytes=2.5 MiB)
               +- Relation default.date_dim[d_date_sk#8203,d_date_id#8204,d_date#8205,d_month_seq#8206,d_week_seq#8207,d_quarter_seq#8208,d_year#8209,d_dow#8210,d_moy#8211,d_dom#8212,d_qoy#8213,d_fy_year#8214,d_fy_quarter_seq#8215,d_fy_week_seq#8216,d_day_name#8217,d_quarter_name#8218,d_holiday#8219,d_weekend#8220,d_following_holiday#8221,d_first_dom#8222,d_last_dom#8223,d_same_day_ly#8224,d_same_day_lq#8225,d_current_day#8226,d_current_week#8227,d_current_month#8228,d_current_quarter#8229,d_current_year#8230] parquet, Statistics(sizeInBytes=2.5 MiB)

==== q23b ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=6.3 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=3.6 EiB)
   +- Sort [c_last_name#8452 ASC NULLS FIRST, c_first_name#8451 ASC NULLS FIRST, sales#8335 ASC NULLS FIRST], true, Statistics(sizeInBytes=3.6 EiB)
      +- Union false, false, Statistics(sizeInBytes=3.6 EiB)
         :- Aggregate [c_last_name#8452, c_first_name#8451], [c_last_name#8452, c_first_name#8451, sum(CheckOverflow((promote_precision(cast(cs_quantity#215 as decimal(12,2))) * promote_precision(cast(cs_list_price#217 as decimal(12,2)))), DecimalType(18,2))) AS sales#8335], Statistics(sizeInBytes=2.4 EiB)
         :  +- Project [cs_quantity#215, cs_list_price#217, c_first_name#8451, c_last_name#8452], Statistics(sizeInBytes=2.3 EiB)
         :     +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#8461), Statistics(sizeInBytes=2.6 EiB)
         :        :- Project [cs_sold_date_sk#197, cs_quantity#215, cs_list_price#217, c_first_name#8451, c_last_name#8452], Statistics(sizeInBytes=25.2 TiB)
         :        :  +- Join Inner, (cs_bill_customer_sk#200 = c_customer_sk#8443), Statistics(sizeInBytes=28.3 TiB)
         :        :     :- Join LeftSemi, (cs_bill_customer_sk#200 = c_customer_sk#8425), Statistics(sizeInBytes=14.5 MiB)
         :        :     :  :- Project [cs_sold_date_sk#197, cs_bill_customer_sk#200, cs_quantity#215, cs_list_price#217], Statistics(sizeInBytes=14.5 MiB)
         :        :     :  :  +- Join LeftSemi, (cs_item_sk#212 = item_sk#8342), Statistics(sizeInBytes=16.6 MiB)
         :        :     :  :     :- Project [cs_sold_date_sk#197, cs_bill_customer_sk#200, cs_item_sk#212, cs_quantity#215, cs_list_price#217], Statistics(sizeInBytes=16.6 MiB)
         :        :     :  :     :  +- Filter (isnotnull(cs_bill_customer_sk#200) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
         :        :     :  :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
         :        :     :  :     +- Project [item_sk#8342], Statistics(sizeInBytes=143.1 PiB)
         :        :     :  :        +- Filter (cnt#8344L > 4), Statistics(sizeInBytes=238.6 PiB)
         :        :     :  :           +- Aggregate [_groupingexpression#8557, i_item_sk#437, d_date#26], [i_item_sk#437 AS item_sk#8342, count(1) AS cnt#8344L], Statistics(sizeInBytes=238.6 PiB)
         :        :     :  :              +- Project [d_date#26, i_item_sk#437, substr(i_item_desc#441, 1, 30) AS _groupingexpression#8557], Statistics(sizeInBytes=429.4 PiB)
         :        :     :  :                 +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=477.2 PiB)
         :        :     :  :                    :- Project [ss_item_sk#416, d_date#26], Statistics(sizeInBytes=1427.6 GiB)
         :        :     :  :                    :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2.1 TiB)
         :        :     :  :                    :     :- Project [ss_sold_date_sk#414, ss_item_sk#416], Statistics(sizeInBytes=15.3 MiB)
         :        :     :  :                    :     :  +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_item_sk#416)), Statistics(sizeInBytes=141.1 MiB)
         :        :     :  :                    :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
         :        :     :  :                    :     +- Project [d_date_sk#24, d_date#26], Statistics(sizeInBytes=140.4 KiB)
         :        :     :  :                    :        +- Filter (d_year#30 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
         :        :     :  :                    :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
         :        :     :  :                    +- Project [i_item_sk#437, i_item_desc#441], Statistics(sizeInBytes=342.3 KiB)
         :        :     :  :                       +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
         :        :     :  :                          +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
         :        :     :  +- Project [c_customer_sk#8425], Statistics(sizeInBytes=4.4 TiB)
         :        :     :     +- Filter (isnotnull(ssales#8347) AND (cast(ssales#8347 as decimal(38,8)) > CheckOverflow((0.500000 * promote_precision(cast(scalar-subquery#8348 [] as decimal(32,6)))), DecimalType(38,8)))), Statistics(sizeInBytes=10.3 TiB)
         :        :     :        :  +- Aggregate [max(csales#8345) AS tpcds_cmax#8346], Statistics(sizeInBytes=24.0 B, rowCount=1)
         :        :     :        :     +- Aggregate [c_customer_sk#81], [sum(CheckOverflow((promote_precision(cast(ss_quantity#8361 as decimal(12,2))) * promote_precision(cast(ss_sales_price#8364 as decimal(12,2)))), DecimalType(18,2))) AS csales#8345], Statistics(sizeInBytes=829.8 PiB)
         :        :     :        :        +- Project [ss_quantity#8361, ss_sales_price#8364, c_customer_sk#81], Statistics(sizeInBytes=829.8 PiB)
         :        :     :        :           +- Join Inner, (ss_sold_date_sk#8351 = d_date_sk#8374), Statistics(sizeInBytes=1106.4 PiB)
         :        :     :        :              :- Project [ss_sold_date_sk#8351, ss_quantity#8361, ss_sales_price#8364, c_customer_sk#81], Statistics(sizeInBytes=10.5 TiB)
         :        :     :        :              :  +- Join Inner, (ss_customer_sk#8354 = c_customer_sk#81), Statistics(sizeInBytes=12.0 TiB)
         :        :     :        :              :     :- Project [ss_sold_date_sk#8351, ss_customer_sk#8354, ss_quantity#8361, ss_sales_price#8364], Statistics(sizeInBytes=26.7 MiB)
         :        :     :        :              :     :  +- Filter (isnotnull(ss_customer_sk#8354) AND isnotnull(ss_sold_date_sk#8351)), Statistics(sizeInBytes=141.1 MiB)
         :        :     :        :              :     :     +- Relation default.store_sales[ss_sold_date_sk#8351,ss_sold_time_sk#8352,ss_item_sk#8353,ss_customer_sk#8354,ss_cdemo_sk#8355,ss_hdemo_sk#8356,ss_addr_sk#8357,ss_store_sk#8358,ss_promo_sk#8359,ss_ticket_number#8360,ss_quantity#8361,ss_wholesale_cost#8362,ss_list_price#8363,ss_sales_price#8364,ss_ext_discount_amt#8365,ss_ext_sales_price#8366,ss_ext_wholesale_cost#8367,ss_ext_list_price#8368,ss_ext_tax#8369,ss_coupon_amt#8370,ss_net_paid#8371,ss_net_paid_inc_tax#8372,ss_net_profit#8373] parquet, Statistics(sizeInBytes=141.1 MiB)
         :        :     :        :              :     +- Project [c_customer_sk#81], Statistics(sizeInBytes=460.7 KiB)
         :        :     :        :              :        +- Filter isnotnull(c_customer_sk#81), Statistics(sizeInBytes=7.8 MiB)
         :        :     :        :              :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
         :        :     :        :              +- Project [d_date_sk#8374], Statistics(sizeInBytes=105.3 KiB)
         :        :     :        :                 +- Filter (d_year#8380 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#8374)), Statistics(sizeInBytes=2.5 MiB)
         :        :     :        :                    +- Relation default.date_dim[d_date_sk#8374,d_date_id#8375,d_date#8376,d_month_seq#8377,d_week_seq#8378,d_quarter_seq#8379,d_year#8380,d_dow#8381,d_moy#8382,d_dom#8383,d_qoy#8384,d_fy_year#8385,d_fy_quarter_seq#8386,d_fy_week_seq#8387,d_day_name#8388,d_quarter_name#8389,d_holiday#8390,d_weekend#8391,d_following_holiday#8392,d_first_dom#8393,d_last_dom#8394,d_same_day_ly#8395,d_same_day_lq#8396,d_current_day#8397,d_current_week#8398,d_current_month#8399,d_current_quarter#8400,d_current_year#8401] parquet, Statistics(sizeInBytes=2.5 MiB)
         :        :     :        +- Aggregate [c_customer_sk#8425], [c_customer_sk#8425, sum(CheckOverflow((promote_precision(cast(ss_quantity#8412 as decimal(12,2))) * promote_precision(cast(ss_sales_price#8415 as decimal(12,2)))), DecimalType(18,2))) AS ssales#8347], Statistics(sizeInBytes=10.3 TiB)
         :        :     :           +- Project [ss_quantity#8412, ss_sales_price#8415, c_customer_sk#8425], Statistics(sizeInBytes=8.8 TiB)
         :        :     :              +- Join Inner, (ss_customer_sk#8405 = c_customer_sk#8425), Statistics(sizeInBytes=10.3 TiB)
         :        :     :                 :- Project [ss_customer_sk#8405, ss_quantity#8412, ss_sales_price#8415], Statistics(sizeInBytes=22.9 MiB)
         :        :     :                 :  +- Filter isnotnull(ss_customer_sk#8405), Statistics(sizeInBytes=141.1 MiB)
         :        :     :                 :     +- Relation default.store_sales[ss_sold_date_sk#8402,ss_sold_time_sk#8403,ss_item_sk#8404,ss_customer_sk#8405,ss_cdemo_sk#8406,ss_hdemo_sk#8407,ss_addr_sk#8408,ss_store_sk#8409,ss_promo_sk#8410,ss_ticket_number#8411,ss_quantity#8412,ss_wholesale_cost#8413,ss_list_price#8414,ss_sales_price#8415,ss_ext_discount_amt#8416,ss_ext_sales_price#8417,ss_ext_wholesale_cost#8418,ss_ext_list_price#8419,ss_ext_tax#8420,ss_coupon_amt#8421,ss_net_paid#8422,ss_net_paid_inc_tax#8423,ss_net_profit#8424] parquet, Statistics(sizeInBytes=141.1 MiB)
         :        :     :                 +- Project [c_customer_sk#8425], Statistics(sizeInBytes=460.7 KiB)
         :        :     :                    +- Filter isnotnull(c_customer_sk#8425), Statistics(sizeInBytes=7.8 MiB)
         :        :     :                       +- Relation default.customer[c_customer_sk#8425,c_customer_id#8426,c_current_cdemo_sk#8427,c_current_hdemo_sk#8428,c_current_addr_sk#8429,c_first_shipto_date_sk#8430,c_first_sales_date_sk#8431,c_salutation#8432,c_first_name#8433,c_last_name#8434,c_preferred_cust_flag#8435,c_birth_day#8436,c_birth_month#8437,c_birth_year#8438,c_birth_country#8439,c_login#8440,c_email_address#8441,c_last_review_date#8442] parquet, Statistics(sizeInBytes=7.8 MiB)
         :        :     +- Join LeftSemi, (c_customer_sk#8443 = c_customer_sk#8425), Statistics(sizeInBytes=1996.3 KiB)
         :        :        :- Project [c_customer_sk#8443, c_first_name#8451, c_last_name#8452], Statistics(sizeInBytes=1996.3 KiB)
         :        :        :  +- Filter isnotnull(c_customer_sk#8443), Statistics(sizeInBytes=7.8 MiB)
         :        :        :     +- Relation default.customer[c_customer_sk#8443,c_customer_id#8444,c_current_cdemo_sk#8445,c_current_hdemo_sk#8446,c_current_addr_sk#8447,c_first_shipto_date_sk#8448,c_first_sales_date_sk#8449,c_salutation#8450,c_first_name#8451,c_last_name#8452,c_preferred_cust_flag#8453,c_birth_day#8454,c_birth_month#8455,c_birth_year#8456,c_birth_country#8457,c_login#8458,c_email_address#8459,c_last_review_date#8460] parquet, Statistics(sizeInBytes=7.8 MiB)
         :        :        +- Project [c_customer_sk#8425], Statistics(sizeInBytes=4.4 TiB)
         :        :           +- Filter (isnotnull(ssales#8347) AND (cast(ssales#8347 as decimal(38,8)) > CheckOverflow((0.500000 * promote_precision(cast(scalar-subquery#8348 [] as decimal(32,6)))), DecimalType(38,8)))), Statistics(sizeInBytes=10.3 TiB)
         :        :              :  +- Aggregate [max(csales#8345) AS tpcds_cmax#8346], Statistics(sizeInBytes=24.0 B, rowCount=1)
         :        :              :     +- Aggregate [c_customer_sk#81], [sum(CheckOverflow((promote_precision(cast(ss_quantity#8361 as decimal(12,2))) * promote_precision(cast(ss_sales_price#8364 as decimal(12,2)))), DecimalType(18,2))) AS csales#8345], Statistics(sizeInBytes=829.8 PiB)
         :        :              :        +- Project [ss_quantity#8361, ss_sales_price#8364, c_customer_sk#81], Statistics(sizeInBytes=829.8 PiB)
         :        :              :           +- Join Inner, (ss_sold_date_sk#8351 = d_date_sk#8374), Statistics(sizeInBytes=1106.4 PiB)
         :        :              :              :- Project [ss_sold_date_sk#8351, ss_quantity#8361, ss_sales_price#8364, c_customer_sk#81], Statistics(sizeInBytes=10.5 TiB)
         :        :              :              :  +- Join Inner, (ss_customer_sk#8354 = c_customer_sk#81), Statistics(sizeInBytes=12.0 TiB)
         :        :              :              :     :- Project [ss_sold_date_sk#8351, ss_customer_sk#8354, ss_quantity#8361, ss_sales_price#8364], Statistics(sizeInBytes=26.7 MiB)
         :        :              :              :     :  +- Filter (isnotnull(ss_customer_sk#8354) AND isnotnull(ss_sold_date_sk#8351)), Statistics(sizeInBytes=141.1 MiB)
         :        :              :              :     :     +- Relation default.store_sales[ss_sold_date_sk#8351,ss_sold_time_sk#8352,ss_item_sk#8353,ss_customer_sk#8354,ss_cdemo_sk#8355,ss_hdemo_sk#8356,ss_addr_sk#8357,ss_store_sk#8358,ss_promo_sk#8359,ss_ticket_number#8360,ss_quantity#8361,ss_wholesale_cost#8362,ss_list_price#8363,ss_sales_price#8364,ss_ext_discount_amt#8365,ss_ext_sales_price#8366,ss_ext_wholesale_cost#8367,ss_ext_list_price#8368,ss_ext_tax#8369,ss_coupon_amt#8370,ss_net_paid#8371,ss_net_paid_inc_tax#8372,ss_net_profit#8373] parquet, Statistics(sizeInBytes=141.1 MiB)
         :        :              :              :     +- Project [c_customer_sk#81], Statistics(sizeInBytes=460.7 KiB)
         :        :              :              :        +- Filter isnotnull(c_customer_sk#81), Statistics(sizeInBytes=7.8 MiB)
         :        :              :              :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
         :        :              :              +- Project [d_date_sk#8374], Statistics(sizeInBytes=105.3 KiB)
         :        :              :                 +- Filter (d_year#8380 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#8374)), Statistics(sizeInBytes=2.5 MiB)
         :        :              :                    +- Relation default.date_dim[d_date_sk#8374,d_date_id#8375,d_date#8376,d_month_seq#8377,d_week_seq#8378,d_quarter_seq#8379,d_year#8380,d_dow#8381,d_moy#8382,d_dom#8383,d_qoy#8384,d_fy_year#8385,d_fy_quarter_seq#8386,d_fy_week_seq#8387,d_day_name#8388,d_quarter_name#8389,d_holiday#8390,d_weekend#8391,d_following_holiday#8392,d_first_dom#8393,d_last_dom#8394,d_same_day_ly#8395,d_same_day_lq#8396,d_current_day#8397,d_current_week#8398,d_current_month#8399,d_current_quarter#8400,d_current_year#8401] parquet, Statistics(sizeInBytes=2.5 MiB)
         :        :              +- Aggregate [c_customer_sk#8425], [c_customer_sk#8425, sum(CheckOverflow((promote_precision(cast(ss_quantity#8412 as decimal(12,2))) * promote_precision(cast(ss_sales_price#8415 as decimal(12,2)))), DecimalType(18,2))) AS ssales#8347], Statistics(sizeInBytes=10.3 TiB)
         :        :                 +- Project [ss_quantity#8412, ss_sales_price#8415, c_customer_sk#8425], Statistics(sizeInBytes=8.8 TiB)
         :        :                    +- Join Inner, (ss_customer_sk#8405 = c_customer_sk#8425), Statistics(sizeInBytes=10.3 TiB)
         :        :                       :- Project [ss_customer_sk#8405, ss_quantity#8412, ss_sales_price#8415], Statistics(sizeInBytes=22.9 MiB)
         :        :                       :  +- Filter isnotnull(ss_customer_sk#8405), Statistics(sizeInBytes=141.1 MiB)
         :        :                       :     +- Relation default.store_sales[ss_sold_date_sk#8402,ss_sold_time_sk#8403,ss_item_sk#8404,ss_customer_sk#8405,ss_cdemo_sk#8406,ss_hdemo_sk#8407,ss_addr_sk#8408,ss_store_sk#8409,ss_promo_sk#8410,ss_ticket_number#8411,ss_quantity#8412,ss_wholesale_cost#8413,ss_list_price#8414,ss_sales_price#8415,ss_ext_discount_amt#8416,ss_ext_sales_price#8417,ss_ext_wholesale_cost#8418,ss_ext_list_price#8419,ss_ext_tax#8420,ss_coupon_amt#8421,ss_net_paid#8422,ss_net_paid_inc_tax#8423,ss_net_profit#8424] parquet, Statistics(sizeInBytes=141.1 MiB)
         :        :                       +- Project [c_customer_sk#8425], Statistics(sizeInBytes=460.7 KiB)
         :        :                          +- Filter isnotnull(c_customer_sk#8425), Statistics(sizeInBytes=7.8 MiB)
         :        :                             +- Relation default.customer[c_customer_sk#8425,c_customer_id#8426,c_current_cdemo_sk#8427,c_current_hdemo_sk#8428,c_current_addr_sk#8429,c_first_shipto_date_sk#8430,c_first_sales_date_sk#8431,c_salutation#8432,c_first_name#8433,c_last_name#8434,c_preferred_cust_flag#8435,c_birth_day#8436,c_birth_month#8437,c_birth_year#8438,c_birth_country#8439,c_login#8440,c_email_address#8441,c_last_review_date#8442] parquet, Statistics(sizeInBytes=7.8 MiB)
         :        +- Project [d_date_sk#8461], Statistics(sizeInBytes=105.3 KiB)
         :           +- Filter (((isnotnull(d_year#8467) AND isnotnull(d_moy#8469)) AND ((d_year#8467 = 2000) AND (d_moy#8469 = 2))) AND isnotnull(d_date_sk#8461)), Statistics(sizeInBytes=2.5 MiB)
         :              +- Relation default.date_dim[d_date_sk#8461,d_date_id#8462,d_date#8463,d_month_seq#8464,d_week_seq#8465,d_quarter_seq#8466,d_year#8467,d_dow#8468,d_moy#8469,d_dom#8470,d_qoy#8471,d_fy_year#8472,d_fy_quarter_seq#8473,d_fy_week_seq#8474,d_day_name#8475,d_quarter_name#8476,d_holiday#8477,d_weekend#8478,d_following_holiday#8479,d_first_dom#8480,d_last_dom#8481,d_same_day_ly#8482,d_same_day_lq#8483,d_current_day#8484,d_current_week#8485,d_current_month#8486,d_current_quarter#8487,d_current_year#8488] parquet, Statistics(sizeInBytes=2.5 MiB)
         +- Aggregate [c_last_name#8498, c_first_name#8497], [c_last_name#8498, c_first_name#8497, sum(CheckOverflow((promote_precision(cast(ws_quantity#181 as decimal(12,2))) * promote_precision(cast(ws_list_price#183 as decimal(12,2)))), DecimalType(18,2))) AS sales#8338], Statistics(sizeInBytes=1225.4 PiB)
            +- Project [ws_quantity#181, ws_list_price#183, c_first_name#8497, c_last_name#8498], Statistics(sizeInBytes=1148.8 PiB)
               +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#8507), Statistics(sizeInBytes=1302.0 PiB)
                  :- Project [ws_sold_date_sk#163, ws_quantity#181, ws_list_price#183, c_first_name#8497, c_last_name#8498], Statistics(sizeInBytes=12.4 TiB)
                  :  +- Join Inner, (ws_bill_customer_sk#167 = c_customer_sk#8489), Statistics(sizeInBytes=13.9 TiB)
                  :     :- Join LeftSemi, (ws_bill_customer_sk#167 = c_customer_sk#8425), Statistics(sizeInBytes=7.1 MiB)
                  :     :  :- Project [ws_sold_date_sk#163, ws_bill_customer_sk#167, ws_quantity#181, ws_list_price#183], Statistics(sizeInBytes=7.1 MiB)
                  :     :  :  +- Join LeftSemi, (ws_item_sk#166 = item_sk#8342), Statistics(sizeInBytes=8.2 MiB)
                  :     :  :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_bill_customer_sk#167, ws_quantity#181, ws_list_price#183], Statistics(sizeInBytes=8.2 MiB)
                  :     :  :     :  +- Filter (isnotnull(ws_bill_customer_sk#167) AND isnotnull(ws_sold_date_sk#163)), Statistics(sizeInBytes=52.0 MiB)
                  :     :  :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                  :     :  :     +- Project [item_sk#8342], Statistics(sizeInBytes=143.1 PiB)
                  :     :  :        +- Filter (cnt#8344L > 4), Statistics(sizeInBytes=238.6 PiB)
                  :     :  :           +- Aggregate [_groupingexpression#8557, i_item_sk#437, d_date#26], [i_item_sk#437 AS item_sk#8342, count(1) AS cnt#8344L], Statistics(sizeInBytes=238.6 PiB)
                  :     :  :              +- Project [d_date#26, i_item_sk#437, substr(i_item_desc#441, 1, 30) AS _groupingexpression#8557], Statistics(sizeInBytes=429.4 PiB)
                  :     :  :                 +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=477.2 PiB)
                  :     :  :                    :- Project [ss_item_sk#416, d_date#26], Statistics(sizeInBytes=1427.6 GiB)
                  :     :  :                    :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2.1 TiB)
                  :     :  :                    :     :- Project [ss_sold_date_sk#414, ss_item_sk#416], Statistics(sizeInBytes=15.3 MiB)
                  :     :  :                    :     :  +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_item_sk#416)), Statistics(sizeInBytes=141.1 MiB)
                  :     :  :                    :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                  :     :  :                    :     +- Project [d_date_sk#24, d_date#26], Statistics(sizeInBytes=140.4 KiB)
                  :     :  :                    :        +- Filter (d_year#30 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                  :     :  :                    :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                  :     :  :                    +- Project [i_item_sk#437, i_item_desc#441], Statistics(sizeInBytes=342.3 KiB)
                  :     :  :                       +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
                  :     :  :                          +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
                  :     :  +- Project [c_customer_sk#8425], Statistics(sizeInBytes=4.4 TiB)
                  :     :     +- Filter (isnotnull(ssales#8347) AND (cast(ssales#8347 as decimal(38,8)) > CheckOverflow((0.500000 * promote_precision(cast(scalar-subquery#8348 [] as decimal(32,6)))), DecimalType(38,8)))), Statistics(sizeInBytes=10.3 TiB)
                  :     :        :  +- Aggregate [max(csales#8345) AS tpcds_cmax#8346], Statistics(sizeInBytes=24.0 B, rowCount=1)
                  :     :        :     +- Aggregate [c_customer_sk#81], [sum(CheckOverflow((promote_precision(cast(ss_quantity#8361 as decimal(12,2))) * promote_precision(cast(ss_sales_price#8364 as decimal(12,2)))), DecimalType(18,2))) AS csales#8345], Statistics(sizeInBytes=829.8 PiB)
                  :     :        :        +- Project [ss_quantity#8361, ss_sales_price#8364, c_customer_sk#81], Statistics(sizeInBytes=829.8 PiB)
                  :     :        :           +- Join Inner, (ss_sold_date_sk#8351 = d_date_sk#8374), Statistics(sizeInBytes=1106.4 PiB)
                  :     :        :              :- Project [ss_sold_date_sk#8351, ss_quantity#8361, ss_sales_price#8364, c_customer_sk#81], Statistics(sizeInBytes=10.5 TiB)
                  :     :        :              :  +- Join Inner, (ss_customer_sk#8354 = c_customer_sk#81), Statistics(sizeInBytes=12.0 TiB)
                  :     :        :              :     :- Project [ss_sold_date_sk#8351, ss_customer_sk#8354, ss_quantity#8361, ss_sales_price#8364], Statistics(sizeInBytes=26.7 MiB)
                  :     :        :              :     :  +- Filter (isnotnull(ss_customer_sk#8354) AND isnotnull(ss_sold_date_sk#8351)), Statistics(sizeInBytes=141.1 MiB)
                  :     :        :              :     :     +- Relation default.store_sales[ss_sold_date_sk#8351,ss_sold_time_sk#8352,ss_item_sk#8353,ss_customer_sk#8354,ss_cdemo_sk#8355,ss_hdemo_sk#8356,ss_addr_sk#8357,ss_store_sk#8358,ss_promo_sk#8359,ss_ticket_number#8360,ss_quantity#8361,ss_wholesale_cost#8362,ss_list_price#8363,ss_sales_price#8364,ss_ext_discount_amt#8365,ss_ext_sales_price#8366,ss_ext_wholesale_cost#8367,ss_ext_list_price#8368,ss_ext_tax#8369,ss_coupon_amt#8370,ss_net_paid#8371,ss_net_paid_inc_tax#8372,ss_net_profit#8373] parquet, Statistics(sizeInBytes=141.1 MiB)
                  :     :        :              :     +- Project [c_customer_sk#81], Statistics(sizeInBytes=460.7 KiB)
                  :     :        :              :        +- Filter isnotnull(c_customer_sk#81), Statistics(sizeInBytes=7.8 MiB)
                  :     :        :              :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
                  :     :        :              +- Project [d_date_sk#8374], Statistics(sizeInBytes=105.3 KiB)
                  :     :        :                 +- Filter (d_year#8380 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#8374)), Statistics(sizeInBytes=2.5 MiB)
                  :     :        :                    +- Relation default.date_dim[d_date_sk#8374,d_date_id#8375,d_date#8376,d_month_seq#8377,d_week_seq#8378,d_quarter_seq#8379,d_year#8380,d_dow#8381,d_moy#8382,d_dom#8383,d_qoy#8384,d_fy_year#8385,d_fy_quarter_seq#8386,d_fy_week_seq#8387,d_day_name#8388,d_quarter_name#8389,d_holiday#8390,d_weekend#8391,d_following_holiday#8392,d_first_dom#8393,d_last_dom#8394,d_same_day_ly#8395,d_same_day_lq#8396,d_current_day#8397,d_current_week#8398,d_current_month#8399,d_current_quarter#8400,d_current_year#8401] parquet, Statistics(sizeInBytes=2.5 MiB)
                  :     :        +- Aggregate [c_customer_sk#8425], [c_customer_sk#8425, sum(CheckOverflow((promote_precision(cast(ss_quantity#8412 as decimal(12,2))) * promote_precision(cast(ss_sales_price#8415 as decimal(12,2)))), DecimalType(18,2))) AS ssales#8347], Statistics(sizeInBytes=10.3 TiB)
                  :     :           +- Project [ss_quantity#8412, ss_sales_price#8415, c_customer_sk#8425], Statistics(sizeInBytes=8.8 TiB)
                  :     :              +- Join Inner, (ss_customer_sk#8405 = c_customer_sk#8425), Statistics(sizeInBytes=10.3 TiB)
                  :     :                 :- Project [ss_customer_sk#8405, ss_quantity#8412, ss_sales_price#8415], Statistics(sizeInBytes=22.9 MiB)
                  :     :                 :  +- Filter isnotnull(ss_customer_sk#8405), Statistics(sizeInBytes=141.1 MiB)
                  :     :                 :     +- Relation default.store_sales[ss_sold_date_sk#8402,ss_sold_time_sk#8403,ss_item_sk#8404,ss_customer_sk#8405,ss_cdemo_sk#8406,ss_hdemo_sk#8407,ss_addr_sk#8408,ss_store_sk#8409,ss_promo_sk#8410,ss_ticket_number#8411,ss_quantity#8412,ss_wholesale_cost#8413,ss_list_price#8414,ss_sales_price#8415,ss_ext_discount_amt#8416,ss_ext_sales_price#8417,ss_ext_wholesale_cost#8418,ss_ext_list_price#8419,ss_ext_tax#8420,ss_coupon_amt#8421,ss_net_paid#8422,ss_net_paid_inc_tax#8423,ss_net_profit#8424] parquet, Statistics(sizeInBytes=141.1 MiB)
                  :     :                 +- Project [c_customer_sk#8425], Statistics(sizeInBytes=460.7 KiB)
                  :     :                    +- Filter isnotnull(c_customer_sk#8425), Statistics(sizeInBytes=7.8 MiB)
                  :     :                       +- Relation default.customer[c_customer_sk#8425,c_customer_id#8426,c_current_cdemo_sk#8427,c_current_hdemo_sk#8428,c_current_addr_sk#8429,c_first_shipto_date_sk#8430,c_first_sales_date_sk#8431,c_salutation#8432,c_first_name#8433,c_last_name#8434,c_preferred_cust_flag#8435,c_birth_day#8436,c_birth_month#8437,c_birth_year#8438,c_birth_country#8439,c_login#8440,c_email_address#8441,c_last_review_date#8442] parquet, Statistics(sizeInBytes=7.8 MiB)
                  :     +- Join LeftSemi, (c_customer_sk#8489 = c_customer_sk#8425), Statistics(sizeInBytes=1996.3 KiB)
                  :        :- Project [c_customer_sk#8489, c_first_name#8497, c_last_name#8498], Statistics(sizeInBytes=1996.3 KiB)
                  :        :  +- Filter isnotnull(c_customer_sk#8489), Statistics(sizeInBytes=7.8 MiB)
                  :        :     +- Relation default.customer[c_customer_sk#8489,c_customer_id#8490,c_current_cdemo_sk#8491,c_current_hdemo_sk#8492,c_current_addr_sk#8493,c_first_shipto_date_sk#8494,c_first_sales_date_sk#8495,c_salutation#8496,c_first_name#8497,c_last_name#8498,c_preferred_cust_flag#8499,c_birth_day#8500,c_birth_month#8501,c_birth_year#8502,c_birth_country#8503,c_login#8504,c_email_address#8505,c_last_review_date#8506] parquet, Statistics(sizeInBytes=7.8 MiB)
                  :        +- Project [c_customer_sk#8425], Statistics(sizeInBytes=4.4 TiB)
                  :           +- Filter (isnotnull(ssales#8347) AND (cast(ssales#8347 as decimal(38,8)) > CheckOverflow((0.500000 * promote_precision(cast(scalar-subquery#8348 [] as decimal(32,6)))), DecimalType(38,8)))), Statistics(sizeInBytes=10.3 TiB)
                  :              :  +- Aggregate [max(csales#8345) AS tpcds_cmax#8346], Statistics(sizeInBytes=24.0 B, rowCount=1)
                  :              :     +- Aggregate [c_customer_sk#81], [sum(CheckOverflow((promote_precision(cast(ss_quantity#8361 as decimal(12,2))) * promote_precision(cast(ss_sales_price#8364 as decimal(12,2)))), DecimalType(18,2))) AS csales#8345], Statistics(sizeInBytes=829.8 PiB)
                  :              :        +- Project [ss_quantity#8361, ss_sales_price#8364, c_customer_sk#81], Statistics(sizeInBytes=829.8 PiB)
                  :              :           +- Join Inner, (ss_sold_date_sk#8351 = d_date_sk#8374), Statistics(sizeInBytes=1106.4 PiB)
                  :              :              :- Project [ss_sold_date_sk#8351, ss_quantity#8361, ss_sales_price#8364, c_customer_sk#81], Statistics(sizeInBytes=10.5 TiB)
                  :              :              :  +- Join Inner, (ss_customer_sk#8354 = c_customer_sk#81), Statistics(sizeInBytes=12.0 TiB)
                  :              :              :     :- Project [ss_sold_date_sk#8351, ss_customer_sk#8354, ss_quantity#8361, ss_sales_price#8364], Statistics(sizeInBytes=26.7 MiB)
                  :              :              :     :  +- Filter (isnotnull(ss_customer_sk#8354) AND isnotnull(ss_sold_date_sk#8351)), Statistics(sizeInBytes=141.1 MiB)
                  :              :              :     :     +- Relation default.store_sales[ss_sold_date_sk#8351,ss_sold_time_sk#8352,ss_item_sk#8353,ss_customer_sk#8354,ss_cdemo_sk#8355,ss_hdemo_sk#8356,ss_addr_sk#8357,ss_store_sk#8358,ss_promo_sk#8359,ss_ticket_number#8360,ss_quantity#8361,ss_wholesale_cost#8362,ss_list_price#8363,ss_sales_price#8364,ss_ext_discount_amt#8365,ss_ext_sales_price#8366,ss_ext_wholesale_cost#8367,ss_ext_list_price#8368,ss_ext_tax#8369,ss_coupon_amt#8370,ss_net_paid#8371,ss_net_paid_inc_tax#8372,ss_net_profit#8373] parquet, Statistics(sizeInBytes=141.1 MiB)
                  :              :              :     +- Project [c_customer_sk#81], Statistics(sizeInBytes=460.7 KiB)
                  :              :              :        +- Filter isnotnull(c_customer_sk#81), Statistics(sizeInBytes=7.8 MiB)
                  :              :              :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
                  :              :              +- Project [d_date_sk#8374], Statistics(sizeInBytes=105.3 KiB)
                  :              :                 +- Filter (d_year#8380 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#8374)), Statistics(sizeInBytes=2.5 MiB)
                  :              :                    +- Relation default.date_dim[d_date_sk#8374,d_date_id#8375,d_date#8376,d_month_seq#8377,d_week_seq#8378,d_quarter_seq#8379,d_year#8380,d_dow#8381,d_moy#8382,d_dom#8383,d_qoy#8384,d_fy_year#8385,d_fy_quarter_seq#8386,d_fy_week_seq#8387,d_day_name#8388,d_quarter_name#8389,d_holiday#8390,d_weekend#8391,d_following_holiday#8392,d_first_dom#8393,d_last_dom#8394,d_same_day_ly#8395,d_same_day_lq#8396,d_current_day#8397,d_current_week#8398,d_current_month#8399,d_current_quarter#8400,d_current_year#8401] parquet, Statistics(sizeInBytes=2.5 MiB)
                  :              +- Aggregate [c_customer_sk#8425], [c_customer_sk#8425, sum(CheckOverflow((promote_precision(cast(ss_quantity#8412 as decimal(12,2))) * promote_precision(cast(ss_sales_price#8415 as decimal(12,2)))), DecimalType(18,2))) AS ssales#8347], Statistics(sizeInBytes=10.3 TiB)
                  :                 +- Project [ss_quantity#8412, ss_sales_price#8415, c_customer_sk#8425], Statistics(sizeInBytes=8.8 TiB)
                  :                    +- Join Inner, (ss_customer_sk#8405 = c_customer_sk#8425), Statistics(sizeInBytes=10.3 TiB)
                  :                       :- Project [ss_customer_sk#8405, ss_quantity#8412, ss_sales_price#8415], Statistics(sizeInBytes=22.9 MiB)
                  :                       :  +- Filter isnotnull(ss_customer_sk#8405), Statistics(sizeInBytes=141.1 MiB)
                  :                       :     +- Relation default.store_sales[ss_sold_date_sk#8402,ss_sold_time_sk#8403,ss_item_sk#8404,ss_customer_sk#8405,ss_cdemo_sk#8406,ss_hdemo_sk#8407,ss_addr_sk#8408,ss_store_sk#8409,ss_promo_sk#8410,ss_ticket_number#8411,ss_quantity#8412,ss_wholesale_cost#8413,ss_list_price#8414,ss_sales_price#8415,ss_ext_discount_amt#8416,ss_ext_sales_price#8417,ss_ext_wholesale_cost#8418,ss_ext_list_price#8419,ss_ext_tax#8420,ss_coupon_amt#8421,ss_net_paid#8422,ss_net_paid_inc_tax#8423,ss_net_profit#8424] parquet, Statistics(sizeInBytes=141.1 MiB)
                  :                       +- Project [c_customer_sk#8425], Statistics(sizeInBytes=460.7 KiB)
                  :                          +- Filter isnotnull(c_customer_sk#8425), Statistics(sizeInBytes=7.8 MiB)
                  :                             +- Relation default.customer[c_customer_sk#8425,c_customer_id#8426,c_current_cdemo_sk#8427,c_current_hdemo_sk#8428,c_current_addr_sk#8429,c_first_shipto_date_sk#8430,c_first_sales_date_sk#8431,c_salutation#8432,c_first_name#8433,c_last_name#8434,c_preferred_cust_flag#8435,c_birth_day#8436,c_birth_month#8437,c_birth_year#8438,c_birth_country#8439,c_login#8440,c_email_address#8441,c_last_review_date#8442] parquet, Statistics(sizeInBytes=7.8 MiB)
                  +- Project [d_date_sk#8507], Statistics(sizeInBytes=105.3 KiB)
                     +- Filter (((isnotnull(d_year#8513) AND isnotnull(d_moy#8515)) AND ((d_year#8513 = 2000) AND (d_moy#8515 = 2))) AND isnotnull(d_date_sk#8507)), Statistics(sizeInBytes=2.5 MiB)
                        +- Relation default.date_dim[d_date_sk#8507,d_date_id#8508,d_date#8509,d_month_seq#8510,d_week_seq#8511,d_quarter_seq#8512,d_year#8513,d_dow#8514,d_moy#8515,d_dom#8516,d_qoy#8517,d_fy_year#8518,d_fy_quarter_seq#8519,d_fy_week_seq#8520,d_day_name#8521,d_quarter_name#8522,d_holiday#8523,d_weekend#8524,d_following_holiday#8525,d_first_dom#8526,d_last_dom#8527,d_same_day_ly#8528,d_same_day_lq#8529,d_current_day#8530,d_current_week#8531,d_current_month#8532,d_current_quarter#8533,d_current_year#8534] parquet, Statistics(sizeInBytes=2.5 MiB)

==== q24 ==== 
== Optimized Logical Plan ==
Filter (isnotnull(paid#8687) AND (cast(paid#8687 as decimal(33,8)) > cast(scalar-subquery#8688 [] as decimal(33,8)))), Statistics(sizeInBytes=5.13E+35 B)
:  +- Aggregate [CheckOverflow((0.050000 * promote_precision(avg(netpaid#8689))), DecimalType(24,8)) AS (0.05 * avg(netpaid))#8693], Statistics(sizeInBytes=24.0 B, rowCount=1)
:     +- Aggregate [c_last_name#90, c_first_name#89, s_store_name#57, ca_state#3725, s_state#76, i_color#454, i_current_price#442, i_manager_id#457, i_units#455, i_size#452], [MakeDecimal(sum(UnscaledValue(ss_net_paid#434)),17,2) AS netpaid#8689], Statistics(sizeInBytes=9.78E+34 B)
:        +- Project [ss_net_paid#434, s_store_name#57, s_state#76, i_current_price#442, i_size#452, i_color#454, i_units#455, i_manager_id#457, c_first_name#89, c_last_name#90, ca_state#3725], Statistics(sizeInBytes=1.15E+36 B)
:           +- Join Inner, ((c_birth_country#95 = upper(ca_country#3727)) AND (s_zip#77 = ca_zip#3726)), Statistics(sizeInBytes=1.64E+36 B)
:              :- Project [ss_net_paid#434, s_store_name#57, s_state#76, s_zip#77, i_current_price#442, i_size#452, i_color#454, i_units#455, i_manager_id#457, c_first_name#89, c_last_name#90, c_birth_country#95], Statistics(sizeInBytes=2.24E+30 B)
:              :  +- Join Inner, (ss_customer_sk#417 = c_customer_sk#81), Statistics(sizeInBytes=2.32E+30 B)
:              :     :- Project [ss_customer_sk#417, ss_net_paid#434, s_store_name#57, s_state#76, s_zip#77, i_current_price#442, i_size#452, i_color#454, i_units#455, i_manager_id#457], Statistics(sizeInBytes=8.21E+23 B)
:              :     :  +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=8.64E+23 B)
:              :     :     :- Project [ss_item_sk#416, ss_customer_sk#417, ss_net_paid#434, s_store_name#57, s_state#76, s_zip#77], Statistics(sizeInBytes=834.0 PiB)
:              :     :     :  +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=913.5 PiB)
:              :     :     :     :- Project [ss_item_sk#416, ss_customer_sk#417, ss_store_sk#421, ss_net_paid#434], Statistics(sizeInBytes=52.4 TiB)
:              :     :     :     :  +- Join Inner, ((ss_ticket_number#423 = sr_ticket_number#13) AND (ss_item_sk#416 = sr_item_sk#6)), Statistics(sizeInBytes=74.9 TiB)
:              :     :     :     :     :- Project [ss_item_sk#416, ss_customer_sk#417, ss_store_sk#421, ss_ticket_number#423, ss_net_paid#434], Statistics(sizeInBytes=30.5 MiB)
:              :     :     :     :     :  +- Filter (((isnotnull(ss_ticket_number#423) AND isnotnull(ss_item_sk#416)) AND isnotnull(ss_store_sk#421)) AND isnotnull(ss_customer_sk#417)), Statistics(sizeInBytes=141.1 MiB)
:              :     :     :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
:              :     :     :     :     +- Project [sr_item_sk#6, sr_ticket_number#13], Statistics(sizeInBytes=2.5 MiB)
:              :     :     :     :        +- Filter (isnotnull(sr_ticket_number#13) AND isnotnull(sr_item_sk#6)), Statistics(sizeInBytes=19.0 MiB)
:              :     :     :     :           +- Relation default.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet, Statistics(sizeInBytes=19.0 MiB)
:              :     :     :     +- Project [s_store_sk#52, s_store_name#57, s_state#76, s_zip#77], Statistics(sizeInBytes=17.4 KiB)
:              :     :     :        +- Filter (((isnotnull(s_market_id#62) AND (s_market_id#62 = 8)) AND isnotnull(s_store_sk#52)) AND isnotnull(s_zip#77)), Statistics(sizeInBytes=101.7 KiB)
:              :     :     :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
:              :     :     +- Project [i_item_sk#437, i_current_price#442, i_size#452, i_color#454, i_units#455, i_manager_id#457], Statistics(sizeInBytes=898.5 KiB)
:              :     :        +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
:              :     :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
:              :     +- Project [c_customer_sk#81, c_first_name#89, c_last_name#90, c_birth_country#95], Statistics(sizeInBytes=2.7 MiB)
:              :        +- Filter (isnotnull(c_customer_sk#81) AND isnotnull(c_birth_country#95)), Statistics(sizeInBytes=7.8 MiB)
:              :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
:              +- Project [ca_state#3725, ca_zip#3726, ca_country#3727], Statistics(sizeInBytes=714.9 KiB)
:                 +- Filter (isnotnull(ca_country#3727) AND isnotnull(ca_zip#3726)), Statistics(sizeInBytes=2.5 MiB)
:                    +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
+- Aggregate [c_last_name#90, c_first_name#89, s_store_name#57], [c_last_name#90, c_first_name#89, s_store_name#57, sum(netpaid#8689) AS paid#8687], Statistics(sizeInBytes=5.13E+35 B)
   +- Aggregate [c_last_name#90, c_first_name#89, s_store_name#57, ca_state#3725, s_state#76, i_color#454, i_current_price#442, i_manager_id#457, i_units#455, i_size#452], [c_last_name#90, c_first_name#89, s_store_name#57, MakeDecimal(sum(UnscaledValue(ss_net_paid#434)),17,2) AS netpaid#8689], Statistics(sizeInBytes=4.64E+35 B)
      +- Project [ss_net_paid#434, s_store_name#57, s_state#76, i_current_price#442, i_size#452, i_color#454, i_units#455, i_manager_id#457, c_first_name#89, c_last_name#90, ca_state#3725], Statistics(sizeInBytes=1.15E+36 B)
         +- Join Inner, ((c_birth_country#95 = upper(ca_country#3727)) AND (s_zip#77 = ca_zip#3726)), Statistics(sizeInBytes=1.64E+36 B)
            :- Project [ss_net_paid#434, s_store_name#57, s_state#76, s_zip#77, i_current_price#442, i_size#452, i_color#454, i_units#455, i_manager_id#457, c_first_name#89, c_last_name#90, c_birth_country#95], Statistics(sizeInBytes=2.24E+30 B)
            :  +- Join Inner, (ss_customer_sk#417 = c_customer_sk#81), Statistics(sizeInBytes=2.32E+30 B)
            :     :- Project [ss_customer_sk#417, ss_net_paid#434, s_store_name#57, s_state#76, s_zip#77, i_current_price#442, i_size#452, i_color#454, i_units#455, i_manager_id#457], Statistics(sizeInBytes=8.21E+23 B)
            :     :  +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=8.64E+23 B)
            :     :     :- Project [ss_item_sk#416, ss_customer_sk#417, ss_net_paid#434, s_store_name#57, s_state#76, s_zip#77], Statistics(sizeInBytes=834.0 PiB)
            :     :     :  +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=913.5 PiB)
            :     :     :     :- Project [ss_item_sk#416, ss_customer_sk#417, ss_store_sk#421, ss_net_paid#434], Statistics(sizeInBytes=52.4 TiB)
            :     :     :     :  +- Join Inner, ((ss_ticket_number#423 = sr_ticket_number#13) AND (ss_item_sk#416 = sr_item_sk#6)), Statistics(sizeInBytes=74.9 TiB)
            :     :     :     :     :- Project [ss_item_sk#416, ss_customer_sk#417, ss_store_sk#421, ss_ticket_number#423, ss_net_paid#434], Statistics(sizeInBytes=30.5 MiB)
            :     :     :     :     :  +- Filter (((isnotnull(ss_ticket_number#423) AND isnotnull(ss_item_sk#416)) AND isnotnull(ss_store_sk#421)) AND isnotnull(ss_customer_sk#417)), Statistics(sizeInBytes=141.1 MiB)
            :     :     :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     :     :     :     +- Project [sr_item_sk#6, sr_ticket_number#13], Statistics(sizeInBytes=2.5 MiB)
            :     :     :     :        +- Filter (isnotnull(sr_ticket_number#13) AND isnotnull(sr_item_sk#6)), Statistics(sizeInBytes=19.0 MiB)
            :     :     :     :           +- Relation default.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet, Statistics(sizeInBytes=19.0 MiB)
            :     :     :     +- Project [s_store_sk#52, s_store_name#57, s_state#76, s_zip#77], Statistics(sizeInBytes=17.4 KiB)
            :     :     :        +- Filter (((isnotnull(s_market_id#62) AND (s_market_id#62 = 8)) AND isnotnull(s_store_sk#52)) AND isnotnull(s_zip#77)), Statistics(sizeInBytes=101.7 KiB)
            :     :     :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
            :     :     +- Project [i_item_sk#437, i_current_price#442, i_size#452, i_color#454, i_units#455, i_manager_id#457], Statistics(sizeInBytes=898.5 KiB)
            :     :        +- Filter ((isnotnull(i_color#454) AND (i_color#454 = pale                )) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
            :     :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
            :     +- Project [c_customer_sk#81, c_first_name#89, c_last_name#90, c_birth_country#95], Statistics(sizeInBytes=2.7 MiB)
            :        +- Filter (isnotnull(c_customer_sk#81) AND isnotnull(c_birth_country#95)), Statistics(sizeInBytes=7.8 MiB)
            :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
            +- Project [ca_state#3725, ca_zip#3726, ca_country#3727], Statistics(sizeInBytes=714.9 KiB)
               +- Filter (isnotnull(ca_country#3727) AND isnotnull(ca_zip#3726)), Statistics(sizeInBytes=2.5 MiB)
                  +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)

==== q25 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=10.9 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=8.11E+45 B)
   +- Sort [i_item_id#438 ASC NULLS FIRST, i_item_desc#441 ASC NULLS FIRST, s_store_id#53 ASC NULLS FIRST, s_store_name#57 ASC NULLS FIRST], true, Statistics(sizeInBytes=8.11E+45 B)
      +- Aggregate [i_item_id#438, i_item_desc#441, s_store_id#53, s_store_name#57], [i_item_id#438, i_item_desc#441, s_store_id#53, s_store_name#57, MakeDecimal(sum(UnscaledValue(ss_net_profit#436)),17,2) AS store_sales_profit#8826, MakeDecimal(sum(UnscaledValue(sr_net_loss#23)),17,2) AS store_returns_loss#8827, MakeDecimal(sum(UnscaledValue(cs_net_profit#230)),17,2) AS catalog_sales_profit#8828], Statistics(sizeInBytes=8.11E+45 B)
         +- Project [ss_net_profit#436, sr_net_loss#23, cs_net_profit#230, s_store_id#53, s_store_name#57, i_item_id#438, i_item_desc#441], Statistics(sizeInBytes=8.11E+45 B)
            +- Join Inner, (i_item_sk#437 = ss_item_sk#416), Statistics(sizeInBytes=8.69E+45 B)
               :- Project [ss_item_sk#416, ss_net_profit#436, sr_net_loss#23, cs_net_profit#230, s_store_id#53, s_store_name#57], Statistics(sizeInBytes=1.53E+40 B)
               :  +- Join Inner, (s_store_sk#52 = ss_store_sk#421), Statistics(sizeInBytes=1.69E+40 B)
               :     :- Project [ss_item_sk#416, ss_store_sk#421, ss_net_profit#436, sr_net_loss#23, cs_net_profit#230], Statistics(sizeInBytes=1.31E+36 B)
               :     :  +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#8857), Statistics(sizeInBytes=1.57E+36 B)
               :     :     :- Project [ss_item_sk#416, ss_store_sk#421, ss_net_profit#436, sr_net_loss#23, cs_sold_date_sk#197, cs_net_profit#230], Statistics(sizeInBytes=1.46E+31 B)
               :     :     :  +- Join Inner, (sr_returned_date_sk#4 = d_date_sk#8829), Statistics(sizeInBytes=1.72E+31 B)
               :     :     :     :- Project [ss_item_sk#416, ss_store_sk#421, ss_net_profit#436, sr_returned_date_sk#4, sr_net_loss#23, cs_sold_date_sk#197, cs_net_profit#230], Statistics(sizeInBytes=1.60E+26 B)
               :     :     :     :  +- Join Inner, (d_date_sk#24 = ss_sold_date_sk#414), Statistics(sizeInBytes=1.86E+26 B)
               :     :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_net_profit#436, sr_returned_date_sk#4, sr_net_loss#23, cs_sold_date_sk#197, cs_net_profit#230], Statistics(sizeInBytes=1497.1 EiB)
               :     :     :     :     :  +- Join Inner, ((sr_customer_sk#7 = cs_bill_customer_sk#200) AND (sr_item_sk#6 = cs_item_sk#212)), Statistics(sizeInBytes=1957.8 EiB)
               :     :     :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_net_profit#436, sr_returned_date_sk#4, sr_item_sk#6, sr_customer_sk#7, sr_net_loss#23], Statistics(sizeInBytes=134.8 TiB)
               :     :     :     :     :     :  +- Join Inner, (((ss_customer_sk#417 = sr_customer_sk#7) AND (ss_item_sk#416 = sr_item_sk#6)) AND (ss_ticket_number#423 = sr_ticket_number#13)), Statistics(sizeInBytes=168.5 TiB)
               :     :     :     :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_customer_sk#417, ss_store_sk#421, ss_ticket_number#423, ss_net_profit#436], Statistics(sizeInBytes=34.3 MiB)
               :     :     :     :     :     :     :  +- Filter (((isnotnull(ss_customer_sk#417) AND isnotnull(ss_item_sk#416)) AND isnotnull(ss_ticket_number#423)) AND (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421))), Statistics(sizeInBytes=141.1 MiB)
               :     :     :     :     :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               :     :     :     :     :     :     +- Project [sr_returned_date_sk#4, sr_item_sk#6, sr_customer_sk#7, sr_ticket_number#13, sr_net_loss#23], Statistics(sizeInBytes=4.9 MiB)
               :     :     :     :     :     :        +- Filter (((isnotnull(sr_customer_sk#7) AND isnotnull(sr_item_sk#6)) AND isnotnull(sr_ticket_number#13)) AND isnotnull(sr_returned_date_sk#4)), Statistics(sizeInBytes=19.0 MiB)
               :     :     :     :     :     :           +- Relation default.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet, Statistics(sizeInBytes=19.0 MiB)
               :     :     :     :     :     +- Project [cs_sold_date_sk#197, cs_bill_customer_sk#200, cs_item_sk#212, cs_net_profit#230], Statistics(sizeInBytes=14.5 MiB)
               :     :     :     :     :        +- Filter ((isnotnull(cs_bill_customer_sk#200) AND isnotnull(cs_item_sk#212)) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
               :     :     :     :     :           +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
               :     :     :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :     :     :     :        +- Filter (((isnotnull(d_moy#32) AND isnotnull(d_year#30)) AND ((d_moy#32 = 4) AND (d_year#30 = 2001))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :     :     :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     :     :     +- Project [d_date_sk#8829], Statistics(sizeInBytes=105.3 KiB)
               :     :     :        +- Filter (((isnotnull(d_moy#8837) AND isnotnull(d_year#8835)) AND (((d_moy#8837 >= 4) AND (d_moy#8837 <= 10)) AND (d_year#8835 = 2001))) AND isnotnull(d_date_sk#8829)), Statistics(sizeInBytes=2.5 MiB)
               :     :     :           +- Relation default.date_dim[d_date_sk#8829,d_date_id#8830,d_date#8831,d_month_seq#8832,d_week_seq#8833,d_quarter_seq#8834,d_year#8835,d_dow#8836,d_moy#8837,d_dom#8838,d_qoy#8839,d_fy_year#8840,d_fy_quarter_seq#8841,d_fy_week_seq#8842,d_day_name#8843,d_quarter_name#8844,d_holiday#8845,d_weekend#8846,d_following_holiday#8847,d_first_dom#8848,d_last_dom#8849,d_same_day_ly#8850,d_same_day_lq#8851,d_current_day#8852,d_current_week#8853,d_current_month#8854,d_current_quarter#8855,d_current_year#8856] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     :     +- Project [d_date_sk#8857], Statistics(sizeInBytes=105.3 KiB)
               :     :        +- Filter (((isnotnull(d_moy#8865) AND isnotnull(d_year#8863)) AND (((d_moy#8865 >= 4) AND (d_moy#8865 <= 10)) AND (d_year#8863 = 2001))) AND isnotnull(d_date_sk#8857)), Statistics(sizeInBytes=2.5 MiB)
               :     :           +- Relation default.date_dim[d_date_sk#8857,d_date_id#8858,d_date#8859,d_month_seq#8860,d_week_seq#8861,d_quarter_seq#8862,d_year#8863,d_dow#8864,d_moy#8865,d_dom#8866,d_qoy#8867,d_fy_year#8868,d_fy_quarter_seq#8869,d_fy_week_seq#8870,d_day_name#8871,d_quarter_name#8872,d_holiday#8873,d_weekend#8874,d_following_holiday#8875,d_first_dom#8876,d_last_dom#8877,d_same_day_ly#8878,d_same_day_lq#8879,d_current_day#8880,d_current_week#8881,d_current_month#8882,d_current_quarter#8883,d_current_year#8884] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     +- Project [s_store_sk#52, s_store_id#53, s_store_name#57], Statistics(sizeInBytes=12.6 KiB)
               :        +- Filter isnotnull(s_store_sk#52), Statistics(sizeInBytes=101.7 KiB)
               :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
               +- Project [i_item_sk#437, i_item_id#438, i_item_desc#441], Statistics(sizeInBytes=556.2 KiB)
                  +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
                     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)


==== q26 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=5.9 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.41E+28 B)
   +- Sort [i_item_id#438 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.41E+28 B)
      +- Aggregate [i_item_id#438], [i_item_id#438, avg(cs_quantity#215) AS agg1#8915, cast((avg(UnscaledValue(cs_list_price#217)) / 100.0) as decimal(11,6)) AS agg2#8916, cast((avg(UnscaledValue(cs_coupon_amt#224)) / 100.0) as decimal(11,6)) AS agg3#8917, cast((avg(UnscaledValue(cs_sales_price#218)) / 100.0) as decimal(11,6)) AS agg4#8918], Statistics(sizeInBytes=1.41E+28 B)
         +- Project [cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224, i_item_id#438], Statistics(sizeInBytes=1.32E+28 B)
            +- Join Inner, (cs_promo_sk#213 = p_promo_sk#3642), Statistics(sizeInBytes=1.51E+28 B)
               :- Project [cs_promo_sk#213, cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224, i_item_id#438], Statistics(sizeInBytes=6.15E+23 B)
               :  +- Join Inner, (cs_item_sk#212 = i_item_sk#437), Statistics(sizeInBytes=6.98E+23 B)
               :     :- Project [cs_item_sk#212, cs_promo_sk#213, cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224], Statistics(sizeInBytes=1767.7 PiB)
               :     :  +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#24), Statistics(sizeInBytes=2.0 EiB)
               :     :     :- Project [cs_sold_date_sk#197, cs_item_sk#212, cs_promo_sk#213, cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224], Statistics(sizeInBytes=19.8 TiB)
               :     :     :  +- Join Inner, (cs_bill_cdemo_sk#201 = cd_demo_sk#3633), Statistics(sizeInBytes=23.1 TiB)
               :     :     :     :- Project [cs_sold_date_sk#197, cs_bill_cdemo_sk#201, cs_item_sk#212, cs_promo_sk#213, cs_quantity#215, cs_list_price#217, cs_sales_price#218, cs_coupon_amt#224], Statistics(sizeInBytes=27.0 MiB)
               :     :     :     :  +- Filter ((isnotnull(cs_bill_cdemo_sk#201) AND isnotnull(cs_sold_date_sk#197)) AND (isnotnull(cs_item_sk#212) AND isnotnull(cs_promo_sk#213))), Statistics(sizeInBytes=105.8 MiB)
               :     :     :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
               :     :     :     +- Project [cd_demo_sk#3633], Statistics(sizeInBytes=878.6 KiB)
               :     :     :        +- Filter ((((isnotnull(cd_gender#3634) AND isnotnull(cd_marital_status#3635)) AND isnotnull(cd_education_status#3636)) AND (((cd_gender#3634 = M) AND (cd_marital_status#3635 = S)) AND (cd_education_status#3636 = College             ))) AND isnotnull(cd_demo_sk#3633)), Statistics(sizeInBytes=7.7 MiB)
               :     :     :           +- Relation default.customer_demographics[cd_demo_sk#3633,cd_gender#3634,cd_marital_status#3635,cd_education_status#3636,cd_purchase_estimate#3637,cd_credit_rating#3638,cd_dep_count#3639,cd_dep_employed_count#3640,cd_dep_college_count#3641] parquet, Statistics(sizeInBytes=7.7 MiB)
               :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :     :        +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2000)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     +- Project [i_item_sk#437, i_item_id#438], Statistics(sizeInBytes=342.3 KiB)
               :        +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
               :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
               +- Project [p_promo_sk#3642], Statistics(sizeInBytes=23.9 KiB)
                  +- Filter (((p_channel_email#3651 = N) OR (p_channel_event#3656 = N)) AND isnotnull(p_promo_sk#3642)), Statistics(sizeInBytes=589.4 KiB)
                     +- Relation default.promotion[p_promo_sk#3642,p_promo_id#3643,p_start_date_sk#3644,p_end_date_sk#3645,p_item_sk#3646,p_cost#3647,p_response_target#3648,p_promo_name#3649,p_channel_dmail#3650,p_channel_email#3651,p_channel_catalog#3652,p_channel_tv#3653,p_channel_radio#3654,p_channel_press#3655,p_channel_event#3656,p_channel_demo#3657,p_channel_details#3658,p_purpose#3659,p_discount_active#3660] parquet, Statistics(sizeInBytes=589.4 KiB)


==== q27 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=7.9 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=2.59E+28 B)
   +- Sort [i_item_id#8996 ASC NULLS FIRST, s_state#8997 ASC NULLS FIRST], true, Statistics(sizeInBytes=2.59E+28 B)
      +- Aggregate [i_item_id#8996, s_state#8997, spark_grouping_id#8995L], [i_item_id#8996, s_state#8997, cast((shiftright(spark_grouping_id#8995L, 0) & 1) as tinyint) AS g_state#8984, avg(ss_quantity#424) AS agg1#8985, cast((avg(UnscaledValue(ss_list_price#426)) / 100.0) as decimal(11,6)) AS agg2#8986, cast((avg(UnscaledValue(ss_coupon_amt#433)) / 100.0) as decimal(11,6)) AS agg3#8987, cast((avg(UnscaledValue(ss_sales_price#427)) / 100.0) as decimal(11,6)) AS agg4#8988], Statistics(sizeInBytes=2.59E+28 B)
         +- Expand [[ss_quantity#424, ss_list_price#426, ss_sales_price#427, ss_coupon_amt#433, i_item_id#438, s_state#76, 0], [ss_quantity#424, ss_list_price#426, ss_sales_price#427, ss_coupon_amt#433, i_item_id#438, null, 1], [ss_quantity#424, ss_list_price#426, ss_sales_price#427, ss_coupon_amt#433, null, null, 3]], [ss_quantity#424, ss_list_price#426, ss_sales_price#427, ss_coupon_amt#433, i_item_id#8996, s_state#8997, spark_grouping_id#8995L], Statistics(sizeInBytes=2.69E+28 B)
            +- Project [ss_quantity#424, ss_list_price#426, ss_sales_price#427, ss_coupon_amt#433, i_item_id#438, s_state#76], Statistics(sizeInBytes=8.11E+27 B)
               +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=8.97E+27 B)
                  :- Project [ss_item_sk#416, ss_quantity#424, ss_list_price#426, ss_sales_price#427, ss_coupon_amt#433, s_state#76], Statistics(sizeInBytes=2.56E+22 B)
                  :  +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=2.90E+22 B)
                  :     :- Project [ss_item_sk#416, ss_store_sk#421, ss_quantity#424, ss_list_price#426, ss_sales_price#427, ss_coupon_amt#433], Statistics(sizeInBytes=3.2 EiB)
                  :     :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=3.7 EiB)
                  :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_quantity#424, ss_list_price#426, ss_sales_price#427, ss_coupon_amt#433], Statistics(sizeInBytes=36.5 TiB)
                  :     :     :  +- Join Inner, (ss_cdemo_sk#418 = cd_demo_sk#3633), Statistics(sizeInBytes=42.5 TiB)
                  :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_cdemo_sk#418, ss_store_sk#421, ss_quantity#424, ss_list_price#426, ss_sales_price#427, ss_coupon_amt#433], Statistics(sizeInBytes=49.6 MiB)
                  :     :     :     :  +- Filter ((isnotnull(ss_cdemo_sk#418) AND isnotnull(ss_sold_date_sk#414)) AND (isnotnull(ss_store_sk#421) AND isnotnull(ss_item_sk#416))), Statistics(sizeInBytes=141.1 MiB)
                  :     :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                  :     :     :     +- Project [cd_demo_sk#3633], Statistics(sizeInBytes=878.6 KiB)
                  :     :     :        +- Filter ((((isnotnull(cd_gender#3634) AND isnotnull(cd_marital_status#3635)) AND isnotnull(cd_education_status#3636)) AND (((cd_gender#3634 = M) AND (cd_marital_status#3635 = S)) AND (cd_education_status#3636 = College             ))) AND isnotnull(cd_demo_sk#3633)), Statistics(sizeInBytes=7.7 MiB)
                  :     :     :           +- Relation default.customer_demographics[cd_demo_sk#3633,cd_gender#3634,cd_marital_status#3635,cd_education_status#3636,cd_purchase_estimate#3637,cd_credit_rating#3638,cd_dep_count#3639,cd_dep_employed_count#3640,cd_dep_college_count#3641] parquet, Statistics(sizeInBytes=7.7 MiB)
                  :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                  :     :        +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2002)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                  :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                  :     +- Project [s_store_sk#52, s_state#76], Statistics(sizeInBytes=7.7 KiB)
                  :        +- Filter ((isnotnull(s_state#76) AND (s_state#76 = TN)) AND isnotnull(s_store_sk#52)), Statistics(sizeInBytes=101.7 KiB)
                  :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
                  +- Project [i_item_sk#437, i_item_id#438], Statistics(sizeInBytes=342.3 KiB)
                     +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
                        +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)

==== q28 ====
== Optimized Logical Plan ==
Join Inner, Statistics(sizeInBytes=1024.0 MiB)
:- Join Inner, Statistics(sizeInBytes=32.0 MiB)
:  :- Join Inner, Statistics(sizeInBytes=1024.0 KiB)
:  :  :- Join Inner, Statistics(sizeInBytes=32.0 KiB)
:  :  :  :- Join Inner, Statistics(sizeInBytes=1024.0 B)
:  :  :  :  :- Aggregate [cast((avg(UnscaledValue(ss_list_price#426)) / 100.0) as decimal(11,6)) AS B1_LP#9046, count(ss_list_price#426) AS B1_CNT#9047L, count(distinct ss_list_price#426) AS B1_CNTD#9048L], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :  :  :  :  +- Project [ss_list_price#426], Statistics(sizeInBytes=15.3 MiB)
:  :  :  :  :     +- Filter (isnotnull(ss_quantity#424) AND (((ss_quantity#424 >= 0) AND (ss_quantity#424 <= 5)) AND ((((ss_list_price#426 >= 8.00) AND (ss_list_price#426 <= 18.00)) OR ((ss_coupon_amt#433 >= 459.00) AND (ss_coupon_amt#433 <= 1459.00))) OR ((ss_wholesale_cost#425 >= 57.00) AND (ss_wholesale_cost#425 <= 77.00))))), Statistics(sizeInBytes=141.1 MiB)
:  :  :  :  :        +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :  :  :  +- Aggregate [cast((avg(UnscaledValue(ss_list_price#9076)) / 100.0) as decimal(11,6)) AS B2_LP#9049, count(ss_list_price#9076) AS B2_CNT#9050L, count(distinct ss_list_price#9076) AS B2_CNTD#9051L], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :  :  :     +- Project [ss_list_price#9076], Statistics(sizeInBytes=15.3 MiB)
:  :  :  :        +- Filter (isnotnull(ss_quantity#9074) AND (((ss_quantity#9074 >= 6) AND (ss_quantity#9074 <= 10)) AND ((((ss_list_price#9076 >= 90.00) AND (ss_list_price#9076 <= 100.00)) OR ((ss_coupon_amt#9083 >= 2323.00) AND (ss_coupon_amt#9083 <= 3323.00))) OR ((ss_wholesale_cost#9075 >= 31.00) AND (ss_wholesale_cost#9075 <= 51.00))))), Statistics(sizeInBytes=141.1 MiB)
:  :  :  :           +- Relation default.store_sales[ss_sold_date_sk#9064,ss_sold_time_sk#9065,ss_item_sk#9066,ss_customer_sk#9067,ss_cdemo_sk#9068,ss_hdemo_sk#9069,ss_addr_sk#9070,ss_store_sk#9071,ss_promo_sk#9072,ss_ticket_number#9073,ss_quantity#9074,ss_wholesale_cost#9075,ss_list_price#9076,ss_sales_price#9077,ss_ext_discount_amt#9078,ss_ext_sales_price#9079,ss_ext_wholesale_cost#9080,ss_ext_list_price#9081,ss_ext_tax#9082,ss_coupon_amt#9083,ss_net_paid#9084,ss_net_paid_inc_tax#9085,ss_net_profit#9086] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :  :  +- Aggregate [cast((avg(UnscaledValue(ss_list_price#9099)) / 100.0) as decimal(11,6)) AS B3_LP#9052, count(ss_list_price#9099) AS B3_CNT#9053L, count(distinct ss_list_price#9099) AS B3_CNTD#9054L], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :  :     +- Project [ss_list_price#9099], Statistics(sizeInBytes=15.3 MiB)
:  :  :        +- Filter (isnotnull(ss_quantity#9097) AND (((ss_quantity#9097 >= 11) AND (ss_quantity#9097 <= 15)) AND ((((ss_list_price#9099 >= 142.00) AND (ss_list_price#9099 <= 152.00)) OR ((ss_coupon_amt#9106 >= 12214.00) AND (ss_coupon_amt#9106 <= 13214.00))) OR ((ss_wholesale_cost#9098 >= 79.00) AND (ss_wholesale_cost#9098 <= 99.00))))), Statistics(sizeInBytes=141.1 MiB)
:  :  :           +- Relation default.store_sales[ss_sold_date_sk#9087,ss_sold_time_sk#9088,ss_item_sk#9089,ss_customer_sk#9090,ss_cdemo_sk#9091,ss_hdemo_sk#9092,ss_addr_sk#9093,ss_store_sk#9094,ss_promo_sk#9095,ss_ticket_number#9096,ss_quantity#9097,ss_wholesale_cost#9098,ss_list_price#9099,ss_sales_price#9100,ss_ext_discount_amt#9101,ss_ext_sales_price#9102,ss_ext_wholesale_cost#9103,ss_ext_list_price#9104,ss_ext_tax#9105,ss_coupon_amt#9106,ss_net_paid#9107,ss_net_paid_inc_tax#9108,ss_net_profit#9109] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :  +- Aggregate [cast((avg(UnscaledValue(ss_list_price#9122)) / 100.0) as decimal(11,6)) AS B4_LP#9055, count(ss_list_price#9122) AS B4_CNT#9056L, count(distinct ss_list_price#9122) AS B4_CNTD#9057L], Statistics(sizeInBytes=32.0 B, rowCount=1)
:  :     +- Project [ss_list_price#9122], Statistics(sizeInBytes=15.3 MiB)
:  :        +- Filter (isnotnull(ss_quantity#9120) AND (((ss_quantity#9120 >= 16) AND (ss_quantity#9120 <= 20)) AND ((((ss_list_price#9122 >= 135.00) AND (ss_list_price#9122 <= 145.00)) OR ((ss_coupon_amt#9129 >= 6071.00) AND (ss_coupon_amt#9129 <= 7071.00))) OR ((ss_wholesale_cost#9121 >= 38.00) AND (ss_wholesale_cost#9121 <= 58.00))))), Statistics(sizeInBytes=141.1 MiB)
:  :           +- Relation default.store_sales[ss_sold_date_sk#9110,ss_sold_time_sk#9111,ss_item_sk#9112,ss_customer_sk#9113,ss_cdemo_sk#9114,ss_hdemo_sk#9115,ss_addr_sk#9116,ss_store_sk#9117,ss_promo_sk#9118,ss_ticket_number#9119,ss_quantity#9120,ss_wholesale_cost#9121,ss_list_price#9122,ss_sales_price#9123,ss_ext_discount_amt#9124,ss_ext_sales_price#9125,ss_ext_wholesale_cost#9126,ss_ext_list_price#9127,ss_ext_tax#9128,ss_coupon_amt#9129,ss_net_paid#9130,ss_net_paid_inc_tax#9131,ss_net_profit#9132] parquet, Statistics(sizeInBytes=141.1 MiB)
:  +- Aggregate [cast((avg(UnscaledValue(ss_list_price#9145)) / 100.0) as decimal(11,6)) AS B5_LP#9058, count(ss_list_price#9145) AS B5_CNT#9059L, count(distinct ss_list_price#9145) AS B5_CNTD#9060L], Statistics(sizeInBytes=32.0 B, rowCount=1)
:     +- Project [ss_list_price#9145], Statistics(sizeInBytes=15.3 MiB)
:        +- Filter (isnotnull(ss_quantity#9143) AND (((ss_quantity#9143 >= 21) AND (ss_quantity#9143 <= 25)) AND ((((ss_list_price#9145 >= 122.00) AND (ss_list_price#9145 <= 132.00)) OR ((ss_coupon_amt#9152 >= 836.00) AND (ss_coupon_amt#9152 <= 1836.00))) OR ((ss_wholesale_cost#9144 >= 17.00) AND (ss_wholesale_cost#9144 <= 37.00))))), Statistics(sizeInBytes=141.1 MiB)
:           +- Relation default.store_sales[ss_sold_date_sk#9133,ss_sold_time_sk#9134,ss_item_sk#9135,ss_customer_sk#9136,ss_cdemo_sk#9137,ss_hdemo_sk#9138,ss_addr_sk#9139,ss_store_sk#9140,ss_promo_sk#9141,ss_ticket_number#9142,ss_quantity#9143,ss_wholesale_cost#9144,ss_list_price#9145,ss_sales_price#9146,ss_ext_discount_amt#9147,ss_ext_sales_price#9148,ss_ext_wholesale_cost#9149,ss_ext_list_price#9150,ss_ext_tax#9151,ss_coupon_amt#9152,ss_net_paid#9153,ss_net_paid_inc_tax#9154,ss_net_profit#9155] parquet, Statistics(sizeInBytes=141.1 MiB)
+- Aggregate [cast((avg(UnscaledValue(ss_list_price#9168)) / 100.0) as decimal(11,6)) AS B6_LP#9061, count(ss_list_price#9168) AS B6_CNT#9062L, count(distinct ss_list_price#9168) AS B6_CNTD#9063L], Statistics(sizeInBytes=32.0 B, rowCount=1)
   +- Project [ss_list_price#9168], Statistics(sizeInBytes=15.3 MiB)
      +- Filter (isnotnull(ss_quantity#9166) AND (((ss_quantity#9166 >= 26) AND (ss_quantity#9166 <= 30)) AND ((((ss_list_price#9168 >= 154.00) AND (ss_list_price#9168 <= 164.00)) OR ((ss_coupon_amt#9175 >= 7326.00) AND (ss_coupon_amt#9175 <= 8326.00))) OR ((ss_wholesale_cost#9167 >= 7.00) AND (ss_wholesale_cost#9167 <= 27.00))))), Statistics(sizeInBytes=141.1 MiB)
         +- Relation default.store_sales[ss_sold_date_sk#9156,ss_sold_time_sk#9157,ss_item_sk#9158,ss_customer_sk#9159,ss_cdemo_sk#9160,ss_hdemo_sk#9161,ss_addr_sk#9162,ss_store_sk#9163,ss_promo_sk#9164,ss_ticket_number#9165,ss_quantity#9166,ss_wholesale_cost#9167,ss_list_price#9168,ss_sales_price#9169,ss_ext_discount_amt#9170,ss_ext_sales_price#9171,ss_ext_wholesale_cost#9172,ss_ext_list_price#9173,ss_ext_tax#9174,ss_coupon_amt#9175,ss_net_paid#9176,ss_net_paid_inc_tax#9177,ss_net_profit#9178] parquet, Statistics(sizeInBytes=141.1 MiB)

==== q29 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=10.9 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=4.46E+45 B)
   +- Sort [i_item_id#438 ASC NULLS FIRST, i_item_desc#441 ASC NULLS FIRST, s_store_id#53 ASC NULLS FIRST, s_store_name#57 ASC NULLS FIRST], true, Statistics(sizeInBytes=4.46E+45 B)
      +- Aggregate [i_item_id#438, i_item_desc#441, s_store_id#53, s_store_name#57], [i_item_id#438, i_item_desc#441, s_store_id#53, s_store_name#57, sum(ss_quantity#424) AS store_sales_quantity#9590L, sum(sr_return_quantity#14) AS store_returns_quantity#9591L, sum(cs_quantity#215) AS catalog_sales_quantity#9592L], Statistics(sizeInBytes=4.46E+45 B)
         +- Project [ss_quantity#424, sr_return_quantity#14, cs_quantity#215, s_store_id#53, s_store_name#57, i_item_id#438, i_item_desc#441], Statistics(sizeInBytes=3.99E+45 B)
            +- Join Inner, (i_item_sk#437 = ss_item_sk#416), Statistics(sizeInBytes=4.30E+45 B)
               :- Project [ss_item_sk#416, ss_quantity#424, sr_return_quantity#14, cs_quantity#215, s_store_id#53, s_store_name#57], Statistics(sizeInBytes=7.56E+39 B)
               :  +- Join Inner, (s_store_sk#52 = ss_store_sk#421), Statistics(sizeInBytes=8.50E+39 B)
               :     :- Project [ss_item_sk#416, ss_store_sk#421, ss_quantity#424, sr_return_quantity#14, cs_quantity#215], Statistics(sizeInBytes=6.60E+35 B)
               :     :  +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#9621), Statistics(sizeInBytes=8.48E+35 B)
               :     :     :- Project [ss_item_sk#416, ss_store_sk#421, ss_quantity#424, sr_return_quantity#14, cs_sold_date_sk#197, cs_quantity#215], Statistics(sizeInBytes=7.87E+30 B)
               :     :     :  +- Join Inner, (sr_returned_date_sk#4 = d_date_sk#9593), Statistics(sizeInBytes=9.83E+30 B)
               :     :     :     :- Project [ss_item_sk#416, ss_store_sk#421, ss_quantity#424, sr_returned_date_sk#4, sr_return_quantity#14, cs_sold_date_sk#197, cs_quantity#215], Statistics(sizeInBytes=9.12E+25 B)
               :     :     :     :  +- Join Inner, (d_date_sk#24 = ss_sold_date_sk#414), Statistics(sizeInBytes=1.11E+26 B)
               :     :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_quantity#424, sr_returned_date_sk#4, sr_return_quantity#14, cs_sold_date_sk#197, cs_quantity#215], Statistics(sizeInBytes=896.4 EiB)
               :     :     :     :     :  +- Join Inner, ((sr_customer_sk#7 = cs_bill_customer_sk#200) AND (sr_item_sk#6 = cs_item_sk#212)), Statistics(sizeInBytes=1255.0 EiB)
               :     :     :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_quantity#424, sr_returned_date_sk#4, sr_item_sk#6, sr_customer_sk#7, sr_return_quantity#14], Statistics(sizeInBytes=100.8 TiB)
               :     :     :     :     :     :  +- Join Inner, (((ss_customer_sk#417 = sr_customer_sk#7) AND (ss_item_sk#416 = sr_item_sk#6)) AND (ss_ticket_number#423 = sr_ticket_number#13)), Statistics(sizeInBytes=131.0 TiB)
               :     :     :     :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_customer_sk#417, ss_store_sk#421, ss_ticket_number#423, ss_quantity#424], Statistics(sizeInBytes=30.5 MiB)
               :     :     :     :     :     :     :  +- Filter (((isnotnull(ss_customer_sk#417) AND isnotnull(ss_item_sk#416)) AND isnotnull(ss_ticket_number#423)) AND (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421))), Statistics(sizeInBytes=141.1 MiB)
               :     :     :     :     :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               :     :     :     :     :     :     +- Project [sr_returned_date_sk#4, sr_item_sk#6, sr_customer_sk#7, sr_ticket_number#13, sr_return_quantity#14], Statistics(sizeInBytes=4.3 MiB)
               :     :     :     :     :     :        +- Filter (((isnotnull(sr_customer_sk#7) AND isnotnull(sr_item_sk#6)) AND isnotnull(sr_ticket_number#13)) AND isnotnull(sr_returned_date_sk#4)), Statistics(sizeInBytes=19.0 MiB)
               :     :     :     :     :     :           +- Relation default.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet, Statistics(sizeInBytes=19.0 MiB)
               :     :     :     :     :     +- Project [cs_sold_date_sk#197, cs_bill_customer_sk#200, cs_item_sk#212, cs_quantity#215], Statistics(sizeInBytes=12.4 MiB)
               :     :     :     :     :        +- Filter ((isnotnull(cs_bill_customer_sk#200) AND isnotnull(cs_item_sk#212)) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
               :     :     :     :     :           +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
               :     :     :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :     :     :     :        +- Filter (((isnotnull(d_moy#32) AND isnotnull(d_year#30)) AND ((d_moy#32 = 9) AND (d_year#30 = 1999))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :     :     :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     :     :     +- Project [d_date_sk#9593], Statistics(sizeInBytes=105.3 KiB)
               :     :     :        +- Filter (((isnotnull(d_moy#9601) AND isnotnull(d_year#9599)) AND (((d_moy#9601 >= 9) AND (d_moy#9601 <= 12)) AND (d_year#9599 = 1999))) AND isnotnull(d_date_sk#9593)), Statistics(sizeInBytes=2.5 MiB)
               :     :     :           +- Relation default.date_dim[d_date_sk#9593,d_date_id#9594,d_date#9595,d_month_seq#9596,d_week_seq#9597,d_quarter_seq#9598,d_year#9599,d_dow#9600,d_moy#9601,d_dom#9602,d_qoy#9603,d_fy_year#9604,d_fy_quarter_seq#9605,d_fy_week_seq#9606,d_day_name#9607,d_quarter_name#9608,d_holiday#9609,d_weekend#9610,d_following_holiday#9611,d_first_dom#9612,d_last_dom#9613,d_same_day_ly#9614,d_same_day_lq#9615,d_current_day#9616,d_current_week#9617,d_current_month#9618,d_current_quarter#9619,d_current_year#9620] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     :     +- Project [d_date_sk#9621], Statistics(sizeInBytes=105.3 KiB)
               :     :        +- Filter (d_year#9627 IN (1999,2000,2001) AND isnotnull(d_date_sk#9621)), Statistics(sizeInBytes=2.5 MiB)
               :     :           +- Relation default.date_dim[d_date_sk#9621,d_date_id#9622,d_date#9623,d_month_seq#9624,d_week_seq#9625,d_quarter_seq#9626,d_year#9627,d_dow#9628,d_moy#9629,d_dom#9630,d_qoy#9631,d_fy_year#9632,d_fy_quarter_seq#9633,d_fy_week_seq#9634,d_day_name#9635,d_quarter_name#9636,d_holiday#9637,d_weekend#9638,d_following_holiday#9639,d_first_dom#9640,d_last_dom#9641,d_same_day_ly#9642,d_same_day_lq#9643,d_current_day#9644,d_current_week#9645,d_current_month#9646,d_current_quarter#9647,d_current_year#9648] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     +- Project [s_store_sk#52, s_store_id#53, s_store_name#57], Statistics(sizeInBytes=12.6 KiB)
               :        +- Filter isnotnull(s_store_sk#52), Statistics(sizeInBytes=101.7 KiB)
               :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
               +- Project [i_item_sk#437, i_item_id#438, i_item_desc#441], Statistics(sizeInBytes=556.2 KiB)
                  +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
                     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)

==== q30 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=18.8 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=2.61E+44 B)
   +- Sort [c_customer_id#82 ASC NULLS FIRST, c_salutation#88 ASC NULLS FIRST, c_first_name#89 ASC NULLS FIRST, c_last_name#90 ASC NULLS FIRST, c_preferred_cust_flag#91 ASC NULLS FIRST, c_birth_day#92 ASC NULLS FIRST, c_birth_month#93 ASC NULLS FIRST, c_birth_year#94 ASC NULLS FIRST, c_birth_country#95 ASC NULLS FIRST, c_login#96 ASC NULLS FIRST, c_email_address#97 ASC NULLS FIRST, c_last_review_date#98 ASC NULLS FIRST, ctr_total_return#9682 ASC NULLS FIRST], true, Statistics(sizeInBytes=2.61E+44 B)
      +- Project [c_customer_id#82, c_salutation#88, c_first_name#89, c_last_name#90, c_preferred_cust_flag#91, c_birth_day#92, c_birth_month#93, c_birth_year#94, c_birth_country#95, c_login#96, c_email_address#97, c_last_review_date#98, ctr_total_return#9682], Statistics(sizeInBytes=2.61E+44 B)
         +- Join Inner, (ca_address_sk#9683 = c_current_addr_sk#85), Statistics(sizeInBytes=2.72E+44 B)
            :- Project [ctr_total_return#9682, c_customer_id#82, c_current_addr_sk#85, c_salutation#88, c_first_name#89, c_last_name#90, c_preferred_cust_flag#91, c_birth_day#92, c_birth_month#93, c_birth_year#94, c_birth_country#95, c_login#96, c_email_address#97, c_last_review_date#98], Statistics(sizeInBytes=2.10E+39 B)
            :  +- Join Inner, (ctr_customer_sk#9680 = c_customer_sk#81), Statistics(sizeInBytes=2.19E+39 B)
            :     :- Project [ctr_customer_sk#9680, ctr_total_return#9682], Statistics(sizeInBytes=2.90E+32 B)
            :     :  +- Join Inner, ((cast(ctr_total_return#9682 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#9698) AND (ctr_state#9681 = ctr_state#9681#9713)), Statistics(sizeInBytes=1.10E+33 B)
            :     :     :- Filter isnotnull(ctr_total_return#9682), Statistics(sizeInBytes=28.1 PiB)
            :     :     :  +- Aggregate [wr_returning_customer_sk#3334, ca_state#3725], [wr_returning_customer_sk#3334 AS ctr_customer_sk#9680, ca_state#3725 AS ctr_state#9681, MakeDecimal(sum(UnscaledValue(wr_return_amt#3342)),17,2) AS ctr_total_return#9682], Statistics(sizeInBytes=28.1 PiB)
            :     :     :     +- Project [wr_returning_customer_sk#3334, wr_return_amt#3342, ca_state#3725], Statistics(sizeInBytes=28.1 PiB)
            :     :     :        +- Join Inner, (wr_returning_addr_sk#3337 = ca_address_sk#3717), Statistics(sizeInBytes=33.7 PiB)
            :     :     :           :- Project [wr_returning_customer_sk#3334, wr_returning_addr_sk#3337, wr_return_amt#3342], Statistics(sizeInBytes=102.7 GiB)
            :     :     :           :  +- Join Inner, (wr_returned_date_sk#3327 = d_date_sk#24), Statistics(sizeInBytes=136.9 GiB)
            :     :     :           :     :- Project [wr_returned_date_sk#3327, wr_returning_customer_sk#3334, wr_returning_addr_sk#3337, wr_return_amt#3342], Statistics(sizeInBytes=1331.1 KiB)
            :     :     :           :     :  +- Filter ((isnotnull(wr_returned_date_sk#3327) AND isnotnull(wr_returning_addr_sk#3337)) AND isnotnull(wr_returning_customer_sk#3334)), Statistics(sizeInBytes=6.5 MiB)
            :     :     :           :     :     +- Relation default.web_returns[wr_returned_date_sk#3327,wr_returned_time_sk#3328,wr_item_sk#3329,wr_refunded_customer_sk#3330,wr_refunded_cdemo_sk#3331,wr_refunded_hdemo_sk#3332,wr_refunded_addr_sk#3333,wr_returning_customer_sk#3334,wr_returning_cdemo_sk#3335,wr_returning_hdemo_sk#3336,wr_returning_addr_sk#3337,wr_web_page_sk#3338,wr_reason_sk#3339,wr_order_number#3340,wr_return_quantity#3341,wr_return_amt#3342,wr_return_tax#3343,wr_return_amt_inc_tax#3344,wr_fee#3345,wr_return_ship_cost#3346,wr_refunded_cash#3347,wr_reversed_charge#3348,wr_account_credit#3349,wr_net_loss#3350] parquet, Statistics(sizeInBytes=6.5 MiB)
            :     :     :           :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
            :     :     :           :        +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2002)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :     :     :           :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :     :           +- Project [ca_address_sk#3717, ca_state#3725], Statistics(sizeInBytes=336.4 KiB)
            :     :     :              +- Filter (isnotnull(ca_address_sk#3717) AND isnotnull(ca_state#3725)), Statistics(sizeInBytes=2.5 MiB)
            :     :     :                 +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :     +- Filter isnotnull((avg(ctr_total_return) * 1.2)#9698), Statistics(sizeInBytes=30.9 PiB)
            :     :        +- Aggregate [ctr_state#9681], [CheckOverflow((promote_precision(avg(ctr_total_return#9682)) * 1.200000), DecimalType(24,7)) AS (avg(ctr_total_return) * 1.2)#9698, ctr_state#9681 AS ctr_state#9681#9713], Statistics(sizeInBytes=30.9 PiB)
            :     :           +- Aggregate [wr_returning_customer_sk#3334, ca_state#3725], [ca_state#3725 AS ctr_state#9681, MakeDecimal(sum(UnscaledValue(wr_return_amt#3342)),17,2) AS ctr_total_return#9682], Statistics(sizeInBytes=25.3 PiB)
            :     :              +- Project [wr_returning_customer_sk#3334, wr_return_amt#3342, ca_state#3725], Statistics(sizeInBytes=28.1 PiB)
            :     :                 +- Join Inner, (wr_returning_addr_sk#3337 = ca_address_sk#3717), Statistics(sizeInBytes=33.7 PiB)
            :     :                    :- Project [wr_returning_customer_sk#3334, wr_returning_addr_sk#3337, wr_return_amt#3342], Statistics(sizeInBytes=102.7 GiB)
            :     :                    :  +- Join Inner, (wr_returned_date_sk#3327 = d_date_sk#24), Statistics(sizeInBytes=136.9 GiB)
            :     :                    :     :- Project [wr_returned_date_sk#3327, wr_returning_customer_sk#3334, wr_returning_addr_sk#3337, wr_return_amt#3342], Statistics(sizeInBytes=1331.1 KiB)
            :     :                    :     :  +- Filter (isnotnull(wr_returned_date_sk#3327) AND isnotnull(wr_returning_addr_sk#3337)), Statistics(sizeInBytes=6.5 MiB)
            :     :                    :     :     +- Relation default.web_returns[wr_returned_date_sk#3327,wr_returned_time_sk#3328,wr_item_sk#3329,wr_refunded_customer_sk#3330,wr_refunded_cdemo_sk#3331,wr_refunded_hdemo_sk#3332,wr_refunded_addr_sk#3333,wr_returning_customer_sk#3334,wr_returning_cdemo_sk#3335,wr_returning_hdemo_sk#3336,wr_returning_addr_sk#3337,wr_web_page_sk#3338,wr_reason_sk#3339,wr_order_number#3340,wr_return_quantity#3341,wr_return_amt#3342,wr_return_tax#3343,wr_return_amt_inc_tax#3344,wr_fee#3345,wr_return_ship_cost#3346,wr_refunded_cash#3347,wr_reversed_charge#3348,wr_account_credit#3349,wr_net_loss#3350] parquet, Statistics(sizeInBytes=6.5 MiB)
            :     :                    :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
            :     :                    :        +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2002)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :     :                    :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :                    +- Project [ca_address_sk#3717, ca_state#3725], Statistics(sizeInBytes=336.4 KiB)
            :     :                       +- Filter (isnotnull(ca_address_sk#3717) AND isnotnull(ca_state#3725)), Statistics(sizeInBytes=2.5 MiB)
            :     :                          +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     +- Project [c_customer_sk#81, c_customer_id#82, c_current_addr_sk#85, c_salutation#88, c_first_name#89, c_last_name#90, c_preferred_cust_flag#91, c_birth_day#92, c_birth_month#93, c_birth_year#94, c_birth_country#95, c_login#96, c_email_address#97, c_last_review_date#98], Statistics(sizeInBytes=7.2 MiB)
            :        +- Filter (isnotnull(c_customer_sk#81) AND isnotnull(c_current_addr_sk#85)), Statistics(sizeInBytes=7.8 MiB)
            :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
            +- Project [ca_address_sk#9683], Statistics(sizeInBytes=126.2 KiB)
               +- Filter ((isnotnull(ca_state#9691) AND (ca_state#9691 = GA)) AND isnotnull(ca_address_sk#9683)), Statistics(sizeInBytes=2.5 MiB)
                  +- Relation default.customer_address[ca_address_sk#9683,ca_address_id#9684,ca_street_number#9685,ca_street_name#9686,ca_street_type#9687,ca_suite_number#9688,ca_city#9689,ca_county#9690,ca_state#9691,ca_zip#9692,ca_country#9693,ca_gmt_offset#9694,ca_location_type#9695] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q31 ====
== Optimized Logical Plan ==
Sort [ca_county#3724 ASC NULLS FIRST], true, Statistics(sizeInBytes=2.13E+105 B)
+- Project [ca_county#3724, d_year#30, CheckOverflow((promote_precision(web_sales#9814) / promote_precision(web_sales#9757)), DecimalType(37,20)) AS web_q1_q2_increase#9752, CheckOverflow((promote_precision(store_sales#9806) / promote_precision(store_sales#9756)), DecimalType(37,20)) AS store_q1_q2_increase#9753, CheckOverflow((promote_precision(web_sales#9818) / promote_precision(web_sales#9814)), DecimalType(37,20)) AS web_q2_q3_increase#9754, CheckOverflow((promote_precision(store_sales#9810) / promote_precision(store_sales#9806)), DecimalType(37,20)) AS store_q2_q3_increase#9755], Statistics(sizeInBytes=2.13E+105 B)
   +- Join Inner, ((ca_county#9793 = ca_county#10382) AND (CASE WHEN (web_sales#9814 > 0.00) THEN CheckOverflow((promote_precision(web_sales#9818) / promote_precision(web_sales#9814)), DecimalType(37,20)) END > CASE WHEN (store_sales#9806 > 0.00) THEN CheckOverflow((promote_precision(store_sales#9810) / promote_precision(store_sales#9806)), DecimalType(37,20)) END)), Statistics(sizeInBytes=2.66E+105 B)
      :- Project [ca_county#3724, d_year#30, store_sales#9756, store_sales#9806, store_sales#9810, ca_county#9793, web_sales#9757, web_sales#9814], Statistics(sizeInBytes=1.24E+88 B)
      :  +- Join Inner, ((ca_county#9793 = ca_county#10306) AND (CASE WHEN (web_sales#9757 > 0.00) THEN CheckOverflow((promote_precision(web_sales#9814) / promote_precision(web_sales#9757)), DecimalType(37,20)) END > CASE WHEN (store_sales#9756 > 0.00) THEN CheckOverflow((promote_precision(store_sales#9806) / promote_precision(store_sales#9756)), DecimalType(37,20)) END)), Statistics(sizeInBytes=1.51E+88 B)
      :     :- Join Inner, (ca_county#3724 = ca_county#9793), Statistics(sizeInBytes=7.09E+70 B)
      :     :  :- Project [ca_county#3724, d_year#30, store_sales#9756, store_sales#9806, store_sales#9810], Statistics(sizeInBytes=3.31E+53 B)
      :     :  :  +- Join Inner, (ca_county#10165 = ca_county#10230), Statistics(sizeInBytes=5.68E+53 B)
      :     :  :     :- Join Inner, (ca_county#3724 = ca_county#10165), Statistics(sizeInBytes=7.11E+35 B)
      :     :  :     :  :- Aggregate [ca_county#3724, d_qoy#34, d_year#30], [ca_county#3724, d_year#30, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS store_sales#9756], Statistics(sizeInBytes=789.2 PiB)
      :     :  :     :  :  +- Project [ss_ext_sales_price#429, d_year#30, d_qoy#34, ca_county#3724], Statistics(sizeInBytes=868.1 PiB)
      :     :  :     :  :     +- Join Inner, (ss_addr_sk#420 = ca_address_sk#3717), Statistics(sizeInBytes=1025.9 PiB)
      :     :  :     :  :        :- Project [ss_addr_sk#420, ss_ext_sales_price#429, d_year#30, d_qoy#34], Statistics(sizeInBytes=3.0 TiB)
      :     :  :     :  :        :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=3.9 TiB)
      :     :  :     :  :        :     :- Project [ss_sold_date_sk#414, ss_addr_sk#420, ss_ext_sales_price#429], Statistics(sizeInBytes=22.9 MiB)
      :     :  :     :  :        :     :  +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_addr_sk#420)), Statistics(sizeInBytes=141.1 MiB)
      :     :  :     :  :        :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
      :     :  :     :  :        :     +- Project [d_date_sk#24, d_year#30, d_qoy#34], Statistics(sizeInBytes=175.5 KiB)
      :     :  :     :  :        :        +- Filter (((isnotnull(d_qoy#34) AND isnotnull(d_year#30)) AND ((d_qoy#34 = 1) AND (d_year#30 = 2000))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
      :     :  :     :  :        :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
      :     :  :     :  :        +- Project [ca_address_sk#3717, ca_county#3724], Statistics(sizeInBytes=336.4 KiB)
      :     :  :     :  :           +- Filter (isnotnull(ca_address_sk#3717) AND isnotnull(ca_county#3724)), Statistics(sizeInBytes=2.5 MiB)
      :     :  :     :  :              +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
      :     :  :     :  +- Aggregate [ca_county#10165, d_qoy#10140, d_year#10136], [ca_county#10165, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#10122)),17,2) AS store_sales#9806], Statistics(sizeInBytes=710.2 PiB)
      :     :  :     :     +- Project [ss_ext_sales_price#10122, d_year#10136, d_qoy#10140, ca_county#10165], Statistics(sizeInBytes=868.1 PiB)
      :     :  :     :        +- Join Inner, (ss_addr_sk#10113 = ca_address_sk#10158), Statistics(sizeInBytes=1025.9 PiB)
      :     :  :     :           :- Project [ss_addr_sk#10113, ss_ext_sales_price#10122, d_year#10136, d_qoy#10140], Statistics(sizeInBytes=3.0 TiB)
      :     :  :     :           :  +- Join Inner, (ss_sold_date_sk#10107 = d_date_sk#10130), Statistics(sizeInBytes=3.9 TiB)
      :     :  :     :           :     :- Project [ss_sold_date_sk#10107, ss_addr_sk#10113, ss_ext_sales_price#10122], Statistics(sizeInBytes=22.9 MiB)
      :     :  :     :           :     :  +- Filter (isnotnull(ss_sold_date_sk#10107) AND isnotnull(ss_addr_sk#10113)), Statistics(sizeInBytes=141.1 MiB)
      :     :  :     :           :     :     +- Relation default.store_sales[ss_sold_date_sk#10107,ss_sold_time_sk#10108,ss_item_sk#10109,ss_customer_sk#10110,ss_cdemo_sk#10111,ss_hdemo_sk#10112,ss_addr_sk#10113,ss_store_sk#10114,ss_promo_sk#10115,ss_ticket_number#10116,ss_quantity#10117,ss_wholesale_cost#10118,ss_list_price#10119,ss_sales_price#10120,ss_ext_discount_amt#10121,ss_ext_sales_price#10122,ss_ext_wholesale_cost#10123,ss_ext_list_price#10124,ss_ext_tax#10125,ss_coupon_amt#10126,ss_net_paid#10127,ss_net_paid_inc_tax#10128,ss_net_profit#10129] parquet, Statistics(sizeInBytes=141.1 MiB)
      :     :  :     :           :     +- Project [d_date_sk#10130, d_year#10136, d_qoy#10140], Statistics(sizeInBytes=175.5 KiB)
      :     :  :     :           :        +- Filter (((isnotnull(d_qoy#10140) AND isnotnull(d_year#10136)) AND ((d_qoy#10140 = 2) AND (d_year#10136 = 2000))) AND isnotnull(d_date_sk#10130)), Statistics(sizeInBytes=2.5 MiB)
      :     :  :     :           :           +- Relation default.date_dim[d_date_sk#10130,d_date_id#10131,d_date#10132,d_month_seq#10133,d_week_seq#10134,d_quarter_seq#10135,d_year#10136,d_dow#10137,d_moy#10138,d_dom#10139,d_qoy#10140,d_fy_year#10141,d_fy_quarter_seq#10142,d_fy_week_seq#10143,d_day_name#10144,d_quarter_name#10145,d_holiday#10146,d_weekend#10147,d_following_holiday#10148,d_first_dom#10149,d_last_dom#10150,d_same_day_ly#10151,d_same_day_lq#10152,d_current_day#10153,d_current_week#10154,d_current_month#10155,d_current_quarter#10156,d_current_year#10157] parquet, Statistics(sizeInBytes=2.5 MiB)
      :     :  :     :           +- Project [ca_address_sk#10158, ca_county#10165], Statistics(sizeInBytes=336.4 KiB)
      :     :  :     :              +- Filter (isnotnull(ca_address_sk#10158) AND isnotnull(ca_county#10165)), Statistics(sizeInBytes=2.5 MiB)
      :     :  :     :                 +- Relation default.customer_address[ca_address_sk#10158,ca_address_id#10159,ca_street_number#10160,ca_street_name#10161,ca_street_type#10162,ca_suite_number#10163,ca_city#10164,ca_county#10165,ca_state#10166,ca_zip#10167,ca_country#10168,ca_gmt_offset#10169,ca_location_type#10170] parquet, Statistics(sizeInBytes=2.5 MiB)
      :     :  :     +- Aggregate [ca_county#10230, d_qoy#10205, d_year#10201], [ca_county#10230, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#10187)),17,2) AS store_sales#9810], Statistics(sizeInBytes=710.2 PiB)
      :     :  :        +- Project [ss_ext_sales_price#10187, d_year#10201, d_qoy#10205, ca_county#10230], Statistics(sizeInBytes=868.1 PiB)
      :     :  :           +- Join Inner, (ss_addr_sk#10178 = ca_address_sk#10223), Statistics(sizeInBytes=1025.9 PiB)
      :     :  :              :- Project [ss_addr_sk#10178, ss_ext_sales_price#10187, d_year#10201, d_qoy#10205], Statistics(sizeInBytes=3.0 TiB)
      :     :  :              :  +- Join Inner, (ss_sold_date_sk#10172 = d_date_sk#10195), Statistics(sizeInBytes=3.9 TiB)
      :     :  :              :     :- Project [ss_sold_date_sk#10172, ss_addr_sk#10178, ss_ext_sales_price#10187], Statistics(sizeInBytes=22.9 MiB)
      :     :  :              :     :  +- Filter (isnotnull(ss_sold_date_sk#10172) AND isnotnull(ss_addr_sk#10178)), Statistics(sizeInBytes=141.1 MiB)
      :     :  :              :     :     +- Relation default.store_sales[ss_sold_date_sk#10172,ss_sold_time_sk#10173,ss_item_sk#10174,ss_customer_sk#10175,ss_cdemo_sk#10176,ss_hdemo_sk#10177,ss_addr_sk#10178,ss_store_sk#10179,ss_promo_sk#10180,ss_ticket_number#10181,ss_quantity#10182,ss_wholesale_cost#10183,ss_list_price#10184,ss_sales_price#10185,ss_ext_discount_amt#10186,ss_ext_sales_price#10187,ss_ext_wholesale_cost#10188,ss_ext_list_price#10189,ss_ext_tax#10190,ss_coupon_amt#10191,ss_net_paid#10192,ss_net_paid_inc_tax#10193,ss_net_profit#10194] parquet, Statistics(sizeInBytes=141.1 MiB)
      :     :  :              :     +- Project [d_date_sk#10195, d_year#10201, d_qoy#10205], Statistics(sizeInBytes=175.5 KiB)
      :     :  :              :        +- Filter (((isnotnull(d_qoy#10205) AND isnotnull(d_year#10201)) AND ((d_qoy#10205 = 3) AND (d_year#10201 = 2000))) AND isnotnull(d_date_sk#10195)), Statistics(sizeInBytes=2.5 MiB)
      :     :  :              :           +- Relation default.date_dim[d_date_sk#10195,d_date_id#10196,d_date#10197,d_month_seq#10198,d_week_seq#10199,d_quarter_seq#10200,d_year#10201,d_dow#10202,d_moy#10203,d_dom#10204,d_qoy#10205,d_fy_year#10206,d_fy_quarter_seq#10207,d_fy_week_seq#10208,d_day_name#10209,d_quarter_name#10210,d_holiday#10211,d_weekend#10212,d_following_holiday#10213,d_first_dom#10214,d_last_dom#10215,d_same_day_ly#10216,d_same_day_lq#10217,d_current_day#10218,d_current_week#10219,d_current_month#10220,d_current_quarter#10221,d_current_year#10222] parquet, Statistics(sizeInBytes=2.5 MiB)
      :     :  :              +- Project [ca_address_sk#10223, ca_county#10230], Statistics(sizeInBytes=336.4 KiB)
      :     :  :                 +- Filter (isnotnull(ca_address_sk#10223) AND isnotnull(ca_county#10230)), Statistics(sizeInBytes=2.5 MiB)
      :     :  :                    +- Relation default.customer_address[ca_address_sk#10223,ca_address_id#10224,ca_street_number#10225,ca_street_name#10226,ca_street_type#10227,ca_suite_number#10228,ca_city#10229,ca_county#10230,ca_state#10231,ca_zip#10232,ca_country#10233,ca_gmt_offset#10234,ca_location_type#10235] parquet, Statistics(sizeInBytes=2.5 MiB)
      :     :  +- Aggregate [ca_county#9793, d_qoy#9768, d_year#9764], [ca_county#9793, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#186)),17,2) AS web_sales#9757], Statistics(sizeInBytes=189.9 PiB)
      :     :     +- Project [ws_ext_sales_price#186, d_year#9764, d_qoy#9768, ca_county#9793], Statistics(sizeInBytes=232.1 PiB)
      :     :        +- Join Inner, (ws_bill_addr_sk#170 = ca_address_sk#9786), Statistics(sizeInBytes=274.3 PiB)
      :     :           :- Project [ws_bill_addr_sk#170, ws_ext_sales_price#186, d_year#9764, d_qoy#9768], Statistics(sizeInBytes=834.8 GiB)
      :     :           :  +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#9758), Statistics(sizeInBytes=1073.3 GiB)
      :     :           :     :- Project [ws_sold_date_sk#163, ws_bill_addr_sk#170, ws_ext_sales_price#186], Statistics(sizeInBytes=6.1 MiB)
      :     :           :     :  +- Filter (isnotnull(ws_sold_date_sk#163) AND isnotnull(ws_bill_addr_sk#170)), Statistics(sizeInBytes=52.0 MiB)
      :     :           :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
      :     :           :     +- Project [d_date_sk#9758, d_year#9764, d_qoy#9768], Statistics(sizeInBytes=175.5 KiB)
      :     :           :        +- Filter (((isnotnull(d_qoy#9768) AND isnotnull(d_year#9764)) AND ((d_qoy#9768 = 1) AND (d_year#9764 = 2000))) AND isnotnull(d_date_sk#9758)), Statistics(sizeInBytes=2.5 MiB)
      :     :           :           +- Relation default.date_dim[d_date_sk#9758,d_date_id#9759,d_date#9760,d_month_seq#9761,d_week_seq#9762,d_quarter_seq#9763,d_year#9764,d_dow#9765,d_moy#9766,d_dom#9767,d_qoy#9768,d_fy_year#9769,d_fy_quarter_seq#9770,d_fy_week_seq#9771,d_day_name#9772,d_quarter_name#9773,d_holiday#9774,d_weekend#9775,d_following_holiday#9776,d_first_dom#9777,d_last_dom#9778,d_same_day_ly#9779,d_same_day_lq#9780,d_current_day#9781,d_current_week#9782,d_current_month#9783,d_current_quarter#9784,d_current_year#9785] parquet, Statistics(sizeInBytes=2.5 MiB)
      :     :           +- Project [ca_address_sk#9786, ca_county#9793], Statistics(sizeInBytes=336.4 KiB)
      :     :              +- Filter (isnotnull(ca_address_sk#9786) AND isnotnull(ca_county#9793)), Statistics(sizeInBytes=2.5 MiB)
      :     :                 +- Relation default.customer_address[ca_address_sk#9786,ca_address_id#9787,ca_street_number#9788,ca_street_name#9789,ca_street_type#9790,ca_suite_number#9791,ca_city#9792,ca_county#9793,ca_state#9794,ca_zip#9795,ca_country#9796,ca_gmt_offset#9797,ca_location_type#9798] parquet, Statistics(sizeInBytes=2.5 MiB)
      :     +- Aggregate [ca_county#10306, d_qoy#10281, d_year#10277], [ca_county#10306, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#10260)),17,2) AS web_sales#9814], Statistics(sizeInBytes=189.9 PiB)
      :        +- Project [ws_ext_sales_price#10260, d_year#10277, d_qoy#10281, ca_county#10306], Statistics(sizeInBytes=232.1 PiB)
      :           +- Join Inner, (ws_bill_addr_sk#10244 = ca_address_sk#10299), Statistics(sizeInBytes=274.3 PiB)
      :              :- Project [ws_bill_addr_sk#10244, ws_ext_sales_price#10260, d_year#10277, d_qoy#10281], Statistics(sizeInBytes=834.8 GiB)
      :              :  +- Join Inner, (ws_sold_date_sk#10237 = d_date_sk#10271), Statistics(sizeInBytes=1073.3 GiB)
      :              :     :- Project [ws_sold_date_sk#10237, ws_bill_addr_sk#10244, ws_ext_sales_price#10260], Statistics(sizeInBytes=6.1 MiB)
      :              :     :  +- Filter (isnotnull(ws_sold_date_sk#10237) AND isnotnull(ws_bill_addr_sk#10244)), Statistics(sizeInBytes=52.0 MiB)
      :              :     :     +- Relation default.web_sales[ws_sold_date_sk#10237,ws_sold_time_sk#10238,ws_ship_date_sk#10239,ws_item_sk#10240,ws_bill_customer_sk#10241,ws_bill_cdemo_sk#10242,ws_bill_hdemo_sk#10243,ws_bill_addr_sk#10244,ws_ship_customer_sk#10245,ws_ship_cdemo_sk#10246,ws_ship_hdemo_sk#10247,ws_ship_addr_sk#10248,ws_web_page_sk#10249,ws_web_site_sk#10250,ws_ship_mode_sk#10251,ws_warehouse_sk#10252,ws_promo_sk#10253,ws_order_number#10254,ws_quantity#10255,ws_wholesale_cost#10256,ws_list_price#10257,ws_sales_price#10258,ws_ext_discount_amt#10259,ws_ext_sales_price#10260,ws_ext_wholesale_cost#10261,ws_ext_list_price#10262,ws_ext_tax#10263,ws_coupon_amt#10264,ws_ext_ship_cost#10265,ws_net_paid#10266,ws_net_paid_inc_tax#10267,ws_net_paid_inc_ship#10268,ws_net_paid_inc_ship_tax#10269,ws_net_profit#10270] parquet, Statistics(sizeInBytes=52.0 MiB)
      :              :     +- Project [d_date_sk#10271, d_year#10277, d_qoy#10281], Statistics(sizeInBytes=175.5 KiB)
      :              :        +- Filter (((isnotnull(d_qoy#10281) AND isnotnull(d_year#10277)) AND ((d_qoy#10281 = 2) AND (d_year#10277 = 2000))) AND isnotnull(d_date_sk#10271)), Statistics(sizeInBytes=2.5 MiB)
      :              :           +- Relation default.date_dim[d_date_sk#10271,d_date_id#10272,d_date#10273,d_month_seq#10274,d_week_seq#10275,d_quarter_seq#10276,d_year#10277,d_dow#10278,d_moy#10279,d_dom#10280,d_qoy#10281,d_fy_year#10282,d_fy_quarter_seq#10283,d_fy_week_seq#10284,d_day_name#10285,d_quarter_name#10286,d_holiday#10287,d_weekend#10288,d_following_holiday#10289,d_first_dom#10290,d_last_dom#10291,d_same_day_ly#10292,d_same_day_lq#10293,d_current_day#10294,d_current_week#10295,d_current_month#10296,d_current_quarter#10297,d_current_year#10298] parquet, Statistics(sizeInBytes=2.5 MiB)
      :              +- Project [ca_address_sk#10299, ca_county#10306], Statistics(sizeInBytes=336.4 KiB)
      :                 +- Filter (isnotnull(ca_address_sk#10299) AND isnotnull(ca_county#10306)), Statistics(sizeInBytes=2.5 MiB)
      :                    +- Relation default.customer_address[ca_address_sk#10299,ca_address_id#10300,ca_street_number#10301,ca_street_name#10302,ca_street_type#10303,ca_suite_number#10304,ca_city#10305,ca_county#10306,ca_state#10307,ca_zip#10308,ca_country#10309,ca_gmt_offset#10310,ca_location_type#10311] parquet, Statistics(sizeInBytes=2.5 MiB)
      +- Aggregate [ca_county#10382, d_qoy#10357, d_year#10353], [ca_county#10382, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#10336)),17,2) AS web_sales#9818], Statistics(sizeInBytes=189.9 PiB)
         +- Project [ws_ext_sales_price#10336, d_year#10353, d_qoy#10357, ca_county#10382], Statistics(sizeInBytes=232.1 PiB)
            +- Join Inner, (ws_bill_addr_sk#10320 = ca_address_sk#10375), Statistics(sizeInBytes=274.3 PiB)
               :- Project [ws_bill_addr_sk#10320, ws_ext_sales_price#10336, d_year#10353, d_qoy#10357], Statistics(sizeInBytes=834.8 GiB)
               :  +- Join Inner, (ws_sold_date_sk#10313 = d_date_sk#10347), Statistics(sizeInBytes=1073.3 GiB)
               :     :- Project [ws_sold_date_sk#10313, ws_bill_addr_sk#10320, ws_ext_sales_price#10336], Statistics(sizeInBytes=6.1 MiB)
               :     :  +- Filter (isnotnull(ws_sold_date_sk#10313) AND isnotnull(ws_bill_addr_sk#10320)), Statistics(sizeInBytes=52.0 MiB)
               :     :     +- Relation default.web_sales[ws_sold_date_sk#10313,ws_sold_time_sk#10314,ws_ship_date_sk#10315,ws_item_sk#10316,ws_bill_customer_sk#10317,ws_bill_cdemo_sk#10318,ws_bill_hdemo_sk#10319,ws_bill_addr_sk#10320,ws_ship_customer_sk#10321,ws_ship_cdemo_sk#10322,ws_ship_hdemo_sk#10323,ws_ship_addr_sk#10324,ws_web_page_sk#10325,ws_web_site_sk#10326,ws_ship_mode_sk#10327,ws_warehouse_sk#10328,ws_promo_sk#10329,ws_order_number#10330,ws_quantity#10331,ws_wholesale_cost#10332,ws_list_price#10333,ws_sales_price#10334,ws_ext_discount_amt#10335,ws_ext_sales_price#10336,ws_ext_wholesale_cost#10337,ws_ext_list_price#10338,ws_ext_tax#10339,ws_coupon_amt#10340,ws_ext_ship_cost#10341,ws_net_paid#10342,ws_net_paid_inc_tax#10343,ws_net_paid_inc_ship#10344,ws_net_paid_inc_ship_tax#10345,ws_net_profit#10346] parquet, Statistics(sizeInBytes=52.0 MiB)
               :     +- Project [d_date_sk#10347, d_year#10353, d_qoy#10357], Statistics(sizeInBytes=175.5 KiB)
               :        +- Filter (((isnotnull(d_qoy#10357) AND isnotnull(d_year#10353)) AND ((d_qoy#10357 = 3) AND (d_year#10353 = 2000))) AND isnotnull(d_date_sk#10347)), Statistics(sizeInBytes=2.5 MiB)
               :           +- Relation default.date_dim[d_date_sk#10347,d_date_id#10348,d_date#10349,d_month_seq#10350,d_week_seq#10351,d_quarter_seq#10352,d_year#10353,d_dow#10354,d_moy#10355,d_dom#10356,d_qoy#10357,d_fy_year#10358,d_fy_quarter_seq#10359,d_fy_week_seq#10360,d_day_name#10361,d_quarter_name#10362,d_holiday#10363,d_weekend#10364,d_following_holiday#10365,d_first_dom#10366,d_last_dom#10367,d_same_day_ly#10368,d_same_day_lq#10369,d_current_day#10370,d_current_week#10371,d_current_month#10372,d_current_quarter#10373,d_current_year#10374] parquet, Statistics(sizeInBytes=2.5 MiB)
               +- Project [ca_address_sk#10375, ca_county#10382], Statistics(sizeInBytes=336.4 KiB)
                  +- Filter (isnotnull(ca_address_sk#10375) AND isnotnull(ca_county#10382)), Statistics(sizeInBytes=2.5 MiB)
                     +- Relation default.customer_address[ca_address_sk#10375,ca_address_id#10376,ca_street_number#10377,ca_street_name#10378,ca_street_type#10379,ca_suite_number#10380,ca_city#10381,ca_county#10382,ca_state#10383,ca_zip#10384,ca_country#10385,ca_gmt_offset#10386,ca_location_type#10387] parquet, Statistics(sizeInBytes=2.5 MiB)

==== q32 ====
== Optimized Logical Plan ==
Aggregate [MakeDecimal(sum(UnscaledValue(cs_ext_discount_amt#219)),17,2) AS excess discount amount#10452], Statistics(sizeInBytes=16.0 B, rowCount=1)
+- Project [cs_ext_discount_amt#219], Statistics(sizeInBytes=5.91E+28 B)
   +- Join Inner, (d_date_sk#24 = cs_sold_date_sk#197), Statistics(sizeInBytes=8.86E+28 B)
      :- Project [cs_sold_date_sk#197, cs_ext_discount_amt#219], Statistics(sizeInBytes=8.21E+23 B)
      :  +- Join Inner, ((cast(cs_ext_discount_amt#219 as decimal(14,7)) > (1.3 * avg(cs_ext_discount_amt))#10455) AND (cs_item_sk#10471 = i_item_sk#437)), Statistics(sizeInBytes=1.48E+24 B)
      :     :- Project [cs_sold_date_sk#197, cs_ext_discount_amt#219, i_item_sk#437], Statistics(sizeInBytes=1369.6 GiB)
      :     :  +- Join Inner, (i_item_sk#437 = cs_item_sk#212), Statistics(sizeInBytes=1597.9 GiB)
      :     :     :- Project [cs_sold_date_sk#197, cs_item_sk#212, cs_ext_discount_amt#219], Statistics(sizeInBytes=12.4 MiB)
      :     :     :  +- Filter (isnotnull(cs_item_sk#212) AND (isnotnull(cs_ext_discount_amt#219) AND isnotnull(cs_sold_date_sk#197))), Statistics(sizeInBytes=105.8 MiB)
      :     :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
      :     :     +- Project [i_item_sk#437], Statistics(sizeInBytes=128.3 KiB)
      :     :        +- Filter ((isnotnull(i_manufact_id#450) AND (i_manufact_id#450 = 977)) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
      :     :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
      :     +- Filter isnotnull((1.3 * avg(cs_ext_discount_amt))#10455), Statistics(sizeInBytes=936.4 GiB)
      :        +- Aggregate [cs_item_sk#10471], [CheckOverflow((1.300000 * promote_precision(cast((avg(UnscaledValue(cs_ext_discount_amt#10478)) / 100.0) as decimal(11,6)))), DecimalType(14,7)) AS (1.3 * avg(cs_ext_discount_amt))#10455, cs_item_sk#10471], Statistics(sizeInBytes=936.4 GiB)
      :           +- Project [cs_item_sk#10471, cs_ext_discount_amt#10478], Statistics(sizeInBytes=936.4 GiB)
      :              +- Join Inner, (d_date_sk#10490 = cs_sold_date_sk#10456), Statistics(sizeInBytes=1311.0 GiB)
      :                 :- Project [cs_sold_date_sk#10456, cs_item_sk#10471, cs_ext_discount_amt#10478], Statistics(sizeInBytes=12.4 MiB)
      :                 :  +- Filter (isnotnull(cs_sold_date_sk#10456) AND isnotnull(cs_item_sk#10471)), Statistics(sizeInBytes=105.8 MiB)
      :                 :     +- Relation default.catalog_sales[cs_sold_date_sk#10456,cs_sold_time_sk#10457,cs_ship_date_sk#10458,cs_bill_customer_sk#10459,cs_bill_cdemo_sk#10460,cs_bill_hdemo_sk#10461,cs_bill_addr_sk#10462,cs_ship_customer_sk#10463,cs_ship_cdemo_sk#10464,cs_ship_hdemo_sk#10465,cs_ship_addr_sk#10466,cs_call_center_sk#10467,cs_catalog_page_sk#10468,cs_ship_mode_sk#10469,cs_warehouse_sk#10470,cs_item_sk#10471,cs_promo_sk#10472,cs_order_number#10473,cs_quantity#10474,cs_wholesale_cost#10475,cs_list_price#10476,cs_sales_price#10477,cs_ext_discount_amt#10478,cs_ext_sales_price#10479,cs_ext_wholesale_cost#10480,cs_ext_list_price#10481,cs_ext_tax#10482,cs_coupon_amt#10483,cs_ext_ship_cost#10484,cs_net_paid#10485,cs_net_paid_inc_tax#10486,cs_net_paid_inc_ship#10487,cs_net_paid_inc_ship_tax#10488,cs_net_profit#10489] parquet, Statistics(sizeInBytes=105.8 MiB)
      :                 +- Project [d_date_sk#10490], Statistics(sizeInBytes=105.3 KiB)
      :                    +- Filter ((isnotnull(d_date#10492) AND ((d_date#10492 >= 2000-01-27) AND (d_date#10492 <= 2000-04-26))) AND isnotnull(d_date_sk#10490)), Statistics(sizeInBytes=2.5 MiB)
      :                       +- Relation default.date_dim[d_date_sk#10490,d_date_id#10491,d_date#10492,d_month_seq#10493,d_week_seq#10494,d_quarter_seq#10495,d_year#10496,d_dow#10497,d_moy#10498,d_dom#10499,d_qoy#10500,d_fy_year#10501,d_fy_quarter_seq#10502,d_fy_week_seq#10503,d_day_name#10504,d_quarter_name#10505,d_holiday#10506,d_weekend#10507,d_following_holiday#10508,d_first_dom#10509,d_last_dom#10510,d_same_day_ly#10511,d_same_day_lq#10512,d_current_day#10513,d_current_week#10514,d_current_month#10515,d_current_quarter#10516,d_current_year#10517] parquet, Statistics(sizeInBytes=2.5 MiB)
      +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
         +- Filter ((isnotnull(d_date#26) AND ((d_date#26 >= 2000-01-27) AND (d_date#26 <= 2000-04-26))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q33 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=2.7 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=6.63E+22 B)
   +- Sort [total_sales#10542 ASC NULLS FIRST], true, Statistics(sizeInBytes=6.63E+22 B)
      +- Aggregate [i_manufact_id#450], [i_manufact_id#450, sum(total_sales#10543) AS total_sales#10542], Statistics(sizeInBytes=6.63E+22 B)
         +- Union false, false, Statistics(sizeInBytes=4.74E+22 B)
            :- Aggregate [i_manufact_id#450], [i_manufact_id#450, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS total_sales#10543], Statistics(sizeInBytes=2.61E+22 B)
            :  +- Project [ss_ext_sales_price#429, i_manufact_id#450], Statistics(sizeInBytes=2.61E+22 B)
            :     +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=3.66E+22 B)
            :        :- Project [ss_item_sk#416, ss_ext_sales_price#429], Statistics(sizeInBytes=185.5 PiB)
            :        :  +- Join Inner, (ss_addr_sk#420 = ca_address_sk#3717), Statistics(sizeInBytes=259.7 PiB)
            :        :     :- Project [ss_item_sk#416, ss_addr_sk#420, ss_ext_sales_price#429], Statistics(sizeInBytes=2.1 TiB)
            :        :     :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2.7 TiB)
            :        :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_addr_sk#420, ss_ext_sales_price#429], Statistics(sizeInBytes=26.7 MiB)
            :        :     :     :  +- Filter (isnotnull(ss_sold_date_sk#414) AND (isnotnull(ss_addr_sk#420) AND isnotnull(ss_item_sk#416))), Statistics(sizeInBytes=141.1 MiB)
            :        :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
            :        :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
            :        :     :        +- Filter (((isnotnull(d_year#30) AND isnotnull(d_moy#32)) AND ((d_year#30 = 1998) AND (d_moy#32 = 5))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :        :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :        :     +- Project [ca_address_sk#3717], Statistics(sizeInBytes=126.2 KiB)
            :        :        +- Filter ((isnotnull(ca_gmt_offset#3728) AND (ca_gmt_offset#3728 = -5.00)) AND isnotnull(ca_address_sk#3717)), Statistics(sizeInBytes=2.5 MiB)
            :        :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
            :        +- Join LeftSemi, (i_manufact_id#450 = i_manufact_id#10688), Statistics(sizeInBytes=171.1 KiB)
            :           :- Project [i_item_sk#437, i_manufact_id#450], Statistics(sizeInBytes=171.1 KiB)
            :           :  +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
            :           :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
            :           +- Project [i_manufact_id#10688], Statistics(sizeInBytes=128.3 KiB)
            :              +- Filter (isnotnull(i_category#10687) AND (i_category#10687 = Electronics                                       )), Statistics(sizeInBytes=3.1 MiB)
            :                 +- Relation default.item[i_item_sk#10675,i_item_id#10676,i_rec_start_date#10677,i_rec_end_date#10678,i_item_desc#10679,i_current_price#10680,i_wholesale_cost#10681,i_brand_id#10682,i_brand#10683,i_class_id#10684,i_class#10685,i_category_id#10686,i_category#10687,i_manufact_id#10688,i_manufact#10689,i_size#10690,i_formulation#10691,i_color#10692,i_units#10693,i_container#10694,i_manager_id#10695,i_product_name#10696] parquet, Statistics(sizeInBytes=3.1 MiB)
            :- Aggregate [i_manufact_id#10603], [i_manufact_id#10603, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#220)),17,2) AS total_sales#10545], Statistics(sizeInBytes=1.42E+22 B)
            :  +- Project [cs_ext_sales_price#220, i_manufact_id#10603], Statistics(sizeInBytes=1.42E+22 B)
            :     +- Join Inner, (cs_item_sk#212 = i_item_sk#10590), Statistics(sizeInBytes=1.99E+22 B)
            :        :- Project [cs_item_sk#212, cs_ext_sales_price#220], Statistics(sizeInBytes=100.9 PiB)
            :        :  +- Join Inner, (cs_bill_addr_sk#203 = ca_address_sk#10577), Statistics(sizeInBytes=141.3 PiB)
            :        :     :- Project [cs_bill_addr_sk#203, cs_item_sk#212, cs_ext_sales_price#220], Statistics(sizeInBytes=1147.1 GiB)
            :        :     :  +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#10549), Statistics(sizeInBytes=1529.5 GiB)
            :        :     :     :- Project [cs_sold_date_sk#197, cs_bill_addr_sk#203, cs_item_sk#212, cs_ext_sales_price#220], Statistics(sizeInBytes=14.5 MiB)
            :        :     :     :  +- Filter (isnotnull(cs_sold_date_sk#197) AND (isnotnull(cs_bill_addr_sk#203) AND isnotnull(cs_item_sk#212))), Statistics(sizeInBytes=105.8 MiB)
            :        :     :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
            :        :     :     +- Project [d_date_sk#10549], Statistics(sizeInBytes=105.3 KiB)
            :        :     :        +- Filter (((isnotnull(d_year#10555) AND isnotnull(d_moy#10557)) AND ((d_year#10555 = 1998) AND (d_moy#10557 = 5))) AND isnotnull(d_date_sk#10549)), Statistics(sizeInBytes=2.5 MiB)
            :        :     :           +- Relation default.date_dim[d_date_sk#10549,d_date_id#10550,d_date#10551,d_month_seq#10552,d_week_seq#10553,d_quarter_seq#10554,d_year#10555,d_dow#10556,d_moy#10557,d_dom#10558,d_qoy#10559,d_fy_year#10560,d_fy_quarter_seq#10561,d_fy_week_seq#10562,d_day_name#10563,d_quarter_name#10564,d_holiday#10565,d_weekend#10566,d_following_holiday#10567,d_first_dom#10568,d_last_dom#10569,d_same_day_ly#10570,d_same_day_lq#10571,d_current_day#10572,d_current_week#10573,d_current_month#10574,d_current_quarter#10575,d_current_year#10576] parquet, Statistics(sizeInBytes=2.5 MiB)
            :        :     +- Project [ca_address_sk#10577], Statistics(sizeInBytes=126.2 KiB)
            :        :        +- Filter ((isnotnull(ca_gmt_offset#10588) AND (ca_gmt_offset#10588 = -5.00)) AND isnotnull(ca_address_sk#10577)), Statistics(sizeInBytes=2.5 MiB)
            :        :           +- Relation default.customer_address[ca_address_sk#10577,ca_address_id#10578,ca_street_number#10579,ca_street_name#10580,ca_street_type#10581,ca_suite_number#10582,ca_city#10583,ca_county#10584,ca_state#10585,ca_zip#10586,ca_country#10587,ca_gmt_offset#10588,ca_location_type#10589] parquet, Statistics(sizeInBytes=2.5 MiB)
            :        +- Join LeftSemi, (i_manufact_id#10603 = i_manufact_id#10710), Statistics(sizeInBytes=171.1 KiB)
            :           :- Project [i_item_sk#10590, i_manufact_id#10603], Statistics(sizeInBytes=171.1 KiB)
            :           :  +- Filter isnotnull(i_item_sk#10590), Statistics(sizeInBytes=3.1 MiB)
            :           :     +- Relation default.item[i_item_sk#10590,i_item_id#10591,i_rec_start_date#10592,i_rec_end_date#10593,i_item_desc#10594,i_current_price#10595,i_wholesale_cost#10596,i_brand_id#10597,i_brand#10598,i_class_id#10599,i_class#10600,i_category_id#10601,i_category#10602,i_manufact_id#10603,i_manufact#10604,i_size#10605,i_formulation#10606,i_color#10607,i_units#10608,i_container#10609,i_manager_id#10610,i_product_name#10611] parquet, Statistics(sizeInBytes=3.1 MiB)
            :           +- Project [i_manufact_id#10710], Statistics(sizeInBytes=128.3 KiB)
            :              +- Filter (isnotnull(i_category#10709) AND (i_category#10709 = Electronics                                       )), Statistics(sizeInBytes=3.1 MiB)
            :                 +- Relation default.item[i_item_sk#10697,i_item_id#10698,i_rec_start_date#10699,i_rec_end_date#10700,i_item_desc#10701,i_current_price#10702,i_wholesale_cost#10703,i_brand_id#10704,i_brand#10705,i_class_id#10706,i_class#10707,i_category_id#10708,i_category#10709,i_manufact_id#10710,i_manufact#10711,i_size#10712,i_formulation#10713,i_color#10714,i_units#10715,i_container#10716,i_manager_id#10717,i_product_name#10718] parquet, Statistics(sizeInBytes=3.1 MiB)
            +- Aggregate [i_manufact_id#10666], [i_manufact_id#10666, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#186)),17,2) AS total_sales#10547], Statistics(sizeInBytes=6.99E+21 B)
               +- Project [ws_ext_sales_price#186, i_manufact_id#10666], Statistics(sizeInBytes=6.99E+21 B)
                  +- Join Inner, (ws_item_sk#166 = i_item_sk#10653), Statistics(sizeInBytes=9.78E+21 B)
                     :- Project [ws_item_sk#166, ws_ext_sales_price#186], Statistics(sizeInBytes=49.6 PiB)
                     :  +- Join Inner, (ws_bill_addr_sk#170 = ca_address_sk#10640), Statistics(sizeInBytes=69.4 PiB)
                     :     :- Project [ws_item_sk#166, ws_bill_addr_sk#170, ws_ext_sales_price#186], Statistics(sizeInBytes=563.5 GiB)
                     :     :  +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#10612), Statistics(sizeInBytes=751.3 GiB)
                     :     :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_bill_addr_sk#170, ws_ext_sales_price#186], Statistics(sizeInBytes=7.1 MiB)
                     :     :     :  +- Filter (isnotnull(ws_sold_date_sk#163) AND (isnotnull(ws_bill_addr_sk#170) AND isnotnull(ws_item_sk#166))), Statistics(sizeInBytes=52.0 MiB)
                     :     :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                     :     :     +- Project [d_date_sk#10612], Statistics(sizeInBytes=105.3 KiB)
                     :     :        +- Filter (((isnotnull(d_year#10618) AND isnotnull(d_moy#10620)) AND ((d_year#10618 = 1998) AND (d_moy#10620 = 5))) AND isnotnull(d_date_sk#10612)), Statistics(sizeInBytes=2.5 MiB)
                     :     :           +- Relation default.date_dim[d_date_sk#10612,d_date_id#10613,d_date#10614,d_month_seq#10615,d_week_seq#10616,d_quarter_seq#10617,d_year#10618,d_dow#10619,d_moy#10620,d_dom#10621,d_qoy#10622,d_fy_year#10623,d_fy_quarter_seq#10624,d_fy_week_seq#10625,d_day_name#10626,d_quarter_name#10627,d_holiday#10628,d_weekend#10629,d_following_holiday#10630,d_first_dom#10631,d_last_dom#10632,d_same_day_ly#10633,d_same_day_lq#10634,d_current_day#10635,d_current_week#10636,d_current_month#10637,d_current_quarter#10638,d_current_year#10639] parquet, Statistics(sizeInBytes=2.5 MiB)
                     :     +- Project [ca_address_sk#10640], Statistics(sizeInBytes=126.2 KiB)
                     :        +- Filter ((isnotnull(ca_gmt_offset#10651) AND (ca_gmt_offset#10651 = -5.00)) AND isnotnull(ca_address_sk#10640)), Statistics(sizeInBytes=2.5 MiB)
                     :           +- Relation default.customer_address[ca_address_sk#10640,ca_address_id#10641,ca_street_number#10642,ca_street_name#10643,ca_street_type#10644,ca_suite_number#10645,ca_city#10646,ca_county#10647,ca_state#10648,ca_zip#10649,ca_country#10650,ca_gmt_offset#10651,ca_location_type#10652] parquet, Statistics(sizeInBytes=2.5 MiB)
                     +- Join LeftSemi, (i_manufact_id#10666 = i_manufact_id#10732), Statistics(sizeInBytes=171.1 KiB)
                        :- Project [i_item_sk#10653, i_manufact_id#10666], Statistics(sizeInBytes=171.1 KiB)
                        :  +- Filter isnotnull(i_item_sk#10653), Statistics(sizeInBytes=3.1 MiB)
                        :     +- Relation default.item[i_item_sk#10653,i_item_id#10654,i_rec_start_date#10655,i_rec_end_date#10656,i_item_desc#10657,i_current_price#10658,i_wholesale_cost#10659,i_brand_id#10660,i_brand#10661,i_class_id#10662,i_class#10663,i_category_id#10664,i_category#10665,i_manufact_id#10666,i_manufact#10667,i_size#10668,i_formulation#10669,i_color#10670,i_units#10671,i_container#10672,i_manager_id#10673,i_product_name#10674] parquet, Statistics(sizeInBytes=3.1 MiB)
                        +- Project [i_manufact_id#10732], Statistics(sizeInBytes=128.3 KiB)
                           +- Filter (isnotnull(i_category#10731) AND (i_category#10731 = Electronics                                       )), Statistics(sizeInBytes=3.1 MiB)
                              +- Relation default.item[i_item_sk#10719,i_item_id#10720,i_rec_start_date#10721,i_rec_end_date#10722,i_item_desc#10723,i_current_price#10724,i_wholesale_cost#10725,i_brand_id#10726,i_brand#10727,i_class_id#10728,i_class#10729,i_category_id#10730,i_category#10731,i_manufact_id#10732,i_manufact#10733,i_size#10734,i_formulation#10735,i_color#10736,i_units#10737,i_container#10738,i_manager_id#10739,i_product_name#10740] parquet, Statistics(sizeInBytes=3.1 MiB)

==== q36 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=6.7 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.35E+22 B)
   +- Sort [lochierarchy#10792 DESC NULLS LAST, CASE WHEN (lochierarchy#10792 = 0) THEN i_category#10803 END ASC NULLS FIRST, rank_within_parent#10793 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.35E+22 B)
      +- Project [gross_margin#10791, i_category#10803, i_class#10804, lochierarchy#10792, rank_within_parent#10793], Statistics(sizeInBytes=1.35E+22 B)
         +- Window [rank(_w3#10819) windowspecdefinition(_w1#10817, _w2#10818, _w3#10819 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#10793], [_w1#10817, _w2#10818], [_w3#10819 ASC NULLS FIRST], Statistics(sizeInBytes=2.08E+22 B)
            +- Aggregate [i_category#10803, i_class#10804, spark_grouping_id#10802L], [CheckOverflow((promote_precision(MakeDecimal(sum(UnscaledValue(ss_net_profit#436)),17,2)) / promote_precision(MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2))), DecimalType(37,20)) AS gross_margin#10791, i_category#10803, i_class#10804, (cast((shiftright(spark_grouping_id#10802L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#10802L, 0) & 1) as tinyint)) AS lochierarchy#10792, (cast((shiftright(spark_grouping_id#10802L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#10802L, 0) & 1) as tinyint)) AS _w1#10817, CASE WHEN (cast((shiftright(spark_grouping_id#10802L, 0) & 1) as tinyint) = 0) THEN i_category#10803 END AS _w2#10818, CheckOverflow((promote_precision(MakeDecimal(sum(UnscaledValue(ss_net_profit#436)),17,2)) / promote_precision(MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2))), DecimalType(37,20)) AS _w3#10819], Statistics(sizeInBytes=2.00E+22 B)
               +- Expand [[ss_ext_sales_price#429, ss_net_profit#436, i_category#449, i_class#447, 0], [ss_ext_sales_price#429, ss_net_profit#436, i_category#449, null, 1], [ss_ext_sales_price#429, ss_net_profit#436, null, null, 3]], [ss_ext_sales_price#429, ss_net_profit#436, i_category#10803, i_class#10804, spark_grouping_id#10802L], Statistics(sizeInBytes=1.41E+22 B)
                  +- Project [ss_ext_sales_price#429, ss_net_profit#436, i_category#449, i_class#447], Statistics(sizeInBytes=4.18E+21 B)
                     +- Join Inner, (s_store_sk#52 = ss_store_sk#421), Statistics(sizeInBytes=4.70E+21 B)
                        :- Project [ss_store_sk#421, ss_ext_sales_price#429, ss_net_profit#436, i_class#447, i_category#449], Statistics(sizeInBytes=1404.9 PiB)
                        :  +- Join Inner, (i_item_sk#437 = ss_item_sk#416), Statistics(sizeInBytes=1570.1 PiB)
                        :     :- Project [ss_item_sk#416, ss_store_sk#421, ss_ext_sales_price#429, ss_net_profit#436], Statistics(sizeInBytes=2.8 TiB)
                        :     :  +- Join Inner, (d_date_sk#24 = ss_sold_date_sk#414), Statistics(sizeInBytes=3.5 TiB)
                        :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_ext_sales_price#429, ss_net_profit#436], Statistics(sizeInBytes=34.3 MiB)
                        :     :     :  +- Filter (isnotnull(ss_sold_date_sk#414) AND (isnotnull(ss_item_sk#416) AND isnotnull(ss_store_sk#421))), Statistics(sizeInBytes=141.1 MiB)
                        :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                        :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                        :     :        +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2001)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                        :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                        :     +- Project [i_item_sk#437, i_class#447, i_category#449], Statistics(sizeInBytes=556.2 KiB)
                        :        +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
                        :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
                        +- Project [s_store_sk#52], Statistics(sizeInBytes=2.9 KiB)
                           +- Filter ((isnotnull(s_state#76) AND (s_state#76 = TN)) AND isnotnull(s_store_sk#52)), Statistics(sizeInBytes=101.7 KiB)
                              +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)

==== q37 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=5.5 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=8.97E+24 B)
   +- Sort [i_item_id#438 ASC NULLS FIRST], true, Statistics(sizeInBytes=8.97E+24 B)
      +- Aggregate [i_item_id#438, i_item_desc#441, i_current_price#442], [i_item_id#438, i_item_desc#441, i_current_price#442], Statistics(sizeInBytes=8.97E+24 B)
         +- Project [i_item_id#438, i_item_desc#441, i_current_price#442], Statistics(sizeInBytes=8.97E+24 B)
            +- Join Inner, (cs_item_sk#212 = i_item_sk#437), Statistics(sizeInBytes=1.03E+25 B)
               :- Project [i_item_sk#437, i_item_id#438, i_item_desc#441, i_current_price#442], Statistics(sizeInBytes=1394.8 PiB)
               :  +- Join Inner, (d_date_sk#24 = inv_date_sk#8005), Statistics(sizeInBytes=1580.8 PiB)
               :     :- Project [i_item_sk#437, i_item_id#438, i_item_desc#441, i_current_price#442, inv_date_sk#8005], Statistics(sizeInBytes=15.0 TiB)
               :     :  +- Join Inner, (inv_item_sk#8006 = i_item_sk#437), Statistics(sizeInBytes=15.9 TiB)
               :     :     :- Project [i_item_sk#437, i_item_id#438, i_item_desc#441, i_current_price#442], Statistics(sizeInBytes=641.8 KiB)
               :     :     :  +- Filter ((isnotnull(i_current_price#442) AND (((i_current_price#442 >= 68.00) AND (i_current_price#442 <= 98.00)) AND i_manufact_id#450 IN (677,940,694,808))) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
               :     :     :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
               :     :     +- Project [inv_date_sk#8005, inv_item_sk#8006], Statistics(sizeInBytes=25.4 MiB)
               :     :        +- Filter ((isnotnull(inv_quantity_on_hand#8008) AND ((inv_quantity_on_hand#8008 >= 100) AND (inv_quantity_on_hand#8008 <= 500))) AND (isnotnull(inv_item_sk#8006) AND isnotnull(inv_date_sk#8005))), Statistics(sizeInBytes=38.2 MiB)
               :     :           +- Relation default.inventory[inv_date_sk#8005,inv_item_sk#8006,inv_warehouse_sk#8007,inv_quantity_on_hand#8008] parquet, Statistics(sizeInBytes=38.2 MiB)
               :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :        +- Filter ((isnotnull(d_date#26) AND ((d_date#26 >= 2000-02-01) AND (d_date#26 <= 2000-04-01))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               +- Project [cs_item_sk#212], Statistics(sizeInBytes=6.2 MiB)
                  +- Filter isnotnull(cs_item_sk#212), Statistics(sizeInBytes=105.8 MiB)
                     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)

==== q38 ====
== Optimized Logical Plan ==
Aggregate [count(1) AS count(1)#10941L], Statistics(sizeInBytes=16.0 B, rowCount=1)
+- Project, Statistics(sizeInBytes=371.1 PiB)
   +- Join LeftSemi, (((c_last_name#90 <=> c_last_name#10932) AND (c_first_name#89 <=> c_first_name#10931)) AND (d_date#26 <=> d_date#10897)), Statistics(sizeInBytes=2.4 EiB)
      :- Join LeftSemi, (((c_last_name#90 <=> c_last_name#10886) AND (c_first_name#89 <=> c_first_name#10885)) AND (d_date#26 <=> d_date#10851)), Statistics(sizeInBytes=2.4 EiB)
      :  :- Aggregate [c_last_name#90, c_first_name#89, d_date#26], [c_last_name#90, c_first_name#89, d_date#26], Statistics(sizeInBytes=2.4 EiB)
      :  :  +- Project [c_last_name#90, c_first_name#89, d_date#26], Statistics(sizeInBytes=2.4 EiB)
      :  :     +- Join Inner, (ss_customer_sk#417 = c_customer_sk#81), Statistics(sizeInBytes=2.7 EiB)
      :  :        :- Project [ss_customer_sk#417, d_date#26], Statistics(sizeInBytes=1427.6 GiB)
      :  :        :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2.1 TiB)
      :  :        :     :- Project [ss_sold_date_sk#414, ss_customer_sk#417], Statistics(sizeInBytes=15.3 MiB)
      :  :        :     :  +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_customer_sk#417)), Statistics(sizeInBytes=141.1 MiB)
      :  :        :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
      :  :        :     +- Project [d_date_sk#24, d_date#26], Statistics(sizeInBytes=140.4 KiB)
      :  :        :        +- Filter ((isnotnull(d_month_seq#27) AND ((d_month_seq#27 >= 1200) AND (d_month_seq#27 <= 1211))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
      :  :        :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
      :  :        +- Project [c_customer_sk#81, c_first_name#89, c_last_name#90], Statistics(sizeInBytes=1996.3 KiB)
      :  :           +- Filter isnotnull(c_customer_sk#81), Statistics(sizeInBytes=7.8 MiB)
      :  :              +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
      :  +- Aggregate [c_last_name#10886, c_first_name#10885, d_date#10851], [c_last_name#10886, c_first_name#10885, d_date#10851], Statistics(sizeInBytes=1312.6 PiB)
      :     +- Project [c_last_name#10886, c_first_name#10885, d_date#10851], Statistics(sizeInBytes=1312.6 PiB)
      :        +- Join Inner, (cs_bill_customer_sk#200 = c_customer_sk#10877), Statistics(sizeInBytes=1514.5 PiB)
      :           :- Project [cs_bill_customer_sk#200, d_date#10851], Statistics(sizeInBytes=776.9 GiB)
      :           :  +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#10849), Statistics(sizeInBytes=1165.3 GiB)
      :           :     :- Project [cs_sold_date_sk#197, cs_bill_customer_sk#200], Statistics(sizeInBytes=8.3 MiB)
      :           :     :  +- Filter (isnotnull(cs_sold_date_sk#197) AND isnotnull(cs_bill_customer_sk#200)), Statistics(sizeInBytes=105.8 MiB)
      :           :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
      :           :     +- Project [d_date_sk#10849, d_date#10851], Statistics(sizeInBytes=140.4 KiB)
      :           :        +- Filter ((isnotnull(d_month_seq#10852) AND ((d_month_seq#10852 >= 1200) AND (d_month_seq#10852 <= 1211))) AND isnotnull(d_date_sk#10849)), Statistics(sizeInBytes=2.5 MiB)
      :           :           +- Relation default.date_dim[d_date_sk#10849,d_date_id#10850,d_date#10851,d_month_seq#10852,d_week_seq#10853,d_quarter_seq#10854,d_year#10855,d_dow#10856,d_moy#10857,d_dom#10858,d_qoy#10859,d_fy_year#10860,d_fy_quarter_seq#10861,d_fy_week_seq#10862,d_day_name#10863,d_quarter_name#10864,d_holiday#10865,d_weekend#10866,d_following_holiday#10867,d_first_dom#10868,d_last_dom#10869,d_same_day_ly#10870,d_same_day_lq#10871,d_current_day#10872,d_current_week#10873,d_current_month#10874,d_current_quarter#10875,d_current_year#10876] parquet, Statistics(sizeInBytes=2.5 MiB)
      :           +- Project [c_customer_sk#10877, c_first_name#10885, c_last_name#10886], Statistics(sizeInBytes=1996.3 KiB)
      :              +- Filter isnotnull(c_customer_sk#10877), Statistics(sizeInBytes=7.8 MiB)
      :                 +- Relation default.customer[c_customer_sk#10877,c_customer_id#10878,c_current_cdemo_sk#10879,c_current_hdemo_sk#10880,c_current_addr_sk#10881,c_first_shipto_date_sk#10882,c_first_sales_date_sk#10883,c_salutation#10884,c_first_name#10885,c_last_name#10886,c_preferred_cust_flag#10887,c_birth_day#10888,c_birth_month#10889,c_birth_year#10890,c_birth_country#10891,c_login#10892,c_email_address#10893,c_last_review_date#10894] parquet, Statistics(sizeInBytes=7.8 MiB)
      +- Aggregate [c_last_name#10932, c_first_name#10931, d_date#10897], [c_last_name#10932, c_first_name#10931, d_date#10897], Statistics(sizeInBytes=644.8 PiB)
         +- Project [c_last_name#10932, c_first_name#10931, d_date#10897], Statistics(sizeInBytes=644.8 PiB)
            +- Join Inner, (ws_bill_customer_sk#167 = c_customer_sk#10923), Statistics(sizeInBytes=744.0 PiB)
               :- Project [ws_bill_customer_sk#167, d_date#10897], Statistics(sizeInBytes=381.6 GiB)
               :  +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#10895), Statistics(sizeInBytes=572.4 GiB)
               :     :- Project [ws_sold_date_sk#163, ws_bill_customer_sk#167], Statistics(sizeInBytes=4.1 MiB)
               :     :  +- Filter (isnotnull(ws_sold_date_sk#163) AND isnotnull(ws_bill_customer_sk#167)), Statistics(sizeInBytes=52.0 MiB)
               :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
               :     +- Project [d_date_sk#10895, d_date#10897], Statistics(sizeInBytes=140.4 KiB)
               :        +- Filter ((isnotnull(d_month_seq#10898) AND ((d_month_seq#10898 >= 1200) AND (d_month_seq#10898 <= 1211))) AND isnotnull(d_date_sk#10895)), Statistics(sizeInBytes=2.5 MiB)
               :           +- Relation default.date_dim[d_date_sk#10895,d_date_id#10896,d_date#10897,d_month_seq#10898,d_week_seq#10899,d_quarter_seq#10900,d_year#10901,d_dow#10902,d_moy#10903,d_dom#10904,d_qoy#10905,d_fy_year#10906,d_fy_quarter_seq#10907,d_fy_week_seq#10908,d_day_name#10909,d_quarter_name#10910,d_holiday#10911,d_weekend#10912,d_following_holiday#10913,d_first_dom#10914,d_last_dom#10915,d_same_day_ly#10916,d_same_day_lq#10917,d_current_day#10918,d_current_week#10919,d_current_month#10920,d_current_quarter#10921,d_current_year#10922] parquet, Statistics(sizeInBytes=2.5 MiB)
               +- Project [c_customer_sk#10923, c_first_name#10931, c_last_name#10932], Statistics(sizeInBytes=1996.3 KiB)
                  +- Filter isnotnull(c_customer_sk#10923), Statistics(sizeInBytes=7.8 MiB)
                     +- Relation default.customer[c_customer_sk#10923,c_customer_id#10924,c_current_cdemo_sk#10925,c_current_hdemo_sk#10926,c_current_addr_sk#10927,c_first_shipto_date_sk#10928,c_first_sales_date_sk#10929,c_salutation#10930,c_first_name#10931,c_last_name#10932,c_preferred_cust_flag#10933,c_birth_day#10934,c_birth_month#10935,c_birth_year#10936,c_birth_country#10937,c_login#10938,c_email_address#10939,c_last_review_date#10940] parquet, Statistics(sizeInBytes=7.8 MiB)

==== q39a ====
== Optimized Logical Plan ==
Sort [w_warehouse_sk#8009 ASC NULLS FIRST, i_item_sk#437 ASC NULLS FIRST, d_moy#32 ASC NULLS FIRST, mean#10950 ASC NULLS FIRST, cov#10951 ASC NULLS FIRST, d_moy#11136 ASC NULLS FIRST, mean#10983 ASC NULLS FIRST, cov#10984 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.33E+42 B)
+- Join Inner, ((i_item_sk#437 = i_item_sk#11092) AND (w_warehouse_sk#8009 = w_warehouse_sk#11114)), Statistics(sizeInBytes=1.33E+42 B)
   :- Project [w_warehouse_sk#8009, i_item_sk#437, d_moy#32, mean#10950, CASE WHEN (mean#10950 = 0.0) THEN null ELSE (stdev#10949 / mean#10950) END AS cov#10951], Statistics(sizeInBytes=1001.4 EiB)
   :  +- Filter CASE WHEN (mean#10950 = 0.0) THEN false ELSE ((stdev#10949 / mean#10950) > 1.0) END, Statistics(sizeInBytes=1001.4 EiB)
   :     +- Aggregate [w_warehouse_name#8011, w_warehouse_sk#8009, i_item_sk#437, d_moy#32], [w_warehouse_sk#8009, i_item_sk#437, d_moy#32, stddev_samp(cast(inv_quantity_on_hand#8008 as double)) AS stdev#10949, avg(inv_quantity_on_hand#8008) AS mean#10950], Statistics(sizeInBytes=1001.4 EiB)
   :        +- Project [inv_quantity_on_hand#8008, i_item_sk#437, w_warehouse_sk#8009, w_warehouse_name#8011, d_moy#32], Statistics(sizeInBytes=1223.9 EiB)
   :           +- Join Inner, (inv_date_sk#8005 = d_date_sk#24), Statistics(sizeInBytes=1446.5 EiB)
   :              :- Project [inv_date_sk#8005, inv_quantity_on_hand#8008, i_item_sk#437, w_warehouse_sk#8009, w_warehouse_name#8011], Statistics(sizeInBytes=10.3 PiB)
   :              :  +- Join Inner, (inv_warehouse_sk#8007 = w_warehouse_sk#8009), Statistics(sizeInBytes=11.2 PiB)
   :              :     :- Project [inv_date_sk#8005, inv_warehouse_sk#8007, inv_quantity_on_hand#8008, i_item_sk#437], Statistics(sizeInBytes=4.1 TiB)
   :              :     :  +- Join Inner, (inv_item_sk#8006 = i_item_sk#437), Statistics(sizeInBytes=4.8 TiB)
   :              :     :     :- Filter (isnotnull(inv_item_sk#8006) AND (isnotnull(inv_warehouse_sk#8007) AND isnotnull(inv_date_sk#8005))), Statistics(sizeInBytes=38.2 MiB)
   :              :     :     :  +- Relation default.inventory[inv_date_sk#8005,inv_item_sk#8006,inv_warehouse_sk#8007,inv_quantity_on_hand#8008] parquet, Statistics(sizeInBytes=38.2 MiB)
   :              :     :     +- Project [i_item_sk#437], Statistics(sizeInBytes=128.3 KiB)
   :              :     :        +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
   :              :     :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
   :              :     +- Project [w_warehouse_sk#8009, w_warehouse_name#8011], Statistics(sizeInBytes=2.7 KiB)
   :              :        +- Filter isnotnull(w_warehouse_sk#8009), Statistics(sizeInBytes=20.9 KiB)
   :              :           +- Relation default.warehouse[w_warehouse_sk#8009,w_warehouse_id#8010,w_warehouse_name#8011,w_warehouse_sq_ft#8012,w_street_number#8013,w_street_name#8014,w_street_type#8015,w_suite_number#8016,w_city#8017,w_county#8018,w_state#8019,w_zip#8020,w_country#8021,w_gmt_offset#8022] parquet, Statistics(sizeInBytes=20.9 KiB)
   :              +- Project [d_date_sk#24, d_moy#32], Statistics(sizeInBytes=140.4 KiB)
   :                 +- Filter (((isnotnull(d_year#30) AND isnotnull(d_moy#32)) AND ((d_year#30 = 2001) AND (d_moy#32 = 1))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
   :                    +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
   +- Project [w_warehouse_sk#11114, i_item_sk#11092, d_moy#11136, mean#10950 AS mean#10983, CASE WHEN (mean#10950 = 0.0) THEN null ELSE (stdev#10949 / mean#10950) END AS cov#10984], Statistics(sizeInBytes=1001.4 EiB)
      +- Filter CASE WHEN (mean#10950 = 0.0) THEN false ELSE ((stdev#10949 / mean#10950) > 1.0) END, Statistics(sizeInBytes=1001.4 EiB)
         +- Aggregate [w_warehouse_name#11116, w_warehouse_sk#11114, i_item_sk#11092, d_moy#11136], [w_warehouse_sk#11114, i_item_sk#11092, d_moy#11136, stddev_samp(cast(inv_quantity_on_hand#11091 as double)) AS stdev#10949, avg(inv_quantity_on_hand#11091) AS mean#10950], Statistics(sizeInBytes=1001.4 EiB)
            +- Project [inv_quantity_on_hand#11091, i_item_sk#11092, w_warehouse_sk#11114, w_warehouse_name#11116, d_moy#11136], Statistics(sizeInBytes=1223.9 EiB)
               +- Join Inner, (inv_date_sk#11088 = d_date_sk#11128), Statistics(sizeInBytes=1446.5 EiB)
                  :- Project [inv_date_sk#11088, inv_quantity_on_hand#11091, i_item_sk#11092, w_warehouse_sk#11114, w_warehouse_name#11116], Statistics(sizeInBytes=10.3 PiB)
                  :  +- Join Inner, (inv_warehouse_sk#11090 = w_warehouse_sk#11114), Statistics(sizeInBytes=11.2 PiB)
                  :     :- Project [inv_date_sk#11088, inv_warehouse_sk#11090, inv_quantity_on_hand#11091, i_item_sk#11092], Statistics(sizeInBytes=4.1 TiB)
                  :     :  +- Join Inner, (inv_item_sk#11089 = i_item_sk#11092), Statistics(sizeInBytes=4.8 TiB)
                  :     :     :- Filter (isnotnull(inv_item_sk#11089) AND (isnotnull(inv_warehouse_sk#11090) AND isnotnull(inv_date_sk#11088))), Statistics(sizeInBytes=38.2 MiB)
                  :     :     :  +- Relation default.inventory[inv_date_sk#11088,inv_item_sk#11089,inv_warehouse_sk#11090,inv_quantity_on_hand#11091] parquet, Statistics(sizeInBytes=38.2 MiB)
                  :     :     +- Project [i_item_sk#11092], Statistics(sizeInBytes=128.3 KiB)
                  :     :        +- Filter isnotnull(i_item_sk#11092), Statistics(sizeInBytes=3.1 MiB)
                  :     :           +- Relation default.item[i_item_sk#11092,i_item_id#11093,i_rec_start_date#11094,i_rec_end_date#11095,i_item_desc#11096,i_current_price#11097,i_wholesale_cost#11098,i_brand_id#11099,i_brand#11100,i_class_id#11101,i_class#11102,i_category_id#11103,i_category#11104,i_manufact_id#11105,i_manufact#11106,i_size#11107,i_formulation#11108,i_color#11109,i_units#11110,i_container#11111,i_manager_id#11112,i_product_name#11113] parquet, Statistics(sizeInBytes=3.1 MiB)
                  :     +- Project [w_warehouse_sk#11114, w_warehouse_name#11116], Statistics(sizeInBytes=2.7 KiB)
                  :        +- Filter isnotnull(w_warehouse_sk#11114), Statistics(sizeInBytes=20.9 KiB)
                  :           +- Relation default.warehouse[w_warehouse_sk#11114,w_warehouse_id#11115,w_warehouse_name#11116,w_warehouse_sq_ft#11117,w_street_number#11118,w_street_name#11119,w_street_type#11120,w_suite_number#11121,w_city#11122,w_county#11123,w_state#11124,w_zip#11125,w_country#11126,w_gmt_offset#11127] parquet, Statistics(sizeInBytes=20.9 KiB)
                  +- Project [d_date_sk#11128, d_moy#11136], Statistics(sizeInBytes=140.4 KiB)
                     +- Filter (((isnotnull(d_year#11134) AND isnotnull(d_moy#11136)) AND ((d_year#11134 = 2001) AND (d_moy#11136 = 2))) AND isnotnull(d_date_sk#11128)), Statistics(sizeInBytes=2.5 MiB)
                        +- Relation default.date_dim[d_date_sk#11128,d_date_id#11129,d_date#11130,d_month_seq#11131,d_week_seq#11132,d_quarter_seq#11133,d_year#11134,d_dow#11135,d_moy#11136,d_dom#11137,d_qoy#11138,d_fy_year#11139,d_fy_quarter_seq#11140,d_fy_week_seq#11141,d_day_name#11142,d_quarter_name#11143,d_holiday#11144,d_weekend#11145,d_following_holiday#11146,d_first_dom#11147,d_last_dom#11148,d_same_day_ly#11149,d_same_day_lq#11150,d_current_day#11151,d_current_week#11152,d_current_month#11153,d_current_quarter#11154,d_current_year#11155] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q39b ====
== Optimized Logical Plan ==
Sort [w_warehouse_sk#8009 ASC NULLS FIRST, i_item_sk#437 ASC NULLS FIRST, d_moy#32 ASC NULLS FIRST, mean#11330 ASC NULLS FIRST, cov#11331 ASC NULLS FIRST, d_moy#11516 ASC NULLS FIRST, mean#11363 ASC NULLS FIRST, cov#11364 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.33E+42 B)
+- Join Inner, ((i_item_sk#437 = i_item_sk#11472) AND (w_warehouse_sk#8009 = w_warehouse_sk#11494)), Statistics(sizeInBytes=1.33E+42 B)
   :- Project [w_warehouse_sk#8009, i_item_sk#437, d_moy#32, mean#11330, CASE WHEN (mean#11330 = 0.0) THEN null ELSE (stdev#11329 / mean#11330) END AS cov#11331], Statistics(sizeInBytes=1001.4 EiB)
   :  +- Filter (CASE WHEN (mean#11330 = 0.0) THEN false ELSE ((stdev#11329 / mean#11330) > 1.0) END AND CASE WHEN (mean#11330 = 0.0) THEN false ELSE ((stdev#11329 / mean#11330) > 1.5) END), Statistics(sizeInBytes=1001.4 EiB)
   :     +- Aggregate [w_warehouse_name#8011, w_warehouse_sk#8009, i_item_sk#437, d_moy#32], [w_warehouse_sk#8009, i_item_sk#437, d_moy#32, stddev_samp(cast(inv_quantity_on_hand#8008 as double)) AS stdev#11329, avg(inv_quantity_on_hand#8008) AS mean#11330], Statistics(sizeInBytes=1001.4 EiB)
   :        +- Project [inv_quantity_on_hand#8008, i_item_sk#437, w_warehouse_sk#8009, w_warehouse_name#8011, d_moy#32], Statistics(sizeInBytes=1223.9 EiB)
   :           +- Join Inner, (inv_date_sk#8005 = d_date_sk#24), Statistics(sizeInBytes=1446.5 EiB)
   :              :- Project [inv_date_sk#8005, inv_quantity_on_hand#8008, i_item_sk#437, w_warehouse_sk#8009, w_warehouse_name#8011], Statistics(sizeInBytes=10.3 PiB)
   :              :  +- Join Inner, (inv_warehouse_sk#8007 = w_warehouse_sk#8009), Statistics(sizeInBytes=11.2 PiB)
   :              :     :- Project [inv_date_sk#8005, inv_warehouse_sk#8007, inv_quantity_on_hand#8008, i_item_sk#437], Statistics(sizeInBytes=4.1 TiB)
   :              :     :  +- Join Inner, (inv_item_sk#8006 = i_item_sk#437), Statistics(sizeInBytes=4.8 TiB)
   :              :     :     :- Filter (isnotnull(inv_item_sk#8006) AND (isnotnull(inv_warehouse_sk#8007) AND isnotnull(inv_date_sk#8005))), Statistics(sizeInBytes=38.2 MiB)
   :              :     :     :  +- Relation default.inventory[inv_date_sk#8005,inv_item_sk#8006,inv_warehouse_sk#8007,inv_quantity_on_hand#8008] parquet, Statistics(sizeInBytes=38.2 MiB)
   :              :     :     +- Project [i_item_sk#437], Statistics(sizeInBytes=128.3 KiB)
   :              :     :        +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
   :              :     :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
   :              :     +- Project [w_warehouse_sk#8009, w_warehouse_name#8011], Statistics(sizeInBytes=2.7 KiB)
   :              :        +- Filter isnotnull(w_warehouse_sk#8009), Statistics(sizeInBytes=20.9 KiB)
   :              :           +- Relation default.warehouse[w_warehouse_sk#8009,w_warehouse_id#8010,w_warehouse_name#8011,w_warehouse_sq_ft#8012,w_street_number#8013,w_street_name#8014,w_street_type#8015,w_suite_number#8016,w_city#8017,w_county#8018,w_state#8019,w_zip#8020,w_country#8021,w_gmt_offset#8022] parquet, Statistics(sizeInBytes=20.9 KiB)
   :              +- Project [d_date_sk#24, d_moy#32], Statistics(sizeInBytes=140.4 KiB)
   :                 +- Filter (((isnotnull(d_year#30) AND isnotnull(d_moy#32)) AND ((d_year#30 = 2001) AND (d_moy#32 = 1))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
   :                    +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
   +- Project [w_warehouse_sk#11494, i_item_sk#11472, d_moy#11516, mean#11330 AS mean#11363, CASE WHEN (mean#11330 = 0.0) THEN null ELSE (stdev#11329 / mean#11330) END AS cov#11364], Statistics(sizeInBytes=1001.4 EiB)
      +- Filter CASE WHEN (mean#11330 = 0.0) THEN false ELSE ((stdev#11329 / mean#11330) > 1.0) END, Statistics(sizeInBytes=1001.4 EiB)
         +- Aggregate [w_warehouse_name#11496, w_warehouse_sk#11494, i_item_sk#11472, d_moy#11516], [w_warehouse_sk#11494, i_item_sk#11472, d_moy#11516, stddev_samp(cast(inv_quantity_on_hand#11471 as double)) AS stdev#11329, avg(inv_quantity_on_hand#11471) AS mean#11330], Statistics(sizeInBytes=1001.4 EiB)
            +- Project [inv_quantity_on_hand#11471, i_item_sk#11472, w_warehouse_sk#11494, w_warehouse_name#11496, d_moy#11516], Statistics(sizeInBytes=1223.9 EiB)
               +- Join Inner, (inv_date_sk#11468 = d_date_sk#11508), Statistics(sizeInBytes=1446.5 EiB)
                  :- Project [inv_date_sk#11468, inv_quantity_on_hand#11471, i_item_sk#11472, w_warehouse_sk#11494, w_warehouse_name#11496], Statistics(sizeInBytes=10.3 PiB)
                  :  +- Join Inner, (inv_warehouse_sk#11470 = w_warehouse_sk#11494), Statistics(sizeInBytes=11.2 PiB)
                  :     :- Project [inv_date_sk#11468, inv_warehouse_sk#11470, inv_quantity_on_hand#11471, i_item_sk#11472], Statistics(sizeInBytes=4.1 TiB)
                  :     :  +- Join Inner, (inv_item_sk#11469 = i_item_sk#11472), Statistics(sizeInBytes=4.8 TiB)
                  :     :     :- Filter (isnotnull(inv_item_sk#11469) AND (isnotnull(inv_warehouse_sk#11470) AND isnotnull(inv_date_sk#11468))), Statistics(sizeInBytes=38.2 MiB)
                  :     :     :  +- Relation default.inventory[inv_date_sk#11468,inv_item_sk#11469,inv_warehouse_sk#11470,inv_quantity_on_hand#11471] parquet, Statistics(sizeInBytes=38.2 MiB)
                  :     :     +- Project [i_item_sk#11472], Statistics(sizeInBytes=128.3 KiB)
                  :     :        +- Filter isnotnull(i_item_sk#11472), Statistics(sizeInBytes=3.1 MiB)
                  :     :           +- Relation default.item[i_item_sk#11472,i_item_id#11473,i_rec_start_date#11474,i_rec_end_date#11475,i_item_desc#11476,i_current_price#11477,i_wholesale_cost#11478,i_brand_id#11479,i_brand#11480,i_class_id#11481,i_class#11482,i_category_id#11483,i_category#11484,i_manufact_id#11485,i_manufact#11486,i_size#11487,i_formulation#11488,i_color#11489,i_units#11490,i_container#11491,i_manager_id#11492,i_product_name#11493] parquet, Statistics(sizeInBytes=3.1 MiB)
                  :     +- Project [w_warehouse_sk#11494, w_warehouse_name#11496], Statistics(sizeInBytes=2.7 KiB)
                  :        +- Filter isnotnull(w_warehouse_sk#11494), Statistics(sizeInBytes=20.9 KiB)
                  :           +- Relation default.warehouse[w_warehouse_sk#11494,w_warehouse_id#11495,w_warehouse_name#11496,w_warehouse_sq_ft#11497,w_street_number#11498,w_street_name#11499,w_street_type#11500,w_suite_number#11501,w_city#11502,w_county#11503,w_state#11504,w_zip#11505,w_country#11506,w_gmt_offset#11507] parquet, Statistics(sizeInBytes=20.9 KiB)
                  +- Project [d_date_sk#11508, d_moy#11516], Statistics(sizeInBytes=140.4 KiB)
                     +- Filter (((isnotnull(d_year#11514) AND isnotnull(d_moy#11516)) AND ((d_year#11514 = 2001) AND (d_moy#11516 = 2))) AND isnotnull(d_date_sk#11508)), Statistics(sizeInBytes=2.5 MiB)
                        +- Relation default.date_dim[d_date_sk#11508,d_date_id#11509,d_date#11510,d_month_seq#11511,d_week_seq#11512,d_quarter_seq#11513,d_year#11514,d_dow#11515,d_moy#11516,d_dom#11517,d_qoy#11518,d_fy_year#11519,d_fy_quarter_seq#11520,d_fy_week_seq#11521,d_day_name#11522,d_quarter_name#11523,d_holiday#11524,d_weekend#11525,d_following_holiday#11526,d_first_dom#11527,d_last_dom#11528,d_same_day_ly#11529,d_same_day_lq#11530,d_current_day#11531,d_current_week#11532,d_current_month#11533,d_current_quarter#11534,d_current_year#11535] parquet, Statistics(sizeInBytes=2.5 MiB)

==== q40 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=7.8 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=3.13E+27 B)
   +- Sort [w_state#8019 ASC NULLS FIRST, i_item_id#438 ASC NULLS FIRST], true, Statistics(sizeInBytes=3.13E+27 B)
      +- Aggregate [w_state#8019, i_item_id#438], [w_state#8019, i_item_id#438, sum(CASE WHEN (d_date#26 < 2000-03-11) THEN CheckOverflow((promote_precision(cast(cs_sales_price#218 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_refunded_cash#3314 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2)) ELSE 0.00 END) AS sales_before#11709, sum(CASE WHEN (d_date#26 >= 2000-03-11) THEN CheckOverflow((promote_precision(cast(cs_sales_price#218 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_refunded_cash#3314 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2)) ELSE 0.00 END) AS sales_after#11710], Statistics(sizeInBytes=3.13E+27 B)
         +- Project [cs_sales_price#218, cr_refunded_cash#3314, w_state#8019, i_item_id#438, d_date#26], Statistics(sizeInBytes=2.66E+27 B)
            +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#24), Statistics(sizeInBytes=2.98E+27 B)
               :- Project [cs_sold_date_sk#197, cs_sales_price#218, cr_refunded_cash#3314, w_state#8019, i_item_id#438], Statistics(sizeInBytes=2.07E+22 B)
               :  +- Join Inner, (i_item_sk#437 = cs_item_sk#212), Statistics(sizeInBytes=2.31E+22 B)
               :     :- Project [cs_sold_date_sk#197, cs_item_sk#212, cs_sales_price#218, cr_refunded_cash#3314, w_state#8019], Statistics(sizeInBytes=58.7 PiB)
               :     :  +- Join Inner, (cs_warehouse_sk#211 = w_warehouse_sk#8009), Statistics(sizeInBytes=67.7 PiB)
               :     :     :- Project [cs_sold_date_sk#197, cs_warehouse_sk#211, cs_item_sk#212, cs_sales_price#218, cr_refunded_cash#3314], Statistics(sizeInBytes=24.7 TiB)
               :     :     :  +- Join LeftOuter, ((cs_order_number#214 = cr_order_number#3307) AND (cs_item_sk#212 = cr_item_sk#3293)), Statistics(sizeInBytes=32.9 TiB)
               :     :     :     :- Project [cs_sold_date_sk#197, cs_warehouse_sk#211, cs_item_sk#212, cs_order_number#214, cs_sales_price#218], Statistics(sizeInBytes=16.6 MiB)
               :     :     :     :  +- Filter (isnotnull(cs_warehouse_sk#211) AND (isnotnull(cs_item_sk#212) AND isnotnull(cs_sold_date_sk#197))), Statistics(sizeInBytes=105.8 MiB)
               :     :     :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
               :     :     :     +- Project [cr_item_sk#3293, cr_order_number#3307, cr_refunded_cash#3314], Statistics(sizeInBytes=2031.8 KiB)
               :     :     :        +- Filter (isnotnull(cr_order_number#3307) AND isnotnull(cr_item_sk#3293)), Statistics(sizeInBytes=12.6 MiB)
               :     :     :           +- Relation default.catalog_returns[cr_returned_date_sk#3291,cr_returned_time_sk#3292,cr_item_sk#3293,cr_refunded_customer_sk#3294,cr_refunded_cdemo_sk#3295,cr_refunded_hdemo_sk#3296,cr_refunded_addr_sk#3297,cr_returning_customer_sk#3298,cr_returning_cdemo_sk#3299,cr_returning_hdemo_sk#3300,cr_returning_addr_sk#3301,cr_call_center_sk#3302,cr_catalog_page_sk#3303,cr_ship_mode_sk#3304,cr_warehouse_sk#3305,cr_reason_sk#3306,cr_order_number#3307,cr_return_quantity#3308,cr_return_amount#3309,cr_return_tax#3310,cr_return_amt_inc_tax#3311,cr_fee#3312,cr_return_ship_cost#3313,cr_refunded_cash#3314,cr_reversed_charge#3315,cr_store_credit#3316,cr_net_loss#3317] parquet, Statistics(sizeInBytes=12.6 MiB)
               :     :     +- Project [w_warehouse_sk#8009, w_state#8019], Statistics(sizeInBytes=2.7 KiB)
               :     :        +- Filter isnotnull(w_warehouse_sk#8009), Statistics(sizeInBytes=20.9 KiB)
               :     :           +- Relation default.warehouse[w_warehouse_sk#8009,w_warehouse_id#8010,w_warehouse_name#8011,w_warehouse_sq_ft#8012,w_street_number#8013,w_street_name#8014,w_street_type#8015,w_suite_number#8016,w_city#8017,w_county#8018,w_state#8019,w_zip#8020,w_country#8021,w_gmt_offset#8022] parquet, Statistics(sizeInBytes=20.9 KiB)
               :     +- Project [i_item_sk#437, i_item_id#438], Statistics(sizeInBytes=342.3 KiB)
               :        +- Filter ((isnotnull(i_current_price#442) AND ((i_current_price#442 >= 0.99) AND (i_current_price#442 <= 1.49))) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
               :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
               +- Project [d_date_sk#24, d_date#26], Statistics(sizeInBytes=140.4 KiB)
                  +- Filter ((isnotnull(d_date#26) AND ((d_date#26 >= 2000-02-10) AND (d_date#26 <= 2000-04-10))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                     +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q41 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=2.7 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=61.8 GiB)
   +- Sort [i_product_name#458 ASC NULLS FIRST], true, Statistics(sizeInBytes=61.8 GiB)
      +- Aggregate [i_product_name#458], [i_product_name#458], Statistics(sizeInBytes=61.8 GiB)
         +- Project [i_product_name#458], Statistics(sizeInBytes=61.8 GiB)
            +- Join Inner, (i_manufact#11754 = i_manufact#451), Statistics(sizeInBytes=150.2 GiB)
               :- Project [i_manufact#451, i_product_name#458], Statistics(sizeInBytes=513.4 KiB)
               :  +- Filter ((isnotnull(i_manufact_id#450) AND ((i_manufact_id#450 >= 738) AND (i_manufact_id#450 <= 778))) AND isnotnull(i_manufact#451)), Statistics(sizeInBytes=3.1 MiB)
               :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
               +- Project [i_manufact#11754], Statistics(sizeInBytes=299.5 KiB)
                  +- Filter (item_cnt#11737L > 0), Statistics(sizeInBytes=385.0 KiB)
                     +- Aggregate [i_manufact#11754], [count(1) AS item_cnt#11737L, i_manufact#11754], Statistics(sizeInBytes=385.0 KiB)
                        +- Project [i_manufact#11754], Statistics(sizeInBytes=299.5 KiB)
                           +- Filter (((((i_category#11752 = Women                                             ) AND (((((i_color#11757 = powder              ) OR (i_color#11757 = khaki               )) AND ((i_units#11758 = Ounce     ) OR (i_units#11758 = Oz        ))) AND ((i_size#11755 = medium              ) OR (i_size#11755 = extra large         ))) OR ((((i_color#11757 = brown               ) OR (i_color#11757 = honeydew            )) AND ((i_units#11758 = Bunch     ) OR (i_units#11758 = Ton       ))) AND ((i_size#11755 = N/A                 ) OR (i_size#11755 = small               ))))) OR ((i_category#11752 = Men                                               ) AND (((((i_color#11757 = floral              ) OR (i_color#11757 = deep                )) AND ((i_units#11758 = N/A       ) OR (i_units#11758 = Dozen     ))) AND ((i_size#11755 = petite              ) OR (i_size#11755 = large               ))) OR ((((i_color#11757 = light               ) OR (i_color#11757 = cornflower          )) AND ((i_units#11758 = Box       ) OR (i_units#11758 = Pound     ))) AND ((i_size#11755 = medium              ) OR (i_size#11755 = extra large         )))))) OR (((i_category#11752 = Women                                             ) AND (((((i_color#11757 = midnight            ) OR (i_color#11757 = snow                )) AND ((i_units#11758 = Pallet    ) OR (i_units#11758 = Gross     ))) AND ((i_size#11755 = medium              ) OR (i_size#11755 = extra large         ))) OR ((((i_color#11757 = cyan                ) OR (i_color#11757 = papaya              )) AND ((i_units#11758 = Cup       ) OR (i_units#11758 = Dram      ))) AND ((i_size#11755 = N/A                 ) OR (i_size#11755 = small               ))))) OR ((i_category#11752 = Men                                               ) AND (((((i_color#11757 = orange              ) OR (i_color#11757 = frosted             )) AND ((i_units#11758 = Each      ) OR (i_units#11758 = Tbl       ))) AND ((i_size#11755 = petite              ) OR (i_size#11755 = large               ))) OR ((((i_color#11757 = forest              ) OR (i_color#11757 = ghost               )) AND ((i_units#11758 = Lb        ) OR (i_units#11758 = Bundle    ))) AND ((i_size#11755 = medium              ) OR (i_size#11755 = extra large         ))))))) AND isnotnull(i_manufact#11754)), Statistics(sizeInBytes=3.1 MiB)
                              +- Relation default.item[i_item_sk#11740,i_item_id#11741,i_rec_start_date#11742,i_rec_end_date#11743,i_item_desc#11744,i_current_price#11745,i_wholesale_cost#11746,i_brand_id#11747,i_brand#11748,i_class_id#11749,i_class#11750,i_category_id#11751,i_category#11752,i_manufact_id#11753,i_manufact#11754,i_size#11755,i_formulation#11756,i_color#11757,i_units#11758,i_container#11759,i_manager_id#11760,i_product_name#11761] parquet, Statistics(sizeInBytes=3.1 MiB)


==== q42 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=4.3 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=766.5 PiB)
   +- Sort [sum(ss_ext_sales_price)#11768 DESC NULLS LAST, d_year#30 ASC NULLS FIRST, i_category_id#448 ASC NULLS FIRST, i_category#449 ASC NULLS FIRST], true, Statistics(sizeInBytes=766.5 PiB)
      +- Aggregate [d_year#30, i_category_id#448, i_category#449], [d_year#30, i_category_id#448, i_category#449, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS sum(ss_ext_sales_price)#11768], Statistics(sizeInBytes=766.5 PiB)
         +- Project [d_year#30, ss_ext_sales_price#429, i_category_id#448, i_category#449], Statistics(sizeInBytes=766.5 PiB)
            +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=905.9 PiB)
               :- Project [d_year#30, ss_item_sk#416, ss_ext_sales_price#429], Statistics(sizeInBytes=2.4 TiB)
               :  +- Join Inner, (d_date_sk#24 = ss_sold_date_sk#414), Statistics(sizeInBytes=3.1 TiB)
               :     :- Project [d_date_sk#24, d_year#30], Statistics(sizeInBytes=140.4 KiB)
               :     :  +- Filter (((isnotnull(d_moy#32) AND isnotnull(d_year#30)) AND ((d_moy#32 = 11) AND (d_year#30 = 2000))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :     :     +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     +- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_ext_sales_price#429], Statistics(sizeInBytes=22.9 MiB)
               :        +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_item_sk#416)), Statistics(sizeInBytes=141.1 MiB)
               :           +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               +- Project [i_item_sk#437, i_category_id#448, i_category#449], Statistics(sizeInBytes=385.0 KiB)
                  +- Filter ((isnotnull(i_manager_id#457) AND (i_manager_id#457 = 1)) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
                     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)

==== q43 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=10.2 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=81.5 PiB)
   +- Sort [s_store_name#57 ASC NULLS FIRST, s_store_id#53 ASC NULLS FIRST, sun_sales#11779 ASC NULLS FIRST, mon_sales#11780 ASC NULLS FIRST, tue_sales#11781 ASC NULLS FIRST, wed_sales#11782 ASC NULLS FIRST, thu_sales#11783 ASC NULLS FIRST, fri_sales#11784 ASC NULLS FIRST, sat_sales#11785 ASC NULLS FIRST], true, Statistics(sizeInBytes=81.5 PiB)
      +- Aggregate [s_store_name#57, s_store_id#53], [s_store_name#57, s_store_id#53, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Sunday   ) THEN ss_sales_price#427 END)),17,2) AS sun_sales#11779, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Monday   ) THEN ss_sales_price#427 END)),17,2) AS mon_sales#11780, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Tuesday  ) THEN ss_sales_price#427 END)),17,2) AS tue_sales#11781, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Wednesday) THEN ss_sales_price#427 END)),17,2) AS wed_sales#11782, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Thursday ) THEN ss_sales_price#427 END)),17,2) AS thu_sales#11783, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Friday   ) THEN ss_sales_price#427 END)),17,2) AS fri_sales#11784, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Saturday ) THEN ss_sales_price#427 END)),17,2) AS sat_sales#11785], Statistics(sizeInBytes=81.5 PiB)
         +- Project [d_day_name#38, ss_sales_price#427, s_store_id#53, s_store_name#57], Statistics(sizeInBytes=59.5 PiB)
            +- Join Inner, (s_store_sk#52 = ss_store_sk#421), Statistics(sizeInBytes=65.8 PiB)
               :- Project [d_day_name#38, ss_store_sk#421, ss_sales_price#427], Statistics(sizeInBytes=5.2 TiB)
               :  +- Join Inner, (d_date_sk#24 = ss_sold_date_sk#414), Statistics(sizeInBytes=6.3 TiB)
               :     :- Project [d_date_sk#24, d_day_name#38], Statistics(sizeInBytes=280.8 KiB)
               :     :  +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2000)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :     :     +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     +- Project [ss_sold_date_sk#414, ss_store_sk#421, ss_sales_price#427], Statistics(sizeInBytes=22.9 MiB)
               :        +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421)), Statistics(sizeInBytes=141.1 MiB)
               :           +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               +- Project [s_store_sk#52, s_store_id#53, s_store_name#57], Statistics(sizeInBytes=12.6 KiB)
                  +- Filter ((isnotnull(s_gmt_offset#79) AND (s_gmt_offset#79 = -5.00)) AND isnotnull(s_store_sk#52)), Statistics(sizeInBytes=101.7 KiB)
                     +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)

==== q44 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=5.1 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.86E+25 B)
   +- Sort [rnk#11841 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.86E+25 B)
      +- Project [rnk#11841, i_product_name#458 AS best_performing#11847, i_product_name#11897 AS worst_performing#11848], Statistics(sizeInBytes=1.86E+25 B)
         +- Join Inner, (i_item_sk#11876 = item_sk#11842), Statistics(sizeInBytes=2.14E+25 B)
            :- Project [rnk#11841, item_sk#11842, i_product_name#458], Statistics(sizeInBytes=53.0 EiB)
            :  +- Join Inner, (i_item_sk#437 = item_sk#11837), Statistics(sizeInBytes=64.8 EiB)
            :     :- Project [item_sk#11837, rnk#11841, item_sk#11842], Statistics(sizeInBytes=193.8 TiB)
            :     :  +- Join Inner, (rnk#11841 = rnk#11846), Statistics(sizeInBytes=232.6 TiB)
            :     :     :- Project [item_sk#11837, rnk#11841], Statistics(sizeInBytes=15.3 MiB)
            :     :     :  +- Filter ((rnk#11841 < 11) AND isnotnull(item_sk#11837)), Statistics(sizeInBytes=22.9 MiB)
            :     :     :     +- Window [rank(rank_col#11838) windowspecdefinition(rank_col#11838 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rnk#11841], [rank_col#11838 ASC NULLS FIRST], Statistics(sizeInBytes=22.9 MiB)
            :     :     :        +- Filter (isnotnull(rank_col#11838) AND (cast(rank_col#11838 as decimal(13,7)) > CheckOverflow((0.900000 * promote_precision(scalar-subquery#11840 [])), DecimalType(13,7)))), Statistics(sizeInBytes=19.1 MiB)
            :     :     :           :  +- Aggregate [ss_store_sk#11912], [cast((avg(UnscaledValue(ss_net_profit#11927)) / 100.0) as decimal(11,6)) AS rank_col#11839], Statistics(sizeInBytes=15.3 MiB)
            :     :     :           :     +- Project [ss_store_sk#11912, ss_net_profit#11927], Statistics(sizeInBytes=19.1 MiB)
            :     :     :           :        +- Filter (isnotnull(ss_store_sk#11912) AND ((ss_store_sk#11912 = 4) AND isnull(ss_addr_sk#11911))), Statistics(sizeInBytes=141.1 MiB)
            :     :     :           :           +- Relation default.store_sales[ss_sold_date_sk#11905,ss_sold_time_sk#11906,ss_item_sk#11907,ss_customer_sk#11908,ss_cdemo_sk#11909,ss_hdemo_sk#11910,ss_addr_sk#11911,ss_store_sk#11912,ss_promo_sk#11913,ss_ticket_number#11914,ss_quantity#11915,ss_wholesale_cost#11916,ss_list_price#11917,ss_sales_price#11918,ss_ext_discount_amt#11919,ss_ext_sales_price#11920,ss_ext_wholesale_cost#11921,ss_ext_list_price#11922,ss_ext_tax#11923,ss_coupon_amt#11924,ss_net_paid#11925,ss_net_paid_inc_tax#11926,ss_net_profit#11927] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     :     :           +- Aggregate [ss_item_sk#416], [ss_item_sk#416 AS item_sk#11837, cast((avg(UnscaledValue(ss_net_profit#436)) / 100.0) as decimal(11,6)) AS rank_col#11838], Statistics(sizeInBytes=19.1 MiB)
            :     :     :              +- Project [ss_item_sk#416, ss_net_profit#436], Statistics(sizeInBytes=19.1 MiB)
            :     :     :                 +- Filter (isnotnull(ss_store_sk#421) AND (ss_store_sk#421 = 4)), Statistics(sizeInBytes=141.1 MiB)
            :     :     :                    +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     :     +- Project [item_sk#11842, rnk#11846], Statistics(sizeInBytes=15.3 MiB)
            :     :        +- Filter ((rnk#11846 < 11) AND isnotnull(item_sk#11842)), Statistics(sizeInBytes=22.9 MiB)
            :     :           +- Window [rank(rank_col#11843) windowspecdefinition(rank_col#11843 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rnk#11846], [rank_col#11843 DESC NULLS LAST], Statistics(sizeInBytes=22.9 MiB)
            :     :              +- Filter (isnotnull(rank_col#11843) AND (cast(rank_col#11843 as decimal(13,7)) > CheckOverflow((0.900000 * promote_precision(scalar-subquery#11845 [])), DecimalType(13,7)))), Statistics(sizeInBytes=19.1 MiB)
            :     :                 :  +- Aggregate [ss_store_sk#11912], [cast((avg(UnscaledValue(ss_net_profit#11927)) / 100.0) as decimal(11,6)) AS rank_col#11839], Statistics(sizeInBytes=15.3 MiB)
            :     :                 :     +- Project [ss_store_sk#11912, ss_net_profit#11927], Statistics(sizeInBytes=19.1 MiB)
            :     :                 :        +- Filter (isnotnull(ss_store_sk#11912) AND ((ss_store_sk#11912 = 4) AND isnull(ss_addr_sk#11911))), Statistics(sizeInBytes=141.1 MiB)
            :     :                 :           +- Relation default.store_sales[ss_sold_date_sk#11905,ss_sold_time_sk#11906,ss_item_sk#11907,ss_customer_sk#11908,ss_cdemo_sk#11909,ss_hdemo_sk#11910,ss_addr_sk#11911,ss_store_sk#11912,ss_promo_sk#11913,ss_ticket_number#11914,ss_quantity#11915,ss_wholesale_cost#11916,ss_list_price#11917,ss_sales_price#11918,ss_ext_discount_amt#11919,ss_ext_sales_price#11920,ss_ext_wholesale_cost#11921,ss_ext_list_price#11922,ss_ext_tax#11923,ss_coupon_amt#11924,ss_net_paid#11925,ss_net_paid_inc_tax#11926,ss_net_profit#11927] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     :                 +- Aggregate [ss_item_sk#11855], [ss_item_sk#11855 AS item_sk#11842, cast((avg(UnscaledValue(ss_net_profit#11875)) / 100.0) as decimal(11,6)) AS rank_col#11843], Statistics(sizeInBytes=19.1 MiB)
            :     :                    +- Project [ss_item_sk#11855, ss_net_profit#11875], Statistics(sizeInBytes=19.1 MiB)
            :     :                       +- Filter (isnotnull(ss_store_sk#11860) AND (ss_store_sk#11860 = 4)), Statistics(sizeInBytes=141.1 MiB)
            :     :                          +- Relation default.store_sales[ss_sold_date_sk#11853,ss_sold_time_sk#11854,ss_item_sk#11855,ss_customer_sk#11856,ss_cdemo_sk#11857,ss_hdemo_sk#11858,ss_addr_sk#11859,ss_store_sk#11860,ss_promo_sk#11861,ss_ticket_number#11862,ss_quantity#11863,ss_wholesale_cost#11864,ss_list_price#11865,ss_sales_price#11866,ss_ext_discount_amt#11867,ss_ext_sales_price#11868,ss_ext_wholesale_cost#11869,ss_ext_list_price#11870,ss_ext_tax#11871,ss_coupon_amt#11872,ss_net_paid#11873,ss_net_paid_inc_tax#11874,ss_net_profit#11875] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     +- Project [i_item_sk#437, i_product_name#458], Statistics(sizeInBytes=342.3 KiB)
            :        +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
            :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
            +- Project [i_item_sk#11876, i_product_name#11897], Statistics(sizeInBytes=342.3 KiB)
               +- Filter isnotnull(i_item_sk#11876), Statistics(sizeInBytes=3.1 MiB)
                  +- Relation default.item[i_item_sk#11876,i_item_id#11877,i_rec_start_date#11878,i_rec_end_date#11879,i_item_desc#11880,i_current_price#11881,i_wholesale_cost#11882,i_brand_id#11883,i_brand#11884,i_class_id#11885,i_class#11886,i_category_id#11887,i_category#11888,i_manufact_id#11889,i_manufact#11890,i_size#11891,i_formulation#11892,i_color#11893,i_units#11894,i_container#11895,i_manager_id#11896,i_product_name#11897] parquet, Statistics(sizeInBytes=3.1 MiB)

==== q45 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=5.5 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.23E+34 B)
   +- Sort [ca_zip#3726 ASC NULLS FIRST, ca_city#3723 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.23E+34 B)
      +- Aggregate [ca_zip#3726, ca_city#3723], [ca_zip#3726, ca_city#3723, MakeDecimal(sum(UnscaledValue(ws_sales_price#184)),17,2) AS sum(ws_sales_price)#12041], Statistics(sizeInBytes=1.23E+34 B)
         +- Project [ws_sales_price#184, ca_city#3723, ca_zip#3726], Statistics(sizeInBytes=1.23E+34 B)
            +- Filter (substr(ca_zip#3726, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) OR exists#12045), Statistics(sizeInBytes=1.69E+34 B)
               +- Join ExistenceJoin(exists#12045), (i_item_id#438 = i_item_id#12019), Statistics(sizeInBytes=1.69E+34 B)
                  :- Project [ws_sales_price#184, ca_city#3723, ca_zip#3726, i_item_id#438], Statistics(sizeInBytes=5.49E+28 B)
                  :  +- Join Inner, (ws_item_sk#166 = i_item_sk#437), Statistics(sizeInBytes=6.07E+28 B)
                  :     :- Project [ws_item_sk#166, ws_sales_price#184, ca_city#3723, ca_zip#3726], Statistics(sizeInBytes=1.73E+23 B)
                  :     :  +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#24), Statistics(sizeInBytes=1.96E+23 B)
                  :     :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_sales_price#184, ca_city#3723, ca_zip#3726], Statistics(sizeInBytes=1617.5 PiB)
                  :     :     :  +- Join Inner, (c_current_addr_sk#85 = ca_address_sk#3717), Statistics(sizeInBytes=1819.7 PiB)
                  :     :     :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_sales_price#184, c_current_addr_sk#85], Statistics(sizeInBytes=3.3 TiB)
                  :     :     :     :  +- Join Inner, (ws_bill_customer_sk#167 = c_customer_sk#81), Statistics(sizeInBytes=4.3 TiB)
                  :     :     :     :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_bill_customer_sk#167, ws_sales_price#184], Statistics(sizeInBytes=7.1 MiB)
                  :     :     :     :     :  +- Filter (isnotnull(ws_bill_customer_sk#167) AND (isnotnull(ws_sold_date_sk#163) AND isnotnull(ws_item_sk#166))), Statistics(sizeInBytes=52.0 MiB)
                  :     :     :     :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                  :     :     :     :     +- Project [c_customer_sk#81, c_current_addr_sk#85], Statistics(sizeInBytes=614.2 KiB)
                  :     :     :     :        +- Filter (isnotnull(c_customer_sk#81) AND isnotnull(c_current_addr_sk#85)), Statistics(sizeInBytes=7.8 MiB)
                  :     :     :     :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
                  :     :     :     +- Project [ca_address_sk#3717, ca_city#3723, ca_zip#3726], Statistics(sizeInBytes=546.7 KiB)
                  :     :     :        +- Filter isnotnull(ca_address_sk#3717), Statistics(sizeInBytes=2.5 MiB)
                  :     :     :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
                  :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                  :     :        +- Filter (((isnotnull(d_qoy#34) AND isnotnull(d_year#30)) AND ((d_qoy#34 = 2) AND (d_year#30 = 2001))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                  :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                  :     +- Project [i_item_sk#437, i_item_id#438], Statistics(sizeInBytes=342.3 KiB)
                  :        +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
                  :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
                  +- Project [i_item_id#12019], Statistics(sizeInBytes=299.5 KiB)
                     +- Filter i_item_sk#12018 IN (2,3,5,7,11,13,17,19,23,29), Statistics(sizeInBytes=3.1 MiB)
                        +- Relation default.item[i_item_sk#12018,i_item_id#12019,i_rec_start_date#12020,i_rec_end_date#12021,i_item_desc#12022,i_current_price#12023,i_wholesale_cost#12024,i_brand_id#12025,i_brand#12026,i_class_id#12027,i_class#12028,i_category_id#12029,i_category#12030,i_manufact_id#12031,i_manufact#12032,i_size#12033,i_formulation#12034,i_color#12035,i_units#12036,i_container#12037,i_manager_id#12038,i_product_name#12039] parquet, Statistics(sizeInBytes=3.1 MiB)

==== q46 ==== 
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=10.5 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.02E+38 B)
   +- Sort [c_last_name#90 ASC NULLS FIRST, c_first_name#89 ASC NULLS FIRST, ca_city#12061 ASC NULLS FIRST, bought_city#12052 ASC NULLS FIRST, ss_ticket_number#423 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.02E+38 B)
      +- Project [c_last_name#90, c_first_name#89, ca_city#12061, bought_city#12052, ss_ticket_number#423, amt#12053, profit#12054], Statistics(sizeInBytes=1.02E+38 B)
         +- Join Inner, ((c_current_addr_sk#85 = ca_address_sk#12055) AND NOT (ca_city#12061 = bought_city#12052)), Statistics(sizeInBytes=1.10E+38 B)
            :- Project [ss_ticket_number#423, bought_city#12052, amt#12053, profit#12054, c_current_addr_sk#85, c_first_name#89, c_last_name#90], Statistics(sizeInBytes=3.19E+32 B)
            :  +- Join Inner, (ss_customer_sk#417 = c_customer_sk#81), Statistics(sizeInBytes=3.47E+32 B)
            :     :- Aggregate [ss_ticket_number#423, ss_customer_sk#417, ss_addr_sk#420, ca_city#3723], [ss_ticket_number#423, ss_customer_sk#417, ca_city#3723 AS bought_city#12052, MakeDecimal(sum(UnscaledValue(ss_coupon_amt#433)),17,2) AS amt#12053, MakeDecimal(sum(UnscaledValue(ss_net_profit#436)),17,2) AS profit#12054], Statistics(sizeInBytes=1.57E+26 B)
            :     :  +- Project [ss_customer_sk#417, ss_addr_sk#420, ss_ticket_number#423, ss_coupon_amt#433, ss_net_profit#436, ca_city#3723], Statistics(sizeInBytes=1.70E+26 B)
            :     :     +- Join Inner, (ss_addr_sk#420 = ca_address_sk#3717), Statistics(sizeInBytes=1.82E+26 B)
            :     :        :- Project [ss_customer_sk#417, ss_addr_sk#420, ss_ticket_number#423, ss_coupon_amt#433, ss_net_profit#436], Statistics(sizeInBytes=457.4 EiB)
            :     :        :  +- Join Inner, (ss_hdemo_sk#419 = hd_demo_sk#5551), Statistics(sizeInBytes=559.1 EiB)
            :     :        :     :- Project [ss_customer_sk#417, ss_hdemo_sk#419, ss_addr_sk#420, ss_ticket_number#423, ss_coupon_amt#433, ss_net_profit#436], Statistics(sizeInBytes=9.6 PiB)
            :     :        :     :  +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=11.6 PiB)
            :     :        :     :     :- Project [ss_customer_sk#417, ss_hdemo_sk#419, ss_addr_sk#420, ss_store_sk#421, ss_ticket_number#423, ss_coupon_amt#433, ss_net_profit#436], Statistics(sizeInBytes=4.0 TiB)
            :     :        :     :     :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=4.7 TiB)
            :     :        :     :     :     :- Project [ss_sold_date_sk#414, ss_customer_sk#417, ss_hdemo_sk#419, ss_addr_sk#420, ss_store_sk#421, ss_ticket_number#423, ss_coupon_amt#433, ss_net_profit#436], Statistics(sizeInBytes=45.8 MiB)
            :     :        :     :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421)) AND ((isnotnull(ss_hdemo_sk#419) AND isnotnull(ss_addr_sk#420)) AND isnotnull(ss_customer_sk#417))), Statistics(sizeInBytes=141.1 MiB)
            :     :        :     :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     :        :     :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
            :     :        :     :     :        +- Filter ((d_dow#31 IN (6,0) AND d_year#30 IN (1999,2000,2001)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :     :        :     :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :        :     :     +- Project [s_store_sk#52], Statistics(sizeInBytes=2.9 KiB)
            :     :        :     :        +- Filter (s_city#74 IN (Fairview,Midway) AND isnotnull(s_store_sk#52)), Statistics(sizeInBytes=101.7 KiB)
            :     :        :     :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
            :     :        :     +- Project [hd_demo_sk#5551], Statistics(sizeInBytes=58.0 KiB)
            :     :        :        +- Filter (((hd_dep_count#5554 = 4) OR (hd_vehicle_count#5555 = 3)) AND isnotnull(hd_demo_sk#5551)), Statistics(sizeInBytes=212.8 KiB)
            :     :        :           +- Relation default.household_demographics[hd_demo_sk#5551,hd_income_band_sk#5552,hd_buy_potential#5553,hd_dep_count#5554,hd_vehicle_count#5555] parquet, Statistics(sizeInBytes=212.8 KiB)
            :     :        +- Project [ca_address_sk#3717, ca_city#3723], Statistics(sizeInBytes=336.4 KiB)
            :     :           +- Filter (isnotnull(ca_address_sk#3717) AND isnotnull(ca_city#3723)), Statistics(sizeInBytes=2.5 MiB)
            :     :              +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     +- Project [c_customer_sk#81, c_current_addr_sk#85, c_first_name#89, c_last_name#90], Statistics(sizeInBytes=2.1 MiB)
            :        +- Filter (isnotnull(c_customer_sk#81) AND isnotnull(c_current_addr_sk#85)), Statistics(sizeInBytes=7.8 MiB)
            :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
            +- Project [ca_address_sk#12055, ca_city#12061], Statistics(sizeInBytes=336.4 KiB)
               +- Filter (isnotnull(ca_address_sk#12055) AND isnotnull(ca_city#12061)), Statistics(sizeInBytes=2.5 MiB)
                  +- Relation default.customer_address[ca_address_sk#12055,ca_address_id#12056,ca_street_number#12057,ca_street_name#12058,ca_street_type#12059,ca_suite_number#12060,ca_city#12061,ca_county#12062,ca_state#12063,ca_zip#12064,ca_country#12065,ca_gmt_offset#12066,ca_location_type#12067] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q46 ====
== Physical Plan ==
AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[c_last_name#90 ASC NULLS FIRST,c_first_name#89 ASC NULLS FIRST,ca_city#12061 ASC NULLS FIRST,bought_city#12052 ASC NULLS FIRST,ss_ticket_number#423 ASC NULLS FIRST], output=[c_last_name#90,c_first_name#89,ca_city#12061,bought_city#12052,ss_ticket_number#423,amt#12053,profit#12054])
   +- *(8) Project [c_last_name#90, c_first_name#89, ca_city#12061, bought_city#12052, ss_ticket_number#423, amt#12053, profit#12054]
      +- *(8) BroadcastHashJoin [c_current_addr_sk#85], [ca_address_sk#12055], Inner, BuildRight, NOT (ca_city#12061 = bought_city#12052), false
         :- *(8) Project [ss_ticket_number#423, bought_city#12052, amt#12053, profit#12054, c_current_addr_sk#85, c_first_name#89, c_last_name#90]
         :  +- *(8) BroadcastHashJoin [ss_customer_sk#417], [c_customer_sk#81], Inner, BuildRight, false
         :     :- *(8) HashAggregate(keys=[ss_ticket_number#423, ss_customer_sk#417, ss_addr_sk#420, ca_city#3723], functions=[sum(UnscaledValue(ss_coupon_amt#433)), sum(UnscaledValue(ss_net_profit#436))], output=[ss_ticket_number#423, ss_customer_sk#417, bought_city#12052, amt#12053, profit#12054])
         :     :  +- ShuffleQueryStage 7
         :     :     +- Exchange hashpartitioning(ss_ticket_number#423, ss_customer_sk#417, ss_addr_sk#420, ca_city#3723, 20), ENSURE_REQUIREMENTS, [plan_id=100725]
         :     :        +- *(7) HashAggregate(keys=[ss_ticket_number#423, ss_customer_sk#417, ss_addr_sk#420, ca_city#3723], functions=[partial_sum(UnscaledValue(ss_coupon_amt#433)), partial_sum(UnscaledValue(ss_net_profit#436))], output=[ss_ticket_number#423, ss_customer_sk#417, ss_addr_sk#420, ca_city#3723, sum#12080L, sum#12081L])
         :     :           +- *(7) Project [ss_customer_sk#417, ss_addr_sk#420, ss_ticket_number#423, ss_coupon_amt#433, ss_net_profit#436, ca_city#3723]
         :     :              +- *(7) BroadcastHashJoin [ss_addr_sk#420], [ca_address_sk#3717], Inner, BuildRight, false
         :     :                 :- *(7) Project [ss_customer_sk#417, ss_addr_sk#420, ss_ticket_number#423, ss_coupon_amt#433, ss_net_profit#436]
         :     :                 :  +- *(7) BroadcastHashJoin [ss_hdemo_sk#419], [hd_demo_sk#5551], Inner, BuildRight, false
         :     :                 :     :- *(7) Project [ss_customer_sk#417, ss_hdemo_sk#419, ss_addr_sk#420, ss_ticket_number#423, ss_coupon_amt#433, ss_net_profit#436]
         :     :                 :     :  +- *(7) BroadcastHashJoin [ss_store_sk#421], [s_store_sk#52], Inner, BuildRight, false
         :     :                 :     :     :- *(7) Project [ss_customer_sk#417, ss_hdemo_sk#419, ss_addr_sk#420, ss_store_sk#421, ss_ticket_number#423, ss_coupon_amt#433, ss_net_profit#436]
         :     :                 :     :     :  +- *(7) BroadcastHashJoin [ss_sold_date_sk#414], [d_date_sk#24], Inner, BuildRight, false
         :     :                 :     :     :     :- *(7) Filter ((((isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421)) AND isnotnull(ss_hdemo_sk#419)) AND isnotnull(ss_addr_sk#420)) AND isnotnull(ss_customer_sk#417))
         :     :                 :     :     :     :  +- *(7) ColumnarToRow
         :     :                 :     :     :     :     +- FileScan parquet default.store_sales[ss_sold_date_sk#414,ss_customer_sk#417,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_ticket_number#423,ss_coupon_amt#433,ss_net_profit#436] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#414), isnotnull(ss_store_sk#421), isnotnull(ss_hdemo_sk#419), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://node001:9100/benchmark/tpcdsTable/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_hdemo_sk), IsNotNull(ss_addr_sk..., ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_sk:int,ss_t...
         :     :                 :     :     :     +- BroadcastQueryStage 0
         :     :                 :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=100152]
         :     :                 :     :     :           +- *(1) Project [d_date_sk#24]
         :     :                 :     :     :              +- *(1) Filter ((d_dow#31 IN (6,0) AND d_year#30 IN (1999,2000,2001)) AND isnotnull(d_date_sk#24))
         :     :                 :     :     :                 +- *(1) ColumnarToRow
         :     :                 :     :     :                    +- FileScan parquet default.date_dim[d_date_sk#24,d_year#30,d_dow#31] Batched: true, DataFilters: [d_dow#31 IN (6,0), d_year#30 IN (1999,2000,2001), isnotnull(d_date_sk#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://node001:9100/benchmark/tpcdsTable/date_dim], PartitionFilters: [], PushedFilters: [In(d_dow, [0,6]), In(d_year, [1999,2000,2001]), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_dow:int>
         :     :                 :     :     +- BroadcastQueryStage 1
         :     :                 :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=100173]
         :     :                 :     :           +- *(2) Project [s_store_sk#52]
         :     :                 :     :              +- *(2) Filter (s_city#74 IN (Fairview,Midway) AND isnotnull(s_store_sk#52))
         :     :                 :     :                 +- *(2) ColumnarToRow
         :     :                 :     :                    +- FileScan parquet default.store[s_store_sk#52,s_city#74] Batched: true, DataFilters: [s_city#74 IN (Fairview,Midway), isnotnull(s_store_sk#52)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://node001:9100/benchmark/tpcdsTable/store], PartitionFilters: [], PushedFilters: [In(s_city, [Fairview,Midway]), IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_city:string>
         :     :                 :     +- BroadcastQueryStage 2
         :     :                 :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=100194]
         :     :                 :           +- *(3) Project [hd_demo_sk#5551]
         :     :                 :              +- *(3) Filter (((hd_dep_count#5554 = 4) OR (hd_vehicle_count#5555 = 3)) AND isnotnull(hd_demo_sk#5551))
         :     :                 :                 +- *(3) ColumnarToRow
         :     :                 :                    +- FileScan parquet default.household_demographics[hd_demo_sk#5551,hd_dep_count#5554,hd_vehicle_count#5555] Batched: true, DataFilters: [((hd_dep_count#5554 = 4) OR (hd_vehicle_count#5555 = 3)), isnotnull(hd_demo_sk#5551)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://node001:9100/benchmark/tpcdsTable/household_demographics], PartitionFilters: [], PushedFilters: [Or(EqualTo(hd_dep_count,4),EqualTo(hd_vehicle_count,3)), IsNotNull(hd_demo_sk)], ReadSchema: struct<hd_demo_sk:int,hd_dep_count:int,hd_vehicle_count:int>
         :     :                 +- BroadcastQueryStage 3
         :     :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=100213]
         :     :                       +- *(4) Filter (isnotnull(ca_address_sk#3717) AND isnotnull(ca_city#3723))
         :     :                          +- *(4) ColumnarToRow
         :     :                             +- FileScan parquet default.customer_address[ca_address_sk#3717,ca_city#3723] Batched: true, DataFilters: [isnotnull(ca_address_sk#3717), isnotnull(ca_city#3723)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://node001:9100/benchmark/tpcdsTable/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk), IsNotNull(ca_city)], ReadSchema: struct<ca_address_sk:int,ca_city:string>
         :     +- BroadcastQueryStage 4
         :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=100237]
         :           +- *(5) Filter (isnotnull(c_customer_sk#81) AND isnotnull(c_current_addr_sk#85))
         :              +- *(5) ColumnarToRow
         :                 +- FileScan parquet default.customer[c_customer_sk#81,c_current_addr_sk#85,c_first_name#89,c_last_name#90] Batched: true, DataFilters: [isnotnull(c_customer_sk#81), isnotnull(c_current_addr_sk#85)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://node001:9100/benchmark/tpcdsTable/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_current_addr_sk)], ReadSchema: struct<c_customer_sk:int,c_current_addr_sk:int,c_first_name:string,c_last_name:string>
         +- BroadcastQueryStage 6
            +- ReusedExchange [ca_address_sk#12055, ca_city#12061], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=100213]

==== q47 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=13.3 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=8.29E+66 B)
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#12088 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#12089 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, s_store_name#57 ASC NULLS FIRST], true, Statistics(sizeInBytes=8.29E+66 B)
      +- Project [i_category#449, i_brand#445, s_store_name#57, s_company_name#69, d_year#30, d_moy#32, avg_monthly_sales#12089, sum_sales#12088, sum_sales#12113 AS psum#12091, sum_sales#12122 AS nsum#12092], Statistics(sizeInBytes=8.29E+66 B)
         +- Join Inner, (((((i_category#449 = i_category#12468) AND (i_brand#445 = i_brand#12464)) AND (s_store_name#57 = s_store_name#12534)) AND (s_company_name#69 = s_company_name#12546)) AND (rn#12090 = (rn#12562 - 1))), Statistics(sizeInBytes=1.36E+67 B)
            :- Project [i_category#449, i_brand#445, s_store_name#57, s_company_name#69, d_year#30, d_moy#32, sum_sales#12088, avg_monthly_sales#12089, rn#12090, sum_sales#12113], Statistics(sizeInBytes=5.21E+44 B)
            :  +- Join Inner, (((((i_category#449 = i_category#12361) AND (i_brand#445 = i_brand#12357)) AND (s_store_name#57 = s_store_name#12427)) AND (s_company_name#69 = s_company_name#12439)) AND (rn#12090 = (rn#12455 + 1))), Statistics(sizeInBytes=8.52E+44 B)
            :     :- Project [i_category#449, i_brand#445, s_store_name#57, s_company_name#69, d_year#30, d_moy#32, sum_sales#12088, avg_monthly_sales#12089, rn#12090], Statistics(sizeInBytes=3.25E+22 B)
            :     :  +- Filter ((isnotnull(avg_monthly_sales#12089) AND (avg_monthly_sales#12089 > 0.000000)) AND CASE WHEN (avg_monthly_sales#12089 > 0.000000) THEN (CheckOverflow((promote_precision(abs(CheckOverflow((promote_precision(cast(sum_sales#12088 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#12089 as decimal(22,6)))), DecimalType(22,6)))) / promote_precision(cast(avg_monthly_sales#12089 as decimal(22,6)))), DecimalType(38,16)) > 0.1000000000000000) END), Statistics(sizeInBytes=3.46E+22 B)
            :     :     +- Window [avg(_w0#12106) windowspecdefinition(i_category#449, i_brand#445, s_store_name#57, s_company_name#69, d_year#30, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#12089], [i_category#449, i_brand#445, s_store_name#57, s_company_name#69, d_year#30], Statistics(sizeInBytes=3.46E+22 B)
            :     :        +- Filter (isnotnull(d_year#30) AND (d_year#30 = 1999)), Statistics(sizeInBytes=3.04E+22 B)
            :     :           +- Window [rank(d_year#30, d_moy#32) windowspecdefinition(i_category#449, i_brand#445, s_store_name#57, s_company_name#69, d_year#30 ASC NULLS FIRST, d_moy#32 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#12090], [i_category#449, i_brand#445, s_store_name#57, s_company_name#69], [d_year#30 ASC NULLS FIRST, d_moy#32 ASC NULLS FIRST], Statistics(sizeInBytes=3.04E+22 B)
            :     :              +- Aggregate [i_category#449, i_brand#445, s_store_name#57, s_company_name#69, d_year#30, d_moy#32], [i_category#449, i_brand#445, s_store_name#57, s_company_name#69, d_year#30, d_moy#32, MakeDecimal(sum(UnscaledValue(ss_sales_price#427)),17,2) AS sum_sales#12088, MakeDecimal(sum(UnscaledValue(ss_sales_price#427)),17,2) AS _w0#12106], Statistics(sizeInBytes=2.94E+22 B)
            :     :                 +- Project [i_brand#445, i_category#449, ss_sales_price#427, d_year#30, d_moy#32, s_store_name#57, s_company_name#69], Statistics(sizeInBytes=2.73E+22 B)
            :     :                    +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=2.94E+22 B)
            :     :                       :- Project [i_brand#445, i_category#449, ss_store_sk#421, ss_sales_price#427, d_year#30, d_moy#32], Statistics(sizeInBytes=2023.5 PiB)
            :     :                       :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2.2 EiB)
            :     :                       :     :- Project [i_brand#445, i_category#449, ss_sold_date_sk#414, ss_store_sk#421, ss_sales_price#427], Statistics(sizeInBytes=12.9 TiB)
            :     :                       :     :  +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=14.5 TiB)
            :     :                       :     :     :- Project [i_item_sk#437, i_brand#445, i_category#449], Statistics(sizeInBytes=556.2 KiB)
            :     :                       :     :     :  +- Filter (isnotnull(i_item_sk#437) AND (isnotnull(i_category#449) AND isnotnull(i_brand#445))), Statistics(sizeInBytes=3.1 MiB)
            :     :                       :     :     :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
            :     :                       :     :     +- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_sales_price#427], Statistics(sizeInBytes=26.7 MiB)
            :     :                       :     :        +- Filter (isnotnull(ss_item_sk#416) AND (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421))), Statistics(sizeInBytes=141.1 MiB)
            :     :                       :     :           +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     :                       :     +- Project [d_date_sk#24, d_year#30, d_moy#32], Statistics(sizeInBytes=175.5 KiB)
            :     :                       :        +- Filter ((((d_year#30 = 1999) OR ((d_year#30 = 1998) AND (d_moy#32 = 12))) OR ((d_year#30 = 2000) AND (d_moy#32 = 1))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :     :                       :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :                       +- Project [s_store_sk#52, s_store_name#57, s_company_name#69], Statistics(sizeInBytes=12.6 KiB)
            :     :                          +- Filter (isnotnull(s_store_sk#52) AND (isnotnull(s_store_name#57) AND isnotnull(s_company_name#69))), Statistics(sizeInBytes=101.7 KiB)
            :     :                             +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
            :     +- Project [i_category#12361, i_brand#12357, s_store_name#12427, s_company_name#12439, sum_sales#12088 AS sum_sales#12113, rn#12455], Statistics(sizeInBytes=2.62E+22 B)
            :        +- Window [rank(d_year#12400, d_moy#12402) windowspecdefinition(i_category#12361, i_brand#12357, s_store_name#12427, s_company_name#12439, d_year#12400 ASC NULLS FIRST, d_moy#12402 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#12455], [i_category#12361, i_brand#12357, s_store_name#12427, s_company_name#12439], [d_year#12400 ASC NULLS FIRST, d_moy#12402 ASC NULLS FIRST], Statistics(sizeInBytes=2.83E+22 B)
            :           +- Aggregate [i_category#12361, i_brand#12357, s_store_name#12427, s_company_name#12439, d_year#12400, d_moy#12402], [i_category#12361, i_brand#12357, s_store_name#12427, s_company_name#12439, d_year#12400, d_moy#12402, MakeDecimal(sum(UnscaledValue(ss_sales_price#12384)),17,2) AS sum_sales#12088], Statistics(sizeInBytes=2.73E+22 B)
            :              +- Project [i_brand#12357, i_category#12361, ss_sales_price#12384, d_year#12400, d_moy#12402, s_store_name#12427, s_company_name#12439], Statistics(sizeInBytes=2.73E+22 B)
            :                 +- Join Inner, (ss_store_sk#12378 = s_store_sk#12422), Statistics(sizeInBytes=2.94E+22 B)
            :                    :- Project [i_brand#12357, i_category#12361, ss_store_sk#12378, ss_sales_price#12384, d_year#12400, d_moy#12402], Statistics(sizeInBytes=2023.5 PiB)
            :                    :  +- Join Inner, (ss_sold_date_sk#12371 = d_date_sk#12394), Statistics(sizeInBytes=2.2 EiB)
            :                    :     :- Project [i_brand#12357, i_category#12361, ss_sold_date_sk#12371, ss_store_sk#12378, ss_sales_price#12384], Statistics(sizeInBytes=12.9 TiB)
            :                    :     :  +- Join Inner, (ss_item_sk#12373 = i_item_sk#12349), Statistics(sizeInBytes=14.5 TiB)
            :                    :     :     :- Project [i_item_sk#12349, i_brand#12357, i_category#12361], Statistics(sizeInBytes=556.2 KiB)
            :                    :     :     :  +- Filter (isnotnull(i_item_sk#12349) AND (isnotnull(i_category#12361) AND isnotnull(i_brand#12357))), Statistics(sizeInBytes=3.1 MiB)
            :                    :     :     :     +- Relation default.item[i_item_sk#12349,i_item_id#12350,i_rec_start_date#12351,i_rec_end_date#12352,i_item_desc#12353,i_current_price#12354,i_wholesale_cost#12355,i_brand_id#12356,i_brand#12357,i_class_id#12358,i_class#12359,i_category_id#12360,i_category#12361,i_manufact_id#12362,i_manufact#12363,i_size#12364,i_formulation#12365,i_color#12366,i_units#12367,i_container#12368,i_manager_id#12369,i_product_name#12370] parquet, Statistics(sizeInBytes=3.1 MiB)
            :                    :     :     +- Project [ss_sold_date_sk#12371, ss_item_sk#12373, ss_store_sk#12378, ss_sales_price#12384], Statistics(sizeInBytes=26.7 MiB)
            :                    :     :        +- Filter ((isnotnull(ss_item_sk#12373) AND isnotnull(ss_sold_date_sk#12371)) AND isnotnull(ss_store_sk#12378)), Statistics(sizeInBytes=141.1 MiB)
            :                    :     :           +- Relation default.store_sales[ss_sold_date_sk#12371,ss_sold_time_sk#12372,ss_item_sk#12373,ss_customer_sk#12374,ss_cdemo_sk#12375,ss_hdemo_sk#12376,ss_addr_sk#12377,ss_store_sk#12378,ss_promo_sk#12379,ss_ticket_number#12380,ss_quantity#12381,ss_wholesale_cost#12382,ss_list_price#12383,ss_sales_price#12384,ss_ext_discount_amt#12385,ss_ext_sales_price#12386,ss_ext_wholesale_cost#12387,ss_ext_list_price#12388,ss_ext_tax#12389,ss_coupon_amt#12390,ss_net_paid#12391,ss_net_paid_inc_tax#12392,ss_net_profit#12393] parquet, Statistics(sizeInBytes=141.1 MiB)
            :                    :     +- Project [d_date_sk#12394, d_year#12400, d_moy#12402], Statistics(sizeInBytes=175.5 KiB)
            :                    :        +- Filter ((((d_year#12400 = 1999) OR ((d_year#12400 = 1998) AND (d_moy#12402 = 12))) OR ((d_year#12400 = 2000) AND (d_moy#12402 = 1))) AND isnotnull(d_date_sk#12394)), Statistics(sizeInBytes=2.5 MiB)
            :                    :           +- Relation default.date_dim[d_date_sk#12394,d_date_id#12395,d_date#12396,d_month_seq#12397,d_week_seq#12398,d_quarter_seq#12399,d_year#12400,d_dow#12401,d_moy#12402,d_dom#12403,d_qoy#12404,d_fy_year#12405,d_fy_quarter_seq#12406,d_fy_week_seq#12407,d_day_name#12408,d_quarter_name#12409,d_holiday#12410,d_weekend#12411,d_following_holiday#12412,d_first_dom#12413,d_last_dom#12414,d_same_day_ly#12415,d_same_day_lq#12416,d_current_day#12417,d_current_week#12418,d_current_month#12419,d_current_quarter#12420,d_current_year#12421] parquet, Statistics(sizeInBytes=2.5 MiB)
            :                    +- Project [s_store_sk#12422, s_store_name#12427, s_company_name#12439], Statistics(sizeInBytes=12.6 KiB)
            :                       +- Filter (isnotnull(s_store_sk#12422) AND (isnotnull(s_store_name#12427) AND isnotnull(s_company_name#12439))), Statistics(sizeInBytes=101.7 KiB)
            :                          +- Relation default.store[s_store_sk#12422,s_store_id#12423,s_rec_start_date#12424,s_rec_end_date#12425,s_closed_date_sk#12426,s_store_name#12427,s_number_employees#12428,s_floor_space#12429,s_hours#12430,s_manager#12431,s_market_id#12432,s_geography_class#12433,s_market_desc#12434,s_market_manager#12435,s_division_id#12436,s_division_name#12437,s_company_id#12438,s_company_name#12439,s_street_number#12440,s_street_name#12441,s_street_type#12442,s_suite_number#12443,s_city#12444,s_county#12445,s_state#12446,s_zip#12447,s_country#12448,s_gmt_offset#12449,s_tax_percentage#12450] parquet, Statistics(sizeInBytes=101.7 KiB)
            +- Project [i_category#12468, i_brand#12464, s_store_name#12534, s_company_name#12546, sum_sales#12088 AS sum_sales#12122, rn#12562], Statistics(sizeInBytes=2.62E+22 B)
               +- Window [rank(d_year#12507, d_moy#12509) windowspecdefinition(i_category#12468, i_brand#12464, s_store_name#12534, s_company_name#12546, d_year#12507 ASC NULLS FIRST, d_moy#12509 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#12562], [i_category#12468, i_brand#12464, s_store_name#12534, s_company_name#12546], [d_year#12507 ASC NULLS FIRST, d_moy#12509 ASC NULLS FIRST], Statistics(sizeInBytes=2.83E+22 B)
                  +- Aggregate [i_category#12468, i_brand#12464, s_store_name#12534, s_company_name#12546, d_year#12507, d_moy#12509], [i_category#12468, i_brand#12464, s_store_name#12534, s_company_name#12546, d_year#12507, d_moy#12509, MakeDecimal(sum(UnscaledValue(ss_sales_price#12491)),17,2) AS sum_sales#12088], Statistics(sizeInBytes=2.73E+22 B)
                     +- Project [i_brand#12464, i_category#12468, ss_sales_price#12491, d_year#12507, d_moy#12509, s_store_name#12534, s_company_name#12546], Statistics(sizeInBytes=2.73E+22 B)
                        +- Join Inner, (ss_store_sk#12485 = s_store_sk#12529), Statistics(sizeInBytes=2.94E+22 B)
                           :- Project [i_brand#12464, i_category#12468, ss_store_sk#12485, ss_sales_price#12491, d_year#12507, d_moy#12509], Statistics(sizeInBytes=2023.5 PiB)
                           :  +- Join Inner, (ss_sold_date_sk#12478 = d_date_sk#12501), Statistics(sizeInBytes=2.2 EiB)
                           :     :- Project [i_brand#12464, i_category#12468, ss_sold_date_sk#12478, ss_store_sk#12485, ss_sales_price#12491], Statistics(sizeInBytes=12.9 TiB)
                           :     :  +- Join Inner, (ss_item_sk#12480 = i_item_sk#12456), Statistics(sizeInBytes=14.5 TiB)
                           :     :     :- Project [i_item_sk#12456, i_brand#12464, i_category#12468], Statistics(sizeInBytes=556.2 KiB)
                           :     :     :  +- Filter (isnotnull(i_item_sk#12456) AND (isnotnull(i_category#12468) AND isnotnull(i_brand#12464))), Statistics(sizeInBytes=3.1 MiB)
                           :     :     :     +- Relation default.item[i_item_sk#12456,i_item_id#12457,i_rec_start_date#12458,i_rec_end_date#12459,i_item_desc#12460,i_current_price#12461,i_wholesale_cost#12462,i_brand_id#12463,i_brand#12464,i_class_id#12465,i_class#12466,i_category_id#12467,i_category#12468,i_manufact_id#12469,i_manufact#12470,i_size#12471,i_formulation#12472,i_color#12473,i_units#12474,i_container#12475,i_manager_id#12476,i_product_name#12477] parquet, Statistics(sizeInBytes=3.1 MiB)
                           :     :     +- Project [ss_sold_date_sk#12478, ss_item_sk#12480, ss_store_sk#12485, ss_sales_price#12491], Statistics(sizeInBytes=26.7 MiB)
                           :     :        +- Filter ((isnotnull(ss_item_sk#12480) AND isnotnull(ss_sold_date_sk#12478)) AND isnotnull(ss_store_sk#12485)), Statistics(sizeInBytes=141.1 MiB)
                           :     :           +- Relation default.store_sales[ss_sold_date_sk#12478,ss_sold_time_sk#12479,ss_item_sk#12480,ss_customer_sk#12481,ss_cdemo_sk#12482,ss_hdemo_sk#12483,ss_addr_sk#12484,ss_store_sk#12485,ss_promo_sk#12486,ss_ticket_number#12487,ss_quantity#12488,ss_wholesale_cost#12489,ss_list_price#12490,ss_sales_price#12491,ss_ext_discount_amt#12492,ss_ext_sales_price#12493,ss_ext_wholesale_cost#12494,ss_ext_list_price#12495,ss_ext_tax#12496,ss_coupon_amt#12497,ss_net_paid#12498,ss_net_paid_inc_tax#12499,ss_net_profit#12500] parquet, Statistics(sizeInBytes=141.1 MiB)
                           :     +- Project [d_date_sk#12501, d_year#12507, d_moy#12509], Statistics(sizeInBytes=175.5 KiB)
                           :        +- Filter ((((d_year#12507 = 1999) OR ((d_year#12507 = 1998) AND (d_moy#12509 = 12))) OR ((d_year#12507 = 2000) AND (d_moy#12509 = 1))) AND isnotnull(d_date_sk#12501)), Statistics(sizeInBytes=2.5 MiB)
                           :           +- Relation default.date_dim[d_date_sk#12501,d_date_id#12502,d_date#12503,d_month_seq#12504,d_week_seq#12505,d_quarter_seq#12506,d_year#12507,d_dow#12508,d_moy#12509,d_dom#12510,d_qoy#12511,d_fy_year#12512,d_fy_quarter_seq#12513,d_fy_week_seq#12514,d_day_name#12515,d_quarter_name#12516,d_holiday#12517,d_weekend#12518,d_following_holiday#12519,d_first_dom#12520,d_last_dom#12521,d_same_day_ly#12522,d_same_day_lq#12523,d_current_day#12524,d_current_week#12525,d_current_month#12526,d_current_quarter#12527,d_current_year#12528] parquet, Statistics(sizeInBytes=2.5 MiB)
                           +- Project [s_store_sk#12529, s_store_name#12534, s_company_name#12546], Statistics(sizeInBytes=12.6 KiB)
                              +- Filter (isnotnull(s_store_sk#12529) AND (isnotnull(s_store_name#12534) AND isnotnull(s_company_name#12546))), Statistics(sizeInBytes=101.7 KiB)
                                 +- Relation default.store[s_store_sk#12529,s_store_id#12530,s_rec_start_date#12531,s_rec_end_date#12532,s_closed_date_sk#12533,s_store_name#12534,s_number_employees#12535,s_floor_space#12536,s_hours#12537,s_manager#12538,s_market_id#12539,s_geography_class#12540,s_market_desc#12541,s_market_manager#12542,s_division_id#12543,s_division_name#12544,s_company_id#12545,s_company_name#12546,s_street_number#12547,s_street_name#12548,s_street_type#12549,s_suite_number#12550,s_city#12551,s_county#12552,s_state#12553,s_zip#12554,s_country#12555,s_gmt_offset#12556,s_tax_percentage#12557] parquet, Statistics(sizeInBytes=101.7 KiB)


==== q48 ==== 
== Optimized Logical Plan ==
Aggregate [sum(ss_quantity#424) AS sum(ss_quantity)#12705L], Statistics(sizeInBytes=16.0 B, rowCount=1)
+- Project [ss_quantity#424], Statistics(sizeInBytes=9.71E+26 B)
   +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=1.62E+27 B)
      :- Project [ss_sold_date_sk#414, ss_quantity#424], Statistics(sizeInBytes=1.50E+22 B)
      :  +- Join Inner, ((ss_addr_sk#420 = ca_address_sk#3717) AND ((((ca_state#3725 IN (CO,OH,TX) AND (ss_net_profit#436 >= 0.00)) AND (ss_net_profit#436 <= 2000.00)) OR ((ca_state#3725 IN (OR,MN,KY) AND (ss_net_profit#436 >= 150.00)) AND (ss_net_profit#436 <= 3000.00))) OR ((ca_state#3725 IN (VA,CA,MS) AND (ss_net_profit#436 >= 50.00)) AND (ss_net_profit#436 <= 25000.00)))), Statistics(sizeInBytes=4.88E+22 B)
      :     :- Project [ss_sold_date_sk#414, ss_addr_sk#420, ss_quantity#424, ss_net_profit#436], Statistics(sizeInBytes=125.8 PiB)
      :     :  +- Join Inner, ((cd_demo_sk#3633 = ss_cdemo_sk#418) AND ((((((cd_marital_status#3635 = M) AND (cd_education_status#3636 = 4 yr Degree         )) AND (ss_sales_price#427 >= 100.00)) AND (ss_sales_price#427 <= 150.00)) OR ((((cd_marital_status#3635 = D) AND (cd_education_status#3636 = 2 yr Degree         )) AND (ss_sales_price#427 >= 50.00)) AND (ss_sales_price#427 <= 100.00))) OR ((((cd_marital_status#3635 = S) AND (cd_education_status#3636 = College             )) AND (ss_sales_price#427 >= 150.00)) AND (ss_sales_price#427 <= 200.00)))), Statistics(sizeInBytes=377.4 PiB)
      :     :     :- Project [ss_sold_date_sk#414, ss_cdemo_sk#418, ss_addr_sk#420, ss_quantity#424, ss_sales_price#427, ss_net_profit#436], Statistics(sizeInBytes=101.5 GiB)
      :     :     :  +- Join Inner, (s_store_sk#52 = ss_store_sk#421), Statistics(sizeInBytes=121.8 GiB)
      :     :     :     :- Project [ss_sold_date_sk#414, ss_cdemo_sk#418, ss_addr_sk#420, ss_store_sk#421, ss_quantity#424, ss_sales_price#427, ss_net_profit#436], Statistics(sizeInBytes=41.9 MiB)
      :     :     :     :  +- Filter (((isnotnull(ss_store_sk#421) AND isnotnull(ss_cdemo_sk#418)) AND (isnotnull(ss_addr_sk#420) AND isnotnull(ss_sold_date_sk#414))) AND (((((ss_sales_price#427 >= 100.00) AND (ss_sales_price#427 <= 150.00)) OR ((ss_sales_price#427 >= 50.00) AND (ss_sales_price#427 <= 100.00))) OR ((ss_sales_price#427 >= 150.00) AND (ss_sales_price#427 <= 200.00))) AND ((((ss_net_profit#436 >= 0.00) AND (ss_net_profit#436 <= 2000.00)) OR ((ss_net_profit#436 >= 150.00) AND (ss_net_profit#436 <= 3000.00))) OR ((ss_net_profit#436 >= 50.00) AND (ss_net_profit#436 <= 25000.00))))), Statistics(sizeInBytes=141.1 MiB)
      :     :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
      :     :     :     +- Project [s_store_sk#52], Statistics(sizeInBytes=2.9 KiB)
      :     :     :        +- Filter isnotnull(s_store_sk#52), Statistics(sizeInBytes=101.7 KiB)
      :     :     :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
      :     :     +- Project [cd_demo_sk#3633, cd_marital_status#3635, cd_education_status#3636], Statistics(sizeInBytes=3.7 MiB)
      :     :        +- Filter (isnotnull(cd_demo_sk#3633) AND ((((cd_marital_status#3635 = M) AND (cd_education_status#3636 = 4 yr Degree         )) OR ((cd_marital_status#3635 = D) AND (cd_education_status#3636 = 2 yr Degree         ))) OR ((cd_marital_status#3635 = S) AND (cd_education_status#3636 = College             )))), Statistics(sizeInBytes=7.7 MiB)
      :     :           +- Relation default.customer_demographics[cd_demo_sk#3633,cd_gender#3634,cd_marital_status#3635,cd_education_status#3636,cd_purchase_estimate#3637,cd_credit_rating#3638,cd_dep_count#3639,cd_dep_employed_count#3640,cd_dep_college_count#3641] parquet, Statistics(sizeInBytes=7.7 MiB)
      :     +- Project [ca_address_sk#3717, ca_state#3725], Statistics(sizeInBytes=336.4 KiB)
      :        +- Filter (((isnotnull(ca_country#3727) AND (ca_country#3727 = United States)) AND isnotnull(ca_address_sk#3717)) AND ((ca_state#3725 IN (CO,OH,TX) OR ca_state#3725 IN (OR,MN,KY)) OR ca_state#3725 IN (VA,CA,MS))), Statistics(sizeInBytes=2.5 MiB)
      :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
      +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
         +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2001)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q49 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=5.5 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=18.1 EiB)
   +- Sort [channel#12717 ASC NULLS FIRST, return_rank#12715 ASC NULLS FIRST, currency_rank#12716 ASC NULLS FIRST], true, Statistics(sizeInBytes=18.1 EiB)
      +- Aggregate [channel#12717, item#12712, return_ratio#12713, return_rank#12715, currency_rank#12716], [channel#12717, item#12712, return_ratio#12713, return_rank#12715, currency_rank#12716], Statistics(sizeInBytes=18.1 EiB)
         +- Union false, false, Statistics(sizeInBytes=18.1 EiB)
            :- Project [web AS channel#12717, item#12712, return_ratio#12713, return_rank#12715, currency_rank#12716], Statistics(sizeInBytes=1092.8 PiB)
            :  +- Filter ((return_rank#12715 <= 10) OR (currency_rank#12716 <= 10)), Statistics(sizeInBytes=1014.8 PiB)
            :     +- Window [rank(currency_ratio#12714) windowspecdefinition(currency_ratio#12714 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#12716], [currency_ratio#12714 ASC NULLS FIRST], Statistics(sizeInBytes=1014.8 PiB)
            :        +- Window [rank(return_ratio#12713) windowspecdefinition(return_ratio#12713 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#12715], [return_ratio#12713 ASC NULLS FIRST], Statistics(sizeInBytes=936.7 PiB)
            :           +- Aggregate [ws_item_sk#166], [ws_item_sk#166 AS item#12712, CheckOverflow((promote_precision(cast(sum(coalesce(wr_return_quantity#3341, 0)) as decimal(15,4))) / promote_precision(cast(sum(coalesce(ws_quantity#181, 0)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#12713, CheckOverflow((promote_precision(cast(sum(coalesce(cast(wr_return_amt#3342 as decimal(12,2)), 0.00)) as decimal(15,4))) / promote_precision(cast(sum(coalesce(cast(ws_net_paid#192 as decimal(12,2)), 0.00)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#12714], Statistics(sizeInBytes=858.6 PiB)
            :              +- Project [ws_item_sk#166, ws_quantity#181, ws_net_paid#192, wr_return_quantity#3341, wr_return_amt#3342], Statistics(sizeInBytes=702.5 PiB)
            :                 +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#24), Statistics(sizeInBytes=858.6 PiB)
            :                    :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_quantity#181, ws_net_paid#192, wr_return_quantity#3341, wr_return_amt#3342], Statistics(sizeInBytes=8.2 TiB)
            :                    :  +- Join Inner, ((ws_order_number#180 = wr_order_number#3340) AND (ws_item_sk#166 = wr_item_sk#3329)), Statistics(sizeInBytes=10.6 TiB)
            :                    :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_order_number#180, ws_quantity#181, ws_net_paid#192], Statistics(sizeInBytes=8.2 MiB)
            :                    :     :  +- Filter ((((isnotnull(ws_net_profit#196) AND isnotnull(ws_net_paid#192)) AND isnotnull(ws_quantity#181)) AND (((ws_net_profit#196 > 1.00) AND (ws_net_paid#192 > 0.00)) AND (ws_quantity#181 > 0))) AND ((isnotnull(ws_order_number#180) AND isnotnull(ws_item_sk#166)) AND isnotnull(ws_sold_date_sk#163))), Statistics(sizeInBytes=52.0 MiB)
            :                    :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
            :                    :     +- Project [wr_item_sk#3329, wr_order_number#3340, wr_return_quantity#3341, wr_return_amt#3342], Statistics(sizeInBytes=1331.1 KiB)
            :                    :        +- Filter ((isnotnull(wr_return_amt#3342) AND (wr_return_amt#3342 > 10000.00)) AND (isnotnull(wr_order_number#3340) AND isnotnull(wr_item_sk#3329))), Statistics(sizeInBytes=6.5 MiB)
            :                    :           +- Relation default.web_returns[wr_returned_date_sk#3327,wr_returned_time_sk#3328,wr_item_sk#3329,wr_refunded_customer_sk#3330,wr_refunded_cdemo_sk#3331,wr_refunded_hdemo_sk#3332,wr_refunded_addr_sk#3333,wr_returning_customer_sk#3334,wr_returning_cdemo_sk#3335,wr_returning_hdemo_sk#3336,wr_returning_addr_sk#3337,wr_web_page_sk#3338,wr_reason_sk#3339,wr_order_number#3340,wr_return_quantity#3341,wr_return_amt#3342,wr_return_tax#3343,wr_return_amt_inc_tax#3344,wr_fee#3345,wr_return_ship_cost#3346,wr_refunded_cash#3347,wr_reversed_charge#3348,wr_account_credit#3349,wr_net_loss#3350] parquet, Statistics(sizeInBytes=6.5 MiB)
            :                    +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
            :                       +- Filter (((isnotnull(d_year#30) AND isnotnull(d_moy#32)) AND ((d_year#30 = 2001) AND (d_moy#32 = 12))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :                          +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :- Project [catalog AS channel#12723, item#12718, return_ratio#12719, return_rank#12721, currency_rank#12722], Statistics(sizeInBytes=3.9 EiB)
            :  +- Filter ((return_rank#12721 <= 10) OR (currency_rank#12722 <= 10)), Statistics(sizeInBytes=3.6 EiB)
            :     +- Window [rank(currency_ratio#12720) windowspecdefinition(currency_ratio#12720 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#12722], [currency_ratio#12720 ASC NULLS FIRST], Statistics(sizeInBytes=3.6 EiB)
            :        +- Window [rank(return_ratio#12719) windowspecdefinition(return_ratio#12719 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#12721], [return_ratio#12719 ASC NULLS FIRST], Statistics(sizeInBytes=3.3 EiB)
            :           +- Aggregate [cs_item_sk#212], [cs_item_sk#212 AS item#12718, CheckOverflow((promote_precision(cast(sum(coalesce(cr_return_quantity#3308, 0)) as decimal(15,4))) / promote_precision(cast(sum(coalesce(cs_quantity#215, 0)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#12719, CheckOverflow((promote_precision(cast(sum(coalesce(cast(cr_return_amount#3309 as decimal(12,2)), 0.00)) as decimal(15,4))) / promote_precision(cast(sum(coalesce(cast(cs_net_paid#226 as decimal(12,2)), 0.00)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#12720], Statistics(sizeInBytes=3.0 EiB)
            :              +- Project [cs_item_sk#212, cs_quantity#215, cs_net_paid#226, cr_return_quantity#3308, cr_return_amount#3309], Statistics(sizeInBytes=2.5 EiB)
            :                 +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#12742), Statistics(sizeInBytes=3.0 EiB)
            :                    :- Project [cs_sold_date_sk#197, cs_item_sk#212, cs_quantity#215, cs_net_paid#226, cr_return_quantity#3308, cr_return_amount#3309], Statistics(sizeInBytes=29.6 TiB)
            :                    :  +- Join Inner, ((cs_order_number#214 = cr_order_number#3307) AND (cs_item_sk#212 = cr_item_sk#3293)), Statistics(sizeInBytes=38.4 TiB)
            :                    :     :- Project [cs_sold_date_sk#197, cs_item_sk#212, cs_order_number#214, cs_quantity#215, cs_net_paid#226], Statistics(sizeInBytes=16.6 MiB)
            :                    :     :  +- Filter ((((isnotnull(cs_net_profit#230) AND isnotnull(cs_net_paid#226)) AND isnotnull(cs_quantity#215)) AND (((cs_net_profit#230 > 1.00) AND (cs_net_paid#226 > 0.00)) AND (cs_quantity#215 > 0))) AND ((isnotnull(cs_order_number#214) AND isnotnull(cs_item_sk#212)) AND isnotnull(cs_sold_date_sk#197))), Statistics(sizeInBytes=105.8 MiB)
            :                    :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
            :                    :     +- Project [cr_item_sk#3293, cr_order_number#3307, cr_return_quantity#3308, cr_return_amount#3309], Statistics(sizeInBytes=2.3 MiB)
            :                    :        +- Filter ((isnotnull(cr_return_amount#3309) AND (cr_return_amount#3309 > 10000.00)) AND (isnotnull(cr_order_number#3307) AND isnotnull(cr_item_sk#3293))), Statistics(sizeInBytes=12.6 MiB)
            :                    :           +- Relation default.catalog_returns[cr_returned_date_sk#3291,cr_returned_time_sk#3292,cr_item_sk#3293,cr_refunded_customer_sk#3294,cr_refunded_cdemo_sk#3295,cr_refunded_hdemo_sk#3296,cr_refunded_addr_sk#3297,cr_returning_customer_sk#3298,cr_returning_cdemo_sk#3299,cr_returning_hdemo_sk#3300,cr_returning_addr_sk#3301,cr_call_center_sk#3302,cr_catalog_page_sk#3303,cr_ship_mode_sk#3304,cr_warehouse_sk#3305,cr_reason_sk#3306,cr_order_number#3307,cr_return_quantity#3308,cr_return_amount#3309,cr_return_tax#3310,cr_return_amt_inc_tax#3311,cr_fee#3312,cr_return_ship_cost#3313,cr_refunded_cash#3314,cr_reversed_charge#3315,cr_store_credit#3316,cr_net_loss#3317] parquet, Statistics(sizeInBytes=12.6 MiB)
            :                    +- Project [d_date_sk#12742], Statistics(sizeInBytes=105.3 KiB)
            :                       +- Filter (((isnotnull(d_year#12748) AND isnotnull(d_moy#12750)) AND ((d_year#12748 = 2001) AND (d_moy#12750 = 12))) AND isnotnull(d_date_sk#12742)), Statistics(sizeInBytes=2.5 MiB)
            :                          +- Relation default.date_dim[d_date_sk#12742,d_date_id#12743,d_date#12744,d_month_seq#12745,d_week_seq#12746,d_quarter_seq#12747,d_year#12748,d_dow#12749,d_moy#12750,d_dom#12751,d_qoy#12752,d_fy_year#12753,d_fy_quarter_seq#12754,d_fy_week_seq#12755,d_day_name#12756,d_quarter_name#12757,d_holiday#12758,d_weekend#12759,d_following_holiday#12760,d_first_dom#12761,d_last_dom#12762,d_same_day_ly#12763,d_same_day_lq#12764,d_current_day#12765,d_current_week#12766,d_current_month#12767,d_current_quarter#12768,d_current_year#12769] parquet, Statistics(sizeInBytes=2.5 MiB)
            +- Project [store AS channel#12729, item#12724, return_ratio#12725, return_rank#12727, currency_rank#12728], Statistics(sizeInBytes=13.2 EiB)
               +- Filter ((return_rank#12727 <= 10) OR (currency_rank#12728 <= 10)), Statistics(sizeInBytes=12.3 EiB)
                  +- Window [rank(currency_ratio#12726) windowspecdefinition(currency_ratio#12726 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#12728], [currency_ratio#12726 ASC NULLS FIRST], Statistics(sizeInBytes=12.3 EiB)
                     +- Window [rank(return_ratio#12725) windowspecdefinition(return_ratio#12725 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#12727], [return_ratio#12725 ASC NULLS FIRST], Statistics(sizeInBytes=11.3 EiB)
                        +- Aggregate [ss_item_sk#416], [ss_item_sk#416 AS item#12724, CheckOverflow((promote_precision(cast(sum(coalesce(sr_return_quantity#14, 0)) as decimal(15,4))) / promote_precision(cast(sum(coalesce(ss_quantity#424, 0)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#12725, CheckOverflow((promote_precision(cast(sum(coalesce(cast(sr_return_amt#15 as decimal(12,2)), 0.00)) as decimal(15,4))) / promote_precision(cast(sum(coalesce(cast(ss_net_paid#434 as decimal(12,2)), 0.00)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#12726], Statistics(sizeInBytes=10.4 EiB)
                           +- Project [ss_item_sk#416, ss_quantity#424, ss_net_paid#434, sr_return_quantity#14, sr_return_amt#15], Statistics(sizeInBytes=8.5 EiB)
                              +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#12770), Statistics(sizeInBytes=10.4 EiB)
                                 :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_quantity#424, ss_net_paid#434, sr_return_quantity#14, sr_return_amt#15], Statistics(sizeInBytes=100.8 TiB)
                                 :  +- Join Inner, ((ss_ticket_number#423 = sr_ticket_number#13) AND (ss_item_sk#416 = sr_item_sk#6)), Statistics(sizeInBytes=131.0 TiB)
                                 :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_ticket_number#423, ss_quantity#424, ss_net_paid#434], Statistics(sizeInBytes=30.5 MiB)
                                 :     :  +- Filter ((((isnotnull(ss_net_profit#436) AND isnotnull(ss_net_paid#434)) AND isnotnull(ss_quantity#424)) AND (((ss_net_profit#436 > 1.00) AND (ss_net_paid#434 > 0.00)) AND (ss_quantity#424 > 0))) AND ((isnotnull(ss_ticket_number#423) AND isnotnull(ss_item_sk#416)) AND isnotnull(ss_sold_date_sk#414))), Statistics(sizeInBytes=141.1 MiB)
                                 :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                                 :     +- Project [sr_item_sk#6, sr_ticket_number#13, sr_return_quantity#14, sr_return_amt#15], Statistics(sizeInBytes=4.3 MiB)
                                 :        +- Filter ((isnotnull(sr_return_amt#15) AND (sr_return_amt#15 > 10000.00)) AND (isnotnull(sr_ticket_number#13) AND isnotnull(sr_item_sk#6))), Statistics(sizeInBytes=19.0 MiB)
                                 :           +- Relation default.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet, Statistics(sizeInBytes=19.0 MiB)
                                 +- Project [d_date_sk#12770], Statistics(sizeInBytes=105.3 KiB)
                                    +- Filter (((isnotnull(d_year#12776) AND isnotnull(d_moy#12778)) AND ((d_year#12776 = 2001) AND (d_moy#12778 = 12))) AND isnotnull(d_date_sk#12770)), Statistics(sizeInBytes=2.5 MiB)
                                       +- Relation default.date_dim[d_date_sk#12770,d_date_id#12771,d_date#12772,d_month_seq#12773,d_week_seq#12774,d_quarter_seq#12775,d_year#12776,d_dow#12777,d_moy#12778,d_dom#12779,d_qoy#12780,d_fy_year#12781,d_fy_quarter_seq#12782,d_fy_week_seq#12783,d_day_name#12784,d_quarter_name#12785,d_holiday#12786,d_weekend#12787,d_following_holiday#12788,d_first_dom#12789,d_last_dom#12790,d_same_day_ly#12791,d_same_day_lq#12792,d_current_day#12793,d_current_week#12794,d_current_month#12795,d_current_quarter#12796,d_current_year#12797] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q50 ==== 
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=22.7 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=2.97E+28 B)
   +- Sort [s_store_name#57 ASC NULLS FIRST, s_company_id#68 ASC NULLS FIRST, s_street_number#70 ASC NULLS FIRST, s_street_name#71 ASC NULLS FIRST, s_street_type#72 ASC NULLS FIRST, s_suite_number#73 ASC NULLS FIRST, s_city#74 ASC NULLS FIRST, s_county#75 ASC NULLS FIRST, s_state#76 ASC NULLS FIRST, s_zip#77 ASC NULLS FIRST], true, Statistics(sizeInBytes=2.97E+28 B)
      +- Aggregate [s_store_name#57, s_company_id#68, s_street_number#70, s_street_name#71, s_street_type#72, s_suite_number#73, s_city#74, s_county#75, s_state#76, s_zip#77], [s_store_name#57, s_company_id#68, s_street_number#70, s_street_name#71, s_street_type#72, s_suite_number#73, s_city#74, s_county#75, s_state#76, s_zip#77, sum(CASE WHEN ((sr_returned_date_sk#4 - ss_sold_date_sk#414) <= 30) THEN 1 ELSE 0 END) AS 30 days #13471L, sum(CASE WHEN (((sr_returned_date_sk#4 - ss_sold_date_sk#414) > 30) AND ((sr_returned_date_sk#4 - ss_sold_date_sk#414) <= 60)) THEN 1 ELSE 0 END) AS 31 - 60 days #13472L, sum(CASE WHEN (((sr_returned_date_sk#4 - ss_sold_date_sk#414) > 60) AND ((sr_returned_date_sk#4 - ss_sold_date_sk#414) <= 90)) THEN 1 ELSE 0 END) AS 61 - 90 days #13473L, sum(CASE WHEN (((sr_returned_date_sk#4 - ss_sold_date_sk#414) > 90) AND ((sr_returned_date_sk#4 - ss_sold_date_sk#414) <= 120)) THEN 1 ELSE 0 END) AS 91 - 120 days #13474L, sum(CASE WHEN ((sr_returned_date_sk#4 - ss_sold_date_sk#414) > 120) THEN 1 ELSE 0 END) AS >120 days #13475L], Statistics(sizeInBytes=2.97E+28 B)
         +- Project [ss_sold_date_sk#414, sr_returned_date_sk#4, s_store_name#57, s_company_id#68, s_street_number#70, s_street_name#71, s_street_type#72, s_suite_number#73, s_city#74, s_county#75, s_state#76, s_zip#77], Statistics(sizeInBytes=2.56E+28 B)
            +- Join Inner, (sr_returned_date_sk#4 = d_date_sk#13476), Statistics(sizeInBytes=2.62E+28 B)
               :- Project [ss_sold_date_sk#414, sr_returned_date_sk#4, s_store_name#57, s_company_id#68, s_street_number#70, s_street_name#71, s_street_type#72, s_suite_number#73, s_city#74, s_county#75, s_state#76, s_zip#77], Statistics(sizeInBytes=2.43E+23 B)
               :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2.47E+23 B)
               :     :- Project [ss_sold_date_sk#414, sr_returned_date_sk#4, s_store_name#57, s_company_id#68, s_street_number#70, s_street_name#71, s_street_type#72, s_suite_number#73, s_city#74, s_county#75, s_state#76, s_zip#77], Statistics(sizeInBytes=2037.8 PiB)
               :     :  +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=2.1 EiB)
               :     :     :- Project [ss_sold_date_sk#414, ss_store_sk#421, sr_returned_date_sk#4], Statistics(sizeInBytes=44.7 TiB)
               :     :     :  +- Join Inner, (((ss_ticket_number#423 = sr_ticket_number#13) AND (ss_item_sk#416 = sr_item_sk#6)) AND (ss_customer_sk#417 = sr_customer_sk#7)), Statistics(sizeInBytes=98.3 TiB)
               :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_customer_sk#417, ss_store_sk#421, ss_ticket_number#423], Statistics(sizeInBytes=26.7 MiB)
               :     :     :     :  +- Filter ((((isnotnull(ss_ticket_number#423) AND isnotnull(ss_item_sk#416)) AND isnotnull(ss_customer_sk#417)) AND isnotnull(ss_store_sk#421)) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
               :     :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               :     :     :     +- Project [sr_returned_date_sk#4, sr_item_sk#6, sr_customer_sk#7, sr_ticket_number#13], Statistics(sizeInBytes=3.7 MiB)
               :     :     :        +- Filter (((isnotnull(sr_ticket_number#13) AND isnotnull(sr_item_sk#6)) AND isnotnull(sr_customer_sk#7)) AND isnotnull(sr_returned_date_sk#4)), Statistics(sizeInBytes=19.0 MiB)
               :     :     :           +- Relation default.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet, Statistics(sizeInBytes=19.0 MiB)
               :     :     +- Project [s_store_sk#52, s_store_name#57, s_company_id#68, s_street_number#70, s_street_name#71, s_street_type#72, s_suite_number#73, s_city#74, s_county#75, s_state#76, s_zip#77], Statistics(sizeInBytes=47.4 KiB)
               :     :        +- Filter isnotnull(s_store_sk#52), Statistics(sizeInBytes=101.7 KiB)
               :     :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
               :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :        +- Filter isnotnull(d_date_sk#24), Statistics(sizeInBytes=2.5 MiB)
               :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               +- Project [d_date_sk#13476], Statistics(sizeInBytes=105.3 KiB)
                  +- Filter (((isnotnull(d_year#13482) AND isnotnull(d_moy#13484)) AND ((d_year#13482 = 2001) AND (d_moy#13484 = 8))) AND isnotnull(d_date_sk#13476)), Statistics(sizeInBytes=2.5 MiB)
                     +- Relation default.date_dim[d_date_sk#13476,d_date_id#13477,d_date#13478,d_month_seq#13479,d_week_seq#13480,d_quarter_seq#13481,d_year#13482,d_dow#13483,d_moy#13484,d_dom#13485,d_qoy#13486,d_fy_year#13487,d_fy_quarter_seq#13488,d_fy_week_seq#13489,d_day_name#13490,d_quarter_name#13491,d_holiday#13492,d_weekend#13493,d_following_holiday#13494,d_first_dom#13495,d_last_dom#13496,d_same_day_ly#13497,d_same_day_lq#13498,d_current_day#13499,d_current_week#13500,d_current_month#13501,d_current_quarter#13502,d_current_year#13503] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q51 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=7.8 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=4.54E+24 B)
   +- Sort [item_sk#13550 ASC NULLS FIRST, d_date#13551 ASC NULLS FIRST], true, Statistics(sizeInBytes=4.54E+24 B)
      +- Filter ((isnotnull(web_cumulative#13554) AND isnotnull(store_cumulative#13555)) AND (web_cumulative#13554 > store_cumulative#13555)), Statistics(sizeInBytes=4.54E+24 B)
         +- Window [max(web_sales#13552) windowspecdefinition(item_sk#13550, d_date#13551 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS web_cumulative#13554, max(store_sales#13553) windowspecdefinition(item_sk#13550, d_date#13551 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS store_cumulative#13555], [item_sk#13550], [d_date#13551 ASC NULLS FIRST], Statistics(sizeInBytes=4.54E+24 B)
            +- Project [CASE WHEN isnotnull(item_sk#13556) THEN item_sk#13556 ELSE item_sk#13558 END AS item_sk#13550, CASE WHEN isnotnull(d_date#26) THEN d_date#26 ELSE d_date#13562 END AS d_date#13551, cume_sales#13557 AS web_sales#13552, cume_sales#13559 AS store_sales#13553], Statistics(sizeInBytes=2.73E+24 B)
               +- Join FullOuter, ((item_sk#13556 = item_sk#13558) AND (d_date#26 = d_date#13562)), Statistics(sizeInBytes=3.18E+24 B)
                  :- Project [item_sk#13556, d_date#26, cume_sales#13557], Statistics(sizeInBytes=858.7 GiB)
                  :  +- Window [sum(_w0#13593) windowspecdefinition(ws_item_sk#166, d_date#26 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#13557], [ws_item_sk#166], [d_date#26 ASC NULLS FIRST], Statistics(sizeInBytes=1180.7 GiB)
                  :     +- Aggregate [ws_item_sk#166, d_date#26], [ws_item_sk#166 AS item_sk#13556, d_date#26, MakeDecimal(sum(UnscaledValue(ws_sales_price#184)),17,2) AS _w0#13593, ws_item_sk#166], Statistics(sizeInBytes=751.3 GiB)
                  :        +- Project [ws_item_sk#166, ws_sales_price#184, d_date#26], Statistics(sizeInBytes=644.0 GiB)
                  :           +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#24), Statistics(sizeInBytes=858.7 GiB)
                  :              :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_sales_price#184], Statistics(sizeInBytes=6.1 MiB)
                  :              :  +- Filter (isnotnull(ws_item_sk#166) AND isnotnull(ws_sold_date_sk#163)), Statistics(sizeInBytes=52.0 MiB)
                  :              :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                  :              +- Project [d_date_sk#24, d_date#26], Statistics(sizeInBytes=140.4 KiB)
                  :                 +- Filter ((isnotnull(d_month_seq#27) AND ((d_month_seq#27 >= 1200) AND (d_month_seq#27 <= 1211))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                  :                    +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                  +- Project [item_sk#13558, d_date#13562, cume_sales#13559], Statistics(sizeInBytes=3.1 TiB)
                     +- Window [sum(_w0#13594) windowspecdefinition(ss_item_sk#416, d_date#13562 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#13559], [ss_item_sk#416], [d_date#13562 ASC NULLS FIRST], Statistics(sizeInBytes=4.3 TiB)
                        +- Aggregate [ss_item_sk#416, d_date#13562], [ss_item_sk#416 AS item_sk#13558, d_date#13562, MakeDecimal(sum(UnscaledValue(ss_sales_price#427)),17,2) AS _w0#13594, ss_item_sk#416], Statistics(sizeInBytes=2.7 TiB)
                           +- Project [ss_item_sk#416, ss_sales_price#427, d_date#13562], Statistics(sizeInBytes=2.4 TiB)
                              +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#13560), Statistics(sizeInBytes=3.1 TiB)
                                 :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_sales_price#427], Statistics(sizeInBytes=22.9 MiB)
                                 :  +- Filter (isnotnull(ss_item_sk#416) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
                                 :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                                 +- Project [d_date_sk#13560, d_date#13562], Statistics(sizeInBytes=140.4 KiB)
                                    +- Filter ((isnotnull(d_month_seq#13563) AND ((d_month_seq#13563 >= 1200) AND (d_month_seq#13563 <= 1211))) AND isnotnull(d_date_sk#13560)), Statistics(sizeInBytes=2.5 MiB)
                                       +- Relation default.date_dim[d_date_sk#13560,d_date_id#13561,d_date#13562,d_month_seq#13563,d_week_seq#13564,d_quarter_seq#13565,d_year#13566,d_dow#13567,d_moy#13568,d_dom#13569,d_qoy#13570,d_fy_year#13571,d_fy_quarter_seq#13572,d_fy_week_seq#13573,d_day_name#13574,d_quarter_name#13575,d_holiday#13576,d_weekend#13577,d_following_holiday#13578,d_first_dom#13579,d_last_dom#13580,d_same_day_ly#13581,d_same_day_lq#13582,d_current_day#13583,d_current_week#13584,d_current_month#13585,d_current_quarter#13586,d_current_year#13587] parquet, Statistics(sizeInBytes=2.5 MiB)

==== q52 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=4.3 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=766.5 PiB)
   +- Sort [d_year#30 ASC NULLS FIRST, ext_price#13619 DESC NULLS LAST, brand_id#13617 ASC NULLS FIRST], true, Statistics(sizeInBytes=766.5 PiB)
      +- Aggregate [d_year#30, i_brand#445, i_brand_id#444], [d_year#30, i_brand_id#444 AS brand_id#13617, i_brand#445 AS brand#13618, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS ext_price#13619], Statistics(sizeInBytes=766.5 PiB)
         +- Project [d_year#30, ss_ext_sales_price#429, i_brand_id#444, i_brand#445], Statistics(sizeInBytes=766.5 PiB)
            +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=905.9 PiB)
               :- Project [d_year#30, ss_item_sk#416, ss_ext_sales_price#429], Statistics(sizeInBytes=2.4 TiB)
               :  +- Join Inner, (d_date_sk#24 = ss_sold_date_sk#414), Statistics(sizeInBytes=3.1 TiB)
               :     :- Project [d_date_sk#24, d_year#30], Statistics(sizeInBytes=140.4 KiB)
               :     :  +- Filter (((isnotnull(d_moy#32) AND isnotnull(d_year#30)) AND ((d_moy#32 = 11) AND (d_year#30 = 2000))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :     :     +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     +- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_ext_sales_price#429], Statistics(sizeInBytes=22.9 MiB)
               :        +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_item_sk#416)), Statistics(sizeInBytes=141.1 MiB)
               :           +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               +- Project [i_item_sk#437, i_brand_id#444, i_brand#445], Statistics(sizeInBytes=385.0 KiB)
                  +- Filter ((isnotnull(i_manager_id#457) AND (i_manager_id#457 = 1)) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
                     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)

==== q53 ==== 
GlobalLimit 100, Statistics(sizeInBytes=3.5 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1237.8 EiB)
   +- Sort [avg_quarterly_sales#13631 ASC NULLS FIRST, sum_sales#13630 ASC NULLS FIRST, i_manufact_id#450 ASC NULLS FIRST], true, Statistics(sizeInBytes=1237.8 EiB)
      +- Project [i_manufact_id#450, sum_sales#13630, avg_quarterly_sales#13631], Statistics(sizeInBytes=1237.8 EiB)
         +- Filter CASE WHEN (avg_quarterly_sales#13631 > 0.000000) THEN (CheckOverflow((promote_precision(abs(CheckOverflow((promote_precision(cast(sum_sales#13630 as decimal(22,6))) - promote_precision(cast(avg_quarterly_sales#13631 as decimal(22,6)))), DecimalType(22,6)))) / promote_precision(cast(avg_quarterly_sales#13631 as decimal(22,6)))), DecimalType(38,16)) > 0.1000000000000000) ELSE false END, Statistics(sizeInBytes=1512.9 EiB)
            +- Window [avg(_w0#13635) windowspecdefinition(i_manufact_id#450, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_quarterly_sales#13631], [i_manufact_id#450], Statistics(sizeInBytes=1512.9 EiB)
               +- Aggregate [i_manufact_id#450, d_qoy#34], [i_manufact_id#450, MakeDecimal(sum(UnscaledValue(ss_sales_price#427)),17,2) AS sum_sales#13630, MakeDecimal(sum(UnscaledValue(ss_sales_price#427)),17,2) AS _w0#13635], Statistics(sizeInBytes=962.8 EiB)
                  +- Project [i_manufact_id#450, ss_sales_price#427, d_qoy#34], Statistics(sizeInBytes=825.2 EiB)
                     +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=1100.3 EiB)
                        :- Project [i_manufact_id#450, ss_store_sk#421, ss_sales_price#427, d_qoy#34], Statistics(sizeInBytes=378.9 PiB)
                        :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=487.1 PiB)
                        :     :- Project [i_manufact_id#450, ss_sold_date_sk#414, ss_store_sk#421, ss_sales_price#427], Statistics(sizeInBytes=3.5 TiB)
                        :     :  +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=4.5 TiB)
                        :     :     :- Project [i_item_sk#437, i_manufact_id#450], Statistics(sizeInBytes=171.1 KiB)
                        :     :     :  +- Filter ((((i_category#449 IN (Books                                             ,Children                                          ,Electronics                                       ) AND i_class#447 IN (personal                                          ,portable                                          ,reference                                         ,self-help                                         )) AND i_brand#445 IN (scholaramalgamalg #14                             ,scholaramalgamalg #7                              ,exportiunivamalg #9                               ,scholaramalgamalg #9                              )) OR ((i_category#449 IN (Women                                             ,Music                                             ,Men                                               ) AND i_class#447 IN (accessories                                       ,classical                                         ,fragrances                                        ,pants                                             )) AND i_brand#445 IN (amalgimporto #1                                   ,edu packscholar #1                                ,exportiimporto #1                                 ,importoamalg #1                                   ))) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
                        :     :     :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
                        :     :     +- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_sales_price#427], Statistics(sizeInBytes=26.7 MiB)
                        :     :        +- Filter (isnotnull(ss_item_sk#416) AND (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421))), Statistics(sizeInBytes=141.1 MiB)
                        :     :           +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                        :     +- Project [d_date_sk#24, d_qoy#34], Statistics(sizeInBytes=140.4 KiB)
                        :        +- Filter (d_month_seq#27 INSET 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211 AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                        :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                        +- Project [s_store_sk#52], Statistics(sizeInBytes=2.9 KiB)
                           +- Filter isnotnull(s_store_sk#52), Statistics(sizeInBytes=101.7 KiB)
                              +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)

==== q54 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=2.3 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.23E+44 B)
   +- Sort [segment#13657 ASC NULLS FIRST, num_customers#13646L ASC NULLS FIRST], true, Statistics(sizeInBytes=1.23E+44 B)
      +- Aggregate [segment#13657], [segment#13657, count(1) AS num_customers#13646L, (segment#13657 * 50) AS segment_base#13647], Statistics(sizeInBytes=1.23E+44 B)
         +- Aggregate [c_customer_sk#81], [cast(CheckOverflow((promote_precision(MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2)) / 50.00), DecimalType(21,6)) as int) AS segment#13657], Statistics(sizeInBytes=6.13E+43 B)
            +- Project [c_customer_sk#81, ss_ext_sales_price#429], Statistics(sizeInBytes=1.02E+44 B)
               +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#13659), Statistics(sizeInBytes=1.43E+44 B)
                  :- Project [c_customer_sk#81, ss_sold_date_sk#414, ss_ext_sales_price#429], Statistics(sizeInBytes=1.33E+39 B)
                  :  +- Join Inner, ((ca_county#3724 = s_county#75) AND (ca_state#3725 = s_state#76)), Statistics(sizeInBytes=5.75E+39 B)
                  :     :- Project [c_customer_sk#81, ss_sold_date_sk#414, ss_ext_sales_price#429, ca_county#3724, ca_state#3725], Statistics(sizeInBytes=4.83E+35 B)
                  :     :  +- Join Inner, (c_current_addr_sk#85 = ca_address_sk#3717), Statistics(sizeInBytes=5.44E+35 B)
                  :     :     :- Project [c_customer_sk#81, c_current_addr_sk#85, ss_sold_date_sk#414, ss_ext_sales_price#429], Statistics(sizeInBytes=9.71E+29 B)
                  :     :     :  +- Join Inner, (c_customer_sk#81 = ss_customer_sk#417), Statistics(sizeInBytes=1.11E+30 B)
                  :     :     :     :- Aggregate [c_customer_sk#81, c_current_addr_sk#85], [c_customer_sk#81, c_current_addr_sk#85], Statistics(sizeInBytes=4.63E+22 B)
                  :     :     :     :  +- Project [c_customer_sk#81, c_current_addr_sk#85], Statistics(sizeInBytes=4.63E+22 B)
                  :     :     :     :     +- Join Inner, (c_customer_sk#81 = customer_sk#13649), Statistics(sizeInBytes=5.78E+22 B)
                  :     :     :     :        :- Project [customer_sk#13649], Statistics(sizeInBytes=81.7 PiB)
                  :     :     :     :        :  +- Join Inner, (sold_date_sk#13648 = d_date_sk#24), Statistics(sizeInBytes=136.1 PiB)
                  :     :     :     :        :     :- Project [sold_date_sk#13648, customer_sk#13649], Statistics(sizeInBytes=1323.8 GiB)
                  :     :     :     :        :     :  +- Join Inner, (item_sk#13650 = i_item_sk#437), Statistics(sizeInBytes=1985.7 GiB)
                  :     :     :     :        :     :     :- Union false, false, Statistics(sizeInBytes=15.5 MiB)
                  :     :     :     :        :     :     :  :- Project [cs_sold_date_sk#197 AS sold_date_sk#13648, cs_bill_customer_sk#200 AS customer_sk#13649, cs_item_sk#212 AS item_sk#13650], Statistics(sizeInBytes=10.4 MiB)
                  :     :     :     :        :     :     :  :  +- Filter (isnotnull(cs_item_sk#212) AND (isnotnull(cs_sold_date_sk#197) AND isnotnull(cs_bill_customer_sk#200))), Statistics(sizeInBytes=105.8 MiB)
                  :     :     :     :        :     :     :  :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
                  :     :     :     :        :     :     :  +- Project [ws_sold_date_sk#163 AS sold_date_sk#13651, ws_bill_customer_sk#167 AS customer_sk#13652, ws_item_sk#166 AS item_sk#13653], Statistics(sizeInBytes=5.1 MiB)
                  :     :     :     :        :     :     :     +- Filter (isnotnull(ws_item_sk#166) AND (isnotnull(ws_sold_date_sk#163) AND isnotnull(ws_bill_customer_sk#167))), Statistics(sizeInBytes=52.0 MiB)
                  :     :     :     :        :     :     :        +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                  :     :     :     :        :     :     +- Project [i_item_sk#437], Statistics(sizeInBytes=128.3 KiB)
                  :     :     :     :        :     :        +- Filter (((isnotnull(i_category#449) AND isnotnull(i_class#447)) AND ((i_category#449 = Women                                             ) AND (i_class#447 = maternity                                         ))) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
                  :     :     :     :        :     :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
                  :     :     :     :        :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                  :     :     :     :        :        +- Filter (((isnotnull(d_moy#32) AND isnotnull(d_year#30)) AND ((d_moy#32 = 12) AND (d_year#30 = 1998))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                  :     :     :     :        :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                  :     :     :     :        +- Project [c_customer_sk#81, c_current_addr_sk#85], Statistics(sizeInBytes=614.2 KiB)
                  :     :     :     :           +- Filter (isnotnull(c_customer_sk#81) AND isnotnull(c_current_addr_sk#85)), Statistics(sizeInBytes=7.8 MiB)
                  :     :     :     :              +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
                  :     :     :     +- Project [ss_sold_date_sk#414, ss_customer_sk#417, ss_ext_sales_price#429], Statistics(sizeInBytes=22.9 MiB)
                  :     :     :        +- Filter (isnotnull(ss_customer_sk#417) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
                  :     :     :           +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                  :     :     +- Project [ca_address_sk#3717, ca_county#3724, ca_state#3725], Statistics(sizeInBytes=546.7 KiB)
                  :     :        +- Filter (isnotnull(ca_address_sk#3717) AND (isnotnull(ca_county#3724) AND isnotnull(ca_state#3725))), Statistics(sizeInBytes=2.5 MiB)
                  :     :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
                  :     +- Project [s_county#75, s_state#76], Statistics(sizeInBytes=11.6 KiB)
                  :        +- Filter (isnotnull(s_county#75) AND isnotnull(s_state#76)), Statistics(sizeInBytes=101.7 KiB)
                  :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
                  +- Project [d_date_sk#13659], Statistics(sizeInBytes=105.3 KiB)
                     +- Filter ((isnotnull(d_month_seq#13662) AND ((d_month_seq#13662 >= scalar-subquery#13655 []) AND (d_month_seq#13662 <= scalar-subquery#13656 []))) AND isnotnull(d_date_sk#13659)), Statistics(sizeInBytes=2.5 MiB)
                        :  :- Aggregate [(d_month_seq + 1)#13687], [(d_month_seq + 1)#13687], Statistics(sizeInBytes=105.3 KiB)
                        :  :  +- Project [(d_month_seq#13693 + 1) AS (d_month_seq + 1)#13687], Statistics(sizeInBytes=105.3 KiB)
                        :  :     +- Filter ((isnotnull(d_year#13696) AND isnotnull(d_moy#13698)) AND ((d_year#13696 = 1998) AND (d_moy#13698 = 12))), Statistics(sizeInBytes=2.5 MiB)
                        :  :        +- Relation default.date_dim[d_date_sk#13690,d_date_id#13691,d_date#13692,d_month_seq#13693,d_week_seq#13694,d_quarter_seq#13695,d_year#13696,d_dow#13697,d_moy#13698,d_dom#13699,d_qoy#13700,d_fy_year#13701,d_fy_quarter_seq#13702,d_fy_week_seq#13703,d_day_name#13704,d_quarter_name#13705,d_holiday#13706,d_weekend#13707,d_following_holiday#13708,d_first_dom#13709,d_last_dom#13710,d_same_day_ly#13711,d_same_day_lq#13712,d_current_day#13713,d_current_week#13714,d_current_month#13715,d_current_quarter#13716,d_current_year#13717] parquet, Statistics(sizeInBytes=2.5 MiB)
                        :  +- Aggregate [(d_month_seq + 3)#13688], [(d_month_seq + 3)#13688], Statistics(sizeInBytes=105.3 KiB)
                        :     +- Project [(d_month_seq#13721 + 3) AS (d_month_seq + 3)#13688], Statistics(sizeInBytes=105.3 KiB)
                        :        +- Filter ((isnotnull(d_year#13724) AND isnotnull(d_moy#13726)) AND ((d_year#13724 = 1998) AND (d_moy#13726 = 12))), Statistics(sizeInBytes=2.5 MiB)
                        :           +- Relation default.date_dim[d_date_sk#13718,d_date_id#13719,d_date#13720,d_month_seq#13721,d_week_seq#13722,d_quarter_seq#13723,d_year#13724,d_dow#13725,d_moy#13726,d_dom#13727,d_qoy#13728,d_fy_year#13729,d_fy_quarter_seq#13730,d_fy_week_seq#13731,d_day_name#13732,d_quarter_name#13733,d_holiday#13734,d_weekend#13735,d_following_holiday#13736,d_first_dom#13737,d_last_dom#13738,d_same_day_ly#13739,d_same_day_lq#13740,d_current_day#13741,d_current_week#13742,d_current_month#13743,d_current_quarter#13744,d_current_year#13745] parquet, Statistics(sizeInBytes=2.5 MiB)
                        +- Relation default.date_dim[d_date_sk#13659,d_date_id#13660,d_date#13661,d_month_seq#13662,d_week_seq#13663,d_quarter_seq#13664,d_year#13665,d_dow#13666,d_moy#13667,d_dom#13668,d_qoy#13669,d_fy_year#13670,d_fy_quarter_seq#13671,d_fy_week_seq#13672,d_day_name#13673,d_quarter_name#13674,d_holiday#13675,d_weekend#13676,d_following_holiday#13677,d_first_dom#13678,d_last_dom#13679,d_same_day_ly#13680,d_same_day_lq#13681,d_current_day#13682,d_current_week#13683,d_current_month#13684,d_current_quarter#13685,d_current_year#13686] parquet, Statistics(sizeInBytes=2.5 MiB)

==== q55 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=3.9 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=539.2 PiB)
   +- Sort [ext_price#13765 DESC NULLS LAST, brand_id#13763 ASC NULLS FIRST], true, Statistics(sizeInBytes=539.2 PiB)
      +- Aggregate [i_brand#445, i_brand_id#444], [i_brand_id#444 AS brand_id#13763, i_brand#445 AS brand#13764, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS ext_price#13765], Statistics(sizeInBytes=539.2 PiB)
         +- Project [ss_ext_sales_price#429, i_brand_id#444, i_brand#445], Statistics(sizeInBytes=539.2 PiB)
            +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=647.0 PiB)
               :- Project [ss_item_sk#416, ss_ext_sales_price#429], Statistics(sizeInBytes=1720.7 GiB)
               :  +- Join Inner, (d_date_sk#24 = ss_sold_date_sk#414), Statistics(sizeInBytes=2.4 TiB)
               :     :- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :     :  +- Filter (((isnotnull(d_moy#32) AND isnotnull(d_year#30)) AND ((d_moy#32 = 11) AND (d_year#30 = 1999))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :     :     +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     +- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_ext_sales_price#429], Statistics(sizeInBytes=22.9 MiB)
               :        +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_item_sk#416)), Statistics(sizeInBytes=141.1 MiB)
               :           +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               +- Project [i_item_sk#437, i_brand_id#444, i_brand#445], Statistics(sizeInBytes=385.0 KiB)
                  +- Filter ((isnotnull(i_manager_id#457) AND (i_manager_id#457 = 28)) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
                     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)

==== q56 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=4.3 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.33E+23 B)
   +- Sort [total_sales#13775 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.33E+23 B)
      +- Aggregate [i_item_id#438], [i_item_id#438, sum(total_sales#13776) AS total_sales#13775], Statistics(sizeInBytes=1.33E+23 B)
         +- Union false, false, Statistics(sizeInBytes=1.08E+23 B)
            :- Aggregate [i_item_id#438], [i_item_id#438, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS total_sales#13776], Statistics(sizeInBytes=5.99E+22 B)
            :  +- Project [ss_ext_sales_price#429, i_item_id#438], Statistics(sizeInBytes=5.99E+22 B)
            :     +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=7.32E+22 B)
            :        :- Project [ss_item_sk#416, ss_ext_sales_price#429], Statistics(sizeInBytes=185.5 PiB)
            :        :  +- Join Inner, (ss_addr_sk#420 = ca_address_sk#3717), Statistics(sizeInBytes=259.7 PiB)
            :        :     :- Project [ss_item_sk#416, ss_addr_sk#420, ss_ext_sales_price#429], Statistics(sizeInBytes=2.1 TiB)
            :        :     :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2.7 TiB)
            :        :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_addr_sk#420, ss_ext_sales_price#429], Statistics(sizeInBytes=26.7 MiB)
            :        :     :     :  +- Filter (isnotnull(ss_sold_date_sk#414) AND (isnotnull(ss_addr_sk#420) AND isnotnull(ss_item_sk#416))), Statistics(sizeInBytes=141.1 MiB)
            :        :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
            :        :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
            :        :     :        +- Filter (((isnotnull(d_year#30) AND isnotnull(d_moy#32)) AND ((d_year#30 = 2001) AND (d_moy#32 = 2))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :        :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :        :     +- Project [ca_address_sk#3717], Statistics(sizeInBytes=126.2 KiB)
            :        :        +- Filter ((isnotnull(ca_gmt_offset#3728) AND (ca_gmt_offset#3728 = -5.00)) AND isnotnull(ca_address_sk#3717)), Statistics(sizeInBytes=2.5 MiB)
            :        :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
            :        +- Join LeftSemi, (i_item_id#438 = i_item_id#13909), Statistics(sizeInBytes=342.3 KiB)
            :           :- Project [i_item_sk#437, i_item_id#438], Statistics(sizeInBytes=342.3 KiB)
            :           :  +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
            :           :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
            :           +- Project [i_item_id#13909], Statistics(sizeInBytes=299.5 KiB)
            :              +- Filter i_color#13925 IN (slate               ,blanched            ,burnished           ), Statistics(sizeInBytes=3.1 MiB)
            :                 +- Relation default.item[i_item_sk#13908,i_item_id#13909,i_rec_start_date#13910,i_rec_end_date#13911,i_item_desc#13912,i_current_price#13913,i_wholesale_cost#13914,i_brand_id#13915,i_brand#13916,i_class_id#13917,i_class#13918,i_category_id#13919,i_category#13920,i_manufact_id#13921,i_manufact#13922,i_size#13923,i_formulation#13924,i_color#13925,i_units#13926,i_container#13927,i_manager_id#13928,i_product_name#13929] parquet, Statistics(sizeInBytes=3.1 MiB)
            :- Aggregate [i_item_id#13824], [i_item_id#13824, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#220)),17,2) AS total_sales#13778], Statistics(sizeInBytes=3.26E+22 B)
            :  +- Project [cs_ext_sales_price#220, i_item_id#13824], Statistics(sizeInBytes=3.26E+22 B)
            :     +- Join Inner, (cs_item_sk#212 = i_item_sk#13823), Statistics(sizeInBytes=3.98E+22 B)
            :        :- Project [cs_item_sk#212, cs_ext_sales_price#220], Statistics(sizeInBytes=100.9 PiB)
            :        :  +- Join Inner, (cs_bill_addr_sk#203 = ca_address_sk#13810), Statistics(sizeInBytes=141.3 PiB)
            :        :     :- Project [cs_bill_addr_sk#203, cs_item_sk#212, cs_ext_sales_price#220], Statistics(sizeInBytes=1147.1 GiB)
            :        :     :  +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#13782), Statistics(sizeInBytes=1529.5 GiB)
            :        :     :     :- Project [cs_sold_date_sk#197, cs_bill_addr_sk#203, cs_item_sk#212, cs_ext_sales_price#220], Statistics(sizeInBytes=14.5 MiB)
            :        :     :     :  +- Filter (isnotnull(cs_sold_date_sk#197) AND (isnotnull(cs_bill_addr_sk#203) AND isnotnull(cs_item_sk#212))), Statistics(sizeInBytes=105.8 MiB)
            :        :     :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
            :        :     :     +- Project [d_date_sk#13782], Statistics(sizeInBytes=105.3 KiB)
            :        :     :        +- Filter (((isnotnull(d_year#13788) AND isnotnull(d_moy#13790)) AND ((d_year#13788 = 2001) AND (d_moy#13790 = 2))) AND isnotnull(d_date_sk#13782)), Statistics(sizeInBytes=2.5 MiB)
            :        :     :           +- Relation default.date_dim[d_date_sk#13782,d_date_id#13783,d_date#13784,d_month_seq#13785,d_week_seq#13786,d_quarter_seq#13787,d_year#13788,d_dow#13789,d_moy#13790,d_dom#13791,d_qoy#13792,d_fy_year#13793,d_fy_quarter_seq#13794,d_fy_week_seq#13795,d_day_name#13796,d_quarter_name#13797,d_holiday#13798,d_weekend#13799,d_following_holiday#13800,d_first_dom#13801,d_last_dom#13802,d_same_day_ly#13803,d_same_day_lq#13804,d_current_day#13805,d_current_week#13806,d_current_month#13807,d_current_quarter#13808,d_current_year#13809] parquet, Statistics(sizeInBytes=2.5 MiB)
            :        :     +- Project [ca_address_sk#13810], Statistics(sizeInBytes=126.2 KiB)
            :        :        +- Filter ((isnotnull(ca_gmt_offset#13821) AND (ca_gmt_offset#13821 = -5.00)) AND isnotnull(ca_address_sk#13810)), Statistics(sizeInBytes=2.5 MiB)
            :        :           +- Relation default.customer_address[ca_address_sk#13810,ca_address_id#13811,ca_street_number#13812,ca_street_name#13813,ca_street_type#13814,ca_suite_number#13815,ca_city#13816,ca_county#13817,ca_state#13818,ca_zip#13819,ca_country#13820,ca_gmt_offset#13821,ca_location_type#13822] parquet, Statistics(sizeInBytes=2.5 MiB)
            :        +- Join LeftSemi, (i_item_id#13824 = i_item_id#13931), Statistics(sizeInBytes=342.3 KiB)
            :           :- Project [i_item_sk#13823, i_item_id#13824], Statistics(sizeInBytes=342.3 KiB)
            :           :  +- Filter isnotnull(i_item_sk#13823), Statistics(sizeInBytes=3.1 MiB)
            :           :     +- Relation default.item[i_item_sk#13823,i_item_id#13824,i_rec_start_date#13825,i_rec_end_date#13826,i_item_desc#13827,i_current_price#13828,i_wholesale_cost#13829,i_brand_id#13830,i_brand#13831,i_class_id#13832,i_class#13833,i_category_id#13834,i_category#13835,i_manufact_id#13836,i_manufact#13837,i_size#13838,i_formulation#13839,i_color#13840,i_units#13841,i_container#13842,i_manager_id#13843,i_product_name#13844] parquet, Statistics(sizeInBytes=3.1 MiB)
            :           +- Project [i_item_id#13931], Statistics(sizeInBytes=299.5 KiB)
            :              +- Filter i_color#13947 IN (slate               ,blanched            ,burnished           ), Statistics(sizeInBytes=3.1 MiB)
            :                 +- Relation default.item[i_item_sk#13930,i_item_id#13931,i_rec_start_date#13932,i_rec_end_date#13933,i_item_desc#13934,i_current_price#13935,i_wholesale_cost#13936,i_brand_id#13937,i_brand#13938,i_class_id#13939,i_class#13940,i_category_id#13941,i_category#13942,i_manufact_id#13943,i_manufact#13944,i_size#13945,i_formulation#13946,i_color#13947,i_units#13948,i_container#13949,i_manager_id#13950,i_product_name#13951] parquet, Statistics(sizeInBytes=3.1 MiB)
            +- Aggregate [i_item_id#13887], [i_item_id#13887, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#186)),17,2) AS total_sales#13780], Statistics(sizeInBytes=1.60E+22 B)
               +- Project [ws_ext_sales_price#186, i_item_id#13887], Statistics(sizeInBytes=1.60E+22 B)
                  +- Join Inner, (ws_item_sk#166 = i_item_sk#13886), Statistics(sizeInBytes=1.96E+22 B)
                     :- Project [ws_item_sk#166, ws_ext_sales_price#186], Statistics(sizeInBytes=49.6 PiB)
                     :  +- Join Inner, (ws_bill_addr_sk#170 = ca_address_sk#13873), Statistics(sizeInBytes=69.4 PiB)
                     :     :- Project [ws_item_sk#166, ws_bill_addr_sk#170, ws_ext_sales_price#186], Statistics(sizeInBytes=563.5 GiB)
                     :     :  +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#13845), Statistics(sizeInBytes=751.3 GiB)
                     :     :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_bill_addr_sk#170, ws_ext_sales_price#186], Statistics(sizeInBytes=7.1 MiB)
                     :     :     :  +- Filter (isnotnull(ws_sold_date_sk#163) AND (isnotnull(ws_bill_addr_sk#170) AND isnotnull(ws_item_sk#166))), Statistics(sizeInBytes=52.0 MiB)
                     :     :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                     :     :     +- Project [d_date_sk#13845], Statistics(sizeInBytes=105.3 KiB)
                     :     :        +- Filter (((isnotnull(d_year#13851) AND isnotnull(d_moy#13853)) AND ((d_year#13851 = 2001) AND (d_moy#13853 = 2))) AND isnotnull(d_date_sk#13845)), Statistics(sizeInBytes=2.5 MiB)
                     :     :           +- Relation default.date_dim[d_date_sk#13845,d_date_id#13846,d_date#13847,d_month_seq#13848,d_week_seq#13849,d_quarter_seq#13850,d_year#13851,d_dow#13852,d_moy#13853,d_dom#13854,d_qoy#13855,d_fy_year#13856,d_fy_quarter_seq#13857,d_fy_week_seq#13858,d_day_name#13859,d_quarter_name#13860,d_holiday#13861,d_weekend#13862,d_following_holiday#13863,d_first_dom#13864,d_last_dom#13865,d_same_day_ly#13866,d_same_day_lq#13867,d_current_day#13868,d_current_week#13869,d_current_month#13870,d_current_quarter#13871,d_current_year#13872] parquet, Statistics(sizeInBytes=2.5 MiB)
                     :     +- Project [ca_address_sk#13873], Statistics(sizeInBytes=126.2 KiB)
                     :        +- Filter ((isnotnull(ca_gmt_offset#13884) AND (ca_gmt_offset#13884 = -5.00)) AND isnotnull(ca_address_sk#13873)), Statistics(sizeInBytes=2.5 MiB)
                     :           +- Relation default.customer_address[ca_address_sk#13873,ca_address_id#13874,ca_street_number#13875,ca_street_name#13876,ca_street_type#13877,ca_suite_number#13878,ca_city#13879,ca_county#13880,ca_state#13881,ca_zip#13882,ca_country#13883,ca_gmt_offset#13884,ca_location_type#13885] parquet, Statistics(sizeInBytes=2.5 MiB)
                     +- Join LeftSemi, (i_item_id#13887 = i_item_id#13953), Statistics(sizeInBytes=342.3 KiB)
                        :- Project [i_item_sk#13886, i_item_id#13887], Statistics(sizeInBytes=342.3 KiB)
                        :  +- Filter isnotnull(i_item_sk#13886), Statistics(sizeInBytes=3.1 MiB)
                        :     +- Relation default.item[i_item_sk#13886,i_item_id#13887,i_rec_start_date#13888,i_rec_end_date#13889,i_item_desc#13890,i_current_price#13891,i_wholesale_cost#13892,i_brand_id#13893,i_brand#13894,i_class_id#13895,i_class#13896,i_category_id#13897,i_category#13898,i_manufact_id#13899,i_manufact#13900,i_size#13901,i_formulation#13902,i_color#13903,i_units#13904,i_container#13905,i_manager_id#13906,i_product_name#13907] parquet, Statistics(sizeInBytes=3.1 MiB)
                        +- Project [i_item_id#13953], Statistics(sizeInBytes=299.5 KiB)
                           +- Filter i_color#13969 IN (slate               ,blanched            ,burnished           ), Statistics(sizeInBytes=3.1 MiB)
                              +- Relation default.item[i_item_sk#13952,i_item_id#13953,i_rec_start_date#13954,i_rec_end_date#13955,i_item_desc#13956,i_current_price#13957,i_wholesale_cost#13958,i_brand_id#13959,i_brand#13960,i_class_id#13961,i_class#13962,i_category_id#13963,i_category#13964,i_manufact_id#13965,i_manufact#13966,i_size#13967,i_formulation#13968,i_color#13969,i_units#13970,i_container#13971,i_manager_id#13972,i_product_name#13973] parquet, Statistics(sizeInBytes=3.1 MiB)

==== q57 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=11.3 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=5.19E+64 B)
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#14040 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#14041 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, cc_name#7114 ASC NULLS FIRST], true, Statistics(sizeInBytes=5.19E+64 B)
      +- Project [i_category#449, i_brand#445, cc_name#7114, d_year#30, d_moy#32, avg_monthly_sales#14041, sum_sales#14040, sum_sales#14064 AS psum#14043, sum_sales#14072 AS nsum#14044], Statistics(sizeInBytes=5.19E+64 B)
         +- Join Inner, ((((i_category#449 = i_category#14456) AND (i_brand#445 = i_brand#14452)) AND (cc_name#7114 = cc_name#14534)) AND (rn#14042 = (rn#14563 - 1))), Statistics(sizeInBytes=8.23E+64 B)
            :- Project [i_category#449, i_brand#445, cc_name#7114, d_year#30, d_moy#32, sum_sales#14040, avg_monthly_sales#14041, rn#14042, sum_sales#14064], Statistics(sizeInBytes=1.78E+43 B)
            :  +- Join Inner, ((((i_category#449 = i_category#14336) AND (i_brand#445 = i_brand#14332)) AND (cc_name#7114 = cc_name#14414)) AND (rn#14042 = (rn#14443 + 1))), Statistics(sizeInBytes=2.79E+43 B)
            :     :- Project [i_category#449, i_brand#445, cc_name#7114, d_year#30, d_moy#32, sum_sales#14040, avg_monthly_sales#14041, rn#14042], Statistics(sizeInBytes=6.02E+21 B)
            :     :  +- Filter ((isnotnull(avg_monthly_sales#14041) AND (avg_monthly_sales#14041 > 0.000000)) AND CASE WHEN (avg_monthly_sales#14041 > 0.000000) THEN (CheckOverflow((promote_precision(abs(CheckOverflow((promote_precision(cast(sum_sales#14040 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#14041 as decimal(22,6)))), DecimalType(22,6)))) / promote_precision(cast(avg_monthly_sales#14041 as decimal(22,6)))), DecimalType(38,16)) > 0.1000000000000000) END), Statistics(sizeInBytes=6.49E+21 B)
            :     :     +- Window [avg(_w0#14058) windowspecdefinition(i_category#449, i_brand#445, cc_name#7114, d_year#30, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#14041], [i_category#449, i_brand#445, cc_name#7114, d_year#30], Statistics(sizeInBytes=6.49E+21 B)
            :     :        +- Filter (isnotnull(d_year#30) AND (d_year#30 = 1999)), Statistics(sizeInBytes=5.56E+21 B)
            :     :           +- Window [rank(d_year#30, d_moy#32) windowspecdefinition(i_category#449, i_brand#445, cc_name#7114, d_year#30 ASC NULLS FIRST, d_moy#32 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#14042], [i_category#449, i_brand#445, cc_name#7114], [d_year#30 ASC NULLS FIRST, d_moy#32 ASC NULLS FIRST], Statistics(sizeInBytes=5.56E+21 B)
            :     :              +- Aggregate [i_category#449, i_brand#445, cc_name#7114, d_year#30, d_moy#32], [i_category#449, i_brand#445, cc_name#7114, d_year#30, d_moy#32, MakeDecimal(sum(UnscaledValue(cs_sales_price#218)),17,2) AS sum_sales#14040, MakeDecimal(sum(UnscaledValue(cs_sales_price#218)),17,2) AS _w0#14058], Statistics(sizeInBytes=5.33E+21 B)
            :     :                 +- Project [i_brand#445, i_category#449, cs_sales_price#218, d_year#30, d_moy#32, cc_name#7114], Statistics(sizeInBytes=4.87E+21 B)
            :     :                    +- Join Inner, (cc_call_center_sk#7108 = cs_call_center_sk#208), Statistics(sizeInBytes=5.33E+21 B)
            :     :                       :- Project [i_brand#445, i_category#449, cs_call_center_sk#208, cs_sales_price#218, d_year#30, d_moy#32], Statistics(sizeInBytes=1101.2 PiB)
            :     :                       :  +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#24), Statistics(sizeInBytes=1230.7 PiB)
            :     :                       :     :- Project [i_brand#445, i_category#449, cs_sold_date_sk#197, cs_call_center_sk#208, cs_sales_price#218], Statistics(sizeInBytes=7.0 TiB)
            :     :                       :     :  +- Join Inner, (cs_item_sk#212 = i_item_sk#437), Statistics(sizeInBytes=7.9 TiB)
            :     :                       :     :     :- Project [i_item_sk#437, i_brand#445, i_category#449], Statistics(sizeInBytes=556.2 KiB)
            :     :                       :     :     :  +- Filter (isnotnull(i_item_sk#437) AND (isnotnull(i_category#449) AND isnotnull(i_brand#445))), Statistics(sizeInBytes=3.1 MiB)
            :     :                       :     :     :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
            :     :                       :     :     +- Project [cs_sold_date_sk#197, cs_call_center_sk#208, cs_item_sk#212, cs_sales_price#218], Statistics(sizeInBytes=14.5 MiB)
            :     :                       :     :        +- Filter (isnotnull(cs_item_sk#212) AND (isnotnull(cs_sold_date_sk#197) AND isnotnull(cs_call_center_sk#208))), Statistics(sizeInBytes=105.8 MiB)
            :     :                       :     :           +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
            :     :                       :     +- Project [d_date_sk#24, d_year#30, d_moy#32], Statistics(sizeInBytes=175.5 KiB)
            :     :                       :        +- Filter ((((d_year#30 = 1999) OR ((d_year#30 = 1998) AND (d_moy#32 = 12))) OR ((d_year#30 = 2000) AND (d_moy#32 = 1))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :     :                       :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :                       +- Project [cc_call_center_sk#7108, cc_name#7114], Statistics(sizeInBytes=4.2 KiB)
            :     :                          +- Filter (isnotnull(cc_call_center_sk#7108) AND isnotnull(cc_name#7114)), Statistics(sizeInBytes=58.2 KiB)
            :     :                             +- Relation default.call_center[cc_call_center_sk#7108,cc_call_center_id#7109,cc_rec_start_date#7110,cc_rec_end_date#7111,cc_closed_date_sk#7112,cc_open_date_sk#7113,cc_name#7114,cc_class#7115,cc_employees#7116,cc_sq_ft#7117,cc_hours#7118,cc_manager#7119,cc_mkt_id#7120,cc_mkt_class#7121,cc_mkt_desc#7122,cc_market_manager#7123,cc_division#7124,cc_division_name#7125,cc_company#7126,cc_company_name#7127,cc_street_number#7128,cc_street_name#7129,cc_street_type#7130,cc_suite_number#7131,cc_city#7132,cc_county#7133,cc_state#7134,cc_zip#7135,cc_country#7136,cc_gmt_offset#7137,cc_tax_percentage#7138] parquet, Statistics(sizeInBytes=58.2 KiB)
            :     +- Project [i_category#14336, i_brand#14332, cc_name#14414, sum_sales#14040 AS sum_sales#14064, rn#14443], Statistics(sizeInBytes=4.63E+21 B)
            :        +- Window [rank(d_year#14386, d_moy#14388) windowspecdefinition(i_category#14336, i_brand#14332, cc_name#14414, d_year#14386 ASC NULLS FIRST, d_moy#14388 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#14443], [i_category#14336, i_brand#14332, cc_name#14414], [d_year#14386 ASC NULLS FIRST, d_moy#14388 ASC NULLS FIRST], Statistics(sizeInBytes=5.10E+21 B)
            :           +- Aggregate [i_category#14336, i_brand#14332, cc_name#14414, d_year#14386, d_moy#14388], [i_category#14336, i_brand#14332, cc_name#14414, d_year#14386, d_moy#14388, MakeDecimal(sum(UnscaledValue(cs_sales_price#14367)),17,2) AS sum_sales#14040], Statistics(sizeInBytes=4.87E+21 B)
            :              +- Project [i_brand#14332, i_category#14336, cs_sales_price#14367, d_year#14386, d_moy#14388, cc_name#14414], Statistics(sizeInBytes=4.87E+21 B)
            :                 +- Join Inner, (cc_call_center_sk#14408 = cs_call_center_sk#14357), Statistics(sizeInBytes=5.33E+21 B)
            :                    :- Project [i_brand#14332, i_category#14336, cs_call_center_sk#14357, cs_sales_price#14367, d_year#14386, d_moy#14388], Statistics(sizeInBytes=1101.2 PiB)
            :                    :  +- Join Inner, (cs_sold_date_sk#14346 = d_date_sk#14380), Statistics(sizeInBytes=1230.7 PiB)
            :                    :     :- Project [i_brand#14332, i_category#14336, cs_sold_date_sk#14346, cs_call_center_sk#14357, cs_sales_price#14367], Statistics(sizeInBytes=7.0 TiB)
            :                    :     :  +- Join Inner, (cs_item_sk#14361 = i_item_sk#14324), Statistics(sizeInBytes=7.9 TiB)
            :                    :     :     :- Project [i_item_sk#14324, i_brand#14332, i_category#14336], Statistics(sizeInBytes=556.2 KiB)
            :                    :     :     :  +- Filter (isnotnull(i_item_sk#14324) AND (isnotnull(i_category#14336) AND isnotnull(i_brand#14332))), Statistics(sizeInBytes=3.1 MiB)
            :                    :     :     :     +- Relation default.item[i_item_sk#14324,i_item_id#14325,i_rec_start_date#14326,i_rec_end_date#14327,i_item_desc#14328,i_current_price#14329,i_wholesale_cost#14330,i_brand_id#14331,i_brand#14332,i_class_id#14333,i_class#14334,i_category_id#14335,i_category#14336,i_manufact_id#14337,i_manufact#14338,i_size#14339,i_formulation#14340,i_color#14341,i_units#14342,i_container#14343,i_manager_id#14344,i_product_name#14345] parquet, Statistics(sizeInBytes=3.1 MiB)
            :                    :     :     +- Project [cs_sold_date_sk#14346, cs_call_center_sk#14357, cs_item_sk#14361, cs_sales_price#14367], Statistics(sizeInBytes=14.5 MiB)
            :                    :     :        +- Filter ((isnotnull(cs_item_sk#14361) AND isnotnull(cs_sold_date_sk#14346)) AND isnotnull(cs_call_center_sk#14357)), Statistics(sizeInBytes=105.8 MiB)
            :                    :     :           +- Relation default.catalog_sales[cs_sold_date_sk#14346,cs_sold_time_sk#14347,cs_ship_date_sk#14348,cs_bill_customer_sk#14349,cs_bill_cdemo_sk#14350,cs_bill_hdemo_sk#14351,cs_bill_addr_sk#14352,cs_ship_customer_sk#14353,cs_ship_cdemo_sk#14354,cs_ship_hdemo_sk#14355,cs_ship_addr_sk#14356,cs_call_center_sk#14357,cs_catalog_page_sk#14358,cs_ship_mode_sk#14359,cs_warehouse_sk#14360,cs_item_sk#14361,cs_promo_sk#14362,cs_order_number#14363,cs_quantity#14364,cs_wholesale_cost#14365,cs_list_price#14366,cs_sales_price#14367,cs_ext_discount_amt#14368,cs_ext_sales_price#14369,cs_ext_wholesale_cost#14370,cs_ext_list_price#14371,cs_ext_tax#14372,cs_coupon_amt#14373,cs_ext_ship_cost#14374,cs_net_paid#14375,cs_net_paid_inc_tax#14376,cs_net_paid_inc_ship#14377,cs_net_paid_inc_ship_tax#14378,cs_net_profit#14379] parquet, Statistics(sizeInBytes=105.8 MiB)
            :                    :     +- Project [d_date_sk#14380, d_year#14386, d_moy#14388], Statistics(sizeInBytes=175.5 KiB)
            :                    :        +- Filter ((((d_year#14386 = 1999) OR ((d_year#14386 = 1998) AND (d_moy#14388 = 12))) OR ((d_year#14386 = 2000) AND (d_moy#14388 = 1))) AND isnotnull(d_date_sk#14380)), Statistics(sizeInBytes=2.5 MiB)
            :                    :           +- Relation default.date_dim[d_date_sk#14380,d_date_id#14381,d_date#14382,d_month_seq#14383,d_week_seq#14384,d_quarter_seq#14385,d_year#14386,d_dow#14387,d_moy#14388,d_dom#14389,d_qoy#14390,d_fy_year#14391,d_fy_quarter_seq#14392,d_fy_week_seq#14393,d_day_name#14394,d_quarter_name#14395,d_holiday#14396,d_weekend#14397,d_following_holiday#14398,d_first_dom#14399,d_last_dom#14400,d_same_day_ly#14401,d_same_day_lq#14402,d_current_day#14403,d_current_week#14404,d_current_month#14405,d_current_quarter#14406,d_current_year#14407] parquet, Statistics(sizeInBytes=2.5 MiB)
            :                    +- Project [cc_call_center_sk#14408, cc_name#14414], Statistics(sizeInBytes=4.2 KiB)
            :                       +- Filter (isnotnull(cc_call_center_sk#14408) AND isnotnull(cc_name#14414)), Statistics(sizeInBytes=58.2 KiB)
            :                          +- Relation default.call_center[cc_call_center_sk#14408,cc_call_center_id#14409,cc_rec_start_date#14410,cc_rec_end_date#14411,cc_closed_date_sk#14412,cc_open_date_sk#14413,cc_name#14414,cc_class#14415,cc_employees#14416,cc_sq_ft#14417,cc_hours#14418,cc_manager#14419,cc_mkt_id#14420,cc_mkt_class#14421,cc_mkt_desc#14422,cc_market_manager#14423,cc_division#14424,cc_division_name#14425,cc_company#14426,cc_company_name#14427,cc_street_number#14428,cc_street_name#14429,cc_street_type#14430,cc_suite_number#14431,cc_city#14432,cc_county#14433,cc_state#14434,cc_zip#14435,cc_country#14436,cc_gmt_offset#14437,cc_tax_percentage#14438] parquet, Statistics(sizeInBytes=58.2 KiB)
            +- Project [i_category#14456, i_brand#14452, cc_name#14534, sum_sales#14040 AS sum_sales#14072, rn#14563], Statistics(sizeInBytes=4.63E+21 B)
               +- Window [rank(d_year#14506, d_moy#14508) windowspecdefinition(i_category#14456, i_brand#14452, cc_name#14534, d_year#14506 ASC NULLS FIRST, d_moy#14508 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#14563], [i_category#14456, i_brand#14452, cc_name#14534], [d_year#14506 ASC NULLS FIRST, d_moy#14508 ASC NULLS FIRST], Statistics(sizeInBytes=5.10E+21 B)
                  +- Aggregate [i_category#14456, i_brand#14452, cc_name#14534, d_year#14506, d_moy#14508], [i_category#14456, i_brand#14452, cc_name#14534, d_year#14506, d_moy#14508, MakeDecimal(sum(UnscaledValue(cs_sales_price#14487)),17,2) AS sum_sales#14040], Statistics(sizeInBytes=4.87E+21 B)
                     +- Project [i_brand#14452, i_category#14456, cs_sales_price#14487, d_year#14506, d_moy#14508, cc_name#14534], Statistics(sizeInBytes=4.87E+21 B)
                        +- Join Inner, (cc_call_center_sk#14528 = cs_call_center_sk#14477), Statistics(sizeInBytes=5.33E+21 B)
                           :- Project [i_brand#14452, i_category#14456, cs_call_center_sk#14477, cs_sales_price#14487, d_year#14506, d_moy#14508], Statistics(sizeInBytes=1101.2 PiB)
                           :  +- Join Inner, (cs_sold_date_sk#14466 = d_date_sk#14500), Statistics(sizeInBytes=1230.7 PiB)
                           :     :- Project [i_brand#14452, i_category#14456, cs_sold_date_sk#14466, cs_call_center_sk#14477, cs_sales_price#14487], Statistics(sizeInBytes=7.0 TiB)
                           :     :  +- Join Inner, (cs_item_sk#14481 = i_item_sk#14444), Statistics(sizeInBytes=7.9 TiB)
                           :     :     :- Project [i_item_sk#14444, i_brand#14452, i_category#14456], Statistics(sizeInBytes=556.2 KiB)
                           :     :     :  +- Filter (isnotnull(i_item_sk#14444) AND (isnotnull(i_category#14456) AND isnotnull(i_brand#14452))), Statistics(sizeInBytes=3.1 MiB)
                           :     :     :     +- Relation default.item[i_item_sk#14444,i_item_id#14445,i_rec_start_date#14446,i_rec_end_date#14447,i_item_desc#14448,i_current_price#14449,i_wholesale_cost#14450,i_brand_id#14451,i_brand#14452,i_class_id#14453,i_class#14454,i_category_id#14455,i_category#14456,i_manufact_id#14457,i_manufact#14458,i_size#14459,i_formulation#14460,i_color#14461,i_units#14462,i_container#14463,i_manager_id#14464,i_product_name#14465] parquet, Statistics(sizeInBytes=3.1 MiB)
                           :     :     +- Project [cs_sold_date_sk#14466, cs_call_center_sk#14477, cs_item_sk#14481, cs_sales_price#14487], Statistics(sizeInBytes=14.5 MiB)
                           :     :        +- Filter ((isnotnull(cs_item_sk#14481) AND isnotnull(cs_sold_date_sk#14466)) AND isnotnull(cs_call_center_sk#14477)), Statistics(sizeInBytes=105.8 MiB)
                           :     :           +- Relation default.catalog_sales[cs_sold_date_sk#14466,cs_sold_time_sk#14467,cs_ship_date_sk#14468,cs_bill_customer_sk#14469,cs_bill_cdemo_sk#14470,cs_bill_hdemo_sk#14471,cs_bill_addr_sk#14472,cs_ship_customer_sk#14473,cs_ship_cdemo_sk#14474,cs_ship_hdemo_sk#14475,cs_ship_addr_sk#14476,cs_call_center_sk#14477,cs_catalog_page_sk#14478,cs_ship_mode_sk#14479,cs_warehouse_sk#14480,cs_item_sk#14481,cs_promo_sk#14482,cs_order_number#14483,cs_quantity#14484,cs_wholesale_cost#14485,cs_list_price#14486,cs_sales_price#14487,cs_ext_discount_amt#14488,cs_ext_sales_price#14489,cs_ext_wholesale_cost#14490,cs_ext_list_price#14491,cs_ext_tax#14492,cs_coupon_amt#14493,cs_ext_ship_cost#14494,cs_net_paid#14495,cs_net_paid_inc_tax#14496,cs_net_paid_inc_ship#14497,cs_net_paid_inc_ship_tax#14498,cs_net_profit#14499] parquet, Statistics(sizeInBytes=105.8 MiB)
                           :     +- Project [d_date_sk#14500, d_year#14506, d_moy#14508], Statistics(sizeInBytes=175.5 KiB)
                           :        +- Filter ((((d_year#14506 = 1999) OR ((d_year#14506 = 1998) AND (d_moy#14508 = 12))) OR ((d_year#14506 = 2000) AND (d_moy#14508 = 1))) AND isnotnull(d_date_sk#14500)), Statistics(sizeInBytes=2.5 MiB)
                           :           +- Relation default.date_dim[d_date_sk#14500,d_date_id#14501,d_date#14502,d_month_seq#14503,d_week_seq#14504,d_quarter_seq#14505,d_year#14506,d_dow#14507,d_moy#14508,d_dom#14509,d_qoy#14510,d_fy_year#14511,d_fy_quarter_seq#14512,d_fy_week_seq#14513,d_day_name#14514,d_quarter_name#14515,d_holiday#14516,d_weekend#14517,d_following_holiday#14518,d_first_dom#14519,d_last_dom#14520,d_same_day_ly#14521,d_same_day_lq#14522,d_current_day#14523,d_current_week#14524,d_current_month#14525,d_current_quarter#14526,d_current_year#14527] parquet, Statistics(sizeInBytes=2.5 MiB)
                           +- Project [cc_call_center_sk#14528, cc_name#14534], Statistics(sizeInBytes=4.2 KiB)
                              +- Filter (isnotnull(cc_call_center_sk#14528) AND isnotnull(cc_name#14534)), Statistics(sizeInBytes=58.2 KiB)
                                 +- Relation default.call_center[cc_call_center_sk#14528,cc_call_center_id#14529,cc_rec_start_date#14530,cc_rec_end_date#14531,cc_closed_date_sk#14532,cc_open_date_sk#14533,cc_name#14534,cc_class#14535,cc_employees#14536,cc_sq_ft#14537,cc_hours#14538,cc_manager#14539,cc_mkt_id#14540,cc_mkt_class#14541,cc_mkt_desc#14542,cc_market_manager#14543,cc_division#14544,cc_division_name#14545,cc_company#14546,cc_company_name#14547,cc_street_number#14548,cc_street_name#14549,cc_street_type#14550,cc_suite_number#14551,cc_city#14552,cc_county#14553,cc_state#14554,cc_zip#14555,cc_country#14556,cc_gmt_offset#14557,cc_tax_percentage#14558] parquet, Statistics(sizeInBytes=58.2 KiB)


==== q58 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=11.3 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=3.81E+52 B)
   +- Sort [item_id#14709 ASC NULLS FIRST, ss_item_rev#14710 ASC NULLS FIRST], true, Statistics(sizeInBytes=3.81E+52 B)
      +- Project [item_id#14709, ss_item_rev#14710, CheckOverflow((promote_precision(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(ss_item_rev#14710 as decimal(19,2))) / promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#14710 as decimal(18,2))) + promote_precision(cast(cs_item_rev#14714 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#14718 as decimal(19,2)))), DecimalType(19,2)))), DecimalType(38,21))) / 3.000000000000000000000), DecimalType(38,21))) * 100.000000000000000000000), DecimalType(38,17)) AS ss_dev#14705, cs_item_rev#14714, CheckOverflow((promote_precision(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(cs_item_rev#14714 as decimal(19,2))) / promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#14710 as decimal(18,2))) + promote_precision(cast(cs_item_rev#14714 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#14718 as decimal(19,2)))), DecimalType(19,2)))), DecimalType(38,21))) / 3.000000000000000000000), DecimalType(38,21))) * 100.000000000000000000000), DecimalType(38,17)) AS cs_dev#14706, ws_item_rev#14718, CheckOverflow((promote_precision(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(ws_item_rev#14718 as decimal(19,2))) / promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#14710 as decimal(18,2))) + promote_precision(cast(cs_item_rev#14714 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#14718 as decimal(19,2)))), DecimalType(19,2)))), DecimalType(38,21))) / 3.000000000000000000000), DecimalType(38,21))) * 100.000000000000000000000), DecimalType(38,17)) AS ws_dev#14707, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#14710 as decimal(18,2))) + promote_precision(cast(cs_item_rev#14714 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#14718 as decimal(19,2)))), DecimalType(19,2))) / 3.00), DecimalType(23,6)) AS average#14708], Statistics(sizeInBytes=3.81E+52 B)
         +- Join Inner, (((((((((item_id#14709 = item_id#14717) AND (cast(ss_item_rev#14710 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ws_item_rev#14718)), DecimalType(19,3)))) AND (cast(ss_item_rev#14710 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ws_item_rev#14718)), DecimalType(20,3)))) AND (cast(cs_item_rev#14714 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ws_item_rev#14718)), DecimalType(19,3)))) AND (cast(cs_item_rev#14714 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ws_item_rev#14718)), DecimalType(20,3)))) AND (cast(ws_item_rev#14718 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ss_item_rev#14710)), DecimalType(19,3)))) AND (cast(ws_item_rev#14718 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ss_item_rev#14710)), DecimalType(20,3)))) AND (cast(ws_item_rev#14718 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(cs_item_rev#14714)), DecimalType(19,3)))) AND (cast(ws_item_rev#14718 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(cs_item_rev#14714)), DecimalType(20,3)))), Statistics(sizeInBytes=2.36E+52 B)
            :- Project [item_id#14709, ss_item_rev#14710, cs_item_rev#14714], Statistics(sizeInBytes=1.43E+35 B)
            :  +- Join Inner, (((((item_id#14709 = item_id#14713) AND (cast(ss_item_rev#14710 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(cs_item_rev#14714)), DecimalType(19,3)))) AND (cast(ss_item_rev#14710 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(cs_item_rev#14714)), DecimalType(20,3)))) AND (cast(cs_item_rev#14714 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ss_item_rev#14710)), DecimalType(19,3)))) AND (cast(cs_item_rev#14714 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ss_item_rev#14710)), DecimalType(20,3)))), Statistics(sizeInBytes=2.08E+35 B)
            :     :- Filter isnotnull(ss_item_rev#14710), Statistics(sizeInBytes=549.0 PiB)
            :     :  +- Aggregate [i_item_id#438], [i_item_id#438 AS item_id#14709, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS ss_item_rev#14710], Statistics(sizeInBytes=549.0 PiB)
            :     :     +- Project [ss_ext_sales_price#429, i_item_id#438], Statistics(sizeInBytes=549.0 PiB)
            :     :        +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=671.0 PiB)
            :     :           :- Project [ss_sold_date_sk#414, ss_ext_sales_price#429, i_item_id#438], Statistics(sizeInBytes=6.4 TiB)
            :     :           :  +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=7.6 TiB)
            :     :           :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_ext_sales_price#429], Statistics(sizeInBytes=22.9 MiB)
            :     :           :     :  +- Filter (isnotnull(ss_item_sk#416) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
            :     :           :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     :           :     +- Project [i_item_sk#437, i_item_id#438], Statistics(sizeInBytes=342.3 KiB)
            :     :           :        +- Filter (isnotnull(i_item_sk#437) AND isnotnull(i_item_id#438)), Statistics(sizeInBytes=3.1 MiB)
            :     :           :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
            :     :           +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
            :     :              +- Join LeftSemi, (d_date#26 = d_date#14911), Statistics(sizeInBytes=140.4 KiB)
            :     :                 :- Project [d_date_sk#24, d_date#26], Statistics(sizeInBytes=140.4 KiB)
            :     :                 :  +- Filter isnotnull(d_date_sk#24), Statistics(sizeInBytes=2.5 MiB)
            :     :                 :     +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :                 +- Project [d_date#14911], Statistics(sizeInBytes=105.3 KiB)
            :     :                    +- Filter (isnotnull(d_week_seq#14913) AND (d_week_seq#14913 = scalar-subquery#14711 [])), Statistics(sizeInBytes=2.5 MiB)
            :     :                       :  +- Project [d_week_seq#14825], Statistics(sizeInBytes=105.3 KiB)
            :     :                       :     +- Filter (isnotnull(d_date#14823) AND (d_date#14823 = 2000-01-03)), Statistics(sizeInBytes=2.5 MiB)
            :     :                       :        +- Relation default.date_dim[d_date_sk#14821,d_date_id#14822,d_date#14823,d_month_seq#14824,d_week_seq#14825,d_quarter_seq#14826,d_year#14827,d_dow#14828,d_moy#14829,d_dom#14830,d_qoy#14831,d_fy_year#14832,d_fy_quarter_seq#14833,d_fy_week_seq#14834,d_day_name#14835,d_quarter_name#14836,d_holiday#14837,d_weekend#14838,d_following_holiday#14839,d_first_dom#14840,d_last_dom#14841,d_same_day_ly#14842,d_same_day_lq#14843,d_current_day#14844,d_current_week#14845,d_current_month#14846,d_current_quarter#14847,d_current_year#14848] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :                       +- Relation default.date_dim[d_date_sk#14909,d_date_id#14910,d_date#14911,d_month_seq#14912,d_week_seq#14913,d_quarter_seq#14914,d_year#14915,d_dow#14916,d_moy#14917,d_dom#14918,d_qoy#14919,d_fy_year#14920,d_fy_quarter_seq#14921,d_fy_week_seq#14922,d_day_name#14923,d_quarter_name#14924,d_holiday#14925,d_weekend#14926,d_following_holiday#14927,d_first_dom#14928,d_last_dom#14929,d_same_day_ly#14930,d_same_day_lq#14931,d_current_day#14932,d_current_week#14933,d_current_month#14934,d_current_quarter#14935,d_current_year#14936] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     +- Filter isnotnull(cs_item_rev#14714), Statistics(sizeInBytes=298.8 PiB)
            :        +- Aggregate [i_item_id#14722], [i_item_id#14722 AS item_id#14713, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#220)),17,2) AS cs_item_rev#14714], Statistics(sizeInBytes=298.8 PiB)
            :           +- Project [cs_ext_sales_price#220, i_item_id#14722], Statistics(sizeInBytes=298.8 PiB)
            :              +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#14743), Statistics(sizeInBytes=365.2 PiB)
            :                 :- Project [cs_sold_date_sk#197, cs_ext_sales_price#220, i_item_id#14722], Statistics(sizeInBytes=3.5 TiB)
            :                 :  +- Join Inner, (cs_item_sk#212 = i_item_sk#14721), Statistics(sizeInBytes=4.2 TiB)
            :                 :     :- Project [cs_sold_date_sk#197, cs_item_sk#212, cs_ext_sales_price#220], Statistics(sizeInBytes=12.4 MiB)
            :                 :     :  +- Filter (isnotnull(cs_item_sk#212) AND isnotnull(cs_sold_date_sk#197)), Statistics(sizeInBytes=105.8 MiB)
            :                 :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
            :                 :     +- Project [i_item_sk#14721, i_item_id#14722], Statistics(sizeInBytes=342.3 KiB)
            :                 :        +- Filter (isnotnull(i_item_sk#14721) AND isnotnull(i_item_id#14722)), Statistics(sizeInBytes=3.1 MiB)
            :                 :           +- Relation default.item[i_item_sk#14721,i_item_id#14722,i_rec_start_date#14723,i_rec_end_date#14724,i_item_desc#14725,i_current_price#14726,i_wholesale_cost#14727,i_brand_id#14728,i_brand#14729,i_class_id#14730,i_class#14731,i_category_id#14732,i_category#14733,i_manufact_id#14734,i_manufact#14735,i_size#14736,i_formulation#14737,i_color#14738,i_units#14739,i_container#14740,i_manager_id#14741,i_product_name#14742] parquet, Statistics(sizeInBytes=3.1 MiB)
            :                 +- Project [d_date_sk#14743], Statistics(sizeInBytes=105.3 KiB)
            :                    +- Join LeftSemi, (d_date#14745 = d_date#14939), Statistics(sizeInBytes=140.4 KiB)
            :                       :- Project [d_date_sk#14743, d_date#14745], Statistics(sizeInBytes=140.4 KiB)
            :                       :  +- Filter isnotnull(d_date_sk#14743), Statistics(sizeInBytes=2.5 MiB)
            :                       :     +- Relation default.date_dim[d_date_sk#14743,d_date_id#14744,d_date#14745,d_month_seq#14746,d_week_seq#14747,d_quarter_seq#14748,d_year#14749,d_dow#14750,d_moy#14751,d_dom#14752,d_qoy#14753,d_fy_year#14754,d_fy_quarter_seq#14755,d_fy_week_seq#14756,d_day_name#14757,d_quarter_name#14758,d_holiday#14759,d_weekend#14760,d_following_holiday#14761,d_first_dom#14762,d_last_dom#14763,d_same_day_ly#14764,d_same_day_lq#14765,d_current_day#14766,d_current_week#14767,d_current_month#14768,d_current_quarter#14769,d_current_year#14770] parquet, Statistics(sizeInBytes=2.5 MiB)
            :                       +- Project [d_date#14939], Statistics(sizeInBytes=105.3 KiB)
            :                          +- Filter (isnotnull(d_week_seq#14941) AND (d_week_seq#14941 = scalar-subquery#14715 [])), Statistics(sizeInBytes=2.5 MiB)
            :                             :  +- Project [d_week_seq#14825], Statistics(sizeInBytes=105.3 KiB)
            :                             :     +- Filter (isnotnull(d_date#14823) AND (d_date#14823 = 2000-01-03)), Statistics(sizeInBytes=2.5 MiB)
            :                             :        +- Relation default.date_dim[d_date_sk#14821,d_date_id#14822,d_date#14823,d_month_seq#14824,d_week_seq#14825,d_quarter_seq#14826,d_year#14827,d_dow#14828,d_moy#14829,d_dom#14830,d_qoy#14831,d_fy_year#14832,d_fy_quarter_seq#14833,d_fy_week_seq#14834,d_day_name#14835,d_quarter_name#14836,d_holiday#14837,d_weekend#14838,d_following_holiday#14839,d_first_dom#14840,d_last_dom#14841,d_same_day_ly#14842,d_same_day_lq#14843,d_current_day#14844,d_current_week#14845,d_current_month#14846,d_current_quarter#14847,d_current_year#14848] parquet, Statistics(sizeInBytes=2.5 MiB)
            :                             +- Relation default.date_dim[d_date_sk#14937,d_date_id#14938,d_date#14939,d_month_seq#14940,d_week_seq#14941,d_quarter_seq#14942,d_year#14943,d_dow#14944,d_moy#14945,d_dom#14946,d_qoy#14947,d_fy_year#14948,d_fy_quarter_seq#14949,d_fy_week_seq#14950,d_day_name#14951,d_quarter_name#14952,d_holiday#14953,d_weekend#14954,d_following_holiday#14955,d_first_dom#14956,d_last_dom#14957,d_same_day_ly#14958,d_same_day_lq#14959,d_current_day#14960,d_current_week#14961,d_current_month#14962,d_current_quarter#14963,d_current_year#14964] parquet, Statistics(sizeInBytes=2.5 MiB)
            +- Filter isnotnull(ws_item_rev#14718), Statistics(sizeInBytes=146.8 PiB)
               +- Aggregate [i_item_id#14772], [i_item_id#14772 AS item_id#14717, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#186)),17,2) AS ws_item_rev#14718], Statistics(sizeInBytes=146.8 PiB)
                  +- Project [ws_ext_sales_price#186, i_item_id#14772], Statistics(sizeInBytes=146.8 PiB)
                     +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#14793), Statistics(sizeInBytes=179.4 PiB)
                        :- Project [ws_sold_date_sk#163, ws_ext_sales_price#186, i_item_id#14772], Statistics(sizeInBytes=1744.3 GiB)
                        :  +- Join Inner, (ws_item_sk#166 = i_item_sk#14771), Statistics(sizeInBytes=2.0 TiB)
                        :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_ext_sales_price#186], Statistics(sizeInBytes=6.1 MiB)
                        :     :  +- Filter (isnotnull(ws_item_sk#166) AND isnotnull(ws_sold_date_sk#163)), Statistics(sizeInBytes=52.0 MiB)
                        :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                        :     +- Project [i_item_sk#14771, i_item_id#14772], Statistics(sizeInBytes=342.3 KiB)
                        :        +- Filter (isnotnull(i_item_sk#14771) AND isnotnull(i_item_id#14772)), Statistics(sizeInBytes=3.1 MiB)
                        :           +- Relation default.item[i_item_sk#14771,i_item_id#14772,i_rec_start_date#14773,i_rec_end_date#14774,i_item_desc#14775,i_current_price#14776,i_wholesale_cost#14777,i_brand_id#14778,i_brand#14779,i_class_id#14780,i_class#14781,i_category_id#14782,i_category#14783,i_manufact_id#14784,i_manufact#14785,i_size#14786,i_formulation#14787,i_color#14788,i_units#14789,i_container#14790,i_manager_id#14791,i_product_name#14792] parquet, Statistics(sizeInBytes=3.1 MiB)
                        +- Project [d_date_sk#14793], Statistics(sizeInBytes=105.3 KiB)
                           +- Join LeftSemi, (d_date#14795 = d_date#14967), Statistics(sizeInBytes=140.4 KiB)
                              :- Project [d_date_sk#14793, d_date#14795], Statistics(sizeInBytes=140.4 KiB)
                              :  +- Filter isnotnull(d_date_sk#14793), Statistics(sizeInBytes=2.5 MiB)
                              :     +- Relation default.date_dim[d_date_sk#14793,d_date_id#14794,d_date#14795,d_month_seq#14796,d_week_seq#14797,d_quarter_seq#14798,d_year#14799,d_dow#14800,d_moy#14801,d_dom#14802,d_qoy#14803,d_fy_year#14804,d_fy_quarter_seq#14805,d_fy_week_seq#14806,d_day_name#14807,d_quarter_name#14808,d_holiday#14809,d_weekend#14810,d_following_holiday#14811,d_first_dom#14812,d_last_dom#14813,d_same_day_ly#14814,d_same_day_lq#14815,d_current_day#14816,d_current_week#14817,d_current_month#14818,d_current_quarter#14819,d_current_year#14820] parquet, Statistics(sizeInBytes=2.5 MiB)
                              +- Project [d_date#14967], Statistics(sizeInBytes=105.3 KiB)
                                 +- Filter (isnotnull(d_week_seq#14969) AND (d_week_seq#14969 = scalar-subquery#14719 [])), Statistics(sizeInBytes=2.5 MiB)
                                    :  +- Project [d_week_seq#14825], Statistics(sizeInBytes=105.3 KiB)
                                    :     +- Filter (isnotnull(d_date#14823) AND (d_date#14823 = 2000-01-03)), Statistics(sizeInBytes=2.5 MiB)
                                    :        +- Relation default.date_dim[d_date_sk#14821,d_date_id#14822,d_date#14823,d_month_seq#14824,d_week_seq#14825,d_quarter_seq#14826,d_year#14827,d_dow#14828,d_moy#14829,d_dom#14830,d_qoy#14831,d_fy_year#14832,d_fy_quarter_seq#14833,d_fy_week_seq#14834,d_day_name#14835,d_quarter_name#14836,d_holiday#14837,d_weekend#14838,d_following_holiday#14839,d_first_dom#14840,d_last_dom#14841,d_same_day_ly#14842,d_same_day_lq#14843,d_current_day#14844,d_current_week#14845,d_current_month#14846,d_current_quarter#14847,d_current_year#14848] parquet, Statistics(sizeInBytes=2.5 MiB)
                                    +- Relation default.date_dim[d_date_sk#14965,d_date_id#14966,d_date#14967,d_month_seq#14968,d_week_seq#14969,d_quarter_seq#14970,d_year#14971,d_dow#14972,d_moy#14973,d_dom#14974,d_qoy#14975,d_fy_year#14976,d_fy_quarter_seq#14977,d_fy_week_seq#14978,d_day_name#14979,d_quarter_name#14980,d_holiday#14981,d_weekend#14982,d_following_holiday#14983,d_first_dom#14984,d_last_dom#14985,d_same_day_ly#14986,d_same_day_lq#14987,d_current_day#14988,d_current_week#14989,d_current_month#14990,d_current_quarter#14991,d_current_year#14992] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q59 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=16.0 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=9.42E+43 B)
   +- Sort [s_store_name1#15033 ASC NULLS FIRST, s_store_id1#15035 ASC NULLS FIRST, d_week_seq1#15034 ASC NULLS FIRST], true, Statistics(sizeInBytes=9.42E+43 B)
      +- Project [s_store_name1#15033, s_store_id1#15035, d_week_seq1#15034, CheckOverflow((promote_precision(sun_sales1#15036) / promote_precision(sun_sales2#15046)), DecimalType(37,20)) AS (sun_sales1 / sun_sales2)#15152, CheckOverflow((promote_precision(mon_sales1#15037) / promote_precision(mon_sales2#15047)), DecimalType(37,20)) AS (mon_sales1 / mon_sales2)#15153, CheckOverflow((promote_precision(tue_sales1#15038) / promote_precision(tue_sales2#15048)), DecimalType(37,20)) AS (tue_sales1 / tue_sales2)#15154, CheckOverflow((promote_precision(wed_sales1#15039) / promote_precision(wed_sales2#15049)), DecimalType(37,20)) AS (wed_sales1 / wed_sales2)#15155, CheckOverflow((promote_precision(thu_sales1#15040) / promote_precision(thu_sales2#15050)), DecimalType(37,20)) AS (thu_sales1 / thu_sales2)#15156, CheckOverflow((promote_precision(fri_sales1#15041) / promote_precision(fri_sales2#15051)), DecimalType(37,20)) AS (fri_sales1 / fri_sales2)#15157, CheckOverflow((promote_precision(sat_sales1#15042) / promote_precision(sat_sales2#15052)), DecimalType(37,20)) AS (sat_sales1 / sat_sales2)#15158], Statistics(sizeInBytes=9.42E+43 B)
         +- Join Inner, ((s_store_id1#15035 = s_store_id2#15045) AND (d_week_seq1#15034 = (d_week_seq2#15044 - 52))), Statistics(sizeInBytes=1.08E+44 B)
            :- Project [s_store_name#57 AS s_store_name1#15033, d_week_seq#28 AS d_week_seq1#15034, s_store_id#53 AS s_store_id1#15035, sun_sales#15053 AS sun_sales1#15036, mon_sales#15054 AS mon_sales1#15037, tue_sales#15055 AS tue_sales1#15038, wed_sales#15056 AS wed_sales1#15039, thu_sales#15057 AS thu_sales1#15040, fri_sales#15058 AS fri_sales1#15041, sat_sales#15059 AS sat_sales1#15042], Statistics(sizeInBytes=1.34E+22 B)
            :  +- Join Inner, (d_week_seq#15064 = d_week_seq#28), Statistics(sizeInBytes=1.39E+22 B)
            :     :- Project [d_week_seq#28, sun_sales#15053, mon_sales#15054, tue_sales#15055, wed_sales#15056, thu_sales#15057, fri_sales#15058, sat_sales#15059, s_store_id#53, s_store_name#57], Statistics(sizeInBytes=114.5 PiB)
            :     :  +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=123.0 PiB)
            :     :     :- Aggregate [d_week_seq#28, ss_store_sk#421], [d_week_seq#28, ss_store_sk#421, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Sunday   ) THEN ss_sales_price#427 END)),17,2) AS sun_sales#15053, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Monday   ) THEN ss_sales_price#427 END)),17,2) AS mon_sales#15054, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Tuesday  ) THEN ss_sales_price#427 END)),17,2) AS tue_sales#15055, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Wednesday) THEN ss_sales_price#427 END)),17,2) AS wed_sales#15056, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Thursday ) THEN ss_sales_price#427 END)),17,2) AS thu_sales#15057, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Friday   ) THEN ss_sales_price#427 END)),17,2) AS fri_sales#15058, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Saturday ) THEN ss_sales_price#427 END)),17,2) AS sat_sales#15059], Statistics(sizeInBytes=9.8 TiB)
            :     :     :  +- Project [ss_store_sk#421, ss_sales_price#427, d_week_seq#28, d_day_name#38], Statistics(sizeInBytes=6.0 TiB)
            :     :     :     +- Join Inner, (d_date_sk#24 = ss_sold_date_sk#414), Statistics(sizeInBytes=7.1 TiB)
            :     :     :        :- Project [ss_sold_date_sk#414, ss_store_sk#421, ss_sales_price#427], Statistics(sizeInBytes=22.9 MiB)
            :     :     :        :  +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421)), Statistics(sizeInBytes=141.1 MiB)
            :     :     :        :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     :     :        +- Project [d_date_sk#24, d_week_seq#28, d_day_name#38], Statistics(sizeInBytes=315.9 KiB)
            :     :     :           +- Filter (isnotnull(d_date_sk#24) AND isnotnull(d_week_seq#28)), Statistics(sizeInBytes=2.5 MiB)
            :     :     :              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :     +- Project [s_store_sk#52, s_store_id#53, s_store_name#57], Statistics(sizeInBytes=12.6 KiB)
            :     :        +- Filter (isnotnull(s_store_sk#52) AND isnotnull(s_store_id#53)), Statistics(sizeInBytes=101.7 KiB)
            :     :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
            :     +- Project [d_week_seq#15064], Statistics(sizeInBytes=105.3 KiB)
            :        +- Filter ((isnotnull(d_month_seq#15063) AND ((d_month_seq#15063 >= 1212) AND (d_month_seq#15063 <= 1223))) AND isnotnull(d_week_seq#15064)), Statistics(sizeInBytes=2.5 MiB)
            :           +- Relation default.date_dim[d_date_sk#15060,d_date_id#15061,d_date#15062,d_month_seq#15063,d_week_seq#15064,d_quarter_seq#15065,d_year#15066,d_dow#15067,d_moy#15068,d_dom#15069,d_qoy#15070,d_fy_year#15071,d_fy_quarter_seq#15072,d_fy_week_seq#15073,d_day_name#15074,d_quarter_name#15075,d_holiday#15076,d_weekend#15077,d_following_holiday#15078,d_first_dom#15079,d_last_dom#15080,d_same_day_ly#15081,d_same_day_lq#15082,d_current_day#15083,d_current_week#15084,d_current_month#15085,d_current_quarter#15086,d_current_year#15087] parquet, Statistics(sizeInBytes=2.5 MiB)
            +- Project [d_week_seq#28 AS d_week_seq2#15044, s_store_id#15089 AS s_store_id2#15045, sun_sales#15053 AS sun_sales2#15046, mon_sales#15054 AS mon_sales2#15047, tue_sales#15055 AS tue_sales2#15048, wed_sales#15056 AS wed_sales2#15049, thu_sales#15057 AS thu_sales2#15050, fri_sales#15058 AS fri_sales2#15051, sat_sales#15059 AS sat_sales2#15052], Statistics(sizeInBytes=8.06E+21 B)
               +- Join Inner, (d_week_seq#15121 = d_week_seq#28), Statistics(sizeInBytes=8.42E+21 B)
                  :- Project [d_week_seq#28, sun_sales#15053, mon_sales#15054, tue_sales#15055, wed_sales#15056, thu_sales#15057, fri_sales#15058, sat_sales#15059, s_store_id#15089], Statistics(sizeInBytes=69.4 PiB)
                  :  +- Join Inner, (ss_store_sk#421 = s_store_sk#15088), Statistics(sizeInBytes=75.7 PiB)
                  :     :- Aggregate [d_week_seq#28, ss_store_sk#421], [d_week_seq#28, ss_store_sk#421, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Sunday   ) THEN ss_sales_price#427 END)),17,2) AS sun_sales#15053, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Monday   ) THEN ss_sales_price#427 END)),17,2) AS mon_sales#15054, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Tuesday  ) THEN ss_sales_price#427 END)),17,2) AS tue_sales#15055, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Wednesday) THEN ss_sales_price#427 END)),17,2) AS wed_sales#15056, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Thursday ) THEN ss_sales_price#427 END)),17,2) AS thu_sales#15057, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Friday   ) THEN ss_sales_price#427 END)),17,2) AS fri_sales#15058, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#38 = Saturday ) THEN ss_sales_price#427 END)),17,2) AS sat_sales#15059], Statistics(sizeInBytes=9.8 TiB)
                  :     :  +- Project [ss_store_sk#421, ss_sales_price#427, d_week_seq#28, d_day_name#38], Statistics(sizeInBytes=6.0 TiB)
                  :     :     +- Join Inner, (d_date_sk#24 = ss_sold_date_sk#414), Statistics(sizeInBytes=7.1 TiB)
                  :     :        :- Project [ss_sold_date_sk#414, ss_store_sk#421, ss_sales_price#427], Statistics(sizeInBytes=22.9 MiB)
                  :     :        :  +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421)), Statistics(sizeInBytes=141.1 MiB)
                  :     :        :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                  :     :        +- Project [d_date_sk#24, d_week_seq#28, d_day_name#38], Statistics(sizeInBytes=315.9 KiB)
                  :     :           +- Filter (isnotnull(d_date_sk#24) AND isnotnull(d_week_seq#28)), Statistics(sizeInBytes=2.5 MiB)
                  :     :              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                  :     +- Project [s_store_sk#15088, s_store_id#15089], Statistics(sizeInBytes=7.7 KiB)
                  :        +- Filter (isnotnull(s_store_sk#15088) AND isnotnull(s_store_id#15089)), Statistics(sizeInBytes=101.7 KiB)
                  :           +- Relation default.store[s_store_sk#15088,s_store_id#15089,s_rec_start_date#15090,s_rec_end_date#15091,s_closed_date_sk#15092,s_store_name#15093,s_number_employees#15094,s_floor_space#15095,s_hours#15096,s_manager#15097,s_market_id#15098,s_geography_class#15099,s_market_desc#15100,s_market_manager#15101,s_division_id#15102,s_division_name#15103,s_company_id#15104,s_company_name#15105,s_street_number#15106,s_street_name#15107,s_street_type#15108,s_suite_number#15109,s_city#15110,s_county#15111,s_state#15112,s_zip#15113,s_country#15114,s_gmt_offset#15115,s_tax_percentage#15116] parquet, Statistics(sizeInBytes=101.7 KiB)
                  +- Project [d_week_seq#15121], Statistics(sizeInBytes=105.3 KiB)
                     +- Filter ((isnotnull(d_month_seq#15120) AND ((d_month_seq#15120 >= 1224) AND (d_month_seq#15120 <= 1235))) AND isnotnull(d_week_seq#15121)), Statistics(sizeInBytes=2.5 MiB)
                        +- Relation default.date_dim[d_date_sk#15117,d_date_id#15118,d_date#15119,d_month_seq#15120,d_week_seq#15121,d_quarter_seq#15122,d_year#15123,d_dow#15124,d_moy#15125,d_dom#15126,d_qoy#15127,d_fy_year#15128,d_fy_quarter_seq#15129,d_fy_week_seq#15130,d_day_name#15131,d_quarter_name#15132,d_holiday#15133,d_weekend#15134,d_following_holiday#15135,d_first_dom#15136,d_last_dom#15137,d_same_day_ly#15138,d_same_day_lq#15139,d_current_day#15140,d_current_week#15141,d_current_month#15142,d_current_quarter#15143,d_current_year#15144] parquet, Statistics(sizeInBytes=2.5 MiB)

==== q60 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=4.3 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.33E+23 B)
   +- Sort [i_item_id#438 ASC NULLS FIRST, total_sales#15270 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.33E+23 B)
      +- Aggregate [i_item_id#438], [i_item_id#438, sum(total_sales#15271) AS total_sales#15270], Statistics(sizeInBytes=1.33E+23 B)
         +- Union false, false, Statistics(sizeInBytes=1.08E+23 B)
            :- Aggregate [i_item_id#438], [i_item_id#438, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS total_sales#15271], Statistics(sizeInBytes=5.99E+22 B)
            :  +- Project [ss_ext_sales_price#429, i_item_id#438], Statistics(sizeInBytes=5.99E+22 B)
            :     +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=7.32E+22 B)
            :        :- Project [ss_item_sk#416, ss_ext_sales_price#429], Statistics(sizeInBytes=185.5 PiB)
            :        :  +- Join Inner, (ss_addr_sk#420 = ca_address_sk#3717), Statistics(sizeInBytes=259.7 PiB)
            :        :     :- Project [ss_item_sk#416, ss_addr_sk#420, ss_ext_sales_price#429], Statistics(sizeInBytes=2.1 TiB)
            :        :     :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2.7 TiB)
            :        :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_addr_sk#420, ss_ext_sales_price#429], Statistics(sizeInBytes=26.7 MiB)
            :        :     :     :  +- Filter (isnotnull(ss_sold_date_sk#414) AND (isnotnull(ss_addr_sk#420) AND isnotnull(ss_item_sk#416))), Statistics(sizeInBytes=141.1 MiB)
            :        :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
            :        :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
            :        :     :        +- Filter (((isnotnull(d_year#30) AND isnotnull(d_moy#32)) AND ((d_year#30 = 1998) AND (d_moy#32 = 9))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :        :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :        :     +- Project [ca_address_sk#3717], Statistics(sizeInBytes=126.2 KiB)
            :        :        +- Filter ((isnotnull(ca_gmt_offset#3728) AND (ca_gmt_offset#3728 = -5.00)) AND isnotnull(ca_address_sk#3717)), Statistics(sizeInBytes=2.5 MiB)
            :        :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
            :        +- Join LeftSemi, (i_item_id#438 = i_item_id#15404), Statistics(sizeInBytes=342.3 KiB)
            :           :- Project [i_item_sk#437, i_item_id#438], Statistics(sizeInBytes=342.3 KiB)
            :           :  +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
            :           :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
            :           +- Project [i_item_id#15404], Statistics(sizeInBytes=299.5 KiB)
            :              +- Filter (isnotnull(i_category#15415) AND (i_category#15415 = Music                                             )), Statistics(sizeInBytes=3.1 MiB)
            :                 +- Relation default.item[i_item_sk#15403,i_item_id#15404,i_rec_start_date#15405,i_rec_end_date#15406,i_item_desc#15407,i_current_price#15408,i_wholesale_cost#15409,i_brand_id#15410,i_brand#15411,i_class_id#15412,i_class#15413,i_category_id#15414,i_category#15415,i_manufact_id#15416,i_manufact#15417,i_size#15418,i_formulation#15419,i_color#15420,i_units#15421,i_container#15422,i_manager_id#15423,i_product_name#15424] parquet, Statistics(sizeInBytes=3.1 MiB)
            :- Aggregate [i_item_id#15319], [i_item_id#15319, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#220)),17,2) AS total_sales#15273], Statistics(sizeInBytes=3.26E+22 B)
            :  +- Project [cs_ext_sales_price#220, i_item_id#15319], Statistics(sizeInBytes=3.26E+22 B)
            :     +- Join Inner, (cs_item_sk#212 = i_item_sk#15318), Statistics(sizeInBytes=3.98E+22 B)
            :        :- Project [cs_item_sk#212, cs_ext_sales_price#220], Statistics(sizeInBytes=100.9 PiB)
            :        :  +- Join Inner, (cs_bill_addr_sk#203 = ca_address_sk#15305), Statistics(sizeInBytes=141.3 PiB)
            :        :     :- Project [cs_bill_addr_sk#203, cs_item_sk#212, cs_ext_sales_price#220], Statistics(sizeInBytes=1147.1 GiB)
            :        :     :  +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#15277), Statistics(sizeInBytes=1529.5 GiB)
            :        :     :     :- Project [cs_sold_date_sk#197, cs_bill_addr_sk#203, cs_item_sk#212, cs_ext_sales_price#220], Statistics(sizeInBytes=14.5 MiB)
            :        :     :     :  +- Filter (isnotnull(cs_sold_date_sk#197) AND (isnotnull(cs_bill_addr_sk#203) AND isnotnull(cs_item_sk#212))), Statistics(sizeInBytes=105.8 MiB)
            :        :     :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
            :        :     :     +- Project [d_date_sk#15277], Statistics(sizeInBytes=105.3 KiB)
            :        :     :        +- Filter (((isnotnull(d_year#15283) AND isnotnull(d_moy#15285)) AND ((d_year#15283 = 1998) AND (d_moy#15285 = 9))) AND isnotnull(d_date_sk#15277)), Statistics(sizeInBytes=2.5 MiB)
            :        :     :           +- Relation default.date_dim[d_date_sk#15277,d_date_id#15278,d_date#15279,d_month_seq#15280,d_week_seq#15281,d_quarter_seq#15282,d_year#15283,d_dow#15284,d_moy#15285,d_dom#15286,d_qoy#15287,d_fy_year#15288,d_fy_quarter_seq#15289,d_fy_week_seq#15290,d_day_name#15291,d_quarter_name#15292,d_holiday#15293,d_weekend#15294,d_following_holiday#15295,d_first_dom#15296,d_last_dom#15297,d_same_day_ly#15298,d_same_day_lq#15299,d_current_day#15300,d_current_week#15301,d_current_month#15302,d_current_quarter#15303,d_current_year#15304] parquet, Statistics(sizeInBytes=2.5 MiB)
            :        :     +- Project [ca_address_sk#15305], Statistics(sizeInBytes=126.2 KiB)
            :        :        +- Filter ((isnotnull(ca_gmt_offset#15316) AND (ca_gmt_offset#15316 = -5.00)) AND isnotnull(ca_address_sk#15305)), Statistics(sizeInBytes=2.5 MiB)
            :        :           +- Relation default.customer_address[ca_address_sk#15305,ca_address_id#15306,ca_street_number#15307,ca_street_name#15308,ca_street_type#15309,ca_suite_number#15310,ca_city#15311,ca_county#15312,ca_state#15313,ca_zip#15314,ca_country#15315,ca_gmt_offset#15316,ca_location_type#15317] parquet, Statistics(sizeInBytes=2.5 MiB)
            :        +- Join LeftSemi, (i_item_id#15319 = i_item_id#15426), Statistics(sizeInBytes=342.3 KiB)
            :           :- Project [i_item_sk#15318, i_item_id#15319], Statistics(sizeInBytes=342.3 KiB)
            :           :  +- Filter isnotnull(i_item_sk#15318), Statistics(sizeInBytes=3.1 MiB)
            :           :     +- Relation default.item[i_item_sk#15318,i_item_id#15319,i_rec_start_date#15320,i_rec_end_date#15321,i_item_desc#15322,i_current_price#15323,i_wholesale_cost#15324,i_brand_id#15325,i_brand#15326,i_class_id#15327,i_class#15328,i_category_id#15329,i_category#15330,i_manufact_id#15331,i_manufact#15332,i_size#15333,i_formulation#15334,i_color#15335,i_units#15336,i_container#15337,i_manager_id#15338,i_product_name#15339] parquet, Statistics(sizeInBytes=3.1 MiB)
            :           +- Project [i_item_id#15426], Statistics(sizeInBytes=299.5 KiB)
            :              +- Filter (isnotnull(i_category#15437) AND (i_category#15437 = Music                                             )), Statistics(sizeInBytes=3.1 MiB)
            :                 +- Relation default.item[i_item_sk#15425,i_item_id#15426,i_rec_start_date#15427,i_rec_end_date#15428,i_item_desc#15429,i_current_price#15430,i_wholesale_cost#15431,i_brand_id#15432,i_brand#15433,i_class_id#15434,i_class#15435,i_category_id#15436,i_category#15437,i_manufact_id#15438,i_manufact#15439,i_size#15440,i_formulation#15441,i_color#15442,i_units#15443,i_container#15444,i_manager_id#15445,i_product_name#15446] parquet, Statistics(sizeInBytes=3.1 MiB)
            +- Aggregate [i_item_id#15382], [i_item_id#15382, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#186)),17,2) AS total_sales#15275], Statistics(sizeInBytes=1.60E+22 B)
               +- Project [ws_ext_sales_price#186, i_item_id#15382], Statistics(sizeInBytes=1.60E+22 B)
                  +- Join Inner, (ws_item_sk#166 = i_item_sk#15381), Statistics(sizeInBytes=1.96E+22 B)
                     :- Project [ws_item_sk#166, ws_ext_sales_price#186], Statistics(sizeInBytes=49.6 PiB)
                     :  +- Join Inner, (ws_bill_addr_sk#170 = ca_address_sk#15368), Statistics(sizeInBytes=69.4 PiB)
                     :     :- Project [ws_item_sk#166, ws_bill_addr_sk#170, ws_ext_sales_price#186], Statistics(sizeInBytes=563.5 GiB)
                     :     :  +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#15340), Statistics(sizeInBytes=751.3 GiB)
                     :     :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_bill_addr_sk#170, ws_ext_sales_price#186], Statistics(sizeInBytes=7.1 MiB)
                     :     :     :  +- Filter (isnotnull(ws_sold_date_sk#163) AND (isnotnull(ws_bill_addr_sk#170) AND isnotnull(ws_item_sk#166))), Statistics(sizeInBytes=52.0 MiB)
                     :     :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                     :     :     +- Project [d_date_sk#15340], Statistics(sizeInBytes=105.3 KiB)
                     :     :        +- Filter (((isnotnull(d_year#15346) AND isnotnull(d_moy#15348)) AND ((d_year#15346 = 1998) AND (d_moy#15348 = 9))) AND isnotnull(d_date_sk#15340)), Statistics(sizeInBytes=2.5 MiB)
                     :     :           +- Relation default.date_dim[d_date_sk#15340,d_date_id#15341,d_date#15342,d_month_seq#15343,d_week_seq#15344,d_quarter_seq#15345,d_year#15346,d_dow#15347,d_moy#15348,d_dom#15349,d_qoy#15350,d_fy_year#15351,d_fy_quarter_seq#15352,d_fy_week_seq#15353,d_day_name#15354,d_quarter_name#15355,d_holiday#15356,d_weekend#15357,d_following_holiday#15358,d_first_dom#15359,d_last_dom#15360,d_same_day_ly#15361,d_same_day_lq#15362,d_current_day#15363,d_current_week#15364,d_current_month#15365,d_current_quarter#15366,d_current_year#15367] parquet, Statistics(sizeInBytes=2.5 MiB)
                     :     +- Project [ca_address_sk#15368], Statistics(sizeInBytes=126.2 KiB)
                     :        +- Filter ((isnotnull(ca_gmt_offset#15379) AND (ca_gmt_offset#15379 = -5.00)) AND isnotnull(ca_address_sk#15368)), Statistics(sizeInBytes=2.5 MiB)
                     :           +- Relation default.customer_address[ca_address_sk#15368,ca_address_id#15369,ca_street_number#15370,ca_street_name#15371,ca_street_type#15372,ca_suite_number#15373,ca_city#15374,ca_county#15375,ca_state#15376,ca_zip#15377,ca_country#15378,ca_gmt_offset#15379,ca_location_type#15380] parquet, Statistics(sizeInBytes=2.5 MiB)
                     +- Join LeftSemi, (i_item_id#15382 = i_item_id#15448), Statistics(sizeInBytes=342.3 KiB)
                        :- Project [i_item_sk#15381, i_item_id#15382], Statistics(sizeInBytes=342.3 KiB)
                        :  +- Filter isnotnull(i_item_sk#15381), Statistics(sizeInBytes=3.1 MiB)
                        :     +- Relation default.item[i_item_sk#15381,i_item_id#15382,i_rec_start_date#15383,i_rec_end_date#15384,i_item_desc#15385,i_current_price#15386,i_wholesale_cost#15387,i_brand_id#15388,i_brand#15389,i_class_id#15390,i_class#15391,i_category_id#15392,i_category#15393,i_manufact_id#15394,i_manufact#15395,i_size#15396,i_formulation#15397,i_color#15398,i_units#15399,i_container#15400,i_manager_id#15401,i_product_name#15402] parquet, Statistics(sizeInBytes=3.1 MiB)
                        +- Project [i_item_id#15448], Statistics(sizeInBytes=299.5 KiB)
                           +- Filter (isnotnull(i_category#15459) AND (i_category#15459 = Music                                             )), Statistics(sizeInBytes=3.1 MiB)
                              +- Relation default.item[i_item_sk#15447,i_item_id#15448,i_rec_start_date#15449,i_rec_end_date#15450,i_item_desc#15451,i_current_price#15452,i_wholesale_cost#15453,i_brand_id#15454,i_brand#15455,i_class_id#15456,i_class#15457,i_category_id#15458,i_category#15459,i_manufact_id#15460,i_manufact#15461,i_size#15462,i_formulation#15463,i_color#15464,i_units#15465,i_container#15466,i_manager_id#15467,i_product_name#15468] parquet, Statistics(sizeInBytes=3.1 MiB)


==== q61 ====
== Optimized Logical Plan ==
Project [promotions#15519, total#15520, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(promotions#15519 as decimal(15,4))) / promote_precision(cast(total#15520 as decimal(15,4)))), DecimalType(35,20))) * 100.00000000000000000000), DecimalType(38,19)) AS ((CAST(promotions AS DECIMAL(15,4)) / CAST(total AS DECIMAL(15,4))) * 100)#15662], Statistics(sizeInBytes=426.0 B)
+- Join Inner, Statistics(sizeInBytes=256.0 B)
   :- Aggregate [MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS promotions#15519], Statistics(sizeInBytes=16.0 B, rowCount=1)
   :  +- Project [ss_ext_sales_price#429], Statistics(sizeInBytes=5.02E+35 B)
   :     +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=7.54E+35 B)
   :        :- Project [ss_item_sk#416, ss_ext_sales_price#429], Statistics(sizeInBytes=5.73E+30 B)
   :        :  +- Join Inner, (ca_address_sk#3717 = c_current_addr_sk#85), Statistics(sizeInBytes=8.03E+30 B)
   :        :     :- Project [ss_item_sk#416, ss_ext_sales_price#429, c_current_addr_sk#85], Statistics(sizeInBytes=6.22E+25 B)
   :        :     :  +- Join Inner, (ss_customer_sk#417 = c_customer_sk#81), Statistics(sizeInBytes=8.29E+25 B)
   :        :     :     :- Project [ss_item_sk#416, ss_customer_sk#417, ss_ext_sales_price#429], Statistics(sizeInBytes=114.3 EiB)
   :        :     :     :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=152.4 EiB)
   :        :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_customer_sk#417, ss_ext_sales_price#429], Statistics(sizeInBytes=1481.7 TiB)
   :        :     :     :     :  +- Join Inner, (ss_promo_sk#422 = p_promo_sk#3642), Statistics(sizeInBytes=1905.0 TiB)
   :        :     :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_customer_sk#417, ss_promo_sk#422, ss_ext_sales_price#429], Statistics(sizeInBytes=79.7 GiB)
   :        :     :     :     :     :  +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=99.7 GiB)
   :        :     :     :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_customer_sk#417, ss_store_sk#421, ss_promo_sk#422, ss_ext_sales_price#429], Statistics(sizeInBytes=34.3 MiB)
   :        :     :     :     :     :     :  +- Filter ((isnotnull(ss_store_sk#421) AND isnotnull(ss_promo_sk#422)) AND ((isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_customer_sk#417)) AND isnotnull(ss_item_sk#416))), Statistics(sizeInBytes=141.1 MiB)
   :        :     :     :     :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
   :        :     :     :     :     :     +- Project [s_store_sk#52], Statistics(sizeInBytes=2.9 KiB)
   :        :     :     :     :     :        +- Filter ((isnotnull(s_gmt_offset#79) AND (s_gmt_offset#79 = -5.00)) AND isnotnull(s_store_sk#52)), Statistics(sizeInBytes=101.7 KiB)
   :        :     :     :     :     :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
   :        :     :     :     :     +- Project [p_promo_sk#3642], Statistics(sizeInBytes=23.9 KiB)
   :        :     :     :     :        +- Filter ((((p_channel_dmail#3650 = Y) OR (p_channel_email#3651 = Y)) OR (p_channel_tv#3653 = Y)) AND isnotnull(p_promo_sk#3642)), Statistics(sizeInBytes=589.4 KiB)
   :        :     :     :     :           +- Relation default.promotion[p_promo_sk#3642,p_promo_id#3643,p_start_date_sk#3644,p_end_date_sk#3645,p_item_sk#3646,p_cost#3647,p_response_target#3648,p_promo_name#3649,p_channel_dmail#3650,p_channel_email#3651,p_channel_catalog#3652,p_channel_tv#3653,p_channel_radio#3654,p_channel_press#3655,p_channel_event#3656,p_channel_demo#3657,p_channel_details#3658,p_purpose#3659,p_discount_active#3660] parquet, Statistics(sizeInBytes=589.4 KiB)
   :        :     :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
   :        :     :     :        +- Filter (((isnotnull(d_year#30) AND isnotnull(d_moy#32)) AND ((d_year#30 = 1998) AND (d_moy#32 = 11))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
   :        :     :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
   :        :     :     +- Project [c_customer_sk#81, c_current_addr_sk#85], Statistics(sizeInBytes=614.2 KiB)
   :        :     :        +- Filter (isnotnull(c_customer_sk#81) AND isnotnull(c_current_addr_sk#85)), Statistics(sizeInBytes=7.8 MiB)
   :        :     :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
   :        :     +- Project [ca_address_sk#3717], Statistics(sizeInBytes=126.2 KiB)
   :        :        +- Filter ((isnotnull(ca_gmt_offset#3728) AND (ca_gmt_offset#3728 = -5.00)) AND isnotnull(ca_address_sk#3717)), Statistics(sizeInBytes=2.5 MiB)
   :        :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
   :        +- Project [i_item_sk#437], Statistics(sizeInBytes=128.3 KiB)
   :           +- Filter ((isnotnull(i_category#449) AND (i_category#449 = Jewelry                                           )) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
   :              +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
   +- Aggregate [MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#15536)),17,2) AS total#15520], Statistics(sizeInBytes=16.0 B, rowCount=1)
      +- Project [ss_ext_sales_price#15536], Statistics(sizeInBytes=2.28E+31 B)
         +- Join Inner, (ss_item_sk#15523 = i_item_sk#15632), Statistics(sizeInBytes=3.42E+31 B)
            :- Project [ss_item_sk#15523, ss_ext_sales_price#15536], Statistics(sizeInBytes=2.60E+26 B)
            :  +- Join Inner, (ca_address_sk#15619 = c_current_addr_sk#15605), Statistics(sizeInBytes=3.65E+26 B)
            :     :- Project [ss_item_sk#15523, ss_ext_sales_price#15536, c_current_addr_sk#15605], Statistics(sizeInBytes=2.82E+21 B)
            :     :  +- Join Inner, (ss_customer_sk#15524 = c_customer_sk#15601), Statistics(sizeInBytes=3.76E+21 B)
            :     :     :- Project [ss_item_sk#15523, ss_customer_sk#15524, ss_ext_sales_price#15536], Statistics(sizeInBytes=5.3 PiB)
            :     :     :  +- Join Inner, (ss_sold_date_sk#15521 = d_date_sk#15573), Statistics(sizeInBytes=7.1 PiB)
            :     :     :     :- Project [ss_sold_date_sk#15521, ss_item_sk#15523, ss_customer_sk#15524, ss_ext_sales_price#15536], Statistics(sizeInBytes=68.9 GiB)
            :     :     :     :  +- Join Inner, (ss_store_sk#15528 = s_store_sk#15544), Statistics(sizeInBytes=88.6 GiB)
            :     :     :     :     :- Project [ss_sold_date_sk#15521, ss_item_sk#15523, ss_customer_sk#15524, ss_store_sk#15528, ss_ext_sales_price#15536], Statistics(sizeInBytes=30.5 MiB)
            :     :     :     :     :  +- Filter (isnotnull(ss_store_sk#15528) AND ((isnotnull(ss_sold_date_sk#15521) AND isnotnull(ss_customer_sk#15524)) AND isnotnull(ss_item_sk#15523))), Statistics(sizeInBytes=141.1 MiB)
            :     :     :     :     :     +- Relation default.store_sales[ss_sold_date_sk#15521,ss_sold_time_sk#15522,ss_item_sk#15523,ss_customer_sk#15524,ss_cdemo_sk#15525,ss_hdemo_sk#15526,ss_addr_sk#15527,ss_store_sk#15528,ss_promo_sk#15529,ss_ticket_number#15530,ss_quantity#15531,ss_wholesale_cost#15532,ss_list_price#15533,ss_sales_price#15534,ss_ext_discount_amt#15535,ss_ext_sales_price#15536,ss_ext_wholesale_cost#15537,ss_ext_list_price#15538,ss_ext_tax#15539,ss_coupon_amt#15540,ss_net_paid#15541,ss_net_paid_inc_tax#15542,ss_net_profit#15543] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     :     :     :     +- Project [s_store_sk#15544], Statistics(sizeInBytes=2.9 KiB)
            :     :     :     :        +- Filter ((isnotnull(s_gmt_offset#15571) AND (s_gmt_offset#15571 = -5.00)) AND isnotnull(s_store_sk#15544)), Statistics(sizeInBytes=101.7 KiB)
            :     :     :     :           +- Relation default.store[s_store_sk#15544,s_store_id#15545,s_rec_start_date#15546,s_rec_end_date#15547,s_closed_date_sk#15548,s_store_name#15549,s_number_employees#15550,s_floor_space#15551,s_hours#15552,s_manager#15553,s_market_id#15554,s_geography_class#15555,s_market_desc#15556,s_market_manager#15557,s_division_id#15558,s_division_name#15559,s_company_id#15560,s_company_name#15561,s_street_number#15562,s_street_name#15563,s_street_type#15564,s_suite_number#15565,s_city#15566,s_county#15567,s_state#15568,s_zip#15569,s_country#15570,s_gmt_offset#15571,s_tax_percentage#15572] parquet, Statistics(sizeInBytes=101.7 KiB)
            :     :     :     +- Project [d_date_sk#15573], Statistics(sizeInBytes=105.3 KiB)
            :     :     :        +- Filter (((isnotnull(d_year#15579) AND isnotnull(d_moy#15581)) AND ((d_year#15579 = 1998) AND (d_moy#15581 = 11))) AND isnotnull(d_date_sk#15573)), Statistics(sizeInBytes=2.5 MiB)
            :     :     :           +- Relation default.date_dim[d_date_sk#15573,d_date_id#15574,d_date#15575,d_month_seq#15576,d_week_seq#15577,d_quarter_seq#15578,d_year#15579,d_dow#15580,d_moy#15581,d_dom#15582,d_qoy#15583,d_fy_year#15584,d_fy_quarter_seq#15585,d_fy_week_seq#15586,d_day_name#15587,d_quarter_name#15588,d_holiday#15589,d_weekend#15590,d_following_holiday#15591,d_first_dom#15592,d_last_dom#15593,d_same_day_ly#15594,d_same_day_lq#15595,d_current_day#15596,d_current_week#15597,d_current_month#15598,d_current_quarter#15599,d_current_year#15600] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :     +- Project [c_customer_sk#15601, c_current_addr_sk#15605], Statistics(sizeInBytes=614.2 KiB)
            :     :        +- Filter (isnotnull(c_customer_sk#15601) AND isnotnull(c_current_addr_sk#15605)), Statistics(sizeInBytes=7.8 MiB)
            :     :           +- Relation default.customer[c_customer_sk#15601,c_customer_id#15602,c_current_cdemo_sk#15603,c_current_hdemo_sk#15604,c_current_addr_sk#15605,c_first_shipto_date_sk#15606,c_first_sales_date_sk#15607,c_salutation#15608,c_first_name#15609,c_last_name#15610,c_preferred_cust_flag#15611,c_birth_day#15612,c_birth_month#15613,c_birth_year#15614,c_birth_country#15615,c_login#15616,c_email_address#15617,c_last_review_date#15618] parquet, Statistics(sizeInBytes=7.8 MiB)
            :     +- Project [ca_address_sk#15619], Statistics(sizeInBytes=126.2 KiB)
            :        +- Filter ((isnotnull(ca_gmt_offset#15630) AND (ca_gmt_offset#15630 = -5.00)) AND isnotnull(ca_address_sk#15619)), Statistics(sizeInBytes=2.5 MiB)
            :           +- Relation default.customer_address[ca_address_sk#15619,ca_address_id#15620,ca_street_number#15621,ca_street_name#15622,ca_street_type#15623,ca_suite_number#15624,ca_city#15625,ca_county#15626,ca_state#15627,ca_zip#15628,ca_country#15629,ca_gmt_offset#15630,ca_location_type#15631] parquet, Statistics(sizeInBytes=2.5 MiB)
            +- Project [i_item_sk#15632], Statistics(sizeInBytes=128.3 KiB)
               +- Filter ((isnotnull(i_category#15644) AND (i_category#15644 = Jewelry                                           )) AND isnotnull(i_item_sk#15632)), Statistics(sizeInBytes=3.1 MiB)
                  +- Relation default.item[i_item_sk#15632,i_item_id#15633,i_rec_start_date#15634,i_rec_end_date#15635,i_item_desc#15636,i_current_price#15637,i_wholesale_cost#15638,i_brand_id#15639,i_brand#15640,i_class_id#15641,i_class#15642,i_category_id#15643,i_category#15644,i_manufact_id#15645,i_manufact#15646,i_size#15647,i_formulation#15648,i_color#15649,i_units#15650,i_container#15651,i_manager_id#15652,i_product_name#15653] parquet, Statistics(sizeInBytes=3.1 MiB)


==== q62 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=10.5 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=5.55E+23 B)
   +- Sort [substr(w_warehouse_name, 1, 20)#15692 ASC NULLS FIRST, sm_type#15683 ASC NULLS FIRST, web_name#3355 ASC NULLS FIRST], true, Statistics(sizeInBytes=5.55E+23 B)
      +- Aggregate [_groupingexpression#15702, sm_type#15683, web_name#3355], [_groupingexpression#15702 AS substr(w_warehouse_name, 1, 20)#15692, sm_type#15683, web_name#3355, sum(CASE WHEN ((ws_ship_date_sk#165 - ws_sold_date_sk#163) <= 30) THEN 1 ELSE 0 END) AS 30 days #15676L, sum(CASE WHEN (((ws_ship_date_sk#165 - ws_sold_date_sk#163) > 30) AND ((ws_ship_date_sk#165 - ws_sold_date_sk#163) <= 60)) THEN 1 ELSE 0 END) AS 31 - 60 days #15677L, sum(CASE WHEN (((ws_ship_date_sk#165 - ws_sold_date_sk#163) > 60) AND ((ws_ship_date_sk#165 - ws_sold_date_sk#163) <= 90)) THEN 1 ELSE 0 END) AS 61 - 90 days #15678L, sum(CASE WHEN (((ws_ship_date_sk#165 - ws_sold_date_sk#163) > 90) AND ((ws_ship_date_sk#165 - ws_sold_date_sk#163) <= 120)) THEN 1 ELSE 0 END) AS 91 - 120 days #15679L, sum(CASE WHEN ((ws_ship_date_sk#165 - ws_sold_date_sk#163) > 120) THEN 1 ELSE 0 END) AS >120 days #15680L], Statistics(sizeInBytes=5.55E+23 B)
         +- Project [ws_sold_date_sk#163, ws_ship_date_sk#165, sm_type#15683, web_name#3355, substr(w_warehouse_name#8011, 1, 20) AS _groupingexpression#15702], Statistics(sizeInBytes=3.90E+23 B)
            +- Join Inner, (ws_ship_date_sk#165 = d_date_sk#24), Statistics(sizeInBytes=4.11E+23 B)
               :- Project [ws_sold_date_sk#163, ws_ship_date_sk#165, w_warehouse_name#8011, sm_type#15683, web_name#3355], Statistics(sizeInBytes=3.3 EiB)
               :  +- Join Inner, (ws_web_site_sk#176 = web_site_sk#3351), Statistics(sizeInBytes=3.7 EiB)
               :     :- Project [ws_sold_date_sk#163, ws_ship_date_sk#165, ws_web_site_sk#176, w_warehouse_name#8011, sm_type#15683], Statistics(sizeInBytes=184.0 TiB)
               :     :  +- Join Inner, (ws_ship_mode_sk#177 = sm_ship_mode_sk#15681), Statistics(sizeInBytes=208.5 TiB)
               :     :     :- Project [ws_sold_date_sk#163, ws_ship_date_sk#165, ws_web_site_sk#176, ws_ship_mode_sk#177, w_warehouse_name#8011], Statistics(sizeInBytes=16.5 GiB)
               :     :     :  +- Join Inner, (ws_warehouse_sk#178 = w_warehouse_sk#8009), Statistics(sizeInBytes=19.6 GiB)
               :     :     :     :- Project [ws_sold_date_sk#163, ws_ship_date_sk#165, ws_web_site_sk#176, ws_ship_mode_sk#177, ws_warehouse_sk#178], Statistics(sizeInBytes=7.1 MiB)
               :     :     :     :  +- Filter ((isnotnull(ws_warehouse_sk#178) AND isnotnull(ws_ship_mode_sk#177)) AND (isnotnull(ws_web_site_sk#176) AND isnotnull(ws_ship_date_sk#165))), Statistics(sizeInBytes=52.0 MiB)
               :     :     :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
               :     :     :     +- Project [w_warehouse_sk#8009, w_warehouse_name#8011], Statistics(sizeInBytes=2.7 KiB)
               :     :     :        +- Filter isnotnull(w_warehouse_sk#8009), Statistics(sizeInBytes=20.9 KiB)
               :     :     :           +- Relation default.warehouse[w_warehouse_sk#8009,w_warehouse_id#8010,w_warehouse_name#8011,w_warehouse_sq_ft#8012,w_street_number#8013,w_street_name#8014,w_street_type#8015,w_suite_number#8016,w_city#8017,w_county#8018,w_state#8019,w_zip#8020,w_country#8021,w_gmt_offset#8022] parquet, Statistics(sizeInBytes=20.9 KiB)
               :     :     +- Project [sm_ship_mode_sk#15681, sm_type#15683], Statistics(sizeInBytes=12.6 KiB)
               :     :        +- Filter isnotnull(sm_ship_mode_sk#15681), Statistics(sizeInBytes=44.1 KiB)
               :     :           +- Relation default.ship_mode[sm_ship_mode_sk#15681,sm_ship_mode_id#15682,sm_type#15683,sm_code#15684,sm_carrier#15685,sm_contract#15686] parquet, Statistics(sizeInBytes=44.1 KiB)
               :     +- Project [web_site_sk#3351, web_name#3355], Statistics(sizeInBytes=20.3 KiB)
               :        +- Filter isnotnull(web_site_sk#3351), Statistics(sizeInBytes=249.1 KiB)
               :           +- Relation default.web_site[web_site_sk#3351,web_site_id#3352,web_rec_start_date#3353,web_rec_end_date#3354,web_name#3355,web_open_date_sk#3356,web_close_date_sk#3357,web_class#3358,web_manager#3359,web_mkt_id#3360,web_mkt_class#3361,web_mkt_desc#3362,web_market_manager#3363,web_company_id#3364,web_company_name#3365,web_street_number#3366,web_street_name#3367,web_street_type#3368,web_suite_number#3369,web_city#3370,web_county#3371,web_state#3372,web_zip#3373,web_country#3374,web_gmt_offset#3375,web_tax_percentage#3376] parquet, Statistics(sizeInBytes=249.1 KiB)
               +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                  +- Filter ((isnotnull(d_month_seq#27) AND ((d_month_seq#27 >= 1200) AND (d_month_seq#27 <= 1211))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                     +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)

==== q63 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=3.5 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1237.8 EiB)
   +- Sort [i_manager_id#457 ASC NULLS FIRST, avg_monthly_sales#15729 ASC NULLS FIRST, sum_sales#15728 ASC NULLS FIRST], true, Statistics(sizeInBytes=1237.8 EiB)
      +- Project [i_manager_id#457, sum_sales#15728, avg_monthly_sales#15729], Statistics(sizeInBytes=1237.8 EiB)
         +- Filter CASE WHEN (avg_monthly_sales#15729 > 0.000000) THEN (CheckOverflow((promote_precision(abs(CheckOverflow((promote_precision(cast(sum_sales#15728 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#15729 as decimal(22,6)))), DecimalType(22,6)))) / promote_precision(cast(avg_monthly_sales#15729 as decimal(22,6)))), DecimalType(38,16)) > 0.1000000000000000) ELSE false END, Statistics(sizeInBytes=1512.9 EiB)
            +- Window [avg(_w0#15733) windowspecdefinition(i_manager_id#457, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#15729], [i_manager_id#457], Statistics(sizeInBytes=1512.9 EiB)
               +- Aggregate [i_manager_id#457, d_moy#32], [i_manager_id#457, MakeDecimal(sum(UnscaledValue(ss_sales_price#427)),17,2) AS sum_sales#15728, MakeDecimal(sum(UnscaledValue(ss_sales_price#427)),17,2) AS _w0#15733], Statistics(sizeInBytes=962.8 EiB)
                  +- Project [i_manager_id#457, ss_sales_price#427, d_moy#32], Statistics(sizeInBytes=825.2 EiB)
                     +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=1100.3 EiB)
                        :- Project [i_manager_id#457, ss_store_sk#421, ss_sales_price#427, d_moy#32], Statistics(sizeInBytes=378.9 PiB)
                        :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=487.1 PiB)
                        :     :- Project [i_manager_id#457, ss_sold_date_sk#414, ss_store_sk#421, ss_sales_price#427], Statistics(sizeInBytes=3.5 TiB)
                        :     :  +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=4.5 TiB)
                        :     :     :- Project [i_item_sk#437, i_manager_id#457], Statistics(sizeInBytes=171.1 KiB)
                        :     :     :  +- Filter ((((i_category#449 IN (Books                                             ,Children                                          ,Electronics                                       ) AND i_class#447 IN (personal                                          ,portable                                          ,refernece                                         ,self-help                                         )) AND i_brand#445 IN (scholaramalgamalg #14                             ,scholaramalgamalg #7                              ,exportiunivamalg #9                               ,scholaramalgamalg #9                              )) OR ((i_category#449 IN (Women                                             ,Music                                             ,Men                                               ) AND i_class#447 IN (accessories                                       ,classical                                         ,fragrances                                        ,pants                                             )) AND i_brand#445 IN (amalgimporto #1                                   ,edu packscholar #1                                ,exportiimporto #1                                 ,importoamalg #1                                   ))) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
                        :     :     :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
                        :     :     +- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_sales_price#427], Statistics(sizeInBytes=26.7 MiB)
                        :     :        +- Filter (isnotnull(ss_item_sk#416) AND (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421))), Statistics(sizeInBytes=141.1 MiB)
                        :     :           +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                        :     +- Project [d_date_sk#24, d_moy#32], Statistics(sizeInBytes=140.4 KiB)
                        :        +- Filter (d_month_seq#27 INSET 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211 AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                        :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                        +- Project [s_store_sk#52], Statistics(sizeInBytes=2.9 KiB)
                           +- Filter isnotnull(s_store_sk#52), Statistics(sizeInBytes=101.7 KiB)
                              +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)


==== q65 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=9.0 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=2.37E+34 B)
   +- Sort [s_store_name#57 ASC NULLS FIRST, i_item_desc#441 ASC NULLS FIRST], true, Statistics(sizeInBytes=2.37E+34 B)
      +- Project [s_store_name#57, i_item_desc#441, revenue#15746, i_current_price#442, i_wholesale_cost#443, i_brand#445], Statistics(sizeInBytes=2.37E+34 B)
         +- Join Inner, ((ss_store_sk#421 = ss_store_sk#15754) AND (cast(revenue#15746 as decimal(23,7)) <= CheckOverflow((0.100000 * promote_precision(ave#15745)), DecimalType(23,7)))), Statistics(sizeInBytes=2.99E+34 B)
            :- Project [s_store_name#57, ss_store_sk#15754, revenue#15746, i_item_desc#441, i_current_price#442, i_wholesale_cost#443, i_brand#445], Statistics(sizeInBytes=1.13E+22 B)
            :  +- Join Inner, (i_item_sk#437 = ss_item_sk#15749), Statistics(sizeInBytes=1.23E+22 B)
            :     :- Project [s_store_name#57, ss_store_sk#15754, ss_item_sk#15749, revenue#15746], Statistics(sizeInBytes=14.6 PiB)
            :     :  +- Join Inner, (s_store_sk#52 = ss_store_sk#15754), Statistics(sizeInBytes=15.9 PiB)
            :     :     :- Project [s_store_sk#52, s_store_name#57], Statistics(sizeInBytes=7.7 KiB)
            :     :     :  +- Filter isnotnull(s_store_sk#52), Statistics(sizeInBytes=101.7 KiB)
            :     :     :     +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
            :     :     +- Filter isnotnull(revenue#15746), Statistics(sizeInBytes=2.1 TiB)
            :     :        +- Aggregate [ss_store_sk#15754, ss_item_sk#15749], [ss_store_sk#15754, ss_item_sk#15749, MakeDecimal(sum(UnscaledValue(ss_sales_price#15760)),17,2) AS revenue#15746], Statistics(sizeInBytes=2.1 TiB)
            :     :           +- Project [ss_item_sk#15749, ss_store_sk#15754, ss_sales_price#15760], Statistics(sizeInBytes=2.1 TiB)
            :     :              +- Join Inner, (ss_sold_date_sk#15747 = d_date_sk#15770), Statistics(sizeInBytes=2.7 TiB)
            :     :                 :- Project [ss_sold_date_sk#15747, ss_item_sk#15749, ss_store_sk#15754, ss_sales_price#15760], Statistics(sizeInBytes=26.7 MiB)
            :     :                 :  +- Filter ((isnotnull(ss_sold_date_sk#15747) AND isnotnull(ss_store_sk#15754)) AND isnotnull(ss_item_sk#15749)), Statistics(sizeInBytes=141.1 MiB)
            :     :                 :     +- Relation default.store_sales[ss_sold_date_sk#15747,ss_sold_time_sk#15748,ss_item_sk#15749,ss_customer_sk#15750,ss_cdemo_sk#15751,ss_hdemo_sk#15752,ss_addr_sk#15753,ss_store_sk#15754,ss_promo_sk#15755,ss_ticket_number#15756,ss_quantity#15757,ss_wholesale_cost#15758,ss_list_price#15759,ss_sales_price#15760,ss_ext_discount_amt#15761,ss_ext_sales_price#15762,ss_ext_wholesale_cost#15763,ss_ext_list_price#15764,ss_ext_tax#15765,ss_coupon_amt#15766,ss_net_paid#15767,ss_net_paid_inc_tax#15768,ss_net_profit#15769] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     :                 +- Project [d_date_sk#15770], Statistics(sizeInBytes=105.3 KiB)
            :     :                    +- Filter ((isnotnull(d_month_seq#15773) AND ((d_month_seq#15773 >= 1176) AND (d_month_seq#15773 <= 1187))) AND isnotnull(d_date_sk#15770)), Statistics(sizeInBytes=2.5 MiB)
            :     :                       +- Relation default.date_dim[d_date_sk#15770,d_date_id#15771,d_date#15772,d_month_seq#15773,d_week_seq#15774,d_quarter_seq#15775,d_year#15776,d_dow#15777,d_moy#15778,d_dom#15779,d_qoy#15780,d_fy_year#15781,d_fy_quarter_seq#15782,d_fy_week_seq#15783,d_day_name#15784,d_quarter_name#15785,d_holiday#15786,d_weekend#15787,d_following_holiday#15788,d_first_dom#15789,d_last_dom#15790,d_same_day_ly#15791,d_same_day_lq#15792,d_current_day#15793,d_current_week#15794,d_current_month#15795,d_current_quarter#15796,d_current_year#15797] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     +- Project [i_item_sk#437, i_item_desc#441, i_current_price#442, i_wholesale_cost#443, i_brand#445], Statistics(sizeInBytes=727.3 KiB)
            :        +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
            :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
            +- Aggregate [ss_store_sk#421], [ss_store_sk#421, avg(revenue#15744) AS ave#15745], Statistics(sizeInBytes=2.4 TiB)
               +- Aggregate [ss_store_sk#421, ss_item_sk#416], [ss_store_sk#421, MakeDecimal(sum(UnscaledValue(ss_sales_price#427)),17,2) AS revenue#15744], Statistics(sizeInBytes=1756.6 GiB)
                  +- Project [ss_item_sk#416, ss_store_sk#421, ss_sales_price#427], Statistics(sizeInBytes=2.1 TiB)
                     +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2.7 TiB)
                        :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_sales_price#427], Statistics(sizeInBytes=26.7 MiB)
                        :  +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421)), Statistics(sizeInBytes=141.1 MiB)
                        :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                        +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                           +- Filter ((isnotnull(d_month_seq#27) AND ((d_month_seq#27 >= 1176) AND (d_month_seq#27 <= 1187))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q66 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=69.5 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.80E+26 B)
   +- Sort [w_warehouse_name#8011 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.80E+26 B)
      +- Aggregate [w_warehouse_name#8011, w_warehouse_sq_ft#8012, w_city#8017, w_county#8018, w_state#8019, w_country#8021, ship_carriers#15839, year#15840], [w_warehouse_name#8011, w_warehouse_sq_ft#8012, w_city#8017, w_county#8018, w_state#8019, w_country#8021, ship_carriers#15839, year#15840, sum(jan_sales#15841) AS jan_sales#15891, sum(feb_sales#15842) AS feb_sales#15892, sum(mar_sales#15843) AS mar_sales#15893, sum(apr_sales#15844) AS apr_sales#15894, sum(may_sales#15845) AS may_sales#15895, sum(jun_sales#15846) AS jun_sales#15896, sum(jul_sales#15847) AS jul_sales#15897, sum(aug_sales#15848) AS aug_sales#15898, sum(sep_sales#15849) AS sep_sales#15899, sum(oct_sales#15850) AS oct_sales#15900, sum(nov_sales#15851) AS nov_sales#15901, sum(dec_sales#15852) AS dec_sales#15902, sum(CheckOverflow((promote_precision(jan_sales#15841) / promote_precision(cast(w_warehouse_sq_ft#8012 as decimal(28,2)))), DecimalType(38,12))) AS jan_sales_per_sq_foot#15903, sum(CheckOverflow((promote_precision(feb_sales#15842) / promote_precision(cast(w_warehouse_sq_ft#8012 as decimal(28,2)))), DecimalType(38,12))) AS feb_sales_per_sq_foot#15904, sum(CheckOverflow((promote_precision(mar_sales#15843) / promote_precision(cast(w_warehouse_sq_ft#8012 as decimal(28,2)))), DecimalType(38,12))) AS mar_sales_per_sq_foot#15905, sum(CheckOverflow((promote_precision(apr_sales#15844) / promote_precision(cast(w_warehouse_sq_ft#8012 as decimal(28,2)))), DecimalType(38,12))) AS apr_sales_per_sq_foot#15906, sum(CheckOverflow((promote_precision(may_sales#15845) / promote_precision(cast(w_warehouse_sq_ft#8012 as decimal(28,2)))), DecimalType(38,12))) AS may_sales_per_sq_foot#15907, sum(CheckOverflow((promote_precision(jun_sales#15846) / promote_precision(cast(w_warehouse_sq_ft#8012 as decimal(28,2)))), DecimalType(38,12))) AS jun_sales_per_sq_foot#15908, sum(CheckOverflow((promote_precision(jul_sales#15847) / promote_precision(cast(w_warehouse_sq_ft#8012 as decimal(28,2)))), DecimalType(38,12))) AS jul_sales_per_sq_foot#15909, sum(CheckOverflow((promote_precision(aug_sales#15848) / promote_precision(cast(w_warehouse_sq_ft#8012 as decimal(28,2)))), DecimalType(38,12))) AS aug_sales_per_sq_foot#15910, sum(CheckOverflow((promote_precision(sep_sales#15849) / promote_precision(cast(w_warehouse_sq_ft#8012 as decimal(28,2)))), DecimalType(38,12))) AS sep_sales_per_sq_foot#15911, sum(CheckOverflow((promote_precision(oct_sales#15850) / promote_precision(cast(w_warehouse_sq_ft#8012 as decimal(28,2)))), DecimalType(38,12))) AS oct_sales_per_sq_foot#15912, sum(CheckOverflow((promote_precision(nov_sales#15851) / promote_precision(cast(w_warehouse_sq_ft#8012 as decimal(28,2)))), DecimalType(38,12))) AS nov_sales_per_sq_foot#15913, sum(CheckOverflow((promote_precision(dec_sales#15852) / promote_precision(cast(w_warehouse_sq_ft#8012 as decimal(28,2)))), DecimalType(38,12))) AS dec_sales_per_sq_foot#15914, sum(jan_net#15853) AS jan_net#15915, sum(feb_net#15854) AS feb_net#15916, sum(mar_net#15855) AS mar_net#15917, sum(apr_net#15856) AS apr_net#15918, sum(may_net#15857) AS may_net#15919, sum(jun_net#15858) AS jun_net#15920, sum(jul_net#15859) AS jul_net#15921, sum(aug_net#15860) AS aug_net#15922, sum(sep_net#15861) AS sep_net#15923, sum(oct_net#15862) AS oct_net#15924, sum(nov_net#15863) AS nov_net#15925, sum(dec_net#15864) AS dec_net#15926], Statistics(sizeInBytes=1.80E+26 B)
         +- Union false, false, Statistics(sizeInBytes=1.32E+26 B)
            :- Aggregate [w_warehouse_name#8011, w_warehouse_sq_ft#8012, w_city#8017, w_county#8018, w_state#8019, w_country#8021, d_year#30], [w_warehouse_name#8011, w_warehouse_sq_ft#8012, w_city#8017, w_county#8018, w_state#8019, w_country#8021, DHL,BARIAN AS ship_carriers#15839, d_year#30 AS year#15840, sum(CASE WHEN (d_moy#32 = 1) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#186 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jan_sales#15841, sum(CASE WHEN (d_moy#32 = 2) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#186 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS feb_sales#15842, sum(CASE WHEN (d_moy#32 = 3) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#186 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS mar_sales#15843, sum(CASE WHEN (d_moy#32 = 4) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#186 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS apr_sales#15844, sum(CASE WHEN (d_moy#32 = 5) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#186 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS may_sales#15845, sum(CASE WHEN (d_moy#32 = 6) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#186 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jun_sales#15846, sum(CASE WHEN (d_moy#32 = 7) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#186 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jul_sales#15847, sum(CASE WHEN (d_moy#32 = 8) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#186 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS aug_sales#15848, sum(CASE WHEN (d_moy#32 = 9) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#186 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS sep_sales#15849, sum(CASE WHEN (d_moy#32 = 10) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#186 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS oct_sales#15850, sum(CASE WHEN (d_moy#32 = 11) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#186 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS nov_sales#15851, sum(CASE WHEN (d_moy#32 = 12) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#186 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS dec_sales#15852, sum(CASE WHEN (d_moy#32 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid#192 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jan_net#15853, sum(CASE WHEN (d_moy#32 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid#192 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS feb_net#15854, sum(CASE WHEN (d_moy#32 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid#192 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS mar_net#15855, sum(CASE WHEN (d_moy#32 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid#192 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS apr_net#15856, sum(CASE WHEN (d_moy#32 = 5) THEN CheckOverflow((promote_precision(cast(ws_net_paid#192 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS may_net#15857, sum(CASE WHEN (d_moy#32 = 6) THEN CheckOverflow((promote_precision(cast(ws_net_paid#192 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jun_net#15858, sum(CASE WHEN (d_moy#32 = 7) THEN CheckOverflow((promote_precision(cast(ws_net_paid#192 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jul_net#15859, sum(CASE WHEN (d_moy#32 = 8) THEN CheckOverflow((promote_precision(cast(ws_net_paid#192 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS aug_net#15860, sum(CASE WHEN (d_moy#32 = 9) THEN CheckOverflow((promote_precision(cast(ws_net_paid#192 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS sep_net#15861, sum(CASE WHEN (d_moy#32 = 10) THEN CheckOverflow((promote_precision(cast(ws_net_paid#192 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS oct_net#15862, sum(CASE WHEN (d_moy#32 = 11) THEN CheckOverflow((promote_precision(cast(ws_net_paid#192 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS nov_net#15863, sum(CASE WHEN (d_moy#32 = 12) THEN CheckOverflow((promote_precision(cast(ws_net_paid#192 as decimal(12,2))) * promote_precision(cast(ws_quantity#181 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS dec_net#15864], Statistics(sizeInBytes=4.34E+25 B)
            :  +- Project [ws_quantity#181, ws_ext_sales_price#186, ws_net_paid#192, w_warehouse_name#8011, w_warehouse_sq_ft#8012, w_city#8017, w_county#8018, w_state#8019, w_country#8021, d_year#30, d_moy#32], Statistics(sizeInBytes=1.17E+25 B)
            :     +- Join Inner, (ws_ship_mode_sk#177 = sm_ship_mode_sk#15681), Statistics(sizeInBytes=1.23E+25 B)
            :        :- Project [ws_ship_mode_sk#177, ws_quantity#181, ws_ext_sales_price#186, ws_net_paid#192, w_warehouse_name#8011, w_warehouse_sq_ft#8012, w_city#8017, w_county#8018, w_state#8019, w_country#8021, d_year#30, d_moy#32], Statistics(sizeInBytes=2.55E+21 B)
            :        :  +- Join Inner, (ws_sold_time_sk#164 = t_time_sk#15927), Statistics(sizeInBytes=2.69E+21 B)
            :        :     :- Project [ws_sold_time_sk#164, ws_ship_mode_sk#177, ws_quantity#181, ws_ext_sales_price#186, ws_net_paid#192, w_warehouse_name#8011, w_warehouse_sq_ft#8012, w_city#8017, w_county#8018, w_state#8019, w_country#8021, d_year#30, d_moy#32], Statistics(sizeInBytes=17.2 PiB)
            :        :     :  +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#24), Statistics(sizeInBytes=18.1 PiB)
            :        :     :     :- Project [ws_sold_date_sk#163, ws_sold_time_sk#164, ws_ship_mode_sk#177, ws_quantity#181, ws_ext_sales_price#186, ws_net_paid#192, w_warehouse_name#8011, w_warehouse_sq_ft#8012, w_city#8017, w_county#8018, w_state#8019, w_country#8021], Statistics(sizeInBytes=105.5 GiB)
            :        :     :     :  +- Join Inner, (ws_warehouse_sk#178 = w_warehouse_sk#8009), Statistics(sizeInBytes=111.4 GiB)
            :        :     :     :     :- Project [ws_sold_date_sk#163, ws_sold_time_sk#164, ws_ship_mode_sk#177, ws_warehouse_sk#178, ws_quantity#181, ws_ext_sales_price#186, ws_net_paid#192], Statistics(sizeInBytes=11.2 MiB)
            :        :     :     :     :  +- Filter ((isnotnull(ws_warehouse_sk#178) AND isnotnull(ws_sold_date_sk#163)) AND (isnotnull(ws_sold_time_sk#164) AND isnotnull(ws_ship_mode_sk#177))), Statistics(sizeInBytes=52.0 MiB)
            :        :     :     :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
            :        :     :     :     +- Project [w_warehouse_sk#8009, w_warehouse_name#8011, w_warehouse_sq_ft#8012, w_city#8017, w_county#8018, w_state#8019, w_country#8021], Statistics(sizeInBytes=9.9 KiB)
            :        :     :     :        +- Filter isnotnull(w_warehouse_sk#8009), Statistics(sizeInBytes=20.9 KiB)
            :        :     :     :           +- Relation default.warehouse[w_warehouse_sk#8009,w_warehouse_id#8010,w_warehouse_name#8011,w_warehouse_sq_ft#8012,w_street_number#8013,w_street_name#8014,w_street_type#8015,w_suite_number#8016,w_city#8017,w_county#8018,w_state#8019,w_zip#8020,w_country#8021,w_gmt_offset#8022] parquet, Statistics(sizeInBytes=20.9 KiB)
            :        :     :     +- Project [d_date_sk#24, d_year#30, d_moy#32], Statistics(sizeInBytes=175.5 KiB)
            :        :     :        +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2001)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :        :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :        :     +- Project [t_time_sk#15927], Statistics(sizeInBytes=136.2 KiB)
            :        :        +- Filter ((isnotnull(t_time#15929) AND ((t_time#15929 >= 30838) AND (t_time#15929 <= 59638))) AND isnotnull(t_time_sk#15927)), Statistics(sizeInBytes=1452.6 KiB)
            :        :           +- Relation default.time_dim[t_time_sk#15927,t_time_id#15928,t_time#15929,t_hour#15930,t_minute#15931,t_second#15932,t_am_pm#15933,t_shift#15934,t_sub_shift#15935,t_meal_time#15936] parquet, Statistics(sizeInBytes=1452.6 KiB)
            :        +- Project [sm_ship_mode_sk#15681], Statistics(sizeInBytes=4.7 KiB)
            :           +- Filter (sm_carrier#15685 IN (DHL                 ,BARIAN              ) AND isnotnull(sm_ship_mode_sk#15681)), Statistics(sizeInBytes=44.1 KiB)
            :              +- Relation default.ship_mode[sm_ship_mode_sk#15681,sm_ship_mode_id#15682,sm_type#15683,sm_code#15684,sm_carrier#15685,sm_contract#15686] parquet, Statistics(sizeInBytes=44.1 KiB)
            +- Aggregate [w_warehouse_name#15939, w_warehouse_sq_ft#15940, w_city#15945, w_county#15946, w_state#15947, w_country#15949, d_year#15957], [w_warehouse_name#15939, w_warehouse_sq_ft#15940, w_city#15945, w_county#15946, w_state#15947, w_country#15949, DHL,BARIAN AS ship_carriers#15865, d_year#15957 AS year#15866, sum(CASE WHEN (d_moy#15959 = 1) THEN CheckOverflow((promote_precision(cast(cs_sales_price#218 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jan_sales#15867, sum(CASE WHEN (d_moy#15959 = 2) THEN CheckOverflow((promote_precision(cast(cs_sales_price#218 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS feb_sales#15868, sum(CASE WHEN (d_moy#15959 = 3) THEN CheckOverflow((promote_precision(cast(cs_sales_price#218 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS mar_sales#15869, sum(CASE WHEN (d_moy#15959 = 4) THEN CheckOverflow((promote_precision(cast(cs_sales_price#218 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS apr_sales#15870, sum(CASE WHEN (d_moy#15959 = 5) THEN CheckOverflow((promote_precision(cast(cs_sales_price#218 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS may_sales#15871, sum(CASE WHEN (d_moy#15959 = 6) THEN CheckOverflow((promote_precision(cast(cs_sales_price#218 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jun_sales#15872, sum(CASE WHEN (d_moy#15959 = 7) THEN CheckOverflow((promote_precision(cast(cs_sales_price#218 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jul_sales#15873, sum(CASE WHEN (d_moy#15959 = 8) THEN CheckOverflow((promote_precision(cast(cs_sales_price#218 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS aug_sales#15874, sum(CASE WHEN (d_moy#15959 = 9) THEN CheckOverflow((promote_precision(cast(cs_sales_price#218 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS sep_sales#15875, sum(CASE WHEN (d_moy#15959 = 10) THEN CheckOverflow((promote_precision(cast(cs_sales_price#218 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS oct_sales#15876, sum(CASE WHEN (d_moy#15959 = 11) THEN CheckOverflow((promote_precision(cast(cs_sales_price#218 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS nov_sales#15877, sum(CASE WHEN (d_moy#15959 = 12) THEN CheckOverflow((promote_precision(cast(cs_sales_price#218 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS dec_sales#15878, sum(CASE WHEN (d_moy#15959 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#227 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jan_net#15879, sum(CASE WHEN (d_moy#15959 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#227 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS feb_net#15880, sum(CASE WHEN (d_moy#15959 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#227 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS mar_net#15881, sum(CASE WHEN (d_moy#15959 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#227 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS apr_net#15882, sum(CASE WHEN (d_moy#15959 = 5) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#227 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS may_net#15883, sum(CASE WHEN (d_moy#15959 = 6) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#227 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jun_net#15884, sum(CASE WHEN (d_moy#15959 = 7) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#227 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS jul_net#15885, sum(CASE WHEN (d_moy#15959 = 8) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#227 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS aug_net#15886, sum(CASE WHEN (d_moy#15959 = 9) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#227 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS sep_net#15887, sum(CASE WHEN (d_moy#15959 = 10) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#227 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS oct_net#15888, sum(CASE WHEN (d_moy#15959 = 11) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#227 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS nov_net#15889, sum(CASE WHEN (d_moy#15959 = 12) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#227 as decimal(12,2))) * promote_precision(cast(cs_quantity#215 as decimal(12,2)))), DecimalType(18,2)) ELSE 0.00 END) AS dec_net#15890], Statistics(sizeInBytes=8.83E+25 B)
               +- Project [cs_quantity#215, cs_sales_price#218, cs_net_paid_inc_tax#227, w_warehouse_name#15939, w_warehouse_sq_ft#15940, w_city#15945, w_county#15946, w_state#15947, w_country#15949, d_year#15957, d_moy#15959], Statistics(sizeInBytes=2.38E+25 B)
                  +- Join Inner, (cs_ship_mode_sk#210 = sm_ship_mode_sk#15989), Statistics(sizeInBytes=2.51E+25 B)
                     :- Project [cs_ship_mode_sk#210, cs_quantity#215, cs_sales_price#218, cs_net_paid_inc_tax#227, w_warehouse_name#15939, w_warehouse_sq_ft#15940, w_city#15945, w_county#15946, w_state#15947, w_country#15949, d_year#15957, d_moy#15959], Statistics(sizeInBytes=5.20E+21 B)
                     :  +- Join Inner, (cs_sold_time_sk#198 = t_time_sk#15979), Statistics(sizeInBytes=5.48E+21 B)
                     :     :- Project [cs_sold_time_sk#198, cs_ship_mode_sk#210, cs_quantity#215, cs_sales_price#218, cs_net_paid_inc_tax#227, w_warehouse_name#15939, w_warehouse_sq_ft#15940, w_city#15945, w_county#15946, w_state#15947, w_country#15949, d_year#15957, d_moy#15959], Statistics(sizeInBytes=34.9 PiB)
                     :     :  +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#15951), Statistics(sizeInBytes=36.8 PiB)
                     :     :     :- Project [cs_sold_date_sk#197, cs_sold_time_sk#198, cs_ship_mode_sk#210, cs_quantity#215, cs_sales_price#218, cs_net_paid_inc_tax#227, w_warehouse_name#15939, w_warehouse_sq_ft#15940, w_city#15945, w_county#15946, w_state#15947, w_country#15949], Statistics(sizeInBytes=214.8 GiB)
                     :     :     :  +- Join Inner, (cs_warehouse_sk#211 = w_warehouse_sk#15937), Statistics(sizeInBytes=226.7 GiB)
                     :     :     :     :- Project [cs_sold_date_sk#197, cs_sold_time_sk#198, cs_ship_mode_sk#210, cs_warehouse_sk#211, cs_quantity#215, cs_sales_price#218, cs_net_paid_inc_tax#227], Statistics(sizeInBytes=22.8 MiB)
                     :     :     :     :  +- Filter ((isnotnull(cs_warehouse_sk#211) AND isnotnull(cs_sold_date_sk#197)) AND (isnotnull(cs_sold_time_sk#198) AND isnotnull(cs_ship_mode_sk#210))), Statistics(sizeInBytes=105.8 MiB)
                     :     :     :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
                     :     :     :     +- Project [w_warehouse_sk#15937, w_warehouse_name#15939, w_warehouse_sq_ft#15940, w_city#15945, w_county#15946, w_state#15947, w_country#15949], Statistics(sizeInBytes=9.9 KiB)
                     :     :     :        +- Filter isnotnull(w_warehouse_sk#15937), Statistics(sizeInBytes=20.9 KiB)
                     :     :     :           +- Relation default.warehouse[w_warehouse_sk#15937,w_warehouse_id#15938,w_warehouse_name#15939,w_warehouse_sq_ft#15940,w_street_number#15941,w_street_name#15942,w_street_type#15943,w_suite_number#15944,w_city#15945,w_county#15946,w_state#15947,w_zip#15948,w_country#15949,w_gmt_offset#15950] parquet, Statistics(sizeInBytes=20.9 KiB)
                     :     :     +- Project [d_date_sk#15951, d_year#15957, d_moy#15959], Statistics(sizeInBytes=175.5 KiB)
                     :     :        +- Filter ((isnotnull(d_year#15957) AND (d_year#15957 = 2001)) AND isnotnull(d_date_sk#15951)), Statistics(sizeInBytes=2.5 MiB)
                     :     :           +- Relation default.date_dim[d_date_sk#15951,d_date_id#15952,d_date#15953,d_month_seq#15954,d_week_seq#15955,d_quarter_seq#15956,d_year#15957,d_dow#15958,d_moy#15959,d_dom#15960,d_qoy#15961,d_fy_year#15962,d_fy_quarter_seq#15963,d_fy_week_seq#15964,d_day_name#15965,d_quarter_name#15966,d_holiday#15967,d_weekend#15968,d_following_holiday#15969,d_first_dom#15970,d_last_dom#15971,d_same_day_ly#15972,d_same_day_lq#15973,d_current_day#15974,d_current_week#15975,d_current_month#15976,d_current_quarter#15977,d_current_year#15978] parquet, Statistics(sizeInBytes=2.5 MiB)
                     :     +- Project [t_time_sk#15979], Statistics(sizeInBytes=136.2 KiB)
                     :        +- Filter ((isnotnull(t_time#15981) AND ((t_time#15981 >= 30838) AND (t_time#15981 <= 59638))) AND isnotnull(t_time_sk#15979)), Statistics(sizeInBytes=1452.6 KiB)
                     :           +- Relation default.time_dim[t_time_sk#15979,t_time_id#15980,t_time#15981,t_hour#15982,t_minute#15983,t_second#15984,t_am_pm#15985,t_shift#15986,t_sub_shift#15987,t_meal_time#15988] parquet, Statistics(sizeInBytes=1452.6 KiB)
                     +- Project [sm_ship_mode_sk#15989], Statistics(sizeInBytes=4.7 KiB)
                        +- Filter (sm_carrier#15993 IN (DHL                 ,BARIAN              ) AND isnotnull(sm_ship_mode_sk#15989)), Statistics(sizeInBytes=44.1 KiB)
                           +- Relation default.ship_mode[sm_ship_mode_sk#15989,sm_ship_mode_id#15990,sm_type#15991,sm_code#15992,sm_carrier#15993,sm_contract#15994] parquet, Statistics(sizeInBytes=44.1 KiB)


==== q67 ==== 
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=13.7 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=3.62E+23 B)
   +- Sort [i_category#17246 ASC NULLS FIRST, i_class#17247 ASC NULLS FIRST, i_brand#17248 ASC NULLS FIRST, i_product_name#17249 ASC NULLS FIRST, d_year#17250 ASC NULLS FIRST, d_qoy#17251 ASC NULLS FIRST, d_moy#17252 ASC NULLS FIRST, s_store_id#17253 ASC NULLS FIRST, sumsales#17232 ASC NULLS FIRST, rk#17233 ASC NULLS FIRST], true, Statistics(sizeInBytes=3.62E+23 B)
      +- Filter (rk#17233 <= 100), Statistics(sizeInBytes=3.62E+23 B)
         +- Window [rank(sumsales#17232) windowspecdefinition(i_category#17246, sumsales#17232 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#17233], [i_category#17246], [sumsales#17232 DESC NULLS LAST], Statistics(sizeInBytes=3.62E+23 B)
            +- Aggregate [i_category#17246, i_class#17247, i_brand#17248, i_product_name#17249, d_year#17250, d_qoy#17251, d_moy#17252, s_store_id#17253, spark_grouping_id#17245L], [i_category#17246, i_class#17247, i_brand#17248, i_product_name#17249, d_year#17250, d_qoy#17251, d_moy#17252, s_store_id#17253, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#427 as decimal(12,2))) * promote_precision(cast(ss_quantity#424 as decimal(12,2)))), DecimalType(18,2)), 0.00)) AS sumsales#17232], Statistics(sizeInBytes=3.51E+23 B)
               +- Expand [[ss_quantity#424, ss_sales_price#427, i_category#449, i_class#447, i_brand#445, i_product_name#458, d_year#30, d_qoy#34, d_moy#32, s_store_id#53, 0], [ss_quantity#424, ss_sales_price#427, i_category#449, i_class#447, i_brand#445, i_product_name#458, d_year#30, d_qoy#34, d_moy#32, null, 1], [ss_quantity#424, ss_sales_price#427, i_category#449, i_class#447, i_brand#445, i_product_name#458, d_year#30, d_qoy#34, null, null, 3], [ss_quantity#424, ss_sales_price#427, i_category#449, i_class#447, i_brand#445, i_product_name#458, d_year#30, null, null, null, 7], [ss_quantity#424, ss_sales_price#427, i_category#449, i_class#447, i_brand#445, i_product_name#458, null, null, null, null, 15], [ss_quantity#424, ss_sales_price#427, i_category#449, i_class#447, i_brand#445, null, null, null, null, null, 31], [ss_quantity#424, ss_sales_price#427, i_category#449, i_class#447, null, null, null, null, null, null, 63], [ss_quantity#424, ss_sales_price#427, i_category#449, null, null, null, null, null, null, null, 127], [ss_quantity#424, ss_sales_price#427, null, null, null, null, null, null, null, null, 255]], [ss_quantity#424, ss_sales_price#427, i_category#17246, i_class#17247, i_brand#17248, i_product_name#17249, d_year#17250, d_qoy#17251, d_moy#17252, s_store_id#17253, spark_grouping_id#17245L], Statistics(sizeInBytes=3.62E+23 B)
                  +- Project [ss_quantity#424, ss_sales_price#427, i_category#449, i_class#447, i_brand#445, i_product_name#458, d_year#30, d_qoy#34, d_moy#32, s_store_id#53], Statistics(sizeInBytes=3.79E+22 B)
                     +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=4.02E+22 B)
                        :- Project [ss_item_sk#416, ss_quantity#424, ss_sales_price#427, d_year#30, d_moy#32, d_qoy#34, s_store_id#53], Statistics(sizeInBytes=35.4 PiB)
                        :  +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=40.5 PiB)
                        :     :- Project [ss_item_sk#416, ss_store_sk#421, ss_quantity#424, ss_sales_price#427, d_year#30, d_moy#32, d_qoy#34], Statistics(sizeInBytes=5.2 TiB)
                        :     :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=6.3 TiB)
                        :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_quantity#424, ss_sales_price#427], Statistics(sizeInBytes=30.5 MiB)
                        :     :     :  +- Filter (isnotnull(ss_sold_date_sk#414) AND (isnotnull(ss_store_sk#421) AND isnotnull(ss_item_sk#416))), Statistics(sizeInBytes=141.1 MiB)
                        :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                        :     :     +- Project [d_date_sk#24, d_year#30, d_moy#32, d_qoy#34], Statistics(sizeInBytes=210.6 KiB)
                        :     :        +- Filter ((isnotnull(d_month_seq#27) AND ((d_month_seq#27 >= 1200) AND (d_month_seq#27 <= 1211))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                        :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                        :     +- Project [s_store_sk#52, s_store_id#53], Statistics(sizeInBytes=7.7 KiB)
                        :        +- Filter isnotnull(s_store_sk#52), Statistics(sizeInBytes=101.7 KiB)
                        :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
                        +- Project [i_item_sk#437, i_brand#445, i_class#447, i_category#449, i_product_name#458], Statistics(sizeInBytes=984.0 KiB)
                           +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
                              +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)

==== q68 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=11.3 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.34E+38 B)
   +- Sort [c_last_name#90 ASC NULLS FIRST, ss_ticket_number#423 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.34E+38 B)
      +- Project [c_last_name#90, c_first_name#89, ca_city#17294, bought_city#17284, ss_ticket_number#423, extended_price#17285, extended_tax#17287, list_price#17286], Statistics(sizeInBytes=1.34E+38 B)
         +- Join Inner, ((c_current_addr_sk#85 = ca_address_sk#17288) AND NOT (ca_city#17294 = bought_city#17284)), Statistics(sizeInBytes=1.43E+38 B)
            :- Project [ss_ticket_number#423, bought_city#17284, extended_price#17285, list_price#17286, extended_tax#17287, c_current_addr_sk#85, c_first_name#89, c_last_name#90], Statistics(sizeInBytes=4.15E+32 B)
            :  +- Join Inner, (ss_customer_sk#417 = c_customer_sk#81), Statistics(sizeInBytes=4.49E+32 B)
            :     :- Aggregate [ss_ticket_number#423, ss_customer_sk#417, ss_addr_sk#420, ca_city#3723], [ss_ticket_number#423, ss_customer_sk#417, ca_city#3723 AS bought_city#17284, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS extended_price#17285, MakeDecimal(sum(UnscaledValue(ss_ext_list_price#431)),17,2) AS list_price#17286, MakeDecimal(sum(UnscaledValue(ss_ext_tax#432)),17,2) AS extended_tax#17287], Statistics(sizeInBytes=2.04E+26 B)
            :     :  +- Project [ss_customer_sk#417, ss_addr_sk#420, ss_ticket_number#423, ss_ext_sales_price#429, ss_ext_list_price#431, ss_ext_tax#432, ca_city#3723], Statistics(sizeInBytes=2.17E+26 B)
            :     :     +- Join Inner, (ss_addr_sk#420 = ca_address_sk#3717), Statistics(sizeInBytes=2.31E+26 B)
            :     :        :- Project [ss_customer_sk#417, ss_addr_sk#420, ss_ticket_number#423, ss_ext_sales_price#429, ss_ext_list_price#431, ss_ext_tax#432], Statistics(sizeInBytes=581.5 EiB)
            :     :        :  +- Join Inner, (ss_hdemo_sk#419 = hd_demo_sk#5551), Statistics(sizeInBytes=687.2 EiB)
            :     :        :     :- Project [ss_customer_sk#417, ss_hdemo_sk#419, ss_addr_sk#420, ss_ticket_number#423, ss_ext_sales_price#429, ss_ext_list_price#431, ss_ext_tax#432], Statistics(sizeInBytes=11.8 PiB)
            :     :        :     :  +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=13.8 PiB)
            :     :        :     :     :- Project [ss_customer_sk#417, ss_hdemo_sk#419, ss_addr_sk#420, ss_store_sk#421, ss_ticket_number#423, ss_ext_sales_price#429, ss_ext_list_price#431, ss_ext_tax#432], Statistics(sizeInBytes=4.8 TiB)
            :     :        :     :     :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=5.5 TiB)
            :     :        :     :     :     :- Project [ss_sold_date_sk#414, ss_customer_sk#417, ss_hdemo_sk#419, ss_addr_sk#420, ss_store_sk#421, ss_ticket_number#423, ss_ext_sales_price#429, ss_ext_list_price#431, ss_ext_tax#432], Statistics(sizeInBytes=53.4 MiB)
            :     :        :     :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421)) AND ((isnotnull(ss_hdemo_sk#419) AND isnotnull(ss_addr_sk#420)) AND isnotnull(ss_customer_sk#417))), Statistics(sizeInBytes=141.1 MiB)
            :     :        :     :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     :        :     :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
            :     :        :     :     :        +- Filter ((isnotnull(d_dom#33) AND (((d_dom#33 >= 1) AND (d_dom#33 <= 2)) AND d_year#30 IN (1999,2000,2001))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :     :        :     :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :        :     :     +- Project [s_store_sk#52], Statistics(sizeInBytes=2.9 KiB)
            :     :        :     :        +- Filter (s_city#74 IN (Midway,Fairview) AND isnotnull(s_store_sk#52)), Statistics(sizeInBytes=101.7 KiB)
            :     :        :     :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
            :     :        :     +- Project [hd_demo_sk#5551], Statistics(sizeInBytes=58.0 KiB)
            :     :        :        +- Filter (((hd_dep_count#5554 = 4) OR (hd_vehicle_count#5555 = 3)) AND isnotnull(hd_demo_sk#5551)), Statistics(sizeInBytes=212.8 KiB)
            :     :        :           +- Relation default.household_demographics[hd_demo_sk#5551,hd_income_band_sk#5552,hd_buy_potential#5553,hd_dep_count#5554,hd_vehicle_count#5555] parquet, Statistics(sizeInBytes=212.8 KiB)
            :     :        +- Project [ca_address_sk#3717, ca_city#3723], Statistics(sizeInBytes=336.4 KiB)
            :     :           +- Filter (isnotnull(ca_address_sk#3717) AND isnotnull(ca_city#3723)), Statistics(sizeInBytes=2.5 MiB)
            :     :              +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     +- Project [c_customer_sk#81, c_current_addr_sk#85, c_first_name#89, c_last_name#90], Statistics(sizeInBytes=2.1 MiB)
            :        +- Filter (isnotnull(c_customer_sk#81) AND isnotnull(c_current_addr_sk#85)), Statistics(sizeInBytes=7.8 MiB)
            :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
            +- Project [ca_address_sk#17288, ca_city#17294], Statistics(sizeInBytes=336.4 KiB)
               +- Filter (isnotnull(ca_address_sk#17288) AND isnotnull(ca_city#17294)), Statistics(sizeInBytes=2.5 MiB)
                  +- Relation default.customer_address[ca_address_sk#17288,ca_address_id#17289,ca_street_number#17290,ca_street_name#17291,ca_street_type#17292,ca_suite_number#17293,ca_city#17294,ca_county#17295,ca_state#17296,ca_zip#17297,ca_country#17298,ca_gmt_offset#17299,ca_location_type#17300] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q70 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=6.0 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=60.5 PiB)
   +- Sort [lochierarchy#17329 DESC NULLS LAST, CASE WHEN (lochierarchy#17329 = 0) THEN s_state#17438 END ASC NULLS FIRST, rank_within_parent#17330 ASC NULLS FIRST], true, Statistics(sizeInBytes=60.5 PiB)
      +- Project [total_sum#17328, s_state#17438, s_county#17439, lochierarchy#17329, rank_within_parent#17330], Statistics(sizeInBytes=60.5 PiB)
         +- Window [rank(_w3#17454) windowspecdefinition(_w1#17452, _w2#17453, _w3#17454 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#17330], [_w1#17452, _w2#17453], [_w3#17454 DESC NULLS LAST], Statistics(sizeInBytes=89.2 PiB)
            +- Aggregate [s_state#17438, s_county#17439, spark_grouping_id#17437L], [MakeDecimal(sum(UnscaledValue(ss_net_profit#436)),17,2) AS total_sum#17328, s_state#17438, s_county#17439, (cast((shiftright(spark_grouping_id#17437L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#17437L, 0) & 1) as tinyint)) AS lochierarchy#17329, (cast((shiftright(spark_grouping_id#17437L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#17437L, 0) & 1) as tinyint)) AS _w1#17452, CASE WHEN (cast((shiftright(spark_grouping_id#17437L, 0) & 1) as tinyint) = 0) THEN s_state#17438 END AS _w2#17453, MakeDecimal(sum(UnscaledValue(ss_net_profit#436)),17,2) AS _w3#17454], Statistics(sizeInBytes=85.3 PiB)
               +- Expand [[ss_net_profit#436, s_state#76, s_county#75, 0], [ss_net_profit#436, s_state#76, null, 1], [ss_net_profit#436, null, null, 3]], [ss_net_profit#436, s_state#17438, s_county#17439, spark_grouping_id#17437L], Statistics(sizeInBytes=63.4 PiB)
                  +- Project [ss_net_profit#436, s_state#76, s_county#75], Statistics(sizeInBytes=18.5 PiB)
                     +- Join Inner, (s_store_sk#52 = ss_store_sk#421), Statistics(sizeInBytes=21.1 PiB)
                        :- Project [ss_store_sk#421, ss_net_profit#436], Statistics(sizeInBytes=1720.7 GiB)
                        :  +- Join Inner, (d_date_sk#24 = ss_sold_date_sk#414), Statistics(sizeInBytes=2.4 TiB)
                        :     :- Project [ss_sold_date_sk#414, ss_store_sk#421, ss_net_profit#436], Statistics(sizeInBytes=22.9 MiB)
                        :     :  +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421)), Statistics(sizeInBytes=141.1 MiB)
                        :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                        :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                        :        +- Filter ((isnotnull(d_month_seq#27) AND ((d_month_seq#27 >= 1200) AND (d_month_seq#27 <= 1211))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                        :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                        +- Join LeftSemi, (s_state#76 = s_state#17400), Statistics(sizeInBytes=12.6 KiB)
                           :- Project [s_store_sk#52, s_county#75, s_state#76], Statistics(sizeInBytes=12.6 KiB)
                           :  +- Filter isnotnull(s_store_sk#52), Statistics(sizeInBytes=101.7 KiB)
                           :     +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
                           +- Project [s_state#17400], Statistics(sizeInBytes=9.7 PiB)
                              +- Filter (ranking#17332 <= 5), Statistics(sizeInBytes=20.7 PiB)
                                 +- Window [rank(_w2#17346) windowspecdefinition(s_state#17400, _w2#17346 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#17332], [s_state#17400], [_w2#17346 DESC NULLS LAST], Statistics(sizeInBytes=20.7 PiB)
                                    +- Aggregate [s_state#17400], [s_state#17400, s_state#17400, MakeDecimal(sum(UnscaledValue(ss_net_profit#17375)),17,2) AS _w2#17346], Statistics(sizeInBytes=19.3 PiB)
                                       +- Project [ss_net_profit#17375, s_state#17400], Statistics(sizeInBytes=12.4 PiB)
                                          +- Join Inner, (d_date_sk#17405 = ss_sold_date_sk#17353), Statistics(sizeInBytes=15.2 PiB)
                                             :- Project [ss_sold_date_sk#17353, ss_net_profit#17375, s_state#17400], Statistics(sizeInBytes=147.6 GiB)
                                             :  +- Join Inner, (s_store_sk#17376 = ss_store_sk#17360), Statistics(sizeInBytes=177.2 GiB)
                                             :     :- Project [ss_sold_date_sk#17353, ss_store_sk#17360, ss_net_profit#17375], Statistics(sizeInBytes=22.9 MiB)
                                             :     :  +- Filter (isnotnull(ss_store_sk#17360) AND isnotnull(ss_sold_date_sk#17353)), Statistics(sizeInBytes=141.1 MiB)
                                             :     :     +- Relation default.store_sales[ss_sold_date_sk#17353,ss_sold_time_sk#17354,ss_item_sk#17355,ss_customer_sk#17356,ss_cdemo_sk#17357,ss_hdemo_sk#17358,ss_addr_sk#17359,ss_store_sk#17360,ss_promo_sk#17361,ss_ticket_number#17362,ss_quantity#17363,ss_wholesale_cost#17364,ss_list_price#17365,ss_sales_price#17366,ss_ext_discount_amt#17367,ss_ext_sales_price#17368,ss_ext_wholesale_cost#17369,ss_ext_list_price#17370,ss_ext_tax#17371,ss_coupon_amt#17372,ss_net_paid#17373,ss_net_paid_inc_tax#17374,ss_net_profit#17375] parquet, Statistics(sizeInBytes=141.1 MiB)
                                             :     +- Project [s_store_sk#17376, s_state#17400], Statistics(sizeInBytes=7.7 KiB)
                                             :        +- Filter isnotnull(s_store_sk#17376), Statistics(sizeInBytes=101.7 KiB)
                                             :           +- Relation default.store[s_store_sk#17376,s_store_id#17377,s_rec_start_date#17378,s_rec_end_date#17379,s_closed_date_sk#17380,s_store_name#17381,s_number_employees#17382,s_floor_space#17383,s_hours#17384,s_manager#17385,s_market_id#17386,s_geography_class#17387,s_market_desc#17388,s_market_manager#17389,s_division_id#17390,s_division_name#17391,s_company_id#17392,s_company_name#17393,s_street_number#17394,s_street_name#17395,s_street_type#17396,s_suite_number#17397,s_city#17398,s_county#17399,s_state#17400,s_zip#17401,s_country#17402,s_gmt_offset#17403,s_tax_percentage#17404] parquet, Statistics(sizeInBytes=101.7 KiB)
                                             +- Project [d_date_sk#17405], Statistics(sizeInBytes=105.3 KiB)
                                                +- Filter ((isnotnull(d_month_seq#17408) AND ((d_month_seq#17408 >= 1200) AND (d_month_seq#17408 <= 1211))) AND isnotnull(d_date_sk#17405)), Statistics(sizeInBytes=2.5 MiB)
                                                   +- Relation default.date_dim[d_date_sk#17405,d_date_id#17406,d_date#17407,d_month_seq#17408,d_week_seq#17409,d_quarter_seq#17410,d_year#17411,d_dow#17412,d_moy#17413,d_dom#17414,d_qoy#17415,d_fy_year#17416,d_fy_quarter_seq#17417,d_fy_week_seq#17418,d_day_name#17419,d_quarter_name#17420,d_holiday#17421,d_weekend#17422,d_following_holiday#17423,d_first_dom#17424,d_last_dom#17425,d_same_day_ly#17426,d_same_day_lq#17427,d_current_day#17428,d_current_week#17429,d_current_month#17430,d_current_quarter#17431,d_current_year#17432] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q71 ====
== Optimized Logical Plan ==
Sort [ext_price#17526 DESC NULLS LAST, brand_id#17524 ASC NULLS FIRST], true, Statistics(sizeInBytes=2.73E+23 B)
+- Aggregate [i_brand#445, i_brand_id#444, t_hour#15930, t_minute#15931], [i_brand_id#444 AS brand_id#17524, i_brand#445 AS brand#17525, t_hour#15930, t_minute#15931, MakeDecimal(sum(UnscaledValue(ext_price#17512)),17,2) AS ext_price#17526], Statistics(sizeInBytes=2.73E+23 B)
   +- Project [i_brand_id#444, i_brand#445, ext_price#17512, t_hour#15930, t_minute#15931], Statistics(sizeInBytes=2.73E+23 B)
      +- Join Inner, (time_sk#17515 = t_time_sk#15927), Statistics(sizeInBytes=3.18E+23 B)
         :- Project [i_brand_id#444, i_brand#445, ext_price#17512, time_sk#17515], Statistics(sizeInBytes=1215.0 PiB)
         :  +- Join Inner, (sold_item_sk#17514 = i_item_sk#437), Statistics(sizeInBytes=1435.9 PiB)
         :     :- Project [i_item_sk#437, i_brand_id#444, i_brand#445], Statistics(sizeInBytes=385.0 KiB)
         :     :  +- Filter ((isnotnull(i_manager_id#457) AND (i_manager_id#457 = 1)) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
         :     :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
         :     +- Union false, false, Statistics(sizeInBytes=3.7 TiB)
         :        :- Project [ws_ext_sales_price#186 AS ext_price#17512, ws_item_sk#166 AS sold_item_sk#17514, ws_sold_time_sk#164 AS time_sk#17515], Statistics(sizeInBytes=563.5 GiB)
         :        :  +- Join Inner, (d_date_sk#24 = ws_sold_date_sk#163), Statistics(sizeInBytes=751.3 GiB)
         :        :     :- Project [ws_sold_date_sk#163, ws_sold_time_sk#164, ws_item_sk#166, ws_ext_sales_price#186], Statistics(sizeInBytes=7.1 MiB)
         :        :     :  +- Filter (isnotnull(ws_sold_date_sk#163) AND (isnotnull(ws_item_sk#166) AND isnotnull(ws_sold_time_sk#164))), Statistics(sizeInBytes=52.0 MiB)
         :        :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
         :        :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
         :        :        +- Filter (((isnotnull(d_moy#32) AND isnotnull(d_year#30)) AND ((d_moy#32 = 11) AND (d_year#30 = 1999))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
         :        :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
         :        :- Project [cs_ext_sales_price#220 AS ext_price#17516, cs_item_sk#212 AS sold_item_sk#17518, cs_sold_time_sk#198 AS time_sk#17519], Statistics(sizeInBytes=1147.1 GiB)
         :        :  +- Join Inner, (d_date_sk#17527 = cs_sold_date_sk#197), Statistics(sizeInBytes=1529.5 GiB)
         :        :     :- Project [cs_sold_date_sk#197, cs_sold_time_sk#198, cs_item_sk#212, cs_ext_sales_price#220], Statistics(sizeInBytes=14.5 MiB)
         :        :     :  +- Filter (isnotnull(cs_sold_date_sk#197) AND (isnotnull(cs_item_sk#212) AND isnotnull(cs_sold_time_sk#198))), Statistics(sizeInBytes=105.8 MiB)
         :        :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
         :        :     +- Project [d_date_sk#17527], Statistics(sizeInBytes=105.3 KiB)
         :        :        +- Filter (((isnotnull(d_moy#17535) AND isnotnull(d_year#17533)) AND ((d_moy#17535 = 11) AND (d_year#17533 = 1999))) AND isnotnull(d_date_sk#17527)), Statistics(sizeInBytes=2.5 MiB)
         :        :           +- Relation default.date_dim[d_date_sk#17527,d_date_id#17528,d_date#17529,d_month_seq#17530,d_week_seq#17531,d_quarter_seq#17532,d_year#17533,d_dow#17534,d_moy#17535,d_dom#17536,d_qoy#17537,d_fy_year#17538,d_fy_quarter_seq#17539,d_fy_week_seq#17540,d_day_name#17541,d_quarter_name#17542,d_holiday#17543,d_weekend#17544,d_following_holiday#17545,d_first_dom#17546,d_last_dom#17547,d_same_day_ly#17548,d_same_day_lq#17549,d_current_day#17550,d_current_week#17551,d_current_month#17552,d_current_quarter#17553,d_current_year#17554] parquet, Statistics(sizeInBytes=2.5 MiB)
         :        +- Project [ss_ext_sales_price#429 AS ext_price#17520, ss_item_sk#416 AS sold_item_sk#17522, ss_sold_time_sk#415 AS time_sk#17523], Statistics(sizeInBytes=2.1 TiB)
         :           +- Join Inner, (d_date_sk#17555 = ss_sold_date_sk#414), Statistics(sizeInBytes=2.7 TiB)
         :              :- Project [ss_sold_date_sk#414, ss_sold_time_sk#415, ss_item_sk#416, ss_ext_sales_price#429], Statistics(sizeInBytes=26.7 MiB)
         :              :  +- Filter (isnotnull(ss_sold_date_sk#414) AND (isnotnull(ss_item_sk#416) AND isnotnull(ss_sold_time_sk#415))), Statistics(sizeInBytes=141.1 MiB)
         :              :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
         :              +- Project [d_date_sk#17555], Statistics(sizeInBytes=105.3 KiB)
         :                 +- Filter (((isnotnull(d_moy#17563) AND isnotnull(d_year#17561)) AND ((d_moy#17563 = 11) AND (d_year#17561 = 1999))) AND isnotnull(d_date_sk#17555)), Statistics(sizeInBytes=2.5 MiB)
         :                    +- Relation default.date_dim[d_date_sk#17555,d_date_id#17556,d_date#17557,d_month_seq#17558,d_week_seq#17559,d_quarter_seq#17560,d_year#17561,d_dow#17562,d_moy#17563,d_dom#17564,d_qoy#17565,d_fy_year#17566,d_fy_quarter_seq#17567,d_fy_week_seq#17568,d_day_name#17569,d_quarter_name#17570,d_holiday#17571,d_weekend#17572,d_following_holiday#17573,d_first_dom#17574,d_last_dom#17575,d_same_day_ly#17576,d_same_day_lq#17577,d_current_day#17578,d_current_week#17579,d_current_month#17580,d_current_quarter#17581,d_current_year#17582] parquet, Statistics(sizeInBytes=2.5 MiB)
         +- Project [t_time_sk#15927, t_hour#15930, t_minute#15931], Statistics(sizeInBytes=227.0 KiB)
            +- Filter (((t_meal_time#15936 = breakfast           ) OR (t_meal_time#15936 = dinner              )) AND isnotnull(t_time_sk#15927)), Statistics(sizeInBytes=1452.6 KiB)
               +- Relation default.time_dim[t_time_sk#15927,t_time_id#15928,t_time#15929,t_hour#15930,t_minute#15931,t_second#15932,t_am_pm#15933,t_shift#15934,t_sub_shift#15935,t_meal_time#15936] parquet, Statistics(sizeInBytes=1452.6 KiB)

==== q72 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=7.4 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.90E+60 B)
   +- Sort [total_cnt#17600L DESC NULLS LAST, i_item_desc#441 ASC NULLS FIRST, w_warehouse_name#8011 ASC NULLS FIRST, d_week_seq#28 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.90E+60 B)
      +- Aggregate [i_item_desc#441, w_warehouse_name#8011, d_week_seq#28], [i_item_desc#441, w_warehouse_name#8011, d_week_seq#28, count(1) AS no_promo#17598L, count(1) AS promo#17599L, count(1) AS total_cnt#17600L], Statistics(sizeInBytes=1.90E+60 B)
         +- Project [w_warehouse_name#8011, i_item_desc#441, d_week_seq#28], Statistics(sizeInBytes=1.30E+60 B)
            +- Join LeftOuter, ((cr_item_sk#3293 = cs_item_sk#212) AND (cr_order_number#3307 = cs_order_number#214)), Statistics(sizeInBytes=1.70E+60 B)
               :- Project [cs_item_sk#212, cs_order_number#214, w_warehouse_name#8011, i_item_desc#441, d_week_seq#28], Statistics(sizeInBytes=1.22E+54 B)
               :  +- Join LeftOuter, (cs_promo_sk#213 = p_promo_sk#3642), Statistics(sizeInBytes=1.39E+54 B)
               :     :- Project [cs_item_sk#212, cs_promo_sk#213, cs_order_number#214, w_warehouse_name#8011, i_item_desc#441, d_week_seq#28], Statistics(sizeInBytes=5.67E+49 B)
               :     :  +- Join Inner, ((d_date#17632 > date_add(d_date#26, 5)) AND (cs_ship_date_sk#199 = d_date_sk#17630)), Statistics(sizeInBytes=7.09E+49 B)
               :     :     :- Project [cs_ship_date_sk#199, cs_item_sk#212, cs_promo_sk#213, cs_order_number#214, w_warehouse_name#8011, i_item_desc#441, d_date#26, d_week_seq#28], Statistics(sizeInBytes=4.93E+44 B)
               :     :     :  +- Join Inner, ((d_week_seq#28 = d_week_seq#17606) AND (inv_date_sk#8005 = d_date_sk#17602)), Statistics(sizeInBytes=5.76E+44 B)
               :     :     :     :- Project [cs_ship_date_sk#199, cs_item_sk#212, cs_promo_sk#213, cs_order_number#214, inv_date_sk#8005, w_warehouse_name#8011, i_item_desc#441, d_date#26, d_week_seq#28], Statistics(sizeInBytes=4.00E+39 B)
               :     :     :     :  +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#24), Statistics(sizeInBytes=4.42E+39 B)
               :     :     :     :     :- Project [cs_sold_date_sk#197, cs_ship_date_sk#199, cs_item_sk#212, cs_promo_sk#213, cs_order_number#214, inv_date_sk#8005, w_warehouse_name#8011, i_item_desc#441], Statistics(sizeInBytes=2.46E+34 B)
               :     :     :     :     :  +- Join Inner, (cs_bill_hdemo_sk#202 = hd_demo_sk#5551), Statistics(sizeInBytes=2.74E+34 B)
               :     :     :     :     :     :- Project [cs_sold_date_sk#197, cs_ship_date_sk#199, cs_bill_hdemo_sk#202, cs_item_sk#212, cs_promo_sk#213, cs_order_number#214, inv_date_sk#8005, w_warehouse_name#8011, i_item_desc#441], Statistics(sizeInBytes=4.60E+29 B)
               :     :     :     :     :     :  +- Join Inner, (cs_bill_cdemo_sk#201 = cd_demo_sk#3633), Statistics(sizeInBytes=5.09E+29 B)
               :     :     :     :     :     :     :- Project [cs_sold_date_sk#197, cs_ship_date_sk#199, cs_bill_cdemo_sk#201, cs_bill_hdemo_sk#202, cs_item_sk#212, cs_promo_sk#213, cs_order_number#214, inv_date_sk#8005, w_warehouse_name#8011, i_item_desc#441], Statistics(sizeInBytes=5.66E+23 B)
               :     :     :     :     :     :     :  +- Join Inner, (i_item_sk#437 = cs_item_sk#212), Statistics(sizeInBytes=5.94E+23 B)
               :     :     :     :     :     :     :     :- Project [cs_sold_date_sk#197, cs_ship_date_sk#199, cs_bill_cdemo_sk#201, cs_bill_hdemo_sk#202, cs_item_sk#212, cs_promo_sk#213, cs_order_number#214, inv_date_sk#8005, w_warehouse_name#8011], Statistics(sizeInBytes=1504.8 PiB)
               :     :     :     :     :     :     :     :  +- Join Inner, (w_warehouse_sk#8009 = inv_warehouse_sk#8007), Statistics(sizeInBytes=1705.4 PiB)
               :     :     :     :     :     :     :     :     :- Project [cs_sold_date_sk#197, cs_ship_date_sk#199, cs_bill_cdemo_sk#201, cs_bill_hdemo_sk#202, cs_item_sk#212, cs_promo_sk#213, cs_order_number#214, inv_date_sk#8005, inv_warehouse_sk#8007], Statistics(sizeInBytes=622.4 TiB)
               :     :     :     :     :     :     :     :     :  +- Join Inner, ((inv_quantity_on_hand#8008 < cs_quantity#215) AND (cs_item_sk#212 = inv_item_sk#8006)), Statistics(sizeInBytes=792.1 TiB)
               :     :     :     :     :     :     :     :     :     :- Project [cs_sold_date_sk#197, cs_ship_date_sk#199, cs_bill_cdemo_sk#201, cs_bill_hdemo_sk#202, cs_item_sk#212, cs_promo_sk#213, cs_order_number#214, cs_quantity#215], Statistics(sizeInBytes=20.7 MiB)
               :     :     :     :     :     :     :     :     :     :  +- Filter (((isnotnull(cs_quantity#215) AND isnotnull(cs_item_sk#212)) AND isnotnull(cs_bill_cdemo_sk#201)) AND ((isnotnull(cs_bill_hdemo_sk#202) AND isnotnull(cs_sold_date_sk#197)) AND isnotnull(cs_ship_date_sk#199))), Statistics(sizeInBytes=105.8 MiB)
               :     :     :     :     :     :     :     :     :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
               :     :     :     :     :     :     :     :     :     +- Filter (((isnotnull(inv_quantity_on_hand#8008) AND isnotnull(inv_item_sk#8006)) AND isnotnull(inv_warehouse_sk#8007)) AND isnotnull(inv_date_sk#8005)), Statistics(sizeInBytes=38.2 MiB)
               :     :     :     :     :     :     :     :     :        +- Relation default.inventory[inv_date_sk#8005,inv_item_sk#8006,inv_warehouse_sk#8007,inv_quantity_on_hand#8008] parquet, Statistics(sizeInBytes=38.2 MiB)
               :     :     :     :     :     :     :     :     +- Project [w_warehouse_sk#8009, w_warehouse_name#8011], Statistics(sizeInBytes=2.7 KiB)
               :     :     :     :     :     :     :     :        +- Filter isnotnull(w_warehouse_sk#8009), Statistics(sizeInBytes=20.9 KiB)
               :     :     :     :     :     :     :     :           +- Relation default.warehouse[w_warehouse_sk#8009,w_warehouse_id#8010,w_warehouse_name#8011,w_warehouse_sq_ft#8012,w_street_number#8013,w_street_name#8014,w_street_type#8015,w_suite_number#8016,w_city#8017,w_county#8018,w_state#8019,w_zip#8020,w_country#8021,w_gmt_offset#8022] parquet, Statistics(sizeInBytes=20.9 KiB)
               :     :     :     :     :     :     :     +- Project [i_item_sk#437, i_item_desc#441], Statistics(sizeInBytes=342.3 KiB)
               :     :     :     :     :     :     :        +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
               :     :     :     :     :     :     :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
               :     :     :     :     :     :     +- Project [cd_demo_sk#3633], Statistics(sizeInBytes=878.6 KiB)
               :     :     :     :     :     :        +- Filter ((isnotnull(cd_marital_status#3635) AND (cd_marital_status#3635 = D)) AND isnotnull(cd_demo_sk#3633)), Statistics(sizeInBytes=7.7 MiB)
               :     :     :     :     :     :           +- Relation default.customer_demographics[cd_demo_sk#3633,cd_gender#3634,cd_marital_status#3635,cd_education_status#3636,cd_purchase_estimate#3637,cd_credit_rating#3638,cd_dep_count#3639,cd_dep_employed_count#3640,cd_dep_college_count#3641] parquet, Statistics(sizeInBytes=7.7 MiB)
               :     :     :     :     :     +- Project [hd_demo_sk#5551], Statistics(sizeInBytes=58.0 KiB)
               :     :     :     :     :        +- Filter ((isnotnull(hd_buy_potential#5553) AND (hd_buy_potential#5553 = >10000         )) AND isnotnull(hd_demo_sk#5551)), Statistics(sizeInBytes=212.8 KiB)
               :     :     :     :     :           +- Relation default.household_demographics[hd_demo_sk#5551,hd_income_band_sk#5552,hd_buy_potential#5553,hd_dep_count#5554,hd_vehicle_count#5555] parquet, Statistics(sizeInBytes=212.8 KiB)
               :     :     :     :     +- Project [d_date_sk#24, d_date#26, d_week_seq#28], Statistics(sizeInBytes=175.5 KiB)
               :     :     :     :        +- Filter (((isnotnull(d_year#30) AND (d_year#30 = 1999)) AND isnotnull(d_date_sk#24)) AND (isnotnull(d_week_seq#28) AND isnotnull(d_date#26))), Statistics(sizeInBytes=2.5 MiB)
               :     :     :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     :     :     +- Project [d_date_sk#17602, d_week_seq#17606], Statistics(sizeInBytes=140.4 KiB)
               :     :     :        +- Filter (isnotnull(d_week_seq#17606) AND isnotnull(d_date_sk#17602)), Statistics(sizeInBytes=2.5 MiB)
               :     :     :           +- Relation default.date_dim[d_date_sk#17602,d_date_id#17603,d_date#17604,d_month_seq#17605,d_week_seq#17606,d_quarter_seq#17607,d_year#17608,d_dow#17609,d_moy#17610,d_dom#17611,d_qoy#17612,d_fy_year#17613,d_fy_quarter_seq#17614,d_fy_week_seq#17615,d_day_name#17616,d_quarter_name#17617,d_holiday#17618,d_weekend#17619,d_following_holiday#17620,d_first_dom#17621,d_last_dom#17622,d_same_day_ly#17623,d_same_day_lq#17624,d_current_day#17625,d_current_week#17626,d_current_month#17627,d_current_quarter#17628,d_current_year#17629] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     :     +- Project [d_date_sk#17630, d_date#17632], Statistics(sizeInBytes=140.4 KiB)
               :     :        +- Filter (isnotnull(d_date#17632) AND isnotnull(d_date_sk#17630)), Statistics(sizeInBytes=2.5 MiB)
               :     :           +- Relation default.date_dim[d_date_sk#17630,d_date_id#17631,d_date#17632,d_month_seq#17633,d_week_seq#17634,d_quarter_seq#17635,d_year#17636,d_dow#17637,d_moy#17638,d_dom#17639,d_qoy#17640,d_fy_year#17641,d_fy_quarter_seq#17642,d_fy_week_seq#17643,d_day_name#17644,d_quarter_name#17645,d_holiday#17646,d_weekend#17647,d_following_holiday#17648,d_first_dom#17649,d_last_dom#17650,d_same_day_ly#17651,d_same_day_lq#17652,d_current_day#17653,d_current_week#17654,d_current_month#17655,d_current_quarter#17656,d_current_year#17657] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     +- Project [p_promo_sk#3642], Statistics(sizeInBytes=23.9 KiB)
               :        +- Filter isnotnull(p_promo_sk#3642), Statistics(sizeInBytes=589.4 KiB)
               :           +- Relation default.promotion[p_promo_sk#3642,p_promo_id#3643,p_start_date_sk#3644,p_end_date_sk#3645,p_item_sk#3646,p_cost#3647,p_response_target#3648,p_promo_name#3649,p_channel_dmail#3650,p_channel_email#3651,p_channel_catalog#3652,p_channel_tv#3653,p_channel_radio#3654,p_channel_press#3655,p_channel_event#3656,p_channel_demo#3657,p_channel_details#3658,p_purpose#3659,p_discount_active#3660] parquet, Statistics(sizeInBytes=589.4 KiB)
               +- Project [cr_item_sk#3293, cr_order_number#3307], Statistics(sizeInBytes=1354.5 KiB)
                  +- Filter (isnotnull(cr_item_sk#3293) AND isnotnull(cr_order_number#3307)), Statistics(sizeInBytes=12.6 MiB)
                     +- Relation default.catalog_returns[cr_returned_date_sk#3291,cr_returned_time_sk#3292,cr_item_sk#3293,cr_refunded_customer_sk#3294,cr_refunded_cdemo_sk#3295,cr_refunded_hdemo_sk#3296,cr_refunded_addr_sk#3297,cr_returning_customer_sk#3298,cr_returning_cdemo_sk#3299,cr_returning_hdemo_sk#3300,cr_returning_addr_sk#3301,cr_call_center_sk#3302,cr_catalog_page_sk#3303,cr_ship_mode_sk#3304,cr_warehouse_sk#3305,cr_reason_sk#3306,cr_order_number#3307,cr_return_quantity#3308,cr_return_amount#3309,cr_return_tax#3310,cr_return_amt_inc_tax#3311,cr_fee#3312,cr_return_ship_cost#3313,cr_refunded_cash#3314,cr_reversed_charge#3315,cr_store_credit#3316,cr_net_loss#3317] parquet, Statistics(sizeInBytes=12.6 MiB)


==== q73 ====
== Optimized Logical Plan ==
Sort [cnt#17670L DESC NULLS LAST], true, Statistics(sizeInBytes=9.57E+26 B)
+- Project [c_last_name#90, c_first_name#89, c_salutation#88, c_preferred_cust_flag#91, ss_ticket_number#423, cnt#17670L], Statistics(sizeInBytes=9.57E+26 B)
   +- Join Inner, (ss_customer_sk#417 = c_customer_sk#81), Statistics(sizeInBytes=1.03E+27 B)
      :- Filter ((cnt#17670L >= 1) AND (cnt#17670L <= 5)), Statistics(sizeInBytes=247.8 EiB)
      :  +- Aggregate [ss_ticket_number#423, ss_customer_sk#417], [ss_ticket_number#423, ss_customer_sk#417, count(1) AS cnt#17670L], Statistics(sizeInBytes=247.8 EiB)
      :     +- Project [ss_customer_sk#417, ss_ticket_number#423], Statistics(sizeInBytes=165.2 EiB)
      :        +- Join Inner, (ss_hdemo_sk#419 = hd_demo_sk#5551), Statistics(sizeInBytes=247.8 EiB)
      :           :- Project [ss_customer_sk#417, ss_hdemo_sk#419, ss_ticket_number#423], Statistics(sizeInBytes=4.3 PiB)
      :           :  +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=6.0 PiB)
      :           :     :- Project [ss_customer_sk#417, ss_hdemo_sk#419, ss_store_sk#421, ss_ticket_number#423], Statistics(sizeInBytes=2.1 TiB)
      :           :     :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2.7 TiB)
      :           :     :     :- Project [ss_sold_date_sk#414, ss_customer_sk#417, ss_hdemo_sk#419, ss_store_sk#421, ss_ticket_number#423], Statistics(sizeInBytes=26.7 MiB)
      :           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#414) AND ((isnotnull(ss_store_sk#421) AND isnotnull(ss_hdemo_sk#419)) AND isnotnull(ss_customer_sk#417))), Statistics(sizeInBytes=141.1 MiB)
      :           :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
      :           :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
      :           :     :        +- Filter ((isnotnull(d_dom#33) AND (((d_dom#33 >= 1) AND (d_dom#33 <= 2)) AND d_year#30 IN (1999,2000,2001))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
      :           :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
      :           :     +- Project [s_store_sk#52], Statistics(sizeInBytes=2.9 KiB)
      :           :        +- Filter (s_county#75 IN (Williamson County,Franklin Parish,Bronx County,Orange County) AND isnotnull(s_store_sk#52)), Statistics(sizeInBytes=101.7 KiB)
      :           :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
      :           +- Project [hd_demo_sk#5551], Statistics(sizeInBytes=58.0 KiB)
      :              +- Filter ((isnotnull(hd_vehicle_count#5555) AND ((((hd_buy_potential#5553 = >10000         ) OR (hd_buy_potential#5553 = unknown        )) AND (hd_vehicle_count#5555 > 0)) AND CASE WHEN (hd_vehicle_count#5555 > 0) THEN ((cast(hd_dep_count#5554 as double) / cast(hd_vehicle_count#5555 as double)) > 1.0) END)) AND isnotnull(hd_demo_sk#5551)), Statistics(sizeInBytes=212.8 KiB)
      :                 +- Relation default.household_demographics[hd_demo_sk#5551,hd_income_band_sk#5552,hd_buy_potential#5553,hd_dep_count#5554,hd_vehicle_count#5555] parquet, Statistics(sizeInBytes=212.8 KiB)
      +- Project [c_customer_sk#81, c_salutation#88, c_first_name#89, c_last_name#90, c_preferred_cust_flag#91], Statistics(sizeInBytes=3.4 MiB)
         +- Filter isnotnull(c_customer_sk#81), Statistics(sizeInBytes=7.8 MiB)
            +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)

==== q76 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=7.4 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=3.2 EiB)
   +- Sort [channel#17680 ASC NULLS FIRST, col_name#17681 ASC NULLS FIRST, d_year#30 ASC NULLS FIRST, d_qoy#34 ASC NULLS FIRST, i_category#449 ASC NULLS FIRST], true, Statistics(sizeInBytes=3.2 EiB)
      +- Aggregate [channel#17680, col_name#17681, d_year#30, d_qoy#34, i_category#449], [channel#17680, col_name#17681, d_year#30, d_qoy#34, i_category#449, count(1) AS sales_cnt#17689L, MakeDecimal(sum(UnscaledValue(ext_sales_price#17682)),17,2) AS sales_amt#17690], Statistics(sizeInBytes=3.2 EiB)
         +- Union false, false, Statistics(sizeInBytes=2.8 EiB)
            :- Project [store AS channel#17680, ss_store_sk#421 AS col_name#17681, d_year#30, d_qoy#34, i_category#449, ss_ext_sales_price#429 AS ext_sales_price#17682], Statistics(sizeInBytes=1608.7 PiB)
            :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=1324.8 PiB)
            :     :- Project [ss_sold_date_sk#414, ss_store_sk#421, ss_ext_sales_price#429, i_category#449], Statistics(sizeInBytes=7.5 TiB)
            :     :  +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=8.9 TiB)
            :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_ext_sales_price#429], Statistics(sizeInBytes=26.7 MiB)
            :     :     :  +- Filter (isnull(ss_store_sk#421) AND (isnotnull(ss_item_sk#416) AND isnotnull(ss_sold_date_sk#414))), Statistics(sizeInBytes=141.1 MiB)
            :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
            :     :     +- Project [i_item_sk#437, i_category#449], Statistics(sizeInBytes=342.3 KiB)
            :     :        +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
            :     :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
            :     +- Project [d_date_sk#24, d_year#30, d_qoy#34], Statistics(sizeInBytes=175.5 KiB)
            :        +- Filter isnotnull(d_date_sk#24), Statistics(sizeInBytes=2.5 MiB)
            :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :- Project [web AS channel#17683, ws_ship_customer_sk#171 AS col_name#17684, d_year#17720, d_qoy#17724, i_category#17704, ws_ext_sales_price#186 AS ext_sales_price#17685], Statistics(sizeInBytes=430.0 PiB)
            :  +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#17714), Statistics(sizeInBytes=354.2 PiB)
            :     :- Project [ws_sold_date_sk#163, ws_ship_customer_sk#171, ws_ext_sales_price#186, i_category#17704], Statistics(sizeInBytes=2.0 TiB)
            :     :  +- Join Inner, (ws_item_sk#166 = i_item_sk#17692), Statistics(sizeInBytes=2.4 TiB)
            :     :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_ship_customer_sk#171, ws_ext_sales_price#186], Statistics(sizeInBytes=7.1 MiB)
            :     :     :  +- Filter (isnull(ws_ship_customer_sk#171) AND (isnotnull(ws_item_sk#166) AND isnotnull(ws_sold_date_sk#163))), Statistics(sizeInBytes=52.0 MiB)
            :     :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
            :     :     +- Project [i_item_sk#17692, i_category#17704], Statistics(sizeInBytes=342.3 KiB)
            :     :        +- Filter isnotnull(i_item_sk#17692), Statistics(sizeInBytes=3.1 MiB)
            :     :           +- Relation default.item[i_item_sk#17692,i_item_id#17693,i_rec_start_date#17694,i_rec_end_date#17695,i_item_desc#17696,i_current_price#17697,i_wholesale_cost#17698,i_brand_id#17699,i_brand#17700,i_class_id#17701,i_class#17702,i_category_id#17703,i_category#17704,i_manufact_id#17705,i_manufact#17706,i_size#17707,i_formulation#17708,i_color#17709,i_units#17710,i_container#17711,i_manager_id#17712,i_product_name#17713] parquet, Statistics(sizeInBytes=3.1 MiB)
            :     +- Project [d_date_sk#17714, d_year#17720, d_qoy#17724], Statistics(sizeInBytes=175.5 KiB)
            :        +- Filter isnotnull(d_date_sk#17714), Statistics(sizeInBytes=2.5 MiB)
            :           +- Relation default.date_dim[d_date_sk#17714,d_date_id#17715,d_date#17716,d_month_seq#17717,d_week_seq#17718,d_quarter_seq#17719,d_year#17720,d_dow#17721,d_moy#17722,d_dom#17723,d_qoy#17724,d_fy_year#17725,d_fy_quarter_seq#17726,d_fy_week_seq#17727,d_day_name#17728,d_quarter_name#17729,d_holiday#17730,d_weekend#17731,d_following_holiday#17732,d_first_dom#17733,d_last_dom#17734,d_same_day_ly#17735,d_same_day_lq#17736,d_current_day#17737,d_current_week#17738,d_current_month#17739,d_current_quarter#17740,d_current_year#17741] parquet, Statistics(sizeInBytes=2.5 MiB)
            +- Project [catalog AS channel#17686, cs_ship_addr_sk#207 AS col_name#17687, d_year#17770, d_qoy#17774, i_category#17754, cs_ext_sales_price#220 AS ext_sales_price#17688], Statistics(sizeInBytes=875.4 PiB)
               +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#17764), Statistics(sizeInBytes=721.0 PiB)
                  :- Project [cs_sold_date_sk#197, cs_ship_addr_sk#207, cs_ext_sales_price#220, i_category#17754], Statistics(sizeInBytes=4.1 TiB)
                  :  +- Join Inner, (cs_item_sk#212 = i_item_sk#17742), Statistics(sizeInBytes=4.9 TiB)
                  :     :- Project [cs_sold_date_sk#197, cs_ship_addr_sk#207, cs_item_sk#212, cs_ext_sales_price#220], Statistics(sizeInBytes=14.5 MiB)
                  :     :  +- Filter (isnull(cs_ship_addr_sk#207) AND (isnotnull(cs_item_sk#212) AND isnotnull(cs_sold_date_sk#197))), Statistics(sizeInBytes=105.8 MiB)
                  :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
                  :     +- Project [i_item_sk#17742, i_category#17754], Statistics(sizeInBytes=342.3 KiB)
                  :        +- Filter isnotnull(i_item_sk#17742), Statistics(sizeInBytes=3.1 MiB)
                  :           +- Relation default.item[i_item_sk#17742,i_item_id#17743,i_rec_start_date#17744,i_rec_end_date#17745,i_item_desc#17746,i_current_price#17747,i_wholesale_cost#17748,i_brand_id#17749,i_brand#17750,i_class_id#17751,i_class#17752,i_category_id#17753,i_category#17754,i_manufact_id#17755,i_manufact#17756,i_size#17757,i_formulation#17758,i_color#17759,i_units#17760,i_container#17761,i_manager_id#17762,i_product_name#17763] parquet, Statistics(sizeInBytes=3.1 MiB)
                  +- Project [d_date_sk#17764, d_year#17770, d_qoy#17774], Statistics(sizeInBytes=175.5 KiB)
                     +- Filter isnotnull(d_date_sk#17764), Statistics(sizeInBytes=2.5 MiB)
                        +- Relation default.date_dim[d_date_sk#17764,d_date_id#17765,d_date#17766,d_month_seq#17767,d_week_seq#17768,d_quarter_seq#17769,d_year#17770,d_dow#17771,d_moy#17772,d_dom#17773,d_qoy#17774,d_fy_year#17775,d_fy_quarter_seq#17776,d_fy_week_seq#17777,d_day_name#17778,d_quarter_name#17779,d_holiday#17780,d_weekend#17781,d_following_holiday#17782,d_first_dom#17783,d_last_dom#17784,d_same_day_ly#17785,d_same_day_lq#17786,d_current_day#17787,d_current_week#17788,d_current_month#17789,d_current_quarter#17790,d_current_year#17791] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q77 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=7.8 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=2.41E+32 B)
   +- Sort [channel#18062 ASC NULLS FIRST, id#18063 ASC NULLS FIRST], true, Statistics(sizeInBytes=2.41E+32 B)
      +- Aggregate [channel#18062, id#18063, spark_grouping_id#18061L], [channel#18062, id#18063, sum(sales#17827) AS sales#17824, sum(returns#17815) AS returns#17825, sum(profit#17816) AS profit#17826], Statistics(sizeInBytes=2.41E+32 B)
         +- Expand [[sales#17827, returns#17815, profit#17816, channel#18059, id#18060, 0], [sales#17827, returns#17815, profit#17816, channel#18059, null, 1], [sales#17827, returns#17815, profit#17816, null, null, 3]], [sales#17827, returns#17815, profit#17816, channel#18062, id#18063, spark_grouping_id#18061L], Statistics(sizeInBytes=1.93E+32 B)
            +- Union false, false, Statistics(sizeInBytes=5.63E+31 B)
               :- Project [sales#17827, coalesce(returns#17829, 0.00) AS returns#17815, CheckOverflow((promote_precision(cast(profit#17828 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#17830, 0.00) as decimal(18,2)))), DecimalType(18,2)) AS profit#17816, store channel AS channel#18059, s_store_sk#52 AS id#18060], Statistics(sizeInBytes=9.15E+30 B)
               :  +- Join LeftOuter, (s_store_sk#52 = s_store_sk#17881), Statistics(sizeInBytes=7.84E+30 B)
               :     :- Aggregate [s_store_sk#52], [s_store_sk#52, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS sales#17827, MakeDecimal(sum(UnscaledValue(ss_net_profit#436)),17,2) AS profit#17828], Statistics(sizeInBytes=6.2 PiB)
               :     :  +- Project [ss_ext_sales_price#429, ss_net_profit#436, s_store_sk#52], Statistics(sizeInBytes=6.2 PiB)
               :     :     +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=7.1 PiB)
               :     :        :- Project [ss_store_sk#421, ss_ext_sales_price#429, ss_net_profit#436], Statistics(sizeInBytes=2.4 TiB)
               :     :        :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=3.1 TiB)
               :     :        :     :- Project [ss_sold_date_sk#414, ss_store_sk#421, ss_ext_sales_price#429, ss_net_profit#436], Statistics(sizeInBytes=30.5 MiB)
               :     :        :     :  +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421)), Statistics(sizeInBytes=141.1 MiB)
               :     :        :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               :     :        :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :     :        :        +- Filter ((isnotnull(d_date#26) AND ((d_date#26 >= 2000-08-03) AND (d_date#26 <= 2000-09-02))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :     :        :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     :        +- Project [s_store_sk#52], Statistics(sizeInBytes=2.9 KiB)
               :     :           +- Filter isnotnull(s_store_sk#52), Statistics(sizeInBytes=101.7 KiB)
               :     :              +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
               :     +- Aggregate [s_store_sk#17881], [s_store_sk#17881, MakeDecimal(sum(UnscaledValue(sr_return_amt#15)),17,2) AS returns#17829, MakeDecimal(sum(UnscaledValue(sr_net_loss#23)),17,2) AS profit_loss#17830], Statistics(sizeInBytes=1022.0 TiB)
               :        +- Project [sr_return_amt#15, sr_net_loss#23, s_store_sk#17881], Statistics(sizeInBytes=1022.0 TiB)
               :           +- Join Inner, (sr_store_sk#11 = s_store_sk#17881), Statistics(sizeInBytes=1168.0 TiB)
               :              :- Project [sr_store_sk#11, sr_return_amt#15, sr_net_loss#23], Statistics(sizeInBytes=402.2 GiB)
               :              :  +- Join Inner, (sr_returned_date_sk#4 = d_date_sk#17853), Statistics(sizeInBytes=517.1 GiB)
               :              :     :- Project [sr_returned_date_sk#4, sr_store_sk#11, sr_return_amt#15, sr_net_loss#23], Statistics(sizeInBytes=4.9 MiB)
               :              :     :  +- Filter (isnotnull(sr_returned_date_sk#4) AND isnotnull(sr_store_sk#11)), Statistics(sizeInBytes=19.0 MiB)
               :              :     :     +- Relation default.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet, Statistics(sizeInBytes=19.0 MiB)
               :              :     +- Project [d_date_sk#17853], Statistics(sizeInBytes=105.3 KiB)
               :              :        +- Filter ((isnotnull(d_date#17855) AND ((d_date#17855 >= 2000-08-03) AND (d_date#17855 <= 2000-09-02))) AND isnotnull(d_date_sk#17853)), Statistics(sizeInBytes=2.5 MiB)
               :              :           +- Relation default.date_dim[d_date_sk#17853,d_date_id#17854,d_date#17855,d_month_seq#17856,d_week_seq#17857,d_quarter_seq#17858,d_year#17859,d_dow#17860,d_moy#17861,d_dom#17862,d_qoy#17863,d_fy_year#17864,d_fy_quarter_seq#17865,d_fy_week_seq#17866,d_day_name#17867,d_quarter_name#17868,d_holiday#17869,d_weekend#17870,d_following_holiday#17871,d_first_dom#17872,d_last_dom#17873,d_same_day_ly#17874,d_same_day_lq#17875,d_current_day#17876,d_current_week#17877,d_current_month#17878,d_current_quarter#17879,d_current_year#17880] parquet, Statistics(sizeInBytes=2.5 MiB)
               :              +- Project [s_store_sk#17881], Statistics(sizeInBytes=2.9 KiB)
               :                 +- Filter isnotnull(s_store_sk#17881), Statistics(sizeInBytes=101.7 KiB)
               :                    +- Relation default.store[s_store_sk#17881,s_store_id#17882,s_rec_start_date#17883,s_rec_end_date#17884,s_closed_date_sk#17885,s_store_name#17886,s_number_employees#17887,s_floor_space#17888,s_hours#17889,s_manager#17890,s_market_id#17891,s_geography_class#17892,s_market_desc#17893,s_market_manager#17894,s_division_id#17895,s_division_name#17896,s_company_id#17897,s_company_name#17898,s_street_number#17899,s_street_name#17900,s_street_type#17901,s_suite_number#17902,s_city#17903,s_county#17904,s_state#17905,s_zip#17906,s_country#17907,s_gmt_offset#17908,s_tax_percentage#17909] parquet, Statistics(sizeInBytes=101.7 KiB)
               :- Project [sales#17831, returns#17833, CheckOverflow((promote_precision(cast(profit#17832 as decimal(18,2))) - promote_precision(cast(profit_loss#17834 as decimal(18,2)))), DecimalType(18,2)) AS profit#17819, catalog channel AS channel#18069, cs_call_center_sk#208 AS id#18070], Statistics(sizeInBytes=40.6 TiB)
               :  +- Join Inner, Statistics(sizeInBytes=31.9 TiB)
               :     :- Aggregate [cs_call_center_sk#208], [cs_call_center_sk#208, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#220)),17,2) AS sales#17831, MakeDecimal(sum(UnscaledValue(cs_net_profit#230)),17,2) AS profit#17832], Statistics(sizeInBytes=1359.5 GiB)
               :     :  +- Project [cs_call_center_sk#208, cs_ext_sales_price#220, cs_net_profit#230], Statistics(sizeInBytes=1359.5 GiB)
               :     :     +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#17910), Statistics(sizeInBytes=1748.0 GiB)
               :     :        :- Project [cs_sold_date_sk#197, cs_call_center_sk#208, cs_ext_sales_price#220, cs_net_profit#230], Statistics(sizeInBytes=16.6 MiB)
               :     :        :  +- Filter isnotnull(cs_sold_date_sk#197), Statistics(sizeInBytes=105.8 MiB)
               :     :        :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
               :     :        +- Project [d_date_sk#17910], Statistics(sizeInBytes=105.3 KiB)
               :     :           +- Filter ((isnotnull(d_date#17912) AND ((d_date#17912 >= 2000-08-03) AND (d_date#17912 <= 2000-09-02))) AND isnotnull(d_date_sk#17910)), Statistics(sizeInBytes=2.5 MiB)
               :     :              +- Relation default.date_dim[d_date_sk#17910,d_date_id#17911,d_date#17912,d_month_seq#17913,d_week_seq#17914,d_quarter_seq#17915,d_year#17916,d_dow#17917,d_moy#17918,d_dom#17919,d_qoy#17920,d_fy_year#17921,d_fy_quarter_seq#17922,d_fy_week_seq#17923,d_day_name#17924,d_quarter_name#17925,d_holiday#17926,d_weekend#17927,d_following_holiday#17928,d_first_dom#17929,d_last_dom#17930,d_same_day_ly#17931,d_same_day_lq#17932,d_current_day#17933,d_current_week#17934,d_current_month#17935,d_current_quarter#17936,d_current_year#17937] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     +- Aggregate [MakeDecimal(sum(UnscaledValue(cr_return_amount#3309)),17,2) AS returns#17833, MakeDecimal(sum(UnscaledValue(cr_net_loss#3317)),17,2) AS profit_loss#17834], Statistics(sizeInBytes=24.0 B, rowCount=1)
               :        +- Project [cr_return_amount#3309, cr_net_loss#3317], Statistics(sizeInBytes=182.8 GiB)
               :           +- Join Inner, (cr_returned_date_sk#3291 = d_date_sk#17938), Statistics(sizeInBytes=243.8 GiB)
               :              :- Project [cr_returned_date_sk#3291, cr_return_amount#3309, cr_net_loss#3317], Statistics(sizeInBytes=2.3 MiB)
               :              :  +- Filter isnotnull(cr_returned_date_sk#3291), Statistics(sizeInBytes=12.6 MiB)
               :              :     +- Relation default.catalog_returns[cr_returned_date_sk#3291,cr_returned_time_sk#3292,cr_item_sk#3293,cr_refunded_customer_sk#3294,cr_refunded_cdemo_sk#3295,cr_refunded_hdemo_sk#3296,cr_refunded_addr_sk#3297,cr_returning_customer_sk#3298,cr_returning_cdemo_sk#3299,cr_returning_hdemo_sk#3300,cr_returning_addr_sk#3301,cr_call_center_sk#3302,cr_catalog_page_sk#3303,cr_ship_mode_sk#3304,cr_warehouse_sk#3305,cr_reason_sk#3306,cr_order_number#3307,cr_return_quantity#3308,cr_return_amount#3309,cr_return_tax#3310,cr_return_amt_inc_tax#3311,cr_fee#3312,cr_return_ship_cost#3313,cr_refunded_cash#3314,cr_reversed_charge#3315,cr_store_credit#3316,cr_net_loss#3317] parquet, Statistics(sizeInBytes=12.6 MiB)
               :              +- Project [d_date_sk#17938], Statistics(sizeInBytes=105.3 KiB)
               :                 +- Filter ((isnotnull(d_date#17940) AND ((d_date#17940 >= 2000-08-03) AND (d_date#17940 <= 2000-09-02))) AND isnotnull(d_date_sk#17938)), Statistics(sizeInBytes=2.5 MiB)
               :                    +- Relation default.date_dim[d_date_sk#17938,d_date_id#17939,d_date#17940,d_month_seq#17941,d_week_seq#17942,d_quarter_seq#17943,d_year#17944,d_dow#17945,d_moy#17946,d_dom#17947,d_qoy#17948,d_fy_year#17949,d_fy_quarter_seq#17950,d_fy_week_seq#17951,d_day_name#17952,d_quarter_name#17953,d_holiday#17954,d_weekend#17955,d_following_holiday#17956,d_first_dom#17957,d_last_dom#17958,d_same_day_ly#17959,d_same_day_lq#17960,d_current_day#17961,d_current_week#17962,d_current_month#17963,d_current_quarter#17964,d_current_year#17965] parquet, Statistics(sizeInBytes=2.5 MiB)
               +- Project [sales#17835, coalesce(returns#17837, 0.00) AS returns#17822, CheckOverflow((promote_precision(cast(profit#17836 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#17838, 0.00) as decimal(18,2)))), DecimalType(18,2)) AS profit#17823, web channel AS channel#18071, wp_web_page_sk#17839 AS id#18072], Statistics(sizeInBytes=4.72E+31 B)
                  +- Join LeftOuter, (wp_web_page_sk#17839 = wp_web_page_sk#18022), Statistics(sizeInBytes=4.04E+31 B)
                     :- Aggregate [wp_web_page_sk#17839], [wp_web_page_sk#17839, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#186)),17,2) AS sales#17835, MakeDecimal(sum(UnscaledValue(ws_net_profit#196)),17,2) AS profit#17836], Statistics(sizeInBytes=13.2 PiB)
                     :  +- Project [ws_ext_sales_price#186, ws_net_profit#196, wp_web_page_sk#17839], Statistics(sizeInBytes=13.2 PiB)
                     :     +- Join Inner, (ws_web_page_sk#175 = wp_web_page_sk#17839), Statistics(sizeInBytes=15.1 PiB)
                     :        :- Project [ws_web_page_sk#175, ws_ext_sales_price#186, ws_net_profit#196], Statistics(sizeInBytes=667.9 GiB)
                     :        :  +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#17966), Statistics(sizeInBytes=858.7 GiB)
                     :        :     :- Project [ws_sold_date_sk#163, ws_web_page_sk#175, ws_ext_sales_price#186, ws_net_profit#196], Statistics(sizeInBytes=8.2 MiB)
                     :        :     :  +- Filter (isnotnull(ws_sold_date_sk#163) AND isnotnull(ws_web_page_sk#175)), Statistics(sizeInBytes=52.0 MiB)
                     :        :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                     :        :     +- Project [d_date_sk#17966], Statistics(sizeInBytes=105.3 KiB)
                     :        :        +- Filter ((isnotnull(d_date#17968) AND ((d_date#17968 >= 2000-08-03) AND (d_date#17968 <= 2000-09-02))) AND isnotnull(d_date_sk#17966)), Statistics(sizeInBytes=2.5 MiB)
                     :        :           +- Relation default.date_dim[d_date_sk#17966,d_date_id#17967,d_date#17968,d_month_seq#17969,d_week_seq#17970,d_quarter_seq#17971,d_year#17972,d_dow#17973,d_moy#17974,d_dom#17975,d_qoy#17976,d_fy_year#17977,d_fy_quarter_seq#17978,d_fy_week_seq#17979,d_day_name#17980,d_quarter_name#17981,d_holiday#17982,d_weekend#17983,d_following_holiday#17984,d_first_dom#17985,d_last_dom#17986,d_same_day_ly#17987,d_same_day_lq#17988,d_current_day#17989,d_current_week#17990,d_current_month#17991,d_current_quarter#17992,d_current_year#17993] parquet, Statistics(sizeInBytes=2.5 MiB)
                     :        +- Project [wp_web_page_sk#17839], Statistics(sizeInBytes=23.2 KiB)
                     :           +- Filter isnotnull(wp_web_page_sk#17839), Statistics(sizeInBytes=247.3 KiB)
                     :              +- Relation default.web_page[wp_web_page_sk#17839,wp_web_page_id#17840,wp_rec_start_date#17841,wp_rec_end_date#17842,wp_creation_date_sk#17843,wp_access_date_sk#17844,wp_autogen_flag#17845,wp_customer_sk#17846,wp_url#17847,wp_type#17848,wp_char_count#17849,wp_link_count#17850,wp_image_count#17851,wp_max_ad_count#17852] parquet, Statistics(sizeInBytes=247.3 KiB)
                     +- Aggregate [wp_web_page_sk#18022], [wp_web_page_sk#18022, MakeDecimal(sum(UnscaledValue(wr_return_amt#3342)),17,2) AS returns#17837, MakeDecimal(sum(UnscaledValue(wr_net_loss#3350)),17,2) AS profit_loss#17838], Statistics(sizeInBytes=2.4 PiB)
                        +- Project [wr_return_amt#3342, wr_net_loss#3350, wp_web_page_sk#18022], Statistics(sizeInBytes=2.4 PiB)
                           +- Join Inner, (wr_web_page_sk#3338 = wp_web_page_sk#18022), Statistics(sizeInBytes=2.8 PiB)
                              :- Project [wr_web_page_sk#3338, wr_return_amt#3342, wr_net_loss#3350], Statistics(sizeInBytes=121.7 GiB)
                              :  +- Join Inner, (wr_returned_date_sk#3327 = d_date_sk#17994), Statistics(sizeInBytes=156.4 GiB)
                              :     :- Project [wr_returned_date_sk#3327, wr_web_page_sk#3338, wr_return_amt#3342, wr_net_loss#3350], Statistics(sizeInBytes=1521.3 KiB)
                              :     :  +- Filter (isnotnull(wr_returned_date_sk#3327) AND isnotnull(wr_web_page_sk#3338)), Statistics(sizeInBytes=6.5 MiB)
                              :     :     +- Relation default.web_returns[wr_returned_date_sk#3327,wr_returned_time_sk#3328,wr_item_sk#3329,wr_refunded_customer_sk#3330,wr_refunded_cdemo_sk#3331,wr_refunded_hdemo_sk#3332,wr_refunded_addr_sk#3333,wr_returning_customer_sk#3334,wr_returning_cdemo_sk#3335,wr_returning_hdemo_sk#3336,wr_returning_addr_sk#3337,wr_web_page_sk#3338,wr_reason_sk#3339,wr_order_number#3340,wr_return_quantity#3341,wr_return_amt#3342,wr_return_tax#3343,wr_return_amt_inc_tax#3344,wr_fee#3345,wr_return_ship_cost#3346,wr_refunded_cash#3347,wr_reversed_charge#3348,wr_account_credit#3349,wr_net_loss#3350] parquet, Statistics(sizeInBytes=6.5 MiB)
                              :     +- Project [d_date_sk#17994], Statistics(sizeInBytes=105.3 KiB)
                              :        +- Filter ((isnotnull(d_date#17996) AND ((d_date#17996 >= 2000-08-03) AND (d_date#17996 <= 2000-09-02))) AND isnotnull(d_date_sk#17994)), Statistics(sizeInBytes=2.5 MiB)
                              :           +- Relation default.date_dim[d_date_sk#17994,d_date_id#17995,d_date#17996,d_month_seq#17997,d_week_seq#17998,d_quarter_seq#17999,d_year#18000,d_dow#18001,d_moy#18002,d_dom#18003,d_qoy#18004,d_fy_year#18005,d_fy_quarter_seq#18006,d_fy_week_seq#18007,d_day_name#18008,d_quarter_name#18009,d_holiday#18010,d_weekend#18011,d_following_holiday#18012,d_first_dom#18013,d_last_dom#18014,d_same_day_ly#18015,d_same_day_lq#18016,d_current_day#18017,d_current_week#18018,d_current_month#18019,d_current_quarter#18020,d_current_year#18021] parquet, Statistics(sizeInBytes=2.5 MiB)
                              +- Project [wp_web_page_sk#18022], Statistics(sizeInBytes=23.2 KiB)
                                 +- Filter isnotnull(wp_web_page_sk#18022), Statistics(sizeInBytes=247.3 KiB)
                                    +- Relation default.web_page[wp_web_page_sk#18022,wp_web_page_id#18023,wp_rec_start_date#18024,wp_rec_end_date#18025,wp_creation_date_sk#18026,wp_access_date_sk#18027,wp_autogen_flag#18028,wp_customer_sk#18029,wp_url#18030,wp_type#18031,wp_char_count#18032,wp_link_count#18033,wp_image_count#18034,wp_max_ad_count#18035] parquet, Statistics(sizeInBytes=247.3 KiB)


==== q79 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=8.6 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=2.77E+27 B)
   +- Project [c_last_name#90, c_first_name#89, substr(s_city, 1, 30)#18267, ss_ticket_number#423, amt#18263, profit#18264], Statistics(sizeInBytes=2.77E+27 B)
      +- Sort [c_last_name#90 ASC NULLS FIRST, c_first_name#89 ASC NULLS FIRST, substr(s_city#74, 1, 30) ASC NULLS FIRST, profit#18264 ASC NULLS FIRST], true, Statistics(sizeInBytes=3.40E+27 B)
         +- Project [c_last_name#90, c_first_name#89, substr(s_city#74, 1, 30) AS substr(s_city, 1, 30)#18267, ss_ticket_number#423, amt#18263, profit#18264, s_city#74], Statistics(sizeInBytes=3.40E+27 B)
            +- Join Inner, (ss_customer_sk#417 = c_customer_sk#81), Statistics(sizeInBytes=3.02E+27 B)
               :- Aggregate [ss_ticket_number#423, ss_customer_sk#417, ss_addr_sk#420, s_city#74], [ss_ticket_number#423, ss_customer_sk#417, s_city#74, MakeDecimal(sum(UnscaledValue(ss_coupon_amt#433)),17,2) AS amt#18263, MakeDecimal(sum(UnscaledValue(ss_net_profit#436)),17,2) AS profit#18264], Statistics(sizeInBytes=1282.5 EiB)
               :  +- Project [ss_customer_sk#417, ss_addr_sk#420, ss_ticket_number#423, ss_coupon_amt#433, ss_net_profit#436, s_city#74], Statistics(sizeInBytes=1381.2 EiB)
               :     +- Join Inner, (ss_hdemo_sk#419 = hd_demo_sk#5551), Statistics(sizeInBytes=1578.5 EiB)
               :        :- Project [ss_customer_sk#417, ss_hdemo_sk#419, ss_addr_sk#420, ss_ticket_number#423, ss_coupon_amt#433, ss_net_profit#436, s_city#74], Statistics(sizeInBytes=27.2 PiB)
               :        :  +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=30.8 PiB)
               :        :     :- Project [ss_customer_sk#417, ss_hdemo_sk#419, ss_addr_sk#420, ss_store_sk#421, ss_ticket_number#423, ss_coupon_amt#433, ss_net_profit#436], Statistics(sizeInBytes=4.0 TiB)
               :        :     :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=4.7 TiB)
               :        :     :     :- Project [ss_sold_date_sk#414, ss_customer_sk#417, ss_hdemo_sk#419, ss_addr_sk#420, ss_store_sk#421, ss_ticket_number#423, ss_coupon_amt#433, ss_net_profit#436], Statistics(sizeInBytes=45.8 MiB)
               :        :     :     :  +- Filter ((isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421)) AND (isnotnull(ss_hdemo_sk#419) AND isnotnull(ss_customer_sk#417))), Statistics(sizeInBytes=141.1 MiB)
               :        :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               :        :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :        :     :        +- Filter ((isnotnull(d_dow#31) AND ((d_dow#31 = 1) AND d_year#30 IN (1999,2000,2001))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :        :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :        :     +- Project [s_store_sk#52, s_city#74], Statistics(sizeInBytes=7.7 KiB)
               :        :        +- Filter ((isnotnull(s_number_employees#58) AND ((s_number_employees#58 >= 200) AND (s_number_employees#58 <= 295))) AND isnotnull(s_store_sk#52)), Statistics(sizeInBytes=101.7 KiB)
               :        :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
               :        +- Project [hd_demo_sk#5551], Statistics(sizeInBytes=58.0 KiB)
               :           +- Filter (((hd_dep_count#5554 = 6) OR (hd_vehicle_count#5555 > 2)) AND isnotnull(hd_demo_sk#5551)), Statistics(sizeInBytes=212.8 KiB)
               :              +- Relation default.household_demographics[hd_demo_sk#5551,hd_income_band_sk#5552,hd_buy_potential#5553,hd_dep_count#5554,hd_vehicle_count#5555] parquet, Statistics(sizeInBytes=212.8 KiB)
               +- Project [c_customer_sk#81, c_first_name#89, c_last_name#90], Statistics(sizeInBytes=1996.3 KiB)
                  +- Filter isnotnull(c_customer_sk#81), Statistics(sizeInBytes=7.8 MiB)
                     +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)



==== q80 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=9.4 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=2.09E+34 B)
   +- Sort [channel#18463 ASC NULLS FIRST, id#18464 ASC NULLS FIRST], true, Statistics(sizeInBytes=2.09E+34 B)
      +- Aggregate [channel#18463, id#18464, spark_grouping_id#18462L], [channel#18463, id#18464, sum(sales#18294) AS sales#18290, sum(returns#18295) AS returns#18291, sum(profit#18296) AS profit#18292], Statistics(sizeInBytes=2.09E+34 B)
         +- Expand [[sales#18294, returns#18295, profit#18296, channel#18460, id#18461, 0], [sales#18294, returns#18295, profit#18296, channel#18460, null, 1], [sales#18294, returns#18295, profit#18296, null, null, 3]], [sales#18294, returns#18295, profit#18296, channel#18463, id#18464, spark_grouping_id#18462L], Statistics(sizeInBytes=2.09E+34 B)
            +- Union false, false, Statistics(sizeInBytes=6.38E+33 B)
               :- Aggregate [s_store_id#53], [MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS sales#18294, sum(coalesce(cast(sr_return_amt#15 as decimal(12,2)), 0.00)) AS returns#18295, sum(CheckOverflow((promote_precision(cast(ss_net_profit#436 as decimal(13,2))) - promote_precision(cast(coalesce(cast(sr_net_loss#23 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2))) AS profit#18296, store channel AS channel#18460, concat(store, s_store_id#53) AS id#18461], Statistics(sizeInBytes=4.57E+32 B)
               :  +- Project [ss_ext_sales_price#429, ss_net_profit#436, sr_return_amt#15, sr_net_loss#23, s_store_id#53], Statistics(sizeInBytes=3.12E+32 B)
               :     +- Join Inner, (ss_promo_sk#422 = p_promo_sk#3642), Statistics(sizeInBytes=3.53E+32 B)
               :        :- Project [ss_promo_sk#422, ss_ext_sales_price#429, ss_net_profit#436, sr_return_amt#15, sr_net_loss#23, s_store_id#53], Statistics(sizeInBytes=1.44E+28 B)
               :        :  +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=1.63E+28 B)
               :        :     :- Project [ss_item_sk#416, ss_promo_sk#422, ss_ext_sales_price#429, ss_net_profit#436, sr_return_amt#15, sr_net_loss#23, s_store_id#53], Statistics(sizeInBytes=1.24E+23 B)
               :        :     :  +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=1.38E+23 B)
               :        :     :     :- Project [ss_item_sk#416, ss_store_sk#421, ss_promo_sk#422, ss_ext_sales_price#429, ss_net_profit#436, sr_return_amt#15, sr_net_loss#23], Statistics(sizeInBytes=15.1 EiB)
               :        :     :     :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=17.4 EiB)
               :        :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_promo_sk#422, ss_ext_sales_price#429, ss_net_profit#436, sr_return_amt#15, sr_net_loss#23], Statistics(sizeInBytes=169.6 TiB)
               :        :     :     :     :  +- Join LeftOuter, ((ss_item_sk#416 = sr_item_sk#6) AND (ss_ticket_number#423 = sr_ticket_number#13)), Statistics(sizeInBytes=205.9 TiB)
               :        :     :     :     :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_promo_sk#422, ss_ticket_number#423, ss_ext_sales_price#429, ss_net_profit#436], Statistics(sizeInBytes=41.9 MiB)
               :        :     :     :     :     :  +- Filter (((isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421)) AND isnotnull(ss_item_sk#416)) AND isnotnull(ss_promo_sk#422)), Statistics(sizeInBytes=141.1 MiB)
               :        :     :     :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               :        :     :     :     :     +- Project [sr_item_sk#6, sr_ticket_number#13, sr_return_amt#15, sr_net_loss#23], Statistics(sizeInBytes=4.9 MiB)
               :        :     :     :     :        +- Filter (isnotnull(sr_item_sk#6) AND isnotnull(sr_ticket_number#13)), Statistics(sizeInBytes=19.0 MiB)
               :        :     :     :     :           +- Relation default.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet, Statistics(sizeInBytes=19.0 MiB)
               :        :     :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :        :     :     :        +- Filter ((isnotnull(d_date#26) AND ((d_date#26 >= 2000-08-23) AND (d_date#26 <= 2000-09-22))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :        :     :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               :        :     :     +- Project [s_store_sk#52, s_store_id#53], Statistics(sizeInBytes=7.7 KiB)
               :        :     :        +- Filter isnotnull(s_store_sk#52), Statistics(sizeInBytes=101.7 KiB)
               :        :     :           +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
               :        :     +- Project [i_item_sk#437], Statistics(sizeInBytes=128.3 KiB)
               :        :        +- Filter ((isnotnull(i_current_price#442) AND (i_current_price#442 > 50.00)) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
               :        :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
               :        +- Project [p_promo_sk#3642], Statistics(sizeInBytes=23.9 KiB)
               :           +- Filter ((isnotnull(p_channel_tv#3653) AND (p_channel_tv#3653 = N)) AND isnotnull(p_promo_sk#3642)), Statistics(sizeInBytes=589.4 KiB)
               :              +- Relation default.promotion[p_promo_sk#3642,p_promo_id#3643,p_start_date_sk#3644,p_end_date_sk#3645,p_item_sk#3646,p_cost#3647,p_response_target#3648,p_promo_name#3649,p_channel_dmail#3650,p_channel_email#3651,p_channel_catalog#3652,p_channel_tv#3653,p_channel_radio#3654,p_channel_press#3655,p_channel_event#3656,p_channel_demo#3657,p_channel_details#3658,p_purpose#3659,p_discount_active#3660] parquet, Statistics(sizeInBytes=589.4 KiB)
               :- Aggregate [cp_catalog_page_id#3319], [MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#220)),17,2) AS sales#18298, sum(coalesce(cast(cr_return_amount#3309 as decimal(12,2)), 0.00)) AS returns#18299, sum(CheckOverflow((promote_precision(cast(cs_net_profit#230 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_net_loss#3317 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2))) AS profit#18300, catalog channel AS channel#18470, concat(catalog_page, cp_catalog_page_id#3319) AS id#18471], Statistics(sizeInBytes=5.82E+33 B)
               :  +- Project [cs_ext_sales_price#220, cs_net_profit#230, cr_return_amount#3309, cr_net_loss#3317, cp_catalog_page_id#3319], Statistics(sizeInBytes=3.97E+33 B)
               :     +- Join Inner, (cs_promo_sk#213 = p_promo_sk#18354), Statistics(sizeInBytes=4.50E+33 B)
               :        :- Project [cs_promo_sk#213, cs_ext_sales_price#220, cs_net_profit#230, cr_return_amount#3309, cr_net_loss#3317, cp_catalog_page_id#3319], Statistics(sizeInBytes=1.84E+29 B)
               :        :  +- Join Inner, (cs_item_sk#212 = i_item_sk#18332), Statistics(sizeInBytes=2.07E+29 B)
               :        :     :- Project [cs_item_sk#212, cs_promo_sk#213, cs_ext_sales_price#220, cs_net_profit#230, cr_return_amount#3309, cr_net_loss#3317, cp_catalog_page_id#3319], Statistics(sizeInBytes=1.57E+24 B)
               :        :     :  +- Join Inner, (cs_catalog_page_sk#209 = cp_catalog_page_sk#3318), Statistics(sizeInBytes=1.76E+24 B)
               :        :     :     :- Project [cs_catalog_page_sk#209, cs_item_sk#212, cs_promo_sk#213, cs_ext_sales_price#220, cs_net_profit#230, cr_return_amount#3309, cr_net_loss#3317], Statistics(sizeInBytes=4.4 EiB)
               :        :     :     :  +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#18304), Statistics(sizeInBytes=5.1 EiB)
               :        :     :     :     :- Project [cs_sold_date_sk#197, cs_catalog_page_sk#209, cs_item_sk#212, cs_promo_sk#213, cs_ext_sales_price#220, cs_net_profit#230, cr_return_amount#3309, cr_net_loss#3317], Statistics(sizeInBytes=49.7 TiB)
               :        :     :     :     :  +- Join LeftOuter, ((cs_item_sk#212 = cr_item_sk#3293) AND (cs_order_number#214 = cr_order_number#3307)), Statistics(sizeInBytes=60.4 TiB)
               :        :     :     :     :     :- Project [cs_sold_date_sk#197, cs_catalog_page_sk#209, cs_item_sk#212, cs_promo_sk#213, cs_order_number#214, cs_ext_sales_price#220, cs_net_profit#230], Statistics(sizeInBytes=22.8 MiB)
               :        :     :     :     :     :  +- Filter (((isnotnull(cs_sold_date_sk#197) AND isnotnull(cs_catalog_page_sk#209)) AND isnotnull(cs_item_sk#212)) AND isnotnull(cs_promo_sk#213)), Statistics(sizeInBytes=105.8 MiB)
               :        :     :     :     :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
               :        :     :     :     :     +- Project [cr_item_sk#3293, cr_order_number#3307, cr_return_amount#3309, cr_net_loss#3317], Statistics(sizeInBytes=2.6 MiB)
               :        :     :     :     :        +- Filter (isnotnull(cr_item_sk#3293) AND isnotnull(cr_order_number#3307)), Statistics(sizeInBytes=12.6 MiB)
               :        :     :     :     :           +- Relation default.catalog_returns[cr_returned_date_sk#3291,cr_returned_time_sk#3292,cr_item_sk#3293,cr_refunded_customer_sk#3294,cr_refunded_cdemo_sk#3295,cr_refunded_hdemo_sk#3296,cr_refunded_addr_sk#3297,cr_returning_customer_sk#3298,cr_returning_cdemo_sk#3299,cr_returning_hdemo_sk#3300,cr_returning_addr_sk#3301,cr_call_center_sk#3302,cr_catalog_page_sk#3303,cr_ship_mode_sk#3304,cr_warehouse_sk#3305,cr_reason_sk#3306,cr_order_number#3307,cr_return_quantity#3308,cr_return_amount#3309,cr_return_tax#3310,cr_return_amt_inc_tax#3311,cr_fee#3312,cr_return_ship_cost#3313,cr_refunded_cash#3314,cr_reversed_charge#3315,cr_store_credit#3316,cr_net_loss#3317] parquet, Statistics(sizeInBytes=12.6 MiB)
               :        :     :     :     +- Project [d_date_sk#18304], Statistics(sizeInBytes=105.3 KiB)
               :        :     :     :        +- Filter ((isnotnull(d_date#18306) AND ((d_date#18306 >= 2000-08-23) AND (d_date#18306 <= 2000-09-22))) AND isnotnull(d_date_sk#18304)), Statistics(sizeInBytes=2.5 MiB)
               :        :     :     :           +- Relation default.date_dim[d_date_sk#18304,d_date_id#18305,d_date#18306,d_month_seq#18307,d_week_seq#18308,d_quarter_seq#18309,d_year#18310,d_dow#18311,d_moy#18312,d_dom#18313,d_qoy#18314,d_fy_year#18315,d_fy_quarter_seq#18316,d_fy_week_seq#18317,d_day_name#18318,d_quarter_name#18319,d_holiday#18320,d_weekend#18321,d_following_holiday#18322,d_first_dom#18323,d_last_dom#18324,d_same_day_ly#18325,d_same_day_lq#18326,d_current_day#18327,d_current_week#18328,d_current_month#18329,d_current_quarter#18330,d_current_year#18331] parquet, Statistics(sizeInBytes=2.5 MiB)
               :        :     :     +- Project [cp_catalog_page_sk#3318, cp_catalog_page_id#3319], Statistics(sizeInBytes=336.3 KiB)
               :        :     :        +- Filter isnotnull(cp_catalog_page_sk#3318), Statistics(sizeInBytes=1134.9 KiB)
               :        :     :           +- Relation default.catalog_page[cp_catalog_page_sk#3318,cp_catalog_page_id#3319,cp_start_date_sk#3320,cp_end_date_sk#3321,cp_department#3322,cp_catalog_number#3323,cp_catalog_page_number#3324,cp_description#3325,cp_type#3326] parquet, Statistics(sizeInBytes=1134.9 KiB)
               :        :     +- Project [i_item_sk#18332], Statistics(sizeInBytes=128.3 KiB)
               :        :        +- Filter ((isnotnull(i_current_price#18337) AND (i_current_price#18337 > 50.00)) AND isnotnull(i_item_sk#18332)), Statistics(sizeInBytes=3.1 MiB)
               :        :           +- Relation default.item[i_item_sk#18332,i_item_id#18333,i_rec_start_date#18334,i_rec_end_date#18335,i_item_desc#18336,i_current_price#18337,i_wholesale_cost#18338,i_brand_id#18339,i_brand#18340,i_class_id#18341,i_class#18342,i_category_id#18343,i_category#18344,i_manufact_id#18345,i_manufact#18346,i_size#18347,i_formulation#18348,i_color#18349,i_units#18350,i_container#18351,i_manager_id#18352,i_product_name#18353] parquet, Statistics(sizeInBytes=3.1 MiB)
               :        +- Project [p_promo_sk#18354], Statistics(sizeInBytes=23.9 KiB)
               :           +- Filter ((isnotnull(p_channel_tv#18365) AND (p_channel_tv#18365 = N)) AND isnotnull(p_promo_sk#18354)), Statistics(sizeInBytes=589.4 KiB)
               :              +- Relation default.promotion[p_promo_sk#18354,p_promo_id#18355,p_start_date_sk#18356,p_end_date_sk#18357,p_item_sk#18358,p_cost#18359,p_response_target#18360,p_promo_name#18361,p_channel_dmail#18362,p_channel_email#18363,p_channel_catalog#18364,p_channel_tv#18365,p_channel_radio#18366,p_channel_press#18367,p_channel_event#18368,p_channel_demo#18369,p_channel_details#18370,p_purpose#18371,p_discount_active#18372] parquet, Statistics(sizeInBytes=589.4 KiB)
               +- Aggregate [web_site_id#3352], [MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#186)),17,2) AS sales#18301, sum(coalesce(cast(wr_return_amt#3342 as decimal(12,2)), 0.00)) AS returns#18302, sum(CheckOverflow((promote_precision(cast(ws_net_profit#196 as decimal(13,2))) - promote_precision(cast(coalesce(cast(wr_net_loss#3350 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2))) AS profit#18303, web channel AS channel#18472, concat(web_site, web_site_id#3352) AS id#18473], Statistics(sizeInBytes=9.71E+31 B)
                  +- Project [ws_ext_sales_price#186, ws_net_profit#196, wr_return_amt#3342, wr_net_loss#3350, web_site_id#3352], Statistics(sizeInBytes=6.62E+31 B)
                     +- Join Inner, (ws_promo_sk#179 = p_promo_sk#18423), Statistics(sizeInBytes=7.51E+31 B)
                        :- Project [ws_promo_sk#179, ws_ext_sales_price#186, ws_net_profit#196, wr_return_amt#3342, wr_net_loss#3350, web_site_id#3352], Statistics(sizeInBytes=3.07E+27 B)
                        :  +- Join Inner, (ws_item_sk#166 = i_item_sk#18401), Statistics(sizeInBytes=3.45E+27 B)
                        :     :- Project [ws_item_sk#166, ws_promo_sk#179, ws_ext_sales_price#186, ws_net_profit#196, wr_return_amt#3342, wr_net_loss#3350, web_site_id#3352], Statistics(sizeInBytes=2.63E+22 B)
                        :     :  +- Join Inner, (ws_web_site_sk#176 = web_site_sk#3351), Statistics(sizeInBytes=2.93E+22 B)
                        :     :     :- Project [ws_item_sk#166, ws_web_site_sk#176, ws_promo_sk#179, ws_ext_sales_price#186, ws_net_profit#196, wr_return_amt#3342, wr_net_loss#3350], Statistics(sizeInBytes=1251.9 PiB)
                        :     :     :  +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#18373), Statistics(sizeInBytes=1444.5 PiB)
                        :     :     :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_web_site_sk#176, ws_promo_sk#179, ws_ext_sales_price#186, ws_net_profit#196, wr_return_amt#3342, wr_net_loss#3350], Statistics(sizeInBytes=13.7 TiB)
                        :     :     :     :  +- Join LeftOuter, ((ws_item_sk#166 = wr_item_sk#3329) AND (ws_order_number#180 = wr_order_number#3340)), Statistics(sizeInBytes=16.7 TiB)
                        :     :     :     :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_web_site_sk#176, ws_promo_sk#179, ws_order_number#180, ws_ext_sales_price#186, ws_net_profit#196], Statistics(sizeInBytes=11.2 MiB)
                        :     :     :     :     :  +- Filter (((isnotnull(ws_sold_date_sk#163) AND isnotnull(ws_web_site_sk#176)) AND isnotnull(ws_item_sk#166)) AND isnotnull(ws_promo_sk#179)), Statistics(sizeInBytes=52.0 MiB)
                        :     :     :     :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                        :     :     :     :     +- Project [wr_item_sk#3329, wr_order_number#3340, wr_return_amt#3342, wr_net_loss#3350], Statistics(sizeInBytes=1521.3 KiB)
                        :     :     :     :        +- Filter (isnotnull(wr_item_sk#3329) AND isnotnull(wr_order_number#3340)), Statistics(sizeInBytes=6.5 MiB)
                        :     :     :     :           +- Relation default.web_returns[wr_returned_date_sk#3327,wr_returned_time_sk#3328,wr_item_sk#3329,wr_refunded_customer_sk#3330,wr_refunded_cdemo_sk#3331,wr_refunded_hdemo_sk#3332,wr_refunded_addr_sk#3333,wr_returning_customer_sk#3334,wr_returning_cdemo_sk#3335,wr_returning_hdemo_sk#3336,wr_returning_addr_sk#3337,wr_web_page_sk#3338,wr_reason_sk#3339,wr_order_number#3340,wr_return_quantity#3341,wr_return_amt#3342,wr_return_tax#3343,wr_return_amt_inc_tax#3344,wr_fee#3345,wr_return_ship_cost#3346,wr_refunded_cash#3347,wr_reversed_charge#3348,wr_account_credit#3349,wr_net_loss#3350] parquet, Statistics(sizeInBytes=6.5 MiB)
                        :     :     :     +- Project [d_date_sk#18373], Statistics(sizeInBytes=105.3 KiB)
                        :     :     :        +- Filter ((isnotnull(d_date#18375) AND ((d_date#18375 >= 2000-08-23) AND (d_date#18375 <= 2000-09-22))) AND isnotnull(d_date_sk#18373)), Statistics(sizeInBytes=2.5 MiB)
                        :     :     :           +- Relation default.date_dim[d_date_sk#18373,d_date_id#18374,d_date#18375,d_month_seq#18376,d_week_seq#18377,d_quarter_seq#18378,d_year#18379,d_dow#18380,d_moy#18381,d_dom#18382,d_qoy#18383,d_fy_year#18384,d_fy_quarter_seq#18385,d_fy_week_seq#18386,d_day_name#18387,d_quarter_name#18388,d_holiday#18389,d_weekend#18390,d_following_holiday#18391,d_first_dom#18392,d_last_dom#18393,d_same_day_ly#18394,d_same_day_lq#18395,d_current_day#18396,d_current_week#18397,d_current_month#18398,d_current_quarter#18399,d_current_year#18400] parquet, Statistics(sizeInBytes=2.5 MiB)
                        :     :     +- Project [web_site_sk#3351, web_site_id#3352], Statistics(sizeInBytes=20.3 KiB)
                        :     :        +- Filter isnotnull(web_site_sk#3351), Statistics(sizeInBytes=249.1 KiB)
                        :     :           +- Relation default.web_site[web_site_sk#3351,web_site_id#3352,web_rec_start_date#3353,web_rec_end_date#3354,web_name#3355,web_open_date_sk#3356,web_close_date_sk#3357,web_class#3358,web_manager#3359,web_mkt_id#3360,web_mkt_class#3361,web_mkt_desc#3362,web_market_manager#3363,web_company_id#3364,web_company_name#3365,web_street_number#3366,web_street_name#3367,web_street_type#3368,web_suite_number#3369,web_city#3370,web_county#3371,web_state#3372,web_zip#3373,web_country#3374,web_gmt_offset#3375,web_tax_percentage#3376] parquet, Statistics(sizeInBytes=249.1 KiB)
                        :     +- Project [i_item_sk#18401], Statistics(sizeInBytes=128.3 KiB)
                        :        +- Filter ((isnotnull(i_current_price#18406) AND (i_current_price#18406 > 50.00)) AND isnotnull(i_item_sk#18401)), Statistics(sizeInBytes=3.1 MiB)
                        :           +- Relation default.item[i_item_sk#18401,i_item_id#18402,i_rec_start_date#18403,i_rec_end_date#18404,i_item_desc#18405,i_current_price#18406,i_wholesale_cost#18407,i_brand_id#18408,i_brand#18409,i_class_id#18410,i_class#18411,i_category_id#18412,i_category#18413,i_manufact_id#18414,i_manufact#18415,i_size#18416,i_formulation#18417,i_color#18418,i_units#18419,i_container#18420,i_manager_id#18421,i_product_name#18422] parquet, Statistics(sizeInBytes=3.1 MiB)
                        +- Project [p_promo_sk#18423], Statistics(sizeInBytes=23.9 KiB)
                           +- Filter ((isnotnull(p_channel_tv#18434) AND (p_channel_tv#18434 = N)) AND isnotnull(p_promo_sk#18423)), Statistics(sizeInBytes=589.4 KiB)
                              +- Relation default.promotion[p_promo_sk#18423,p_promo_id#18424,p_start_date_sk#18425,p_end_date_sk#18426,p_item_sk#18427,p_cost#18428,p_response_target#18429,p_promo_name#18430,p_channel_dmail#18431,p_channel_email#18432,p_channel_catalog#18433,p_channel_tv#18434,p_channel_radio#18435,p_channel_press#18436,p_channel_event#18437,p_channel_demo#18438,p_channel_details#18439,p_purpose#18440,p_discount_active#18441] parquet, Statistics(sizeInBytes=589.4 KiB)


==== q81 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=29.7 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=7.41E+45 B)
   +- Sort [c_customer_id#82 ASC NULLS FIRST, c_salutation#88 ASC NULLS FIRST, c_first_name#89 ASC NULLS FIRST, c_last_name#90 ASC NULLS FIRST, ca_street_number#18633 ASC NULLS FIRST, ca_street_name#18634 ASC NULLS FIRST, ca_street_type#18635 ASC NULLS FIRST, ca_suite_number#18636 ASC NULLS FIRST, ca_city#18637 ASC NULLS FIRST, ca_county#18638 ASC NULLS FIRST, ca_state#18639 ASC NULLS FIRST, ca_zip#18640 ASC NULLS FIRST, ca_country#18641 ASC NULLS FIRST, ca_gmt_offset#18642 ASC NULLS FIRST, ca_location_type#18643 ASC NULLS FIRST, ctr_total_return#18630 ASC NULLS FIRST], true, Statistics(sizeInBytes=7.41E+45 B)
      +- Project [c_customer_id#82, c_salutation#88, c_first_name#89, c_last_name#90, ca_street_number#18633, ca_street_name#18634, ca_street_type#18635, ca_suite_number#18636, ca_city#18637, ca_county#18638, ca_state#18639, ca_zip#18640, ca_country#18641, ca_gmt_offset#18642, ca_location_type#18643, ctr_total_return#18630], Statistics(sizeInBytes=7.41E+45 B)
         +- Join Inner, (ca_address_sk#18631 = c_current_addr_sk#85), Statistics(sizeInBytes=7.61E+45 B)
            :- Project [ctr_total_return#18630, c_customer_id#82, c_current_addr_sk#85, c_salutation#88, c_first_name#89, c_last_name#90], Statistics(sizeInBytes=3.21E+39 B)
            :  +- Join Inner, (ctr_customer_sk#18628 = c_customer_sk#81), Statistics(sizeInBytes=3.47E+39 B)
            :     :- Project [ctr_customer_sk#18628, ctr_total_return#18630], Statistics(sizeInBytes=9.19E+32 B)
            :     :  +- Join Inner, ((cast(ctr_total_return#18630 as decimal(24,7)) > (avg(ctr_total_return) * 1.2)#18646) AND (ctr_state#18629 = ctr_state#18629#18664)), Statistics(sizeInBytes=3.49E+33 B)
            :     :     :- Filter isnotnull(ctr_total_return#18630), Statistics(sizeInBytes=50.1 PiB)
            :     :     :  +- Aggregate [cr_returning_customer_sk#3298, ca_state#3725], [cr_returning_customer_sk#3298 AS ctr_customer_sk#18628, ca_state#3725 AS ctr_state#18629, MakeDecimal(sum(UnscaledValue(cr_return_amt_inc_tax#3311)),17,2) AS ctr_total_return#18630], Statistics(sizeInBytes=50.1 PiB)
            :     :     :     +- Project [cr_returning_customer_sk#3298, cr_return_amt_inc_tax#3311, ca_state#3725], Statistics(sizeInBytes=50.1 PiB)
            :     :     :        +- Join Inner, (cr_returning_addr_sk#3301 = ca_address_sk#3717), Statistics(sizeInBytes=60.1 PiB)
            :     :     :           :- Project [cr_returning_customer_sk#3298, cr_returning_addr_sk#3301, cr_return_amt_inc_tax#3311], Statistics(sizeInBytes=182.8 GiB)
            :     :     :           :  +- Join Inner, (cr_returned_date_sk#3291 = d_date_sk#24), Statistics(sizeInBytes=243.8 GiB)
            :     :     :           :     :- Project [cr_returned_date_sk#3291, cr_returning_customer_sk#3298, cr_returning_addr_sk#3301, cr_return_amt_inc_tax#3311], Statistics(sizeInBytes=2.3 MiB)
            :     :     :           :     :  +- Filter ((isnotnull(cr_returned_date_sk#3291) AND isnotnull(cr_returning_addr_sk#3301)) AND isnotnull(cr_returning_customer_sk#3298)), Statistics(sizeInBytes=12.6 MiB)
            :     :     :           :     :     +- Relation default.catalog_returns[cr_returned_date_sk#3291,cr_returned_time_sk#3292,cr_item_sk#3293,cr_refunded_customer_sk#3294,cr_refunded_cdemo_sk#3295,cr_refunded_hdemo_sk#3296,cr_refunded_addr_sk#3297,cr_returning_customer_sk#3298,cr_returning_cdemo_sk#3299,cr_returning_hdemo_sk#3300,cr_returning_addr_sk#3301,cr_call_center_sk#3302,cr_catalog_page_sk#3303,cr_ship_mode_sk#3304,cr_warehouse_sk#3305,cr_reason_sk#3306,cr_order_number#3307,cr_return_quantity#3308,cr_return_amount#3309,cr_return_tax#3310,cr_return_amt_inc_tax#3311,cr_fee#3312,cr_return_ship_cost#3313,cr_refunded_cash#3314,cr_reversed_charge#3315,cr_store_credit#3316,cr_net_loss#3317] parquet, Statistics(sizeInBytes=12.6 MiB)
            :     :     :           :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
            :     :     :           :        +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2000)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :     :     :           :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :     :           +- Project [ca_address_sk#3717, ca_state#3725], Statistics(sizeInBytes=336.4 KiB)
            :     :     :              +- Filter (isnotnull(ca_address_sk#3717) AND isnotnull(ca_state#3725)), Statistics(sizeInBytes=2.5 MiB)
            :     :     :                 +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :     +- Filter isnotnull((avg(ctr_total_return) * 1.2)#18646), Statistics(sizeInBytes=55.1 PiB)
            :     :        +- Aggregate [ctr_state#18629], [CheckOverflow((promote_precision(avg(ctr_total_return#18630)) * 1.200000), DecimalType(24,7)) AS (avg(ctr_total_return) * 1.2)#18646, ctr_state#18629 AS ctr_state#18629#18664], Statistics(sizeInBytes=55.1 PiB)
            :     :           +- Aggregate [cr_returning_customer_sk#3298, ca_state#3725], [ca_state#3725 AS ctr_state#18629, MakeDecimal(sum(UnscaledValue(cr_return_amt_inc_tax#3311)),17,2) AS ctr_total_return#18630], Statistics(sizeInBytes=45.0 PiB)
            :     :              +- Project [cr_returning_customer_sk#3298, cr_return_amt_inc_tax#3311, ca_state#3725], Statistics(sizeInBytes=50.1 PiB)
            :     :                 +- Join Inner, (cr_returning_addr_sk#3301 = ca_address_sk#3717), Statistics(sizeInBytes=60.1 PiB)
            :     :                    :- Project [cr_returning_customer_sk#3298, cr_returning_addr_sk#3301, cr_return_amt_inc_tax#3311], Statistics(sizeInBytes=182.8 GiB)
            :     :                    :  +- Join Inner, (cr_returned_date_sk#3291 = d_date_sk#24), Statistics(sizeInBytes=243.8 GiB)
            :     :                    :     :- Project [cr_returned_date_sk#3291, cr_returning_customer_sk#3298, cr_returning_addr_sk#3301, cr_return_amt_inc_tax#3311], Statistics(sizeInBytes=2.3 MiB)
            :     :                    :     :  +- Filter (isnotnull(cr_returned_date_sk#3291) AND isnotnull(cr_returning_addr_sk#3301)), Statistics(sizeInBytes=12.6 MiB)
            :     :                    :     :     +- Relation default.catalog_returns[cr_returned_date_sk#3291,cr_returned_time_sk#3292,cr_item_sk#3293,cr_refunded_customer_sk#3294,cr_refunded_cdemo_sk#3295,cr_refunded_hdemo_sk#3296,cr_refunded_addr_sk#3297,cr_returning_customer_sk#3298,cr_returning_cdemo_sk#3299,cr_returning_hdemo_sk#3300,cr_returning_addr_sk#3301,cr_call_center_sk#3302,cr_catalog_page_sk#3303,cr_ship_mode_sk#3304,cr_warehouse_sk#3305,cr_reason_sk#3306,cr_order_number#3307,cr_return_quantity#3308,cr_return_amount#3309,cr_return_tax#3310,cr_return_amt_inc_tax#3311,cr_fee#3312,cr_return_ship_cost#3313,cr_refunded_cash#3314,cr_reversed_charge#3315,cr_store_credit#3316,cr_net_loss#3317] parquet, Statistics(sizeInBytes=12.6 MiB)
            :     :                    :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
            :     :                    :        +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2000)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            :     :                    :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :                    +- Project [ca_address_sk#3717, ca_state#3725], Statistics(sizeInBytes=336.4 KiB)
            :     :                       +- Filter (isnotnull(ca_address_sk#3717) AND isnotnull(ca_state#3725)), Statistics(sizeInBytes=2.5 MiB)
            :     :                          +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     +- Project [c_customer_sk#81, c_customer_id#82, c_current_addr_sk#85, c_salutation#88, c_first_name#89, c_last_name#90], Statistics(sizeInBytes=3.6 MiB)
            :        +- Filter (isnotnull(c_customer_sk#81) AND isnotnull(c_current_addr_sk#85)), Statistics(sizeInBytes=7.8 MiB)
            :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
            +- Project [ca_address_sk#18631, ca_street_number#18633, ca_street_name#18634, ca_street_type#18635, ca_suite_number#18636, ca_city#18637, ca_county#18638, ca_state#18639, ca_zip#18640, ca_country#18641, ca_gmt_offset#18642, ca_location_type#18643], Statistics(sizeInBytes=2.3 MiB)
               +- Filter ((isnotnull(ca_state#18639) AND (ca_state#18639 = GA)) AND isnotnull(ca_address_sk#18631)), Statistics(sizeInBytes=2.5 MiB)
                  +- Relation default.customer_address[ca_address_sk#18631,ca_address_id#18632,ca_street_number#18633,ca_street_name#18634,ca_street_type#18635,ca_suite_number#18636,ca_city#18637,ca_county#18638,ca_state#18639,ca_zip#18640,ca_country#18641,ca_gmt_offset#18642,ca_location_type#18643] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q82 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=5.5 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.65E+25 B)
   +- Sort [i_item_id#438 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.65E+25 B)
      +- Aggregate [i_item_id#438, i_item_desc#441, i_current_price#442], [i_item_id#438, i_item_desc#441, i_current_price#442], Statistics(sizeInBytes=1.65E+25 B)
         +- Project [i_item_id#438, i_item_desc#441, i_current_price#442], Statistics(sizeInBytes=1.65E+25 B)
            +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=1.88E+25 B)
               :- Project [i_item_sk#437, i_item_id#438, i_item_desc#441, i_current_price#442], Statistics(sizeInBytes=1394.8 PiB)
               :  +- Join Inner, (d_date_sk#24 = inv_date_sk#8005), Statistics(sizeInBytes=1580.8 PiB)
               :     :- Project [i_item_sk#437, i_item_id#438, i_item_desc#441, i_current_price#442, inv_date_sk#8005], Statistics(sizeInBytes=15.0 TiB)
               :     :  +- Join Inner, (inv_item_sk#8006 = i_item_sk#437), Statistics(sizeInBytes=15.9 TiB)
               :     :     :- Project [i_item_sk#437, i_item_id#438, i_item_desc#441, i_current_price#442], Statistics(sizeInBytes=641.8 KiB)
               :     :     :  +- Filter ((isnotnull(i_current_price#442) AND (((i_current_price#442 >= 62.00) AND (i_current_price#442 <= 92.00)) AND i_manufact_id#450 IN (129,270,821,423))) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
               :     :     :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
               :     :     +- Project [inv_date_sk#8005, inv_item_sk#8006], Statistics(sizeInBytes=25.4 MiB)
               :     :        +- Filter ((isnotnull(inv_quantity_on_hand#8008) AND ((inv_quantity_on_hand#8008 >= 100) AND (inv_quantity_on_hand#8008 <= 500))) AND (isnotnull(inv_item_sk#8006) AND isnotnull(inv_date_sk#8005))), Statistics(sizeInBytes=38.2 MiB)
               :     :           +- Relation default.inventory[inv_date_sk#8005,inv_item_sk#8006,inv_warehouse_sk#8007,inv_quantity_on_hand#8008] parquet, Statistics(sizeInBytes=38.2 MiB)
               :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :        +- Filter ((isnotnull(d_date#26) AND ((d_date#26 >= 2000-05-25) AND (d_date#26 <= 2000-07-24))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               +- Project [ss_item_sk#416], Statistics(sizeInBytes=11.4 MiB)
                  +- Filter isnotnull(ss_item_sk#416), Statistics(sizeInBytes=141.1 MiB)
                     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)


==== q83 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=9.0 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.03E+50 B)
   +- Sort [item_id#18714 ASC NULLS FIRST, sr_item_qty#18715L ASC NULLS FIRST], true, Statistics(sizeInBytes=1.03E+50 B)
      +- Project [item_id#18714, sr_item_qty#18715L, (((cast(sr_item_qty#18715L as double) / cast(((sr_item_qty#18715L + cr_item_qty#18719L) + wr_item_qty#18723L) as double)) / 3.0) * 100.0) AS sr_dev#18710, cr_item_qty#18719L, (((cast(cr_item_qty#18719L as double) / cast(((sr_item_qty#18715L + cr_item_qty#18719L) + wr_item_qty#18723L) as double)) / 3.0) * 100.0) AS cr_dev#18711, wr_item_qty#18723L, (((cast(wr_item_qty#18723L as double) / cast(((sr_item_qty#18715L + cr_item_qty#18719L) + wr_item_qty#18723L) as double)) / 3.0) * 100.0) AS wr_dev#18712, CheckOverflow((promote_precision(cast(((sr_item_qty#18715L + cr_item_qty#18719L) + wr_item_qty#18723L) as decimal(21,1))) / 3.0), DecimalType(27,6)) AS average#18713], Statistics(sizeInBytes=1.03E+50 B)
         +- Join Inner, (item_id#18714 = item_id#18722), Statistics(sizeInBytes=8.05E+49 B)
            :- Project [item_id#18714, sr_item_qty#18715L, cr_item_qty#18719L], Statistics(sizeInBytes=2.97E+33 B)
            :  +- Join Inner, (item_id#18714 = item_id#18718), Statistics(sizeInBytes=4.32E+33 B)
            :     :- Aggregate [i_item_id#438], [i_item_id#438 AS item_id#18714, sum(sr_return_quantity#14) AS sr_item_qty#18715L], Statistics(sizeInBytes=79.5 PiB)
            :     :  +- Project [sr_return_quantity#14, i_item_id#438], Statistics(sizeInBytes=70.7 PiB)
            :     :     +- Join Inner, (sr_returned_date_sk#4 = d_date_sk#24), Statistics(sizeInBytes=88.4 PiB)
            :     :        :- Project [sr_returned_date_sk#4, sr_return_quantity#14, i_item_id#438], Statistics(sizeInBytes=859.4 GiB)
            :     :        :  +- Join Inner, (sr_item_sk#6 = i_item_sk#437), Statistics(sizeInBytes=1050.4 GiB)
            :     :        :     :- Project [sr_returned_date_sk#4, sr_item_sk#6, sr_return_quantity#14], Statistics(sizeInBytes=3.1 MiB)
            :     :        :     :  +- Filter (isnotnull(sr_item_sk#6) AND isnotnull(sr_returned_date_sk#4)), Statistics(sizeInBytes=19.0 MiB)
            :     :        :     :     +- Relation default.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet, Statistics(sizeInBytes=19.0 MiB)
            :     :        :     +- Project [i_item_sk#437, i_item_id#438], Statistics(sizeInBytes=342.3 KiB)
            :     :        :        +- Filter (isnotnull(i_item_sk#437) AND isnotnull(i_item_id#438)), Statistics(sizeInBytes=3.1 MiB)
            :     :        :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
            :     :        +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
            :     :           +- Join LeftSemi, (d_date#26 = d_date#18916), Statistics(sizeInBytes=140.4 KiB)
            :     :              :- Project [d_date_sk#24, d_date#26], Statistics(sizeInBytes=140.4 KiB)
            :     :              :  +- Filter isnotnull(d_date_sk#24), Statistics(sizeInBytes=2.5 MiB)
            :     :              :     +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :              +- Project [d_date#18916], Statistics(sizeInBytes=105.3 KiB)
            :     :                 +- Join LeftSemi, (d_week_seq#18918 = d_week_seq#18830), Statistics(sizeInBytes=140.4 KiB)
            :     :                    :- Project [d_date#18916, d_week_seq#18918], Statistics(sizeInBytes=140.4 KiB)
            :     :                    :  +- Relation default.date_dim[d_date_sk#18914,d_date_id#18915,d_date#18916,d_month_seq#18917,d_week_seq#18918,d_quarter_seq#18919,d_year#18920,d_dow#18921,d_moy#18922,d_dom#18923,d_qoy#18924,d_fy_year#18925,d_fy_quarter_seq#18926,d_fy_week_seq#18927,d_day_name#18928,d_quarter_name#18929,d_holiday#18930,d_weekend#18931,d_following_holiday#18932,d_first_dom#18933,d_last_dom#18934,d_same_day_ly#18935,d_same_day_lq#18936,d_current_day#18937,d_current_week#18938,d_current_month#18939,d_current_quarter#18940,d_current_year#18941] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     :                    +- Project [d_week_seq#18830], Statistics(sizeInBytes=105.3 KiB)
            :     :                       +- Filter cast(d_date#18828 as string) IN (2000-06-30,2000-09-27,2000-11-17), Statistics(sizeInBytes=2.5 MiB)
            :     :                          +- Relation default.date_dim[d_date_sk#18826,d_date_id#18827,d_date#18828,d_month_seq#18829,d_week_seq#18830,d_quarter_seq#18831,d_year#18832,d_dow#18833,d_moy#18834,d_dom#18835,d_qoy#18836,d_fy_year#18837,d_fy_quarter_seq#18838,d_fy_week_seq#18839,d_day_name#18840,d_quarter_name#18841,d_holiday#18842,d_weekend#18843,d_following_holiday#18844,d_first_dom#18845,d_last_dom#18846,d_same_day_ly#18847,d_same_day_lq#18848,d_current_day#18849,d_current_week#18850,d_current_month#18851,d_current_quarter#18852,d_current_year#18853] parquet, Statistics(sizeInBytes=2.5 MiB)
            :     +- Aggregate [i_item_id#18727], [i_item_id#18727 AS item_id#18718, sum(cr_return_quantity#3308) AS cr_item_qty#18719L], Statistics(sizeInBytes=42.9 PiB)
            :        +- Project [cr_return_quantity#3308, i_item_id#18727], Statistics(sizeInBytes=38.1 PiB)
            :           +- Join Inner, (cr_returned_date_sk#3291 = d_date_sk#18748), Statistics(sizeInBytes=47.6 PiB)
            :              :- Project [cr_returned_date_sk#3291, cr_return_quantity#3308, i_item_id#18727], Statistics(sizeInBytes=463.0 GiB)
            :              :  +- Join Inner, (cr_item_sk#3293 = i_item_sk#18726), Statistics(sizeInBytes=565.9 GiB)
            :              :     :- Project [cr_returned_date_sk#3291, cr_item_sk#3293, cr_return_quantity#3308], Statistics(sizeInBytes=1693.1 KiB)
            :              :     :  +- Filter (isnotnull(cr_item_sk#3293) AND isnotnull(cr_returned_date_sk#3291)), Statistics(sizeInBytes=12.6 MiB)
            :              :     :     +- Relation default.catalog_returns[cr_returned_date_sk#3291,cr_returned_time_sk#3292,cr_item_sk#3293,cr_refunded_customer_sk#3294,cr_refunded_cdemo_sk#3295,cr_refunded_hdemo_sk#3296,cr_refunded_addr_sk#3297,cr_returning_customer_sk#3298,cr_returning_cdemo_sk#3299,cr_returning_hdemo_sk#3300,cr_returning_addr_sk#3301,cr_call_center_sk#3302,cr_catalog_page_sk#3303,cr_ship_mode_sk#3304,cr_warehouse_sk#3305,cr_reason_sk#3306,cr_order_number#3307,cr_return_quantity#3308,cr_return_amount#3309,cr_return_tax#3310,cr_return_amt_inc_tax#3311,cr_fee#3312,cr_return_ship_cost#3313,cr_refunded_cash#3314,cr_reversed_charge#3315,cr_store_credit#3316,cr_net_loss#3317] parquet, Statistics(sizeInBytes=12.6 MiB)
            :              :     +- Project [i_item_sk#18726, i_item_id#18727], Statistics(sizeInBytes=342.3 KiB)
            :              :        +- Filter (isnotnull(i_item_sk#18726) AND isnotnull(i_item_id#18727)), Statistics(sizeInBytes=3.1 MiB)
            :              :           +- Relation default.item[i_item_sk#18726,i_item_id#18727,i_rec_start_date#18728,i_rec_end_date#18729,i_item_desc#18730,i_current_price#18731,i_wholesale_cost#18732,i_brand_id#18733,i_brand#18734,i_class_id#18735,i_class#18736,i_category_id#18737,i_category#18738,i_manufact_id#18739,i_manufact#18740,i_size#18741,i_formulation#18742,i_color#18743,i_units#18744,i_container#18745,i_manager_id#18746,i_product_name#18747] parquet, Statistics(sizeInBytes=3.1 MiB)
            :              +- Project [d_date_sk#18748], Statistics(sizeInBytes=105.3 KiB)
            :                 +- Join LeftSemi, (d_date#18750 = d_date#18944), Statistics(sizeInBytes=140.4 KiB)
            :                    :- Project [d_date_sk#18748, d_date#18750], Statistics(sizeInBytes=140.4 KiB)
            :                    :  +- Filter isnotnull(d_date_sk#18748), Statistics(sizeInBytes=2.5 MiB)
            :                    :     +- Relation default.date_dim[d_date_sk#18748,d_date_id#18749,d_date#18750,d_month_seq#18751,d_week_seq#18752,d_quarter_seq#18753,d_year#18754,d_dow#18755,d_moy#18756,d_dom#18757,d_qoy#18758,d_fy_year#18759,d_fy_quarter_seq#18760,d_fy_week_seq#18761,d_day_name#18762,d_quarter_name#18763,d_holiday#18764,d_weekend#18765,d_following_holiday#18766,d_first_dom#18767,d_last_dom#18768,d_same_day_ly#18769,d_same_day_lq#18770,d_current_day#18771,d_current_week#18772,d_current_month#18773,d_current_quarter#18774,d_current_year#18775] parquet, Statistics(sizeInBytes=2.5 MiB)
            :                    +- Project [d_date#18944], Statistics(sizeInBytes=105.3 KiB)
            :                       +- Join LeftSemi, (d_week_seq#18946 = d_week_seq#18858), Statistics(sizeInBytes=140.4 KiB)
            :                          :- Project [d_date#18944, d_week_seq#18946], Statistics(sizeInBytes=140.4 KiB)
            :                          :  +- Relation default.date_dim[d_date_sk#18942,d_date_id#18943,d_date#18944,d_month_seq#18945,d_week_seq#18946,d_quarter_seq#18947,d_year#18948,d_dow#18949,d_moy#18950,d_dom#18951,d_qoy#18952,d_fy_year#18953,d_fy_quarter_seq#18954,d_fy_week_seq#18955,d_day_name#18956,d_quarter_name#18957,d_holiday#18958,d_weekend#18959,d_following_holiday#18960,d_first_dom#18961,d_last_dom#18962,d_same_day_ly#18963,d_same_day_lq#18964,d_current_day#18965,d_current_week#18966,d_current_month#18967,d_current_quarter#18968,d_current_year#18969] parquet, Statistics(sizeInBytes=2.5 MiB)
            :                          +- Project [d_week_seq#18858], Statistics(sizeInBytes=105.3 KiB)
            :                             +- Filter cast(d_date#18856 as string) IN (2000-06-30,2000-09-27,2000-11-17), Statistics(sizeInBytes=2.5 MiB)
            :                                +- Relation default.date_dim[d_date_sk#18854,d_date_id#18855,d_date#18856,d_month_seq#18857,d_week_seq#18858,d_quarter_seq#18859,d_year#18860,d_dow#18861,d_moy#18862,d_dom#18863,d_qoy#18864,d_fy_year#18865,d_fy_quarter_seq#18866,d_fy_week_seq#18867,d_day_name#18868,d_quarter_name#18869,d_holiday#18870,d_weekend#18871,d_following_holiday#18872,d_first_dom#18873,d_last_dom#18874,d_same_day_ly#18875,d_same_day_lq#18876,d_current_day#18877,d_current_week#18878,d_current_month#18879,d_current_quarter#18880,d_current_year#18881] parquet, Statistics(sizeInBytes=2.5 MiB)
            +- Aggregate [i_item_id#18777], [i_item_id#18777 AS item_id#18722, sum(wr_return_quantity#3341) AS wr_item_qty#18723L], Statistics(sizeInBytes=24.1 PiB)
               +- Project [wr_return_quantity#3341, i_item_id#18777], Statistics(sizeInBytes=21.4 PiB)
                  +- Join Inner, (wr_returned_date_sk#3327 = d_date_sk#18798), Statistics(sizeInBytes=26.7 PiB)
                     :- Project [wr_returned_date_sk#3327, wr_return_quantity#3341, i_item_id#18777], Statistics(sizeInBytes=260.0 GiB)
                     :  +- Join Inner, (wr_item_sk#3329 = i_item_sk#18776), Statistics(sizeInBytes=317.8 GiB)
                     :     :- Project [wr_returned_date_sk#3327, wr_item_sk#3329, wr_return_quantity#3341], Statistics(sizeInBytes=950.8 KiB)
                     :     :  +- Filter (isnotnull(wr_item_sk#3329) AND isnotnull(wr_returned_date_sk#3327)), Statistics(sizeInBytes=6.5 MiB)
                     :     :     +- Relation default.web_returns[wr_returned_date_sk#3327,wr_returned_time_sk#3328,wr_item_sk#3329,wr_refunded_customer_sk#3330,wr_refunded_cdemo_sk#3331,wr_refunded_hdemo_sk#3332,wr_refunded_addr_sk#3333,wr_returning_customer_sk#3334,wr_returning_cdemo_sk#3335,wr_returning_hdemo_sk#3336,wr_returning_addr_sk#3337,wr_web_page_sk#3338,wr_reason_sk#3339,wr_order_number#3340,wr_return_quantity#3341,wr_return_amt#3342,wr_return_tax#3343,wr_return_amt_inc_tax#3344,wr_fee#3345,wr_return_ship_cost#3346,wr_refunded_cash#3347,wr_reversed_charge#3348,wr_account_credit#3349,wr_net_loss#3350] parquet, Statistics(sizeInBytes=6.5 MiB)
                     :     +- Project [i_item_sk#18776, i_item_id#18777], Statistics(sizeInBytes=342.3 KiB)
                     :        +- Filter (isnotnull(i_item_sk#18776) AND isnotnull(i_item_id#18777)), Statistics(sizeInBytes=3.1 MiB)
                     :           +- Relation default.item[i_item_sk#18776,i_item_id#18777,i_rec_start_date#18778,i_rec_end_date#18779,i_item_desc#18780,i_current_price#18781,i_wholesale_cost#18782,i_brand_id#18783,i_brand#18784,i_class_id#18785,i_class#18786,i_category_id#18787,i_category#18788,i_manufact_id#18789,i_manufact#18790,i_size#18791,i_formulation#18792,i_color#18793,i_units#18794,i_container#18795,i_manager_id#18796,i_product_name#18797] parquet, Statistics(sizeInBytes=3.1 MiB)
                     +- Project [d_date_sk#18798], Statistics(sizeInBytes=105.3 KiB)
                        +- Join LeftSemi, (d_date#18800 = d_date#18972), Statistics(sizeInBytes=140.4 KiB)
                           :- Project [d_date_sk#18798, d_date#18800], Statistics(sizeInBytes=140.4 KiB)
                           :  +- Filter isnotnull(d_date_sk#18798), Statistics(sizeInBytes=2.5 MiB)
                           :     +- Relation default.date_dim[d_date_sk#18798,d_date_id#18799,d_date#18800,d_month_seq#18801,d_week_seq#18802,d_quarter_seq#18803,d_year#18804,d_dow#18805,d_moy#18806,d_dom#18807,d_qoy#18808,d_fy_year#18809,d_fy_quarter_seq#18810,d_fy_week_seq#18811,d_day_name#18812,d_quarter_name#18813,d_holiday#18814,d_weekend#18815,d_following_holiday#18816,d_first_dom#18817,d_last_dom#18818,d_same_day_ly#18819,d_same_day_lq#18820,d_current_day#18821,d_current_week#18822,d_current_month#18823,d_current_quarter#18824,d_current_year#18825] parquet, Statistics(sizeInBytes=2.5 MiB)
                           +- Project [d_date#18972], Statistics(sizeInBytes=105.3 KiB)
                              +- Join LeftSemi, (d_week_seq#18974 = d_week_seq#18886), Statistics(sizeInBytes=140.4 KiB)
                                 :- Project [d_date#18972, d_week_seq#18974], Statistics(sizeInBytes=140.4 KiB)
                                 :  +- Relation default.date_dim[d_date_sk#18970,d_date_id#18971,d_date#18972,d_month_seq#18973,d_week_seq#18974,d_quarter_seq#18975,d_year#18976,d_dow#18977,d_moy#18978,d_dom#18979,d_qoy#18980,d_fy_year#18981,d_fy_quarter_seq#18982,d_fy_week_seq#18983,d_day_name#18984,d_quarter_name#18985,d_holiday#18986,d_weekend#18987,d_following_holiday#18988,d_first_dom#18989,d_last_dom#18990,d_same_day_ly#18991,d_same_day_lq#18992,d_current_day#18993,d_current_week#18994,d_current_month#18995,d_current_quarter#18996,d_current_year#18997] parquet, Statistics(sizeInBytes=2.5 MiB)
                                 +- Project [d_week_seq#18886], Statistics(sizeInBytes=105.3 KiB)
                                    +- Filter cast(d_date#18884 as string) IN (2000-06-30,2000-09-27,2000-11-17), Statistics(sizeInBytes=2.5 MiB)
                                       +- Relation default.date_dim[d_date_sk#18882,d_date_id#18883,d_date#18884,d_month_seq#18885,d_week_seq#18886,d_quarter_seq#18887,d_year#18888,d_dow#18889,d_moy#18890,d_dom#18891,d_qoy#18892,d_fy_year#18893,d_fy_quarter_seq#18894,d_fy_week_seq#18895,d_day_name#18896,d_quarter_name#18897,d_holiday#18898,d_weekend#18899,d_following_holiday#18900,d_first_dom#18901,d_last_dom#18902,d_same_day_ly#18903,d_same_day_lq#18904,d_current_day#18905,d_current_week#18906,d_current_month#18907,d_current_quarter#18908,d_current_year#18909] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q84 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=4.7 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=2.99E+32 B)
   +- Project [customer_id#19040, customername#19041], Statistics(sizeInBytes=2.99E+32 B)
      +- Sort [c_customer_id#82 ASC NULLS FIRST], true, Statistics(sizeInBytes=4.23E+32 B)
         +- Project [c_customer_id#82 AS customer_id#19040, concat(c_last_name#90, , , c_first_name#89) AS customername#19041, c_customer_id#82], Statistics(sizeInBytes=4.23E+32 B)
            +- Join Inner, (sr_cdemo_sk#8 = cd_demo_sk#3633), Statistics(sizeInBytes=4.73E+32 B)
               :- Project [c_customer_id#82, c_first_name#89, c_last_name#90, cd_demo_sk#3633], Statistics(sizeInBytes=2.45E+26 B)
               :  +- Join Inner, (ib_income_band_sk#19042 = hd_income_band_sk#5552), Statistics(sizeInBytes=2.72E+26 B)
               :     :- Project [c_customer_id#82, c_first_name#89, c_last_name#90, cd_demo_sk#3633, hd_income_band_sk#5552], Statistics(sizeInBytes=2.25E+22 B)
               :     :  +- Join Inner, (hd_demo_sk#5551 = c_current_hdemo_sk#84), Statistics(sizeInBytes=2.49E+22 B)
               :     :     :- Project [c_customer_id#82, c_current_hdemo_sk#84, c_first_name#89, c_last_name#90, cd_demo_sk#3633], Statistics(sizeInBytes=279.0 PiB)
               :     :     :  +- Join Inner, (cd_demo_sk#3633 = c_current_cdemo_sk#83), Statistics(sizeInBytes=293.7 PiB)
               :     :     :     :- Project [c_customer_id#82, c_current_cdemo_sk#83, c_current_hdemo_sk#84, c_first_name#89, c_last_name#90], Statistics(sizeInBytes=342.3 GiB)
               :     :     :     :  +- Join Inner, (c_current_addr_sk#85 = ca_address_sk#3717), Statistics(sizeInBytes=378.4 GiB)
               :     :     :     :     :- Project [c_customer_id#82, c_current_cdemo_sk#83, c_current_hdemo_sk#84, c_current_addr_sk#85, c_first_name#89, c_last_name#90], Statistics(sizeInBytes=3.0 MiB)
               :     :     :     :     :  +- Filter (isnotnull(c_current_addr_sk#85) AND (isnotnull(c_current_cdemo_sk#83) AND isnotnull(c_current_hdemo_sk#84))), Statistics(sizeInBytes=7.8 MiB)
               :     :     :     :     :     +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
               :     :     :     :     +- Project [ca_address_sk#3717], Statistics(sizeInBytes=126.2 KiB)
               :     :     :     :        +- Filter ((isnotnull(ca_city#3723) AND (ca_city#3723 = Edgewood)) AND isnotnull(ca_address_sk#3717)), Statistics(sizeInBytes=2.5 MiB)
               :     :     :     :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     :     :     +- Project [cd_demo_sk#3633], Statistics(sizeInBytes=878.6 KiB)
               :     :     :        +- Filter isnotnull(cd_demo_sk#3633), Statistics(sizeInBytes=7.7 MiB)
               :     :     :           +- Relation default.customer_demographics[cd_demo_sk#3633,cd_gender#3634,cd_marital_status#3635,cd_education_status#3636,cd_purchase_estimate#3637,cd_credit_rating#3638,cd_dep_count#3639,cd_dep_employed_count#3640,cd_dep_college_count#3641] parquet, Statistics(sizeInBytes=7.7 MiB)
               :     :     +- Project [hd_demo_sk#5551, hd_income_band_sk#5552], Statistics(sizeInBytes=77.4 KiB)
               :     :        +- Filter (isnotnull(hd_demo_sk#5551) AND isnotnull(hd_income_band_sk#5552)), Statistics(sizeInBytes=212.8 KiB)
               :     :           +- Relation default.household_demographics[hd_demo_sk#5551,hd_income_band_sk#5552,hd_buy_potential#5553,hd_dep_count#5554,hd_vehicle_count#5555] parquet, Statistics(sizeInBytes=212.8 KiB)
               :     +- Project [ib_income_band_sk#19042], Statistics(sizeInBytes=11.8 KiB)
               :        +- Filter (((isnotnull(ib_lower_bound#19043) AND isnotnull(ib_upper_bound#19044)) AND ((ib_lower_bound#19043 >= 38128) AND (ib_upper_bound#19044 <= 88128))) AND isnotnull(ib_income_band_sk#19042)), Statistics(sizeInBytes=19.7 KiB)
               :           +- Relation default.income_band[ib_income_band_sk#19042,ib_lower_bound#19043,ib_upper_bound#19044] parquet, Statistics(sizeInBytes=19.7 KiB)
               +- Project [sr_cdemo_sk#8], Statistics(sizeInBytes=1885.5 KiB)
                  +- Filter isnotnull(sr_cdemo_sk#8), Statistics(sizeInBytes=19.0 MiB)
                     +- Relation default.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet, Statistics(sizeInBytes=19.0 MiB)


==== q85 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=5.1 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=1.02E+45 B)
   +- Sort [substr(r_reason_desc, 1, 20)#19061 ASC NULLS FIRST, avg(ws_quantity)#19062 ASC NULLS FIRST, avg(wr_refunded_cash)#19063 ASC NULLS FIRST, avg(wr_fee)#19064 ASC NULLS FIRST], true, Statistics(sizeInBytes=1.02E+45 B)
      +- Aggregate [r_reason_desc#3782], [substr(r_reason_desc#3782, 1, 20) AS substr(r_reason_desc, 1, 20)#19061, avg(ws_quantity#181) AS avg(ws_quantity)#19062, cast((avg(UnscaledValue(wr_refunded_cash#3347)) / 100.0) as decimal(11,6)) AS avg(wr_refunded_cash)#19063, cast((avg(UnscaledValue(wr_fee#3345)) / 100.0) as decimal(11,6)) AS avg(wr_fee)#19064], Statistics(sizeInBytes=1.02E+45 B)
         +- Project [ws_quantity#181, wr_fee#3345, wr_refunded_cash#3347, r_reason_desc#3782], Statistics(sizeInBytes=9.45E+44 B)
            +- Join Inner, (r_reason_sk#3780 = wr_reason_sk#3339), Statistics(sizeInBytes=1.10E+45 B)
               :- Project [ws_quantity#181, wr_reason_sk#3339, wr_fee#3345, wr_refunded_cash#3347], Statistics(sizeInBytes=3.19E+40 B)
               :  +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#24), Statistics(sizeInBytes=3.98E+40 B)
               :     :- Project [ws_sold_date_sk#163, ws_quantity#181, wr_reason_sk#3339, wr_fee#3345, wr_refunded_cash#3347], Statistics(sizeInBytes=3.69E+35 B)
               :     :  +- Join Inner, ((ca_address_sk#3717 = wr_refunded_addr_sk#3333) AND ((((ca_state#3725 IN (IN,OH,NJ) AND (ws_net_profit#196 >= 100.00)) AND (ws_net_profit#196 <= 200.00)) OR ((ca_state#3725 IN (WI,CT,KY) AND (ws_net_profit#196 >= 150.00)) AND (ws_net_profit#196 <= 300.00))) OR ((ca_state#3725 IN (LA,IA,AR) AND (ws_net_profit#196 >= 50.00)) AND (ws_net_profit#196 <= 250.00)))), Statistics(sizeInBytes=7.39E+35 B)
               :     :     :- Project [ws_sold_date_sk#163, ws_quantity#181, ws_net_profit#196, wr_refunded_addr_sk#3333, wr_reason_sk#3339, wr_fee#3345, wr_refunded_cash#3347], Statistics(sizeInBytes=2.14E+30 B)
               :     :     :  +- Join Inner, (((cd_demo_sk#19048 = wr_returning_cdemo_sk#3335) AND (cd_marital_status#3635 = cd_marital_status#19050)) AND (cd_education_status#3636 = cd_education_status#19051)), Statistics(sizeInBytes=6.08E+30 B)
               :     :     :     :- Project [ws_sold_date_sk#163, ws_quantity#181, ws_net_profit#196, wr_refunded_addr_sk#3333, wr_returning_cdemo_sk#3335, wr_reason_sk#3339, wr_fee#3345, wr_refunded_cash#3347, cd_marital_status#3635, cd_education_status#3636], Statistics(sizeInBytes=1.56E+24 B)
               :     :     :     :  +- Join Inner, (((((((cd_marital_status#3635 = M) AND (cd_education_status#3636 = Advanced Degree     )) AND (ws_sales_price#184 >= 100.00)) AND (ws_sales_price#184 <= 150.00)) OR ((((cd_marital_status#3635 = S) AND (cd_education_status#3636 = College             )) AND (ws_sales_price#184 >= 50.00)) AND (ws_sales_price#184 <= 100.00))) OR ((((cd_marital_status#3635 = W) AND (cd_education_status#3636 = 2 yr Degree         )) AND (ws_sales_price#184 >= 150.00)) AND (ws_sales_price#184 <= 200.00))) AND (cd_demo_sk#3633 = wr_refunded_cdemo_sk#3331)), Statistics(sizeInBytes=1.83E+24 B)
               :     :     :     :     :- Project [ws_sold_date_sk#163, ws_quantity#181, ws_sales_price#184, ws_net_profit#196, wr_refunded_cdemo_sk#3331, wr_refunded_addr_sk#3333, wr_returning_cdemo_sk#3335, wr_reason_sk#3339, wr_fee#3345, wr_refunded_cash#3347], Statistics(sizeInBytes=416.8 PiB)
               :     :     :     :     :  +- Join Inner, (ws_web_page_sk#175 = wp_web_page_sk#17839), Statistics(sizeInBytes=468.9 PiB)
               :     :     :     :     :     :- Project [ws_sold_date_sk#163, ws_web_page_sk#175, ws_quantity#181, ws_sales_price#184, ws_net_profit#196, wr_refunded_cdemo_sk#3331, wr_refunded_addr_sk#3333, wr_returning_cdemo_sk#3335, wr_reason_sk#3339, wr_fee#3345, wr_refunded_cash#3347], Statistics(sizeInBytes=20.2 TiB)
               :     :     :     :     :     :  +- Join Inner, ((ws_item_sk#166 = wr_item_sk#3329) AND (ws_order_number#180 = wr_order_number#3340)), Statistics(sizeInBytes=25.0 TiB)
               :     :     :     :     :     :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_web_page_sk#175, ws_order_number#180, ws_quantity#181, ws_sales_price#184, ws_net_profit#196], Statistics(sizeInBytes=11.2 MiB)
               :     :     :     :     :     :     :  +- Filter ((((isnotnull(ws_item_sk#166) AND isnotnull(ws_order_number#180)) AND isnotnull(ws_web_page_sk#175)) AND isnotnull(ws_sold_date_sk#163)) AND (((((ws_sales_price#184 >= 100.00) AND (ws_sales_price#184 <= 150.00)) OR ((ws_sales_price#184 >= 50.00) AND (ws_sales_price#184 <= 100.00))) OR ((ws_sales_price#184 >= 150.00) AND (ws_sales_price#184 <= 200.00))) AND ((((ws_net_profit#196 >= 100.00) AND (ws_net_profit#196 <= 200.00)) OR ((ws_net_profit#196 >= 150.00) AND (ws_net_profit#196 <= 300.00))) OR ((ws_net_profit#196 >= 50.00) AND (ws_net_profit#196 <= 250.00))))), Statistics(sizeInBytes=52.0 MiB)
               :     :     :     :     :     :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
               :     :     :     :     :     :     +- Project [wr_item_sk#3329, wr_refunded_cdemo_sk#3331, wr_refunded_addr_sk#3333, wr_returning_cdemo_sk#3335, wr_reason_sk#3339, wr_order_number#3340, wr_fee#3345, wr_refunded_cash#3347], Statistics(sizeInBytes=2.2 MiB)
               :     :     :     :     :     :        +- Filter (((isnotnull(wr_item_sk#3329) AND isnotnull(wr_order_number#3340)) AND isnotnull(wr_refunded_cdemo_sk#3331)) AND ((isnotnull(wr_returning_cdemo_sk#3335) AND isnotnull(wr_refunded_addr_sk#3333)) AND isnotnull(wr_reason_sk#3339))), Statistics(sizeInBytes=6.5 MiB)
               :     :     :     :     :     :           +- Relation default.web_returns[wr_returned_date_sk#3327,wr_returned_time_sk#3328,wr_item_sk#3329,wr_refunded_customer_sk#3330,wr_refunded_cdemo_sk#3331,wr_refunded_hdemo_sk#3332,wr_refunded_addr_sk#3333,wr_returning_customer_sk#3334,wr_returning_cdemo_sk#3335,wr_returning_hdemo_sk#3336,wr_returning_addr_sk#3337,wr_web_page_sk#3338,wr_reason_sk#3339,wr_order_number#3340,wr_return_quantity#3341,wr_return_amt#3342,wr_return_tax#3343,wr_return_amt_inc_tax#3344,wr_fee#3345,wr_return_ship_cost#3346,wr_refunded_cash#3347,wr_reversed_charge#3348,wr_account_credit#3349,wr_net_loss#3350] parquet, Statistics(sizeInBytes=6.5 MiB)
               :     :     :     :     :     +- Project [wp_web_page_sk#17839], Statistics(sizeInBytes=23.2 KiB)
               :     :     :     :     :        +- Filter isnotnull(wp_web_page_sk#17839), Statistics(sizeInBytes=247.3 KiB)
               :     :     :     :     :           +- Relation default.web_page[wp_web_page_sk#17839,wp_web_page_id#17840,wp_rec_start_date#17841,wp_rec_end_date#17842,wp_creation_date_sk#17843,wp_access_date_sk#17844,wp_autogen_flag#17845,wp_customer_sk#17846,wp_url#17847,wp_type#17848,wp_char_count#17849,wp_link_count#17850,wp_image_count#17851,wp_max_ad_count#17852] parquet, Statistics(sizeInBytes=247.3 KiB)
               :     :     :     :     +- Project [cd_demo_sk#3633, cd_marital_status#3635, cd_education_status#3636], Statistics(sizeInBytes=3.7 MiB)
               :     :     :     :        +- Filter ((isnotnull(cd_demo_sk#3633) AND (isnotnull(cd_marital_status#3635) AND isnotnull(cd_education_status#3636))) AND ((((cd_marital_status#3635 = M) AND (cd_education_status#3636 = Advanced Degree     )) OR ((cd_marital_status#3635 = S) AND (cd_education_status#3636 = College             ))) OR ((cd_marital_status#3635 = W) AND (cd_education_status#3636 = 2 yr Degree         )))), Statistics(sizeInBytes=7.7 MiB)
               :     :     :     :           +- Relation default.customer_demographics[cd_demo_sk#3633,cd_gender#3634,cd_marital_status#3635,cd_education_status#3636,cd_purchase_estimate#3637,cd_credit_rating#3638,cd_dep_count#3639,cd_dep_employed_count#3640,cd_dep_college_count#3641] parquet, Statistics(sizeInBytes=7.7 MiB)
               :     :     :     +- Project [cd_demo_sk#19048, cd_marital_status#19050, cd_education_status#19051], Statistics(sizeInBytes=3.7 MiB)
               :     :     :        +- Filter ((isnotnull(cd_demo_sk#19048) AND isnotnull(cd_marital_status#19050)) AND isnotnull(cd_education_status#19051)), Statistics(sizeInBytes=7.7 MiB)
               :     :     :           +- Relation default.customer_demographics[cd_demo_sk#19048,cd_gender#19049,cd_marital_status#19050,cd_education_status#19051,cd_purchase_estimate#19052,cd_credit_rating#19053,cd_dep_count#19054,cd_dep_employed_count#19055,cd_dep_college_count#19056] parquet, Statistics(sizeInBytes=7.7 MiB)
               :     :     +- Project [ca_address_sk#3717, ca_state#3725], Statistics(sizeInBytes=336.4 KiB)
               :     :        +- Filter (((isnotnull(ca_country#3727) AND (ca_country#3727 = United States)) AND isnotnull(ca_address_sk#3717)) AND ((ca_state#3725 IN (IN,OH,NJ) OR ca_state#3725 IN (WI,CT,KY)) OR ca_state#3725 IN (LA,IA,AR))), Statistics(sizeInBytes=2.5 MiB)
               :     :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
               :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
               :        +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2000)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
               :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
               +- Project [r_reason_sk#3780, r_reason_desc#3782], Statistics(sizeInBytes=33.8 KiB)
                  +- Filter isnotnull(r_reason_sk#3780), Statistics(sizeInBytes=54.9 KiB)
                     +- Relation default.reason[r_reason_sk#3780,r_reason_id#3781,r_reason_desc#3782] parquet, Statistics(sizeInBytes=54.9 KiB)


==== q86 ==== 
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=6.0 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=714.4 PiB)
   +- Sort [lochierarchy#19103 DESC NULLS LAST, CASE WHEN (lochierarchy#19103 = 0) THEN i_category#19112 END ASC NULLS FIRST, rank_within_parent#19104 ASC NULLS FIRST], true, Statistics(sizeInBytes=714.4 PiB)
      +- Project [total_sum#19102, i_category#19112, i_class#19113, lochierarchy#19103, rank_within_parent#19104], Statistics(sizeInBytes=714.4 PiB)
         +- Window [rank(_w3#19128) windowspecdefinition(_w1#19126, _w2#19127, _w3#19128 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#19104], [_w1#19126, _w2#19127], [_w3#19128 DESC NULLS LAST], Statistics(sizeInBytes=1054.1 PiB)
            +- Aggregate [i_category#19112, i_class#19113, spark_grouping_id#19111L], [MakeDecimal(sum(UnscaledValue(ws_net_paid#192)),17,2) AS total_sum#19102, i_category#19112, i_class#19113, (cast((shiftright(spark_grouping_id#19111L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#19111L, 0) & 1) as tinyint)) AS lochierarchy#19103, (cast((shiftright(spark_grouping_id#19111L, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#19111L, 0) & 1) as tinyint)) AS _w1#19126, CASE WHEN (cast((shiftright(spark_grouping_id#19111L, 0) & 1) as tinyint) = 0) THEN i_category#19112 END AS _w2#19127, MakeDecimal(sum(UnscaledValue(ws_net_paid#192)),17,2) AS _w3#19128], Statistics(sizeInBytes=1007.2 PiB)
               +- Expand [[ws_net_paid#192, i_category#449, i_class#447, 0], [ws_net_paid#192, i_category#449, null, 1], [ws_net_paid#192, null, null, 3]], [ws_net_paid#192, i_category#19112, i_class#19113, spark_grouping_id#19111L], Statistics(sizeInBytes=749.6 PiB)
                  +- Project [ws_net_paid#192, i_category#449, i_class#447], Statistics(sizeInBytes=218.6 PiB)
                     +- Join Inner, (i_item_sk#437 = ws_item_sk#166), Statistics(sizeInBytes=249.9 PiB)
                        :- Project [ws_item_sk#166, ws_net_paid#192], Statistics(sizeInBytes=460.0 GiB)
                        :  +- Join Inner, (d_date_sk#24 = ws_sold_date_sk#163), Statistics(sizeInBytes=644.0 GiB)
                        :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_net_paid#192], Statistics(sizeInBytes=6.1 MiB)
                        :     :  +- Filter (isnotnull(ws_sold_date_sk#163) AND isnotnull(ws_item_sk#166)), Statistics(sizeInBytes=52.0 MiB)
                        :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
                        :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                        :        +- Filter ((isnotnull(d_month_seq#27) AND ((d_month_seq#27 >= 1200) AND (d_month_seq#27 <= 1211))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                        :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                        +- Project [i_item_sk#437, i_class#447, i_category#449], Statistics(sizeInBytes=556.2 KiB)
                           +- Filter isnotnull(i_item_sk#437), Statistics(sizeInBytes=3.1 MiB)
                              +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)


==== q87 ====
== Optimized Logical Plan ==
Aggregate [count(1) AS count(1)#19240L], Statistics(sizeInBytes=16.0 B, rowCount=1)
+- Project, Statistics(sizeInBytes=371.1 PiB)
   +- Join LeftAnti, (((c_last_name#90 <=> c_last_name#19231) AND (c_first_name#89 <=> c_first_name#19230)) AND (d_date#26 <=> d_date#19196)), Statistics(sizeInBytes=2.4 EiB)
      :- Join LeftAnti, (((c_last_name#90 <=> c_last_name#19185) AND (c_first_name#89 <=> c_first_name#19184)) AND (d_date#26 <=> d_date#19150)), Statistics(sizeInBytes=2.4 EiB)
      :  :- Aggregate [c_last_name#90, c_first_name#89, d_date#26], [c_last_name#90, c_first_name#89, d_date#26], Statistics(sizeInBytes=2.4 EiB)
      :  :  +- Project [c_last_name#90, c_first_name#89, d_date#26], Statistics(sizeInBytes=2.4 EiB)
      :  :     +- Join Inner, (ss_customer_sk#417 = c_customer_sk#81), Statistics(sizeInBytes=2.7 EiB)
      :  :        :- Project [ss_customer_sk#417, d_date#26], Statistics(sizeInBytes=1427.6 GiB)
      :  :        :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2.1 TiB)
      :  :        :     :- Project [ss_sold_date_sk#414, ss_customer_sk#417], Statistics(sizeInBytes=15.3 MiB)
      :  :        :     :  +- Filter (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_customer_sk#417)), Statistics(sizeInBytes=141.1 MiB)
      :  :        :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
      :  :        :     +- Project [d_date_sk#24, d_date#26], Statistics(sizeInBytes=140.4 KiB)
      :  :        :        +- Filter ((isnotnull(d_month_seq#27) AND ((d_month_seq#27 >= 1200) AND (d_month_seq#27 <= 1211))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
      :  :        :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
      :  :        +- Project [c_customer_sk#81, c_first_name#89, c_last_name#90], Statistics(sizeInBytes=1996.3 KiB)
      :  :           +- Filter isnotnull(c_customer_sk#81), Statistics(sizeInBytes=7.8 MiB)
      :  :              +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
      :  +- Aggregate [c_last_name#19185, c_first_name#19184, d_date#19150], [c_last_name#19185, c_first_name#19184, d_date#19150], Statistics(sizeInBytes=1312.6 PiB)
      :     +- Project [c_last_name#19185, c_first_name#19184, d_date#19150], Statistics(sizeInBytes=1312.6 PiB)
      :        +- Join Inner, (cs_bill_customer_sk#200 = c_customer_sk#19176), Statistics(sizeInBytes=1514.5 PiB)
      :           :- Project [cs_bill_customer_sk#200, d_date#19150], Statistics(sizeInBytes=776.9 GiB)
      :           :  +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#19148), Statistics(sizeInBytes=1165.3 GiB)
      :           :     :- Project [cs_sold_date_sk#197, cs_bill_customer_sk#200], Statistics(sizeInBytes=8.3 MiB)
      :           :     :  +- Filter (isnotnull(cs_sold_date_sk#197) AND isnotnull(cs_bill_customer_sk#200)), Statistics(sizeInBytes=105.8 MiB)
      :           :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
      :           :     +- Project [d_date_sk#19148, d_date#19150], Statistics(sizeInBytes=140.4 KiB)
      :           :        +- Filter ((isnotnull(d_month_seq#19151) AND ((d_month_seq#19151 >= 1200) AND (d_month_seq#19151 <= 1211))) AND isnotnull(d_date_sk#19148)), Statistics(sizeInBytes=2.5 MiB)
      :           :           +- Relation default.date_dim[d_date_sk#19148,d_date_id#19149,d_date#19150,d_month_seq#19151,d_week_seq#19152,d_quarter_seq#19153,d_year#19154,d_dow#19155,d_moy#19156,d_dom#19157,d_qoy#19158,d_fy_year#19159,d_fy_quarter_seq#19160,d_fy_week_seq#19161,d_day_name#19162,d_quarter_name#19163,d_holiday#19164,d_weekend#19165,d_following_holiday#19166,d_first_dom#19167,d_last_dom#19168,d_same_day_ly#19169,d_same_day_lq#19170,d_current_day#19171,d_current_week#19172,d_current_month#19173,d_current_quarter#19174,d_current_year#19175] parquet, Statistics(sizeInBytes=2.5 MiB)
      :           +- Project [c_customer_sk#19176, c_first_name#19184, c_last_name#19185], Statistics(sizeInBytes=1996.3 KiB)
      :              +- Filter isnotnull(c_customer_sk#19176), Statistics(sizeInBytes=7.8 MiB)
      :                 +- Relation default.customer[c_customer_sk#19176,c_customer_id#19177,c_current_cdemo_sk#19178,c_current_hdemo_sk#19179,c_current_addr_sk#19180,c_first_shipto_date_sk#19181,c_first_sales_date_sk#19182,c_salutation#19183,c_first_name#19184,c_last_name#19185,c_preferred_cust_flag#19186,c_birth_day#19187,c_birth_month#19188,c_birth_year#19189,c_birth_country#19190,c_login#19191,c_email_address#19192,c_last_review_date#19193] parquet, Statistics(sizeInBytes=7.8 MiB)
      +- Aggregate [c_last_name#19231, c_first_name#19230, d_date#19196], [c_last_name#19231, c_first_name#19230, d_date#19196], Statistics(sizeInBytes=644.8 PiB)
         +- Project [c_last_name#19231, c_first_name#19230, d_date#19196], Statistics(sizeInBytes=644.8 PiB)
            +- Join Inner, (ws_bill_customer_sk#167 = c_customer_sk#19222), Statistics(sizeInBytes=744.0 PiB)
               :- Project [ws_bill_customer_sk#167, d_date#19196], Statistics(sizeInBytes=381.6 GiB)
               :  +- Join Inner, (ws_sold_date_sk#163 = d_date_sk#19194), Statistics(sizeInBytes=572.4 GiB)
               :     :- Project [ws_sold_date_sk#163, ws_bill_customer_sk#167], Statistics(sizeInBytes=4.1 MiB)
               :     :  +- Filter (isnotnull(ws_sold_date_sk#163) AND isnotnull(ws_bill_customer_sk#167)), Statistics(sizeInBytes=52.0 MiB)
               :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
               :     +- Project [d_date_sk#19194, d_date#19196], Statistics(sizeInBytes=140.4 KiB)
               :        +- Filter ((isnotnull(d_month_seq#19197) AND ((d_month_seq#19197 >= 1200) AND (d_month_seq#19197 <= 1211))) AND isnotnull(d_date_sk#19194)), Statistics(sizeInBytes=2.5 MiB)
               :           +- Relation default.date_dim[d_date_sk#19194,d_date_id#19195,d_date#19196,d_month_seq#19197,d_week_seq#19198,d_quarter_seq#19199,d_year#19200,d_dow#19201,d_moy#19202,d_dom#19203,d_qoy#19204,d_fy_year#19205,d_fy_quarter_seq#19206,d_fy_week_seq#19207,d_day_name#19208,d_quarter_name#19209,d_holiday#19210,d_weekend#19211,d_following_holiday#19212,d_first_dom#19213,d_last_dom#19214,d_same_day_ly#19215,d_same_day_lq#19216,d_current_day#19217,d_current_week#19218,d_current_month#19219,d_current_quarter#19220,d_current_year#19221] parquet, Statistics(sizeInBytes=2.5 MiB)
               +- Project [c_customer_sk#19222, c_first_name#19230, c_last_name#19231], Statistics(sizeInBytes=1996.3 KiB)
                  +- Filter isnotnull(c_customer_sk#19222), Statistics(sizeInBytes=7.8 MiB)
                     +- Relation default.customer[c_customer_sk#19222,c_customer_id#19223,c_current_cdemo_sk#19224,c_current_hdemo_sk#19225,c_current_addr_sk#19226,c_first_shipto_date_sk#19227,c_first_sales_date_sk#19228,c_salutation#19229,c_first_name#19230,c_last_name#19231,c_preferred_cust_flag#19232,c_birth_day#19233,c_birth_month#19234,c_birth_year#19235,c_birth_country#19236,c_login#19237,c_email_address#19238,c_last_review_date#19239] parquet, Statistics(sizeInBytes=7.8 MiB)


==== q88 ====
== Optimized Logical Plan ==
Join Inner, Statistics(sizeInBytes=4.0 GiB)
:- Join Inner, Statistics(sizeInBytes=256.0 MiB)
:  :- Join Inner, Statistics(sizeInBytes=16.0 MiB)
:  :  :- Join Inner, Statistics(sizeInBytes=1024.0 KiB)
:  :  :  :- Join Inner, Statistics(sizeInBytes=64.0 KiB)
:  :  :  :  :- Join Inner, Statistics(sizeInBytes=4.0 KiB)
:  :  :  :  :  :- Join Inner, Statistics(sizeInBytes=256.0 B)
:  :  :  :  :  :  :- Aggregate [count(1) AS h8_30_to_9#19248L], Statistics(sizeInBytes=16.0 B, rowCount=1)
:  :  :  :  :  :  :  +- Project, Statistics(sizeInBytes=85.5 EiB)
:  :  :  :  :  :  :     +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=170.9 EiB)
:  :  :  :  :  :  :        :- Project [ss_store_sk#421], Statistics(sizeInBytes=58.8 PiB)
:  :  :  :  :  :  :        :  +- Join Inner, (ss_sold_time_sk#415 = t_time_sk#15927), Statistics(sizeInBytes=98.1 PiB)
:  :  :  :  :  :  :        :     :- Project [ss_sold_time_sk#415, ss_store_sk#421], Statistics(sizeInBytes=737.4 GiB)
:  :  :  :  :  :  :        :     :  +- Join Inner, (ss_hdemo_sk#419 = hd_demo_sk#5551), Statistics(sizeInBytes=1106.2 GiB)
:  :  :  :  :  :  :        :     :     :- Project [ss_sold_time_sk#415, ss_hdemo_sk#419, ss_store_sk#421], Statistics(sizeInBytes=19.1 MiB)
:  :  :  :  :  :  :        :     :     :  +- Filter (isnotnull(ss_hdemo_sk#419) AND (isnotnull(ss_sold_time_sk#415) AND isnotnull(ss_store_sk#421))), Statistics(sizeInBytes=141.1 MiB)
:  :  :  :  :  :  :        :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :  :  :  :  :  :        :     :     +- Project [hd_demo_sk#5551], Statistics(sizeInBytes=58.0 KiB)
:  :  :  :  :  :  :        :     :        +- Filter (((((hd_dep_count#5554 = 4) AND (hd_vehicle_count#5555 <= 6)) OR ((hd_dep_count#5554 = 2) AND (hd_vehicle_count#5555 <= 4))) OR ((hd_dep_count#5554 = 0) AND (hd_vehicle_count#5555 <= 2))) AND isnotnull(hd_demo_sk#5551)), Statistics(sizeInBytes=212.8 KiB)
:  :  :  :  :  :  :        :     :           +- Relation default.household_demographics[hd_demo_sk#5551,hd_income_band_sk#5552,hd_buy_potential#5553,hd_dep_count#5554,hd_vehicle_count#5555] parquet, Statistics(sizeInBytes=212.8 KiB)
:  :  :  :  :  :  :        :     +- Project [t_time_sk#15927], Statistics(sizeInBytes=136.2 KiB)
:  :  :  :  :  :  :        :        +- Filter (((isnotnull(t_hour#15930) AND isnotnull(t_minute#15931)) AND ((t_hour#15930 = 8) AND (t_minute#15931 >= 30))) AND isnotnull(t_time_sk#15927)), Statistics(sizeInBytes=1452.6 KiB)
:  :  :  :  :  :  :        :           +- Relation default.time_dim[t_time_sk#15927,t_time_id#15928,t_time#15929,t_hour#15930,t_minute#15931,t_second#15932,t_am_pm#15933,t_shift#15934,t_sub_shift#15935,t_meal_time#15936] parquet, Statistics(sizeInBytes=1452.6 KiB)
:  :  :  :  :  :  :        +- Project [s_store_sk#52], Statistics(sizeInBytes=2.9 KiB)
:  :  :  :  :  :  :           +- Filter ((isnotnull(s_store_name#57) AND (s_store_name#57 = ese)) AND isnotnull(s_store_sk#52)), Statistics(sizeInBytes=101.7 KiB)
:  :  :  :  :  :  :              +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)
:  :  :  :  :  :  +- Aggregate [count(1) AS h9_to_9_30#19249L], Statistics(sizeInBytes=16.0 B, rowCount=1)
:  :  :  :  :  :     +- Project, Statistics(sizeInBytes=85.5 EiB)
:  :  :  :  :  :        +- Join Inner, (ss_store_sk#19271 = s_store_sk#19302), Statistics(sizeInBytes=170.9 EiB)
:  :  :  :  :  :           :- Project [ss_store_sk#19271], Statistics(sizeInBytes=58.8 PiB)
:  :  :  :  :  :           :  +- Join Inner, (ss_sold_time_sk#19265 = t_time_sk#19292), Statistics(sizeInBytes=98.1 PiB)
:  :  :  :  :  :           :     :- Project [ss_sold_time_sk#19265, ss_store_sk#19271], Statistics(sizeInBytes=737.4 GiB)
:  :  :  :  :  :           :     :  +- Join Inner, (ss_hdemo_sk#19269 = hd_demo_sk#19287), Statistics(sizeInBytes=1106.2 GiB)
:  :  :  :  :  :           :     :     :- Project [ss_sold_time_sk#19265, ss_hdemo_sk#19269, ss_store_sk#19271], Statistics(sizeInBytes=19.1 MiB)
:  :  :  :  :  :           :     :     :  +- Filter (isnotnull(ss_hdemo_sk#19269) AND (isnotnull(ss_sold_time_sk#19265) AND isnotnull(ss_store_sk#19271))), Statistics(sizeInBytes=141.1 MiB)
:  :  :  :  :  :           :     :     :     +- Relation default.store_sales[ss_sold_date_sk#19264,ss_sold_time_sk#19265,ss_item_sk#19266,ss_customer_sk#19267,ss_cdemo_sk#19268,ss_hdemo_sk#19269,ss_addr_sk#19270,ss_store_sk#19271,ss_promo_sk#19272,ss_ticket_number#19273,ss_quantity#19274,ss_wholesale_cost#19275,ss_list_price#19276,ss_sales_price#19277,ss_ext_discount_amt#19278,ss_ext_sales_price#19279,ss_ext_wholesale_cost#19280,ss_ext_list_price#19281,ss_ext_tax#19282,ss_coupon_amt#19283,ss_net_paid#19284,ss_net_paid_inc_tax#19285,ss_net_profit#19286] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :  :  :  :  :           :     :     +- Project [hd_demo_sk#19287], Statistics(sizeInBytes=58.0 KiB)
:  :  :  :  :  :           :     :        +- Filter (((((hd_dep_count#19290 = 4) AND (hd_vehicle_count#19291 <= 6)) OR ((hd_dep_count#19290 = 2) AND (hd_vehicle_count#19291 <= 4))) OR ((hd_dep_count#19290 = 0) AND (hd_vehicle_count#19291 <= 2))) AND isnotnull(hd_demo_sk#19287)), Statistics(sizeInBytes=212.8 KiB)
:  :  :  :  :  :           :     :           +- Relation default.household_demographics[hd_demo_sk#19287,hd_income_band_sk#19288,hd_buy_potential#19289,hd_dep_count#19290,hd_vehicle_count#19291] parquet, Statistics(sizeInBytes=212.8 KiB)
:  :  :  :  :  :           :     +- Project [t_time_sk#19292], Statistics(sizeInBytes=136.2 KiB)
:  :  :  :  :  :           :        +- Filter (((isnotnull(t_hour#19295) AND isnotnull(t_minute#19296)) AND ((t_hour#19295 = 9) AND (t_minute#19296 < 30))) AND isnotnull(t_time_sk#19292)), Statistics(sizeInBytes=1452.6 KiB)
:  :  :  :  :  :           :           +- Relation default.time_dim[t_time_sk#19292,t_time_id#19293,t_time#19294,t_hour#19295,t_minute#19296,t_second#19297,t_am_pm#19298,t_shift#19299,t_sub_shift#19300,t_meal_time#19301] parquet, Statistics(sizeInBytes=1452.6 KiB)
:  :  :  :  :  :           +- Project [s_store_sk#19302], Statistics(sizeInBytes=2.9 KiB)
:  :  :  :  :  :              +- Filter ((isnotnull(s_store_name#19307) AND (s_store_name#19307 = ese)) AND isnotnull(s_store_sk#19302)), Statistics(sizeInBytes=101.7 KiB)
:  :  :  :  :  :                 +- Relation default.store[s_store_sk#19302,s_store_id#19303,s_rec_start_date#19304,s_rec_end_date#19305,s_closed_date_sk#19306,s_store_name#19307,s_number_employees#19308,s_floor_space#19309,s_hours#19310,s_manager#19311,s_market_id#19312,s_geography_class#19313,s_market_desc#19314,s_market_manager#19315,s_division_id#19316,s_division_name#19317,s_company_id#19318,s_company_name#19319,s_street_number#19320,s_street_name#19321,s_street_type#19322,s_suite_number#19323,s_city#19324,s_county#19325,s_state#19326,s_zip#19327,s_country#19328,s_gmt_offset#19329,s_tax_percentage#19330] parquet, Statistics(sizeInBytes=101.7 KiB)
:  :  :  :  :  +- Aggregate [count(1) AS h9_30_to_10#19250L], Statistics(sizeInBytes=16.0 B, rowCount=1)
:  :  :  :  :     +- Project, Statistics(sizeInBytes=85.5 EiB)
:  :  :  :  :        +- Join Inner, (ss_store_sk#19338 = s_store_sk#19369), Statistics(sizeInBytes=170.9 EiB)
:  :  :  :  :           :- Project [ss_store_sk#19338], Statistics(sizeInBytes=58.8 PiB)
:  :  :  :  :           :  +- Join Inner, (ss_sold_time_sk#19332 = t_time_sk#19359), Statistics(sizeInBytes=98.1 PiB)
:  :  :  :  :           :     :- Project [ss_sold_time_sk#19332, ss_store_sk#19338], Statistics(sizeInBytes=737.4 GiB)
:  :  :  :  :           :     :  +- Join Inner, (ss_hdemo_sk#19336 = hd_demo_sk#19354), Statistics(sizeInBytes=1106.2 GiB)
:  :  :  :  :           :     :     :- Project [ss_sold_time_sk#19332, ss_hdemo_sk#19336, ss_store_sk#19338], Statistics(sizeInBytes=19.1 MiB)
:  :  :  :  :           :     :     :  +- Filter (isnotnull(ss_hdemo_sk#19336) AND (isnotnull(ss_sold_time_sk#19332) AND isnotnull(ss_store_sk#19338))), Statistics(sizeInBytes=141.1 MiB)
:  :  :  :  :           :     :     :     +- Relation default.store_sales[ss_sold_date_sk#19331,ss_sold_time_sk#19332,ss_item_sk#19333,ss_customer_sk#19334,ss_cdemo_sk#19335,ss_hdemo_sk#19336,ss_addr_sk#19337,ss_store_sk#19338,ss_promo_sk#19339,ss_ticket_number#19340,ss_quantity#19341,ss_wholesale_cost#19342,ss_list_price#19343,ss_sales_price#19344,ss_ext_discount_amt#19345,ss_ext_sales_price#19346,ss_ext_wholesale_cost#19347,ss_ext_list_price#19348,ss_ext_tax#19349,ss_coupon_amt#19350,ss_net_paid#19351,ss_net_paid_inc_tax#19352,ss_net_profit#19353] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :  :  :  :           :     :     +- Project [hd_demo_sk#19354], Statistics(sizeInBytes=58.0 KiB)
:  :  :  :  :           :     :        +- Filter (((((hd_dep_count#19357 = 4) AND (hd_vehicle_count#19358 <= 6)) OR ((hd_dep_count#19357 = 2) AND (hd_vehicle_count#19358 <= 4))) OR ((hd_dep_count#19357 = 0) AND (hd_vehicle_count#19358 <= 2))) AND isnotnull(hd_demo_sk#19354)), Statistics(sizeInBytes=212.8 KiB)
:  :  :  :  :           :     :           +- Relation default.household_demographics[hd_demo_sk#19354,hd_income_band_sk#19355,hd_buy_potential#19356,hd_dep_count#19357,hd_vehicle_count#19358] parquet, Statistics(sizeInBytes=212.8 KiB)
:  :  :  :  :           :     +- Project [t_time_sk#19359], Statistics(sizeInBytes=136.2 KiB)
:  :  :  :  :           :        +- Filter (((isnotnull(t_hour#19362) AND isnotnull(t_minute#19363)) AND ((t_hour#19362 = 9) AND (t_minute#19363 >= 30))) AND isnotnull(t_time_sk#19359)), Statistics(sizeInBytes=1452.6 KiB)
:  :  :  :  :           :           +- Relation default.time_dim[t_time_sk#19359,t_time_id#19360,t_time#19361,t_hour#19362,t_minute#19363,t_second#19364,t_am_pm#19365,t_shift#19366,t_sub_shift#19367,t_meal_time#19368] parquet, Statistics(sizeInBytes=1452.6 KiB)
:  :  :  :  :           +- Project [s_store_sk#19369], Statistics(sizeInBytes=2.9 KiB)
:  :  :  :  :              +- Filter ((isnotnull(s_store_name#19374) AND (s_store_name#19374 = ese)) AND isnotnull(s_store_sk#19369)), Statistics(sizeInBytes=101.7 KiB)
:  :  :  :  :                 +- Relation default.store[s_store_sk#19369,s_store_id#19370,s_rec_start_date#19371,s_rec_end_date#19372,s_closed_date_sk#19373,s_store_name#19374,s_number_employees#19375,s_floor_space#19376,s_hours#19377,s_manager#19378,s_market_id#19379,s_geography_class#19380,s_market_desc#19381,s_market_manager#19382,s_division_id#19383,s_division_name#19384,s_company_id#19385,s_company_name#19386,s_street_number#19387,s_street_name#19388,s_street_type#19389,s_suite_number#19390,s_city#19391,s_county#19392,s_state#19393,s_zip#19394,s_country#19395,s_gmt_offset#19396,s_tax_percentage#19397] parquet, Statistics(sizeInBytes=101.7 KiB)
:  :  :  :  +- Aggregate [count(1) AS h10_to_10_30#19251L], Statistics(sizeInBytes=16.0 B, rowCount=1)
:  :  :  :     +- Project, Statistics(sizeInBytes=85.5 EiB)
:  :  :  :        +- Join Inner, (ss_store_sk#19405 = s_store_sk#19436), Statistics(sizeInBytes=170.9 EiB)
:  :  :  :           :- Project [ss_store_sk#19405], Statistics(sizeInBytes=58.8 PiB)
:  :  :  :           :  +- Join Inner, (ss_sold_time_sk#19399 = t_time_sk#19426), Statistics(sizeInBytes=98.1 PiB)
:  :  :  :           :     :- Project [ss_sold_time_sk#19399, ss_store_sk#19405], Statistics(sizeInBytes=737.4 GiB)
:  :  :  :           :     :  +- Join Inner, (ss_hdemo_sk#19403 = hd_demo_sk#19421), Statistics(sizeInBytes=1106.2 GiB)
:  :  :  :           :     :     :- Project [ss_sold_time_sk#19399, ss_hdemo_sk#19403, ss_store_sk#19405], Statistics(sizeInBytes=19.1 MiB)
:  :  :  :           :     :     :  +- Filter (isnotnull(ss_hdemo_sk#19403) AND (isnotnull(ss_sold_time_sk#19399) AND isnotnull(ss_store_sk#19405))), Statistics(sizeInBytes=141.1 MiB)
:  :  :  :           :     :     :     +- Relation default.store_sales[ss_sold_date_sk#19398,ss_sold_time_sk#19399,ss_item_sk#19400,ss_customer_sk#19401,ss_cdemo_sk#19402,ss_hdemo_sk#19403,ss_addr_sk#19404,ss_store_sk#19405,ss_promo_sk#19406,ss_ticket_number#19407,ss_quantity#19408,ss_wholesale_cost#19409,ss_list_price#19410,ss_sales_price#19411,ss_ext_discount_amt#19412,ss_ext_sales_price#19413,ss_ext_wholesale_cost#19414,ss_ext_list_price#19415,ss_ext_tax#19416,ss_coupon_amt#19417,ss_net_paid#19418,ss_net_paid_inc_tax#19419,ss_net_profit#19420] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :  :  :           :     :     +- Project [hd_demo_sk#19421], Statistics(sizeInBytes=58.0 KiB)
:  :  :  :           :     :        +- Filter (((((hd_dep_count#19424 = 4) AND (hd_vehicle_count#19425 <= 6)) OR ((hd_dep_count#19424 = 2) AND (hd_vehicle_count#19425 <= 4))) OR ((hd_dep_count#19424 = 0) AND (hd_vehicle_count#19425 <= 2))) AND isnotnull(hd_demo_sk#19421)), Statistics(sizeInBytes=212.8 KiB)
:  :  :  :           :     :           +- Relation default.household_demographics[hd_demo_sk#19421,hd_income_band_sk#19422,hd_buy_potential#19423,hd_dep_count#19424,hd_vehicle_count#19425] parquet, Statistics(sizeInBytes=212.8 KiB)
:  :  :  :           :     +- Project [t_time_sk#19426], Statistics(sizeInBytes=136.2 KiB)
:  :  :  :           :        +- Filter (((isnotnull(t_hour#19429) AND isnotnull(t_minute#19430)) AND ((t_hour#19429 = 10) AND (t_minute#19430 < 30))) AND isnotnull(t_time_sk#19426)), Statistics(sizeInBytes=1452.6 KiB)
:  :  :  :           :           +- Relation default.time_dim[t_time_sk#19426,t_time_id#19427,t_time#19428,t_hour#19429,t_minute#19430,t_second#19431,t_am_pm#19432,t_shift#19433,t_sub_shift#19434,t_meal_time#19435] parquet, Statistics(sizeInBytes=1452.6 KiB)
:  :  :  :           +- Project [s_store_sk#19436], Statistics(sizeInBytes=2.9 KiB)
:  :  :  :              +- Filter ((isnotnull(s_store_name#19441) AND (s_store_name#19441 = ese)) AND isnotnull(s_store_sk#19436)), Statistics(sizeInBytes=101.7 KiB)
:  :  :  :                 +- Relation default.store[s_store_sk#19436,s_store_id#19437,s_rec_start_date#19438,s_rec_end_date#19439,s_closed_date_sk#19440,s_store_name#19441,s_number_employees#19442,s_floor_space#19443,s_hours#19444,s_manager#19445,s_market_id#19446,s_geography_class#19447,s_market_desc#19448,s_market_manager#19449,s_division_id#19450,s_division_name#19451,s_company_id#19452,s_company_name#19453,s_street_number#19454,s_street_name#19455,s_street_type#19456,s_suite_number#19457,s_city#19458,s_county#19459,s_state#19460,s_zip#19461,s_country#19462,s_gmt_offset#19463,s_tax_percentage#19464] parquet, Statistics(sizeInBytes=101.7 KiB)
:  :  :  +- Aggregate [count(1) AS h10_30_to_11#19252L], Statistics(sizeInBytes=16.0 B, rowCount=1)
:  :  :     +- Project, Statistics(sizeInBytes=85.5 EiB)
:  :  :        +- Join Inner, (ss_store_sk#19472 = s_store_sk#19503), Statistics(sizeInBytes=170.9 EiB)
:  :  :           :- Project [ss_store_sk#19472], Statistics(sizeInBytes=58.8 PiB)
:  :  :           :  +- Join Inner, (ss_sold_time_sk#19466 = t_time_sk#19493), Statistics(sizeInBytes=98.1 PiB)
:  :  :           :     :- Project [ss_sold_time_sk#19466, ss_store_sk#19472], Statistics(sizeInBytes=737.4 GiB)
:  :  :           :     :  +- Join Inner, (ss_hdemo_sk#19470 = hd_demo_sk#19488), Statistics(sizeInBytes=1106.2 GiB)
:  :  :           :     :     :- Project [ss_sold_time_sk#19466, ss_hdemo_sk#19470, ss_store_sk#19472], Statistics(sizeInBytes=19.1 MiB)
:  :  :           :     :     :  +- Filter (isnotnull(ss_hdemo_sk#19470) AND (isnotnull(ss_sold_time_sk#19466) AND isnotnull(ss_store_sk#19472))), Statistics(sizeInBytes=141.1 MiB)
:  :  :           :     :     :     +- Relation default.store_sales[ss_sold_date_sk#19465,ss_sold_time_sk#19466,ss_item_sk#19467,ss_customer_sk#19468,ss_cdemo_sk#19469,ss_hdemo_sk#19470,ss_addr_sk#19471,ss_store_sk#19472,ss_promo_sk#19473,ss_ticket_number#19474,ss_quantity#19475,ss_wholesale_cost#19476,ss_list_price#19477,ss_sales_price#19478,ss_ext_discount_amt#19479,ss_ext_sales_price#19480,ss_ext_wholesale_cost#19481,ss_ext_list_price#19482,ss_ext_tax#19483,ss_coupon_amt#19484,ss_net_paid#19485,ss_net_paid_inc_tax#19486,ss_net_profit#19487] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :  :           :     :     +- Project [hd_demo_sk#19488], Statistics(sizeInBytes=58.0 KiB)
:  :  :           :     :        +- Filter (((((hd_dep_count#19491 = 4) AND (hd_vehicle_count#19492 <= 6)) OR ((hd_dep_count#19491 = 2) AND (hd_vehicle_count#19492 <= 4))) OR ((hd_dep_count#19491 = 0) AND (hd_vehicle_count#19492 <= 2))) AND isnotnull(hd_demo_sk#19488)), Statistics(sizeInBytes=212.8 KiB)
:  :  :           :     :           +- Relation default.household_demographics[hd_demo_sk#19488,hd_income_band_sk#19489,hd_buy_potential#19490,hd_dep_count#19491,hd_vehicle_count#19492] parquet, Statistics(sizeInBytes=212.8 KiB)
:  :  :           :     +- Project [t_time_sk#19493], Statistics(sizeInBytes=136.2 KiB)
:  :  :           :        +- Filter (((isnotnull(t_hour#19496) AND isnotnull(t_minute#19497)) AND ((t_hour#19496 = 10) AND (t_minute#19497 >= 30))) AND isnotnull(t_time_sk#19493)), Statistics(sizeInBytes=1452.6 KiB)
:  :  :           :           +- Relation default.time_dim[t_time_sk#19493,t_time_id#19494,t_time#19495,t_hour#19496,t_minute#19497,t_second#19498,t_am_pm#19499,t_shift#19500,t_sub_shift#19501,t_meal_time#19502] parquet, Statistics(sizeInBytes=1452.6 KiB)
:  :  :           +- Project [s_store_sk#19503], Statistics(sizeInBytes=2.9 KiB)
:  :  :              +- Filter ((isnotnull(s_store_name#19508) AND (s_store_name#19508 = ese)) AND isnotnull(s_store_sk#19503)), Statistics(sizeInBytes=101.7 KiB)
:  :  :                 +- Relation default.store[s_store_sk#19503,s_store_id#19504,s_rec_start_date#19505,s_rec_end_date#19506,s_closed_date_sk#19507,s_store_name#19508,s_number_employees#19509,s_floor_space#19510,s_hours#19511,s_manager#19512,s_market_id#19513,s_geography_class#19514,s_market_desc#19515,s_market_manager#19516,s_division_id#19517,s_division_name#19518,s_company_id#19519,s_company_name#19520,s_street_number#19521,s_street_name#19522,s_street_type#19523,s_suite_number#19524,s_city#19525,s_county#19526,s_state#19527,s_zip#19528,s_country#19529,s_gmt_offset#19530,s_tax_percentage#19531] parquet, Statistics(sizeInBytes=101.7 KiB)
:  :  +- Aggregate [count(1) AS h11_to_11_30#19253L], Statistics(sizeInBytes=16.0 B, rowCount=1)
:  :     +- Project, Statistics(sizeInBytes=85.5 EiB)
:  :        +- Join Inner, (ss_store_sk#19539 = s_store_sk#19570), Statistics(sizeInBytes=170.9 EiB)
:  :           :- Project [ss_store_sk#19539], Statistics(sizeInBytes=58.8 PiB)
:  :           :  +- Join Inner, (ss_sold_time_sk#19533 = t_time_sk#19560), Statistics(sizeInBytes=98.1 PiB)
:  :           :     :- Project [ss_sold_time_sk#19533, ss_store_sk#19539], Statistics(sizeInBytes=737.4 GiB)
:  :           :     :  +- Join Inner, (ss_hdemo_sk#19537 = hd_demo_sk#19555), Statistics(sizeInBytes=1106.2 GiB)
:  :           :     :     :- Project [ss_sold_time_sk#19533, ss_hdemo_sk#19537, ss_store_sk#19539], Statistics(sizeInBytes=19.1 MiB)
:  :           :     :     :  +- Filter (isnotnull(ss_hdemo_sk#19537) AND (isnotnull(ss_sold_time_sk#19533) AND isnotnull(ss_store_sk#19539))), Statistics(sizeInBytes=141.1 MiB)
:  :           :     :     :     +- Relation default.store_sales[ss_sold_date_sk#19532,ss_sold_time_sk#19533,ss_item_sk#19534,ss_customer_sk#19535,ss_cdemo_sk#19536,ss_hdemo_sk#19537,ss_addr_sk#19538,ss_store_sk#19539,ss_promo_sk#19540,ss_ticket_number#19541,ss_quantity#19542,ss_wholesale_cost#19543,ss_list_price#19544,ss_sales_price#19545,ss_ext_discount_amt#19546,ss_ext_sales_price#19547,ss_ext_wholesale_cost#19548,ss_ext_list_price#19549,ss_ext_tax#19550,ss_coupon_amt#19551,ss_net_paid#19552,ss_net_paid_inc_tax#19553,ss_net_profit#19554] parquet, Statistics(sizeInBytes=141.1 MiB)
:  :           :     :     +- Project [hd_demo_sk#19555], Statistics(sizeInBytes=58.0 KiB)
:  :           :     :        +- Filter (((((hd_dep_count#19558 = 4) AND (hd_vehicle_count#19559 <= 6)) OR ((hd_dep_count#19558 = 2) AND (hd_vehicle_count#19559 <= 4))) OR ((hd_dep_count#19558 = 0) AND (hd_vehicle_count#19559 <= 2))) AND isnotnull(hd_demo_sk#19555)), Statistics(sizeInBytes=212.8 KiB)
:  :           :     :           +- Relation default.household_demographics[hd_demo_sk#19555,hd_income_band_sk#19556,hd_buy_potential#19557,hd_dep_count#19558,hd_vehicle_count#19559] parquet, Statistics(sizeInBytes=212.8 KiB)
:  :           :     +- Project [t_time_sk#19560], Statistics(sizeInBytes=136.2 KiB)
:  :           :        +- Filter (((isnotnull(t_hour#19563) AND isnotnull(t_minute#19564)) AND ((t_hour#19563 = 11) AND (t_minute#19564 < 30))) AND isnotnull(t_time_sk#19560)), Statistics(sizeInBytes=1452.6 KiB)
:  :           :           +- Relation default.time_dim[t_time_sk#19560,t_time_id#19561,t_time#19562,t_hour#19563,t_minute#19564,t_second#19565,t_am_pm#19566,t_shift#19567,t_sub_shift#19568,t_meal_time#19569] parquet, Statistics(sizeInBytes=1452.6 KiB)
:  :           +- Project [s_store_sk#19570], Statistics(sizeInBytes=2.9 KiB)
:  :              +- Filter ((isnotnull(s_store_name#19575) AND (s_store_name#19575 = ese)) AND isnotnull(s_store_sk#19570)), Statistics(sizeInBytes=101.7 KiB)
:  :                 +- Relation default.store[s_store_sk#19570,s_store_id#19571,s_rec_start_date#19572,s_rec_end_date#19573,s_closed_date_sk#19574,s_store_name#19575,s_number_employees#19576,s_floor_space#19577,s_hours#19578,s_manager#19579,s_market_id#19580,s_geography_class#19581,s_market_desc#19582,s_market_manager#19583,s_division_id#19584,s_division_name#19585,s_company_id#19586,s_company_name#19587,s_street_number#19588,s_street_name#19589,s_street_type#19590,s_suite_number#19591,s_city#19592,s_county#19593,s_state#19594,s_zip#19595,s_country#19596,s_gmt_offset#19597,s_tax_percentage#19598] parquet, Statistics(sizeInBytes=101.7 KiB)
:  +- Aggregate [count(1) AS h11_30_to_12#19254L], Statistics(sizeInBytes=16.0 B, rowCount=1)
:     +- Project, Statistics(sizeInBytes=85.5 EiB)
:        +- Join Inner, (ss_store_sk#19606 = s_store_sk#19637), Statistics(sizeInBytes=170.9 EiB)
:           :- Project [ss_store_sk#19606], Statistics(sizeInBytes=58.8 PiB)
:           :  +- Join Inner, (ss_sold_time_sk#19600 = t_time_sk#19627), Statistics(sizeInBytes=98.1 PiB)
:           :     :- Project [ss_sold_time_sk#19600, ss_store_sk#19606], Statistics(sizeInBytes=737.4 GiB)
:           :     :  +- Join Inner, (ss_hdemo_sk#19604 = hd_demo_sk#19622), Statistics(sizeInBytes=1106.2 GiB)
:           :     :     :- Project [ss_sold_time_sk#19600, ss_hdemo_sk#19604, ss_store_sk#19606], Statistics(sizeInBytes=19.1 MiB)
:           :     :     :  +- Filter (isnotnull(ss_hdemo_sk#19604) AND (isnotnull(ss_sold_time_sk#19600) AND isnotnull(ss_store_sk#19606))), Statistics(sizeInBytes=141.1 MiB)
:           :     :     :     +- Relation default.store_sales[ss_sold_date_sk#19599,ss_sold_time_sk#19600,ss_item_sk#19601,ss_customer_sk#19602,ss_cdemo_sk#19603,ss_hdemo_sk#19604,ss_addr_sk#19605,ss_store_sk#19606,ss_promo_sk#19607,ss_ticket_number#19608,ss_quantity#19609,ss_wholesale_cost#19610,ss_list_price#19611,ss_sales_price#19612,ss_ext_discount_amt#19613,ss_ext_sales_price#19614,ss_ext_wholesale_cost#19615,ss_ext_list_price#19616,ss_ext_tax#19617,ss_coupon_amt#19618,ss_net_paid#19619,ss_net_paid_inc_tax#19620,ss_net_profit#19621] parquet, Statistics(sizeInBytes=141.1 MiB)
:           :     :     +- Project [hd_demo_sk#19622], Statistics(sizeInBytes=58.0 KiB)
:           :     :        +- Filter (((((hd_dep_count#19625 = 4) AND (hd_vehicle_count#19626 <= 6)) OR ((hd_dep_count#19625 = 2) AND (hd_vehicle_count#19626 <= 4))) OR ((hd_dep_count#19625 = 0) AND (hd_vehicle_count#19626 <= 2))) AND isnotnull(hd_demo_sk#19622)), Statistics(sizeInBytes=212.8 KiB)
:           :     :           +- Relation default.household_demographics[hd_demo_sk#19622,hd_income_band_sk#19623,hd_buy_potential#19624,hd_dep_count#19625,hd_vehicle_count#19626] parquet, Statistics(sizeInBytes=212.8 KiB)
:           :     +- Project [t_time_sk#19627], Statistics(sizeInBytes=136.2 KiB)
:           :        +- Filter (((isnotnull(t_hour#19630) AND isnotnull(t_minute#19631)) AND ((t_hour#19630 = 11) AND (t_minute#19631 >= 30))) AND isnotnull(t_time_sk#19627)), Statistics(sizeInBytes=1452.6 KiB)
:           :           +- Relation default.time_dim[t_time_sk#19627,t_time_id#19628,t_time#19629,t_hour#19630,t_minute#19631,t_second#19632,t_am_pm#19633,t_shift#19634,t_sub_shift#19635,t_meal_time#19636] parquet, Statistics(sizeInBytes=1452.6 KiB)
:           +- Project [s_store_sk#19637], Statistics(sizeInBytes=2.9 KiB)
:              +- Filter ((isnotnull(s_store_name#19642) AND (s_store_name#19642 = ese)) AND isnotnull(s_store_sk#19637)), Statistics(sizeInBytes=101.7 KiB)
:                 +- Relation default.store[s_store_sk#19637,s_store_id#19638,s_rec_start_date#19639,s_rec_end_date#19640,s_closed_date_sk#19641,s_store_name#19642,s_number_employees#19643,s_floor_space#19644,s_hours#19645,s_manager#19646,s_market_id#19647,s_geography_class#19648,s_market_desc#19649,s_market_manager#19650,s_division_id#19651,s_division_name#19652,s_company_id#19653,s_company_name#19654,s_street_number#19655,s_street_name#19656,s_street_type#19657,s_suite_number#19658,s_city#19659,s_county#19660,s_state#19661,s_zip#19662,s_country#19663,s_gmt_offset#19664,s_tax_percentage#19665] parquet, Statistics(sizeInBytes=101.7 KiB)
+- Aggregate [count(1) AS h12_to_12_30#19255L], Statistics(sizeInBytes=16.0 B, rowCount=1)
   +- Project, Statistics(sizeInBytes=85.5 EiB)
      +- Join Inner, (ss_store_sk#19673 = s_store_sk#19704), Statistics(sizeInBytes=170.9 EiB)
         :- Project [ss_store_sk#19673], Statistics(sizeInBytes=58.8 PiB)
         :  +- Join Inner, (ss_sold_time_sk#19667 = t_time_sk#19694), Statistics(sizeInBytes=98.1 PiB)
         :     :- Project [ss_sold_time_sk#19667, ss_store_sk#19673], Statistics(sizeInBytes=737.4 GiB)
         :     :  +- Join Inner, (ss_hdemo_sk#19671 = hd_demo_sk#19689), Statistics(sizeInBytes=1106.2 GiB)
         :     :     :- Project [ss_sold_time_sk#19667, ss_hdemo_sk#19671, ss_store_sk#19673], Statistics(sizeInBytes=19.1 MiB)
         :     :     :  +- Filter (isnotnull(ss_hdemo_sk#19671) AND (isnotnull(ss_sold_time_sk#19667) AND isnotnull(ss_store_sk#19673))), Statistics(sizeInBytes=141.1 MiB)
         :     :     :     +- Relation default.store_sales[ss_sold_date_sk#19666,ss_sold_time_sk#19667,ss_item_sk#19668,ss_customer_sk#19669,ss_cdemo_sk#19670,ss_hdemo_sk#19671,ss_addr_sk#19672,ss_store_sk#19673,ss_promo_sk#19674,ss_ticket_number#19675,ss_quantity#19676,ss_wholesale_cost#19677,ss_list_price#19678,ss_sales_price#19679,ss_ext_discount_amt#19680,ss_ext_sales_price#19681,ss_ext_wholesale_cost#19682,ss_ext_list_price#19683,ss_ext_tax#19684,ss_coupon_amt#19685,ss_net_paid#19686,ss_net_paid_inc_tax#19687,ss_net_profit#19688] parquet, Statistics(sizeInBytes=141.1 MiB)
         :     :     +- Project [hd_demo_sk#19689], Statistics(sizeInBytes=58.0 KiB)
         :     :        +- Filter (((((hd_dep_count#19692 = 4) AND (hd_vehicle_count#19693 <= 6)) OR ((hd_dep_count#19692 = 2) AND (hd_vehicle_count#19693 <= 4))) OR ((hd_dep_count#19692 = 0) AND (hd_vehicle_count#19693 <= 2))) AND isnotnull(hd_demo_sk#19689)), Statistics(sizeInBytes=212.8 KiB)
         :     :           +- Relation default.household_demographics[hd_demo_sk#19689,hd_income_band_sk#19690,hd_buy_potential#19691,hd_dep_count#19692,hd_vehicle_count#19693] parquet, Statistics(sizeInBytes=212.8 KiB)
         :     +- Project [t_time_sk#19694], Statistics(sizeInBytes=136.2 KiB)
         :        +- Filter (((isnotnull(t_hour#19697) AND isnotnull(t_minute#19698)) AND ((t_hour#19697 = 12) AND (t_minute#19698 < 30))) AND isnotnull(t_time_sk#19694)), Statistics(sizeInBytes=1452.6 KiB)
         :           +- Relation default.time_dim[t_time_sk#19694,t_time_id#19695,t_time#19696,t_hour#19697,t_minute#19698,t_second#19699,t_am_pm#19700,t_shift#19701,t_sub_shift#19702,t_meal_time#19703] parquet, Statistics(sizeInBytes=1452.6 KiB)
         +- Project [s_store_sk#19704], Statistics(sizeInBytes=2.9 KiB)
            +- Filter ((isnotnull(s_store_name#19709) AND (s_store_name#19709 = ese)) AND isnotnull(s_store_sk#19704)), Statistics(sizeInBytes=101.7 KiB)
               +- Relation default.store[s_store_sk#19704,s_store_id#19705,s_rec_start_date#19706,s_rec_end_date#19707,s_closed_date_sk#19708,s_store_name#19709,s_number_employees#19710,s_floor_space#19711,s_hours#19712,s_manager#19713,s_market_id#19714,s_geography_class#19715,s_market_desc#19716,s_market_manager#19717,s_division_id#19718,s_division_name#19719,s_company_id#19720,s_company_name#19721,s_street_number#19722,s_street_name#19723,s_street_type#19724,s_suite_number#19725,s_city#19726,s_county#19727,s_state#19728,s_zip#19729,s_country#19730,s_gmt_offset#19731,s_tax_percentage#19732] parquet, Statistics(sizeInBytes=101.7 KiB)


==== q89 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=13.3 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=3.62E+22 B)
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#19785 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#19786 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, s_store_name#57 ASC NULLS FIRST], true, Statistics(sizeInBytes=3.62E+22 B)
      +- Project [i_category#449, i_class#447, i_brand#445, s_store_name#57, s_company_name#69, d_moy#32, sum_sales#19785, avg_monthly_sales#19786], Statistics(sizeInBytes=3.62E+22 B)
         +- Filter CASE WHEN NOT (avg_monthly_sales#19786 = 0.000000) THEN (CheckOverflow((promote_precision(abs(CheckOverflow((promote_precision(cast(sum_sales#19785 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#19786 as decimal(22,6)))), DecimalType(22,6)))) / promote_precision(cast(avg_monthly_sales#19786 as decimal(22,6)))), DecimalType(38,16)) > 0.1000000000000000) END, Statistics(sizeInBytes=3.83E+22 B)
            +- Window [avg(_w0#19790) windowspecdefinition(i_category#449, i_brand#445, s_store_name#57, s_company_name#69, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#19786], [i_category#449, i_brand#445, s_store_name#57, s_company_name#69], Statistics(sizeInBytes=3.83E+22 B)
               +- Aggregate [i_category#449, i_class#447, i_brand#445, s_store_name#57, s_company_name#69, d_moy#32], [i_category#449, i_class#447, i_brand#445, s_store_name#57, s_company_name#69, d_moy#32, MakeDecimal(sum(UnscaledValue(ss_sales_price#427)),17,2) AS sum_sales#19785, MakeDecimal(sum(UnscaledValue(ss_sales_price#427)),17,2) AS _w0#19790], Statistics(sizeInBytes=3.41E+22 B)
                  +- Project [i_brand#445, i_class#447, i_category#449, ss_sales_price#427, d_moy#32, s_store_name#57, s_company_name#69], Statistics(sizeInBytes=3.20E+22 B)
                     +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=3.41E+22 B)
                        :- Project [i_brand#445, i_class#447, i_category#449, ss_store_sk#421, ss_sales_price#427, d_moy#32], Statistics(sizeInBytes=2.3 EiB)
                        :  +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2.5 EiB)
                        :     :- Project [i_brand#445, i_class#447, i_category#449, ss_sold_date_sk#414, ss_store_sk#421, ss_sales_price#427], Statistics(sizeInBytes=18.3 TiB)
                        :     :  +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=20.1 TiB)
                        :     :     :- Project [i_item_sk#437, i_brand#445, i_class#447, i_category#449], Statistics(sizeInBytes=770.1 KiB)
                        :     :     :  +- Filter (((i_category#449 IN (Books                                             ,Electronics                                       ,Sports                                            ) AND i_class#447 IN (computers                                         ,stereo                                            ,football                                          )) OR (i_category#449 IN (Men                                               ,Jewelry                                           ,Women                                             ) AND i_class#447 IN (shirts                                            ,birdal                                            ,dresses                                           ))) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
                        :     :     :     +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
                        :     :     +- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_store_sk#421, ss_sales_price#427], Statistics(sizeInBytes=26.7 MiB)
                        :     :        +- Filter (isnotnull(ss_item_sk#416) AND (isnotnull(ss_sold_date_sk#414) AND isnotnull(ss_store_sk#421))), Statistics(sizeInBytes=141.1 MiB)
                        :     :           +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                        :     +- Project [d_date_sk#24, d_moy#32], Statistics(sizeInBytes=140.4 KiB)
                        :        +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 1999)) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                        :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
                        +- Project [s_store_sk#52, s_store_name#57, s_company_name#69], Statistics(sizeInBytes=12.6 KiB)
                           +- Filter isnotnull(s_store_sk#52), Statistics(sizeInBytes=101.7 KiB)
                              +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)


==== q90 ====
== Optimized Logical Plan ==
Project [CheckOverflow((promote_precision(cast(amc#19809L as decimal(15,4))) / promote_precision(cast(pmc#19810L as decimal(15,4)))), DecimalType(35,20)) AS am_pm_ratio#19811], Statistics(sizeInBytes=256.0 B)
+- Join Inner, Statistics(sizeInBytes=256.0 B)
   :- Aggregate [count(1) AS amc#19809L], Statistics(sizeInBytes=16.0 B, rowCount=1)
   :  +- Project, Statistics(sizeInBytes=182.4 EiB)
   :     +- Join Inner, (ws_web_page_sk#175 = wp_web_page_sk#17839), Statistics(sizeInBytes=364.7 EiB)
   :        :- Project [ws_web_page_sk#175], Statistics(sizeInBytes=15.7 PiB)
   :        :  +- Join Inner, (ws_sold_time_sk#164 = t_time_sk#15927), Statistics(sizeInBytes=26.2 PiB)
   :        :     :- Project [ws_sold_time_sk#164, ws_web_page_sk#175], Statistics(sizeInBytes=197.1 GiB)
   :        :     :  +- Join Inner, (ws_ship_hdemo_sk#173 = hd_demo_sk#5551), Statistics(sizeInBytes=295.7 GiB)
   :        :     :     :- Project [ws_sold_time_sk#164, ws_ship_hdemo_sk#173, ws_web_page_sk#175], Statistics(sizeInBytes=5.1 MiB)
   :        :     :     :  +- Filter (isnotnull(ws_ship_hdemo_sk#173) AND (isnotnull(ws_sold_time_sk#164) AND isnotnull(ws_web_page_sk#175))), Statistics(sizeInBytes=52.0 MiB)
   :        :     :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
   :        :     :     +- Project [hd_demo_sk#5551], Statistics(sizeInBytes=58.0 KiB)
   :        :     :        +- Filter ((isnotnull(hd_dep_count#5554) AND (hd_dep_count#5554 = 6)) AND isnotnull(hd_demo_sk#5551)), Statistics(sizeInBytes=212.8 KiB)
   :        :     :           +- Relation default.household_demographics[hd_demo_sk#5551,hd_income_band_sk#5552,hd_buy_potential#5553,hd_dep_count#5554,hd_vehicle_count#5555] parquet, Statistics(sizeInBytes=212.8 KiB)
   :        :     +- Project [t_time_sk#15927], Statistics(sizeInBytes=136.2 KiB)
   :        :        +- Filter ((isnotnull(t_hour#15930) AND ((t_hour#15930 >= 8) AND (t_hour#15930 <= 9))) AND isnotnull(t_time_sk#15927)), Statistics(sizeInBytes=1452.6 KiB)
   :        :           +- Relation default.time_dim[t_time_sk#15927,t_time_id#15928,t_time#15929,t_hour#15930,t_minute#15931,t_second#15932,t_am_pm#15933,t_shift#15934,t_sub_shift#15935,t_meal_time#15936] parquet, Statistics(sizeInBytes=1452.6 KiB)
   :        +- Project [wp_web_page_sk#17839], Statistics(sizeInBytes=23.2 KiB)
   :           +- Filter ((isnotnull(wp_char_count#17849) AND ((wp_char_count#17849 >= 5000) AND (wp_char_count#17849 <= 5200))) AND isnotnull(wp_web_page_sk#17839)), Statistics(sizeInBytes=247.3 KiB)
   :              +- Relation default.web_page[wp_web_page_sk#17839,wp_web_page_id#17840,wp_rec_start_date#17841,wp_rec_end_date#17842,wp_creation_date_sk#17843,wp_access_date_sk#17844,wp_autogen_flag#17845,wp_customer_sk#17846,wp_url#17847,wp_type#17848,wp_char_count#17849,wp_link_count#17850,wp_image_count#17851,wp_max_ad_count#17852] parquet, Statistics(sizeInBytes=247.3 KiB)
   +- Aggregate [count(1) AS pmc#19810L], Statistics(sizeInBytes=16.0 B, rowCount=1)
      +- Project, Statistics(sizeInBytes=182.4 EiB)
         +- Join Inner, (ws_web_page_sk#19826 = wp_web_page_sk#19863), Statistics(sizeInBytes=364.7 EiB)
            :- Project [ws_web_page_sk#19826], Statistics(sizeInBytes=15.7 PiB)
            :  +- Join Inner, (ws_sold_time_sk#19815 = t_time_sk#19853), Statistics(sizeInBytes=26.2 PiB)
            :     :- Project [ws_sold_time_sk#19815, ws_web_page_sk#19826], Statistics(sizeInBytes=197.1 GiB)
            :     :  +- Join Inner, (ws_ship_hdemo_sk#19824 = hd_demo_sk#19848), Statistics(sizeInBytes=295.7 GiB)
            :     :     :- Project [ws_sold_time_sk#19815, ws_ship_hdemo_sk#19824, ws_web_page_sk#19826], Statistics(sizeInBytes=5.1 MiB)
            :     :     :  +- Filter (isnotnull(ws_ship_hdemo_sk#19824) AND (isnotnull(ws_sold_time_sk#19815) AND isnotnull(ws_web_page_sk#19826))), Statistics(sizeInBytes=52.0 MiB)
            :     :     :     +- Relation default.web_sales[ws_sold_date_sk#19814,ws_sold_time_sk#19815,ws_ship_date_sk#19816,ws_item_sk#19817,ws_bill_customer_sk#19818,ws_bill_cdemo_sk#19819,ws_bill_hdemo_sk#19820,ws_bill_addr_sk#19821,ws_ship_customer_sk#19822,ws_ship_cdemo_sk#19823,ws_ship_hdemo_sk#19824,ws_ship_addr_sk#19825,ws_web_page_sk#19826,ws_web_site_sk#19827,ws_ship_mode_sk#19828,ws_warehouse_sk#19829,ws_promo_sk#19830,ws_order_number#19831,ws_quantity#19832,ws_wholesale_cost#19833,ws_list_price#19834,ws_sales_price#19835,ws_ext_discount_amt#19836,ws_ext_sales_price#19837,ws_ext_wholesale_cost#19838,ws_ext_list_price#19839,ws_ext_tax#19840,ws_coupon_amt#19841,ws_ext_ship_cost#19842,ws_net_paid#19843,ws_net_paid_inc_tax#19844,ws_net_paid_inc_ship#19845,ws_net_paid_inc_ship_tax#19846,ws_net_profit#19847] parquet, Statistics(sizeInBytes=52.0 MiB)
            :     :     +- Project [hd_demo_sk#19848], Statistics(sizeInBytes=58.0 KiB)
            :     :        +- Filter ((isnotnull(hd_dep_count#19851) AND (hd_dep_count#19851 = 6)) AND isnotnull(hd_demo_sk#19848)), Statistics(sizeInBytes=212.8 KiB)
            :     :           +- Relation default.household_demographics[hd_demo_sk#19848,hd_income_band_sk#19849,hd_buy_potential#19850,hd_dep_count#19851,hd_vehicle_count#19852] parquet, Statistics(sizeInBytes=212.8 KiB)
            :     +- Project [t_time_sk#19853], Statistics(sizeInBytes=136.2 KiB)
            :        +- Filter ((isnotnull(t_hour#19856) AND ((t_hour#19856 >= 19) AND (t_hour#19856 <= 20))) AND isnotnull(t_time_sk#19853)), Statistics(sizeInBytes=1452.6 KiB)
            :           +- Relation default.time_dim[t_time_sk#19853,t_time_id#19854,t_time#19855,t_hour#19856,t_minute#19857,t_second#19858,t_am_pm#19859,t_shift#19860,t_sub_shift#19861,t_meal_time#19862] parquet, Statistics(sizeInBytes=1452.6 KiB)
            +- Project [wp_web_page_sk#19863], Statistics(sizeInBytes=23.2 KiB)
               +- Filter ((isnotnull(wp_char_count#19873) AND ((wp_char_count#19873 >= 5000) AND (wp_char_count#19873 <= 5200))) AND isnotnull(wp_web_page_sk#19863)), Statistics(sizeInBytes=247.3 KiB)
                  +- Relation default.web_page[wp_web_page_sk#19863,wp_web_page_id#19864,wp_rec_start_date#19865,wp_rec_end_date#19866,wp_creation_date_sk#19867,wp_access_date_sk#19868,wp_autogen_flag#19869,wp_customer_sk#19870,wp_url#19871,wp_type#19872,wp_char_count#19873,wp_link_count#19874,wp_image_count#19875,wp_max_ad_count#19876] parquet, Statistics(sizeInBytes=247.3 KiB)



==== q91 ====
== Optimized Logical Plan ==
Sort [Returns_Loss#19889 DESC NULLS LAST], true, Statistics(sizeInBytes=2.85E+37 B)
+- Aggregate [cc_call_center_id#7109, cc_name#7114, cc_manager#7119, cd_marital_status#3635, cd_education_status#3636], [cc_call_center_id#7109 AS Call_Center#19886, cc_name#7114 AS Call_Center_Name#19887, cc_manager#7119 AS Manager#19888, MakeDecimal(sum(UnscaledValue(cr_net_loss#3317)),17,2) AS Returns_Loss#19889], Statistics(sizeInBytes=2.85E+37 B)
   +- Project [cc_call_center_id#7109, cc_name#7114, cc_manager#7119, cr_net_loss#3317, cd_marital_status#3635, cd_education_status#3636], Statistics(sizeInBytes=4.35E+37 B)
      +- Join Inner, (hd_demo_sk#5551 = c_current_hdemo_sk#84), Statistics(sizeInBytes=4.65E+37 B)
         :- Project [cc_call_center_id#7109, cc_name#7114, cc_manager#7119, cr_net_loss#3317, c_current_hdemo_sk#84, cd_marital_status#3635, cd_education_status#3636], Statistics(sizeInBytes=7.83E+32 B)
         :  +- Join Inner, (cd_demo_sk#3633 = c_current_cdemo_sk#83), Statistics(sizeInBytes=8.36E+32 B)
         :     :- Project [cc_call_center_id#7109, cc_name#7114, cc_manager#7119, cr_net_loss#3317, c_current_cdemo_sk#83, c_current_hdemo_sk#84], Statistics(sizeInBytes=2.14E+26 B)
         :     :  +- Join Inner, (ca_address_sk#3717 = c_current_addr_sk#85), Statistics(sizeInBytes=2.35E+26 B)
         :     :     :- Project [cc_call_center_id#7109, cc_name#7114, cc_manager#7119, cr_net_loss#3317, c_current_cdemo_sk#83, c_current_hdemo_sk#84, c_current_addr_sk#85], Statistics(sizeInBytes=1575.9 EiB)
         :     :     :  +- Join Inner, (cr_returning_customer_sk#3298 = c_customer_sk#81), Statistics(sizeInBytes=1719.2 EiB)
         :     :     :     :- Project [cc_call_center_id#7109, cc_name#7114, cc_manager#7119, cr_returning_customer_sk#3298, cr_net_loss#3317], Statistics(sizeInBytes=1910.7 TiB)
         :     :     :     :  +- Join Inner, (cr_returned_date_sk#3291 = d_date_sk#24), Statistics(sizeInBytes=2.1 PiB)
         :     :     :     :     :- Project [cc_call_center_id#7109, cc_name#7114, cc_manager#7119, cr_returned_date_sk#3291, cr_returning_customer_sk#3298, cr_net_loss#3317], Statistics(sizeInBytes=20.0 GiB)
         :     :     :     :     :  +- Join Inner, (cr_call_center_sk#3302 = cc_call_center_sk#7108), Statistics(sizeInBytes=21.9 GiB)
         :     :     :     :     :     :- Project [cc_call_center_sk#7108, cc_call_center_id#7109, cc_name#7114, cc_manager#7119], Statistics(sizeInBytes=9.4 KiB)
         :     :     :     :     :     :  +- Filter isnotnull(cc_call_center_sk#7108), Statistics(sizeInBytes=58.2 KiB)
         :     :     :     :     :     :     +- Relation default.call_center[cc_call_center_sk#7108,cc_call_center_id#7109,cc_rec_start_date#7110,cc_rec_end_date#7111,cc_closed_date_sk#7112,cc_open_date_sk#7113,cc_name#7114,cc_class#7115,cc_employees#7116,cc_sq_ft#7117,cc_hours#7118,cc_manager#7119,cc_mkt_id#7120,cc_mkt_class#7121,cc_mkt_desc#7122,cc_market_manager#7123,cc_division#7124,cc_division_name#7125,cc_company#7126,cc_company_name#7127,cc_street_number#7128,cc_street_name#7129,cc_street_type#7130,cc_suite_number#7131,cc_city#7132,cc_county#7133,cc_state#7134,cc_zip#7135,cc_country#7136,cc_gmt_offset#7137,cc_tax_percentage#7138] parquet, Statistics(sizeInBytes=58.2 KiB)
         :     :     :     :     :     +- Project [cr_returned_date_sk#3291, cr_returning_customer_sk#3298, cr_call_center_sk#3302, cr_net_loss#3317], Statistics(sizeInBytes=2.3 MiB)
         :     :     :     :     :        +- Filter (isnotnull(cr_call_center_sk#3302) AND (isnotnull(cr_returned_date_sk#3291) AND isnotnull(cr_returning_customer_sk#3298))), Statistics(sizeInBytes=12.6 MiB)
         :     :     :     :     :           +- Relation default.catalog_returns[cr_returned_date_sk#3291,cr_returned_time_sk#3292,cr_item_sk#3293,cr_refunded_customer_sk#3294,cr_refunded_cdemo_sk#3295,cr_refunded_hdemo_sk#3296,cr_refunded_addr_sk#3297,cr_returning_customer_sk#3298,cr_returning_cdemo_sk#3299,cr_returning_hdemo_sk#3300,cr_returning_addr_sk#3301,cr_call_center_sk#3302,cr_catalog_page_sk#3303,cr_ship_mode_sk#3304,cr_warehouse_sk#3305,cr_reason_sk#3306,cr_order_number#3307,cr_return_quantity#3308,cr_return_amount#3309,cr_return_tax#3310,cr_return_amt_inc_tax#3311,cr_fee#3312,cr_return_ship_cost#3313,cr_refunded_cash#3314,cr_reversed_charge#3315,cr_store_credit#3316,cr_net_loss#3317] parquet, Statistics(sizeInBytes=12.6 MiB)
         :     :     :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
         :     :     :     :        +- Filter (((isnotnull(d_year#30) AND isnotnull(d_moy#32)) AND ((d_year#30 = 1998) AND (d_moy#32 = 11))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
         :     :     :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
         :     :     :     +- Project [c_customer_sk#81, c_current_cdemo_sk#83, c_current_hdemo_sk#84, c_current_addr_sk#85], Statistics(sizeInBytes=921.4 KiB)
         :     :     :        +- Filter ((isnotnull(c_customer_sk#81) AND isnotnull(c_current_addr_sk#85)) AND (isnotnull(c_current_cdemo_sk#83) AND isnotnull(c_current_hdemo_sk#84))), Statistics(sizeInBytes=7.8 MiB)
         :     :     :           +- Relation default.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet, Statistics(sizeInBytes=7.8 MiB)
         :     :     +- Project [ca_address_sk#3717], Statistics(sizeInBytes=126.2 KiB)
         :     :        +- Filter ((isnotnull(ca_gmt_offset#3728) AND (ca_gmt_offset#3728 = -7.00)) AND isnotnull(ca_address_sk#3717)), Statistics(sizeInBytes=2.5 MiB)
         :     :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
         :     +- Project [cd_demo_sk#3633, cd_marital_status#3635, cd_education_status#3636], Statistics(sizeInBytes=3.7 MiB)
         :        +- Filter ((((cd_marital_status#3635 = M) AND (cd_education_status#3636 = Unknown             )) OR ((cd_marital_status#3635 = W) AND (cd_education_status#3636 = Advanced Degree     ))) AND isnotnull(cd_demo_sk#3633)), Statistics(sizeInBytes=7.7 MiB)
         :           +- Relation default.customer_demographics[cd_demo_sk#3633,cd_gender#3634,cd_marital_status#3635,cd_education_status#3636,cd_purchase_estimate#3637,cd_credit_rating#3638,cd_dep_count#3639,cd_dep_employed_count#3640,cd_dep_college_count#3641] parquet, Statistics(sizeInBytes=7.7 MiB)
         +- Project [hd_demo_sk#5551], Statistics(sizeInBytes=58.0 KiB)
            +- Filter ((isnotnull(hd_buy_potential#5553) AND StartsWith(hd_buy_potential#5553, Unknown)) AND isnotnull(hd_demo_sk#5551)), Statistics(sizeInBytes=212.8 KiB)
               +- Relation default.household_demographics[hd_demo_sk#5551,hd_income_band_sk#5552,hd_buy_potential#5553,hd_dep_count#5554,hd_vehicle_count#5555] parquet, Statistics(sizeInBytes=212.8 KiB)


==== q92 ====
== Optimized Logical Plan ==
Aggregate [MakeDecimal(sum(UnscaledValue(ws_ext_discount_amt#185)),17,2) AS Excess Discount Amount #19903], Statistics(sizeInBytes=16.0 B, rowCount=1)
+- Project [ws_ext_discount_amt#185], Statistics(sizeInBytes=1.43E+28 B)
   +- Join Inner, (d_date_sk#24 = ws_sold_date_sk#163), Statistics(sizeInBytes=2.14E+28 B)
      :- Project [ws_sold_date_sk#163, ws_ext_discount_amt#185], Statistics(sizeInBytes=1.98E+23 B)
      :  +- Join Inner, ((cast(ws_ext_discount_amt#185 as decimal(14,7)) > (1.3 * avg(ws_ext_discount_amt))#19906) AND (ws_item_sk#19910 = i_item_sk#437)), Statistics(sizeInBytes=3.57E+23 B)
      :     :- Project [ws_sold_date_sk#163, ws_ext_discount_amt#185, i_item_sk#437], Statistics(sizeInBytes=672.8 GiB)
      :     :  +- Join Inner, (i_item_sk#437 = ws_item_sk#166), Statistics(sizeInBytes=784.9 GiB)
      :     :     :- Project [ws_sold_date_sk#163, ws_item_sk#166, ws_ext_discount_amt#185], Statistics(sizeInBytes=6.1 MiB)
      :     :     :  +- Filter (isnotnull(ws_item_sk#166) AND (isnotnull(ws_ext_discount_amt#185) AND isnotnull(ws_sold_date_sk#163))), Statistics(sizeInBytes=52.0 MiB)
      :     :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
      :     :     +- Project [i_item_sk#437], Statistics(sizeInBytes=128.3 KiB)
      :     :        +- Filter ((isnotnull(i_manufact_id#450) AND (i_manufact_id#450 = 350)) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
      :     :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
      :     +- Filter isnotnull((1.3 * avg(ws_ext_discount_amt))#19906), Statistics(sizeInBytes=460.0 GiB)
      :        +- Aggregate [ws_item_sk#19910], [CheckOverflow((1.300000 * promote_precision(cast((avg(UnscaledValue(ws_ext_discount_amt#19929)) / 100.0) as decimal(11,6)))), DecimalType(14,7)) AS (1.3 * avg(ws_ext_discount_amt))#19906, ws_item_sk#19910], Statistics(sizeInBytes=460.0 GiB)
      :           +- Project [ws_item_sk#19910, ws_ext_discount_amt#19929], Statistics(sizeInBytes=460.0 GiB)
      :              +- Join Inner, (d_date_sk#19941 = ws_sold_date_sk#19907), Statistics(sizeInBytes=644.0 GiB)
      :                 :- Project [ws_sold_date_sk#19907, ws_item_sk#19910, ws_ext_discount_amt#19929], Statistics(sizeInBytes=6.1 MiB)
      :                 :  +- Filter (isnotnull(ws_sold_date_sk#19907) AND isnotnull(ws_item_sk#19910)), Statistics(sizeInBytes=52.0 MiB)
      :                 :     +- Relation default.web_sales[ws_sold_date_sk#19907,ws_sold_time_sk#19908,ws_ship_date_sk#19909,ws_item_sk#19910,ws_bill_customer_sk#19911,ws_bill_cdemo_sk#19912,ws_bill_hdemo_sk#19913,ws_bill_addr_sk#19914,ws_ship_customer_sk#19915,ws_ship_cdemo_sk#19916,ws_ship_hdemo_sk#19917,ws_ship_addr_sk#19918,ws_web_page_sk#19919,ws_web_site_sk#19920,ws_ship_mode_sk#19921,ws_warehouse_sk#19922,ws_promo_sk#19923,ws_order_number#19924,ws_quantity#19925,ws_wholesale_cost#19926,ws_list_price#19927,ws_sales_price#19928,ws_ext_discount_amt#19929,ws_ext_sales_price#19930,ws_ext_wholesale_cost#19931,ws_ext_list_price#19932,ws_ext_tax#19933,ws_coupon_amt#19934,ws_ext_ship_cost#19935,ws_net_paid#19936,ws_net_paid_inc_tax#19937,ws_net_paid_inc_ship#19938,ws_net_paid_inc_ship_tax#19939,ws_net_profit#19940] parquet, Statistics(sizeInBytes=52.0 MiB)
      :                 +- Project [d_date_sk#19941], Statistics(sizeInBytes=105.3 KiB)
      :                    +- Filter ((isnotnull(d_date#19943) AND ((d_date#19943 >= 2000-01-27) AND (d_date#19943 <= 2000-04-26))) AND isnotnull(d_date_sk#19941)), Statistics(sizeInBytes=2.5 MiB)
      :                       +- Relation default.date_dim[d_date_sk#19941,d_date_id#19942,d_date#19943,d_month_seq#19944,d_week_seq#19945,d_quarter_seq#19946,d_year#19947,d_dow#19948,d_moy#19949,d_dom#19950,d_qoy#19951,d_fy_year#19952,d_fy_quarter_seq#19953,d_fy_week_seq#19954,d_day_name#19955,d_quarter_name#19956,d_holiday#19957,d_weekend#19958,d_following_holiday#19959,d_first_dom#19960,d_last_dom#19961,d_same_day_ly#19962,d_same_day_lq#19963,d_current_day#19964,d_current_week#19965,d_current_month#19966,d_current_quarter#19967,d_current_year#19968] parquet, Statistics(sizeInBytes=2.5 MiB)
      +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
         +- Filter ((isnotnull(d_date#26) AND ((d_date#26 >= 2000-01-27) AND (d_date#26 <= 2000-04-26))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
            +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q93 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=2.7 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=737.7 PiB)
   +- Sort [sumsales#19995 ASC NULLS FIRST, ss_customer_sk#417 ASC NULLS FIRST], true, Statistics(sizeInBytes=737.7 PiB)
      +- Aggregate [ss_customer_sk#417], [ss_customer_sk#417, sum(act_sales#19994) AS sumsales#19995], Statistics(sizeInBytes=737.7 PiB)
         +- Project [ss_customer_sk#417, CASE WHEN isnotnull(sr_return_quantity#14) THEN CheckOverflow((promote_precision(cast((ss_quantity#424 - sr_return_quantity#14) as decimal(12,2))) * promote_precision(cast(ss_sales_price#427 as decimal(12,2)))), DecimalType(18,2)) ELSE CheckOverflow((promote_precision(cast(ss_quantity#424 as decimal(12,2))) * promote_precision(cast(ss_sales_price#427 as decimal(12,2)))), DecimalType(18,2)) END AS act_sales#19994], Statistics(sizeInBytes=526.9 PiB)
            +- Join Inner, (sr_reason_sk#12 = r_reason_sk#3780), Statistics(sizeInBytes=948.4 PiB)
               :- Project [ss_customer_sk#417, ss_quantity#424, ss_sales_price#427, sr_reason_sk#12, sr_return_quantity#14], Statistics(sizeInBytes=74.9 TiB)
               :  +- Join Inner, ((sr_item_sk#6 = ss_item_sk#416) AND (sr_ticket_number#13 = ss_ticket_number#423)), Statistics(sizeInBytes=112.3 TiB)
               :     :- Project [ss_item_sk#416, ss_customer_sk#417, ss_ticket_number#423, ss_quantity#424, ss_sales_price#427], Statistics(sizeInBytes=30.5 MiB)
               :     :  +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
               :     +- Project [sr_item_sk#6, sr_reason_sk#12, sr_ticket_number#13, sr_return_quantity#14], Statistics(sizeInBytes=3.7 MiB)
               :        +- Filter ((isnotnull(sr_item_sk#6) AND isnotnull(sr_ticket_number#13)) AND isnotnull(sr_reason_sk#12)), Statistics(sizeInBytes=19.0 MiB)
               :           +- Relation default.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet, Statistics(sizeInBytes=19.0 MiB)
               +- Project [r_reason_sk#3780], Statistics(sizeInBytes=12.7 KiB)
                  +- Filter ((isnotnull(r_reason_desc#3782) AND (r_reason_desc#3782 = reason 28                                                                                           )) AND isnotnull(r_reason_sk#3780)), Statistics(sizeInBytes=54.9 KiB)
                     +- Relation default.reason[r_reason_sk#3780,r_reason_id#3781,r_reason_desc#3782] parquet, Statistics(sizeInBytes=54.9 KiB)


==== q94 ====
== Optimized Logical Plan ==
Aggregate [count(distinct ws_order_number#180) AS order count #20009L, MakeDecimal(sum(UnscaledValue(ws_ext_ship_cost#191)),17,2) AS total shipping cost #20010, MakeDecimal(sum(UnscaledValue(ws_net_profit#196)),17,2) AS total net profit #20011], Statistics(sizeInBytes=32.0 B, rowCount=1)
+- Project [ws_order_number#180, ws_ext_ship_cost#191, ws_net_profit#196], Statistics(sizeInBytes=513.2 EiB)
   +- Join Inner, (ws_web_site_sk#176 = web_site_sk#3351), Statistics(sizeInBytes=659.9 EiB)
      :- Project [ws_web_site_sk#176, ws_order_number#180, ws_ext_ship_cost#191, ws_net_profit#196], Statistics(sizeInBytes=86.6 PiB)
      :  +- Join Inner, (ws_ship_addr_sk#174 = ca_address_sk#3717), Statistics(sizeInBytes=108.2 PiB)
      :     :- Project [ws_ship_addr_sk#174, ws_web_site_sk#176, ws_order_number#180, ws_ext_ship_cost#191, ws_net_profit#196], Statistics(sizeInBytes=878.2 GiB)
      :     :  +- Join Inner, (ws_ship_date_sk#165 = d_date_sk#24), Statistics(sizeInBytes=1073.3 GiB)
      :     :     :- Join LeftAnti, (ws_order_number#180 = wr_order_number#3340), Statistics(sizeInBytes=10.2 MiB)
      :     :     :  :- Project [ws_ship_date_sk#165, ws_ship_addr_sk#174, ws_web_site_sk#176, ws_order_number#180, ws_ext_ship_cost#191, ws_net_profit#196], Statistics(sizeInBytes=10.2 MiB)
      :     :     :  :  +- Join LeftSemi, ((ws_order_number#180 = ws_order_number#20031) AND NOT (ws_warehouse_sk#178 = ws_warehouse_sk#20029)), Statistics(sizeInBytes=11.2 MiB)
      :     :     :  :     :- Project [ws_ship_date_sk#165, ws_ship_addr_sk#174, ws_web_site_sk#176, ws_warehouse_sk#178, ws_order_number#180, ws_ext_ship_cost#191, ws_net_profit#196], Statistics(sizeInBytes=11.2 MiB)
      :     :     :  :     :  +- Filter ((isnotnull(ws_ship_date_sk#165) AND isnotnull(ws_ship_addr_sk#174)) AND isnotnull(ws_web_site_sk#176)), Statistics(sizeInBytes=52.0 MiB)
      :     :     :  :     :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
      :     :     :  :     +- Project [ws_warehouse_sk#20029, ws_order_number#20031], Statistics(sizeInBytes=4.1 MiB)
      :     :     :  :        +- Relation default.web_sales[ws_sold_date_sk#20014,ws_sold_time_sk#20015,ws_ship_date_sk#20016,ws_item_sk#20017,ws_bill_customer_sk#20018,ws_bill_cdemo_sk#20019,ws_bill_hdemo_sk#20020,ws_bill_addr_sk#20021,ws_ship_customer_sk#20022,ws_ship_cdemo_sk#20023,ws_ship_hdemo_sk#20024,ws_ship_addr_sk#20025,ws_web_page_sk#20026,ws_web_site_sk#20027,ws_ship_mode_sk#20028,ws_warehouse_sk#20029,ws_promo_sk#20030,ws_order_number#20031,ws_quantity#20032,ws_wholesale_cost#20033,ws_list_price#20034,ws_sales_price#20035,ws_ext_discount_amt#20036,ws_ext_sales_price#20037,ws_ext_wholesale_cost#20038,ws_ext_list_price#20039,ws_ext_tax#20040,ws_coupon_amt#20041,ws_ext_ship_cost#20042,ws_net_paid#20043,ws_net_paid_inc_tax#20044,ws_net_paid_inc_ship#20045,ws_net_paid_inc_ship_tax#20046,ws_net_profit#20047] parquet, Statistics(sizeInBytes=52.0 MiB)
      :     :     :  +- Project [wr_order_number#3340], Statistics(sizeInBytes=570.5 KiB)
      :     :     :     +- Relation default.web_returns[wr_returned_date_sk#3327,wr_returned_time_sk#3328,wr_item_sk#3329,wr_refunded_customer_sk#3330,wr_refunded_cdemo_sk#3331,wr_refunded_hdemo_sk#3332,wr_refunded_addr_sk#3333,wr_returning_customer_sk#3334,wr_returning_cdemo_sk#3335,wr_returning_hdemo_sk#3336,wr_returning_addr_sk#3337,wr_web_page_sk#3338,wr_reason_sk#3339,wr_order_number#3340,wr_return_quantity#3341,wr_return_amt#3342,wr_return_tax#3343,wr_return_amt_inc_tax#3344,wr_fee#3345,wr_return_ship_cost#3346,wr_refunded_cash#3347,wr_reversed_charge#3348,wr_account_credit#3349,wr_net_loss#3350] parquet, Statistics(sizeInBytes=6.5 MiB)
      :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
      :     :        +- Filter ((isnotnull(d_date#26) AND ((d_date#26 >= 1999-02-01) AND (d_date#26 <= 1999-04-02))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
      :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
      :     +- Project [ca_address_sk#3717], Statistics(sizeInBytes=126.2 KiB)
      :        +- Filter ((isnotnull(ca_state#3725) AND (ca_state#3725 = IL)) AND isnotnull(ca_address_sk#3717)), Statistics(sizeInBytes=2.5 MiB)
      :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
      +- Project [web_site_sk#3351], Statistics(sizeInBytes=7.6 KiB)
         +- Filter ((isnotnull(web_company_name#3365) AND (web_company_name#3365 = pri                                               )) AND isnotnull(web_site_sk#3351)), Statistics(sizeInBytes=249.1 KiB)
            +- Relation default.web_site[web_site_sk#3351,web_site_id#3352,web_rec_start_date#3353,web_rec_end_date#3354,web_name#3355,web_open_date_sk#3356,web_close_date_sk#3357,web_class#3358,web_manager#3359,web_mkt_id#3360,web_mkt_class#3361,web_mkt_desc#3362,web_market_manager#3363,web_company_id#3364,web_company_name#3365,web_street_number#3366,web_street_name#3367,web_street_type#3368,web_suite_number#3369,web_city#3370,web_county#3371,web_state#3372,web_zip#3373,web_country#3374,web_gmt_offset#3375,web_tax_percentage#3376] parquet, Statistics(sizeInBytes=249.1 KiB)


==== q95 ====
== Optimized Logical Plan ==
Aggregate [count(distinct ws_order_number#20213) AS order count #20155L, MakeDecimal(sum(UnscaledValue(ws_ext_ship_cost#20224)),17,2) AS total shipping cost #20156, MakeDecimal(sum(UnscaledValue(ws_net_profit#20229)),17,2) AS total net profit #20157], Statistics(sizeInBytes=32.0 B, rowCount=1)
+- Project [ws_order_number#20213, ws_ext_ship_cost#20224, ws_net_profit#20229], Statistics(sizeInBytes=513.2 EiB)
   +- Join Inner, (ws_web_site_sk#20209 = web_site_sk#3351), Statistics(sizeInBytes=659.9 EiB)
      :- Project [ws_web_site_sk#20209, ws_order_number#20213, ws_ext_ship_cost#20224, ws_net_profit#20229], Statistics(sizeInBytes=86.6 PiB)
      :  +- Join Inner, (ws_ship_addr_sk#20207 = ca_address_sk#3717), Statistics(sizeInBytes=108.2 PiB)
      :     :- Project [ws_ship_addr_sk#20207, ws_web_site_sk#20209, ws_order_number#20213, ws_ext_ship_cost#20224, ws_net_profit#20229], Statistics(sizeInBytes=878.2 GiB)
      :     :  +- Join Inner, (ws_ship_date_sk#20198 = d_date_sk#24), Statistics(sizeInBytes=1073.3 GiB)
      :     :     :- Join LeftSemi, (ws_order_number#20213 = wr_order_number#3340), Statistics(sizeInBytes=10.2 MiB)
      :     :     :  :- Join LeftSemi, (ws_order_number#20213 = ws_order_number#180), Statistics(sizeInBytes=10.2 MiB)
      :     :     :  :  :- Project [ws_ship_date_sk#20198, ws_ship_addr_sk#20207, ws_web_site_sk#20209, ws_order_number#20213, ws_ext_ship_cost#20224, ws_net_profit#20229], Statistics(sizeInBytes=10.2 MiB)
      :     :     :  :  :  +- Filter ((isnotnull(ws_ship_date_sk#20198) AND isnotnull(ws_ship_addr_sk#20207)) AND isnotnull(ws_web_site_sk#20209)), Statistics(sizeInBytes=52.0 MiB)
      :     :     :  :  :     +- Relation default.web_sales[ws_sold_date_sk#20196,ws_sold_time_sk#20197,ws_ship_date_sk#20198,ws_item_sk#20199,ws_bill_customer_sk#20200,ws_bill_cdemo_sk#20201,ws_bill_hdemo_sk#20202,ws_bill_addr_sk#20203,ws_ship_customer_sk#20204,ws_ship_cdemo_sk#20205,ws_ship_hdemo_sk#20206,ws_ship_addr_sk#20207,ws_web_page_sk#20208,ws_web_site_sk#20209,ws_ship_mode_sk#20210,ws_warehouse_sk#20211,ws_promo_sk#20212,ws_order_number#20213,ws_quantity#20214,ws_wholesale_cost#20215,ws_list_price#20216,ws_sales_price#20217,ws_ext_discount_amt#20218,ws_ext_sales_price#20219,ws_ext_wholesale_cost#20220,ws_ext_list_price#20221,ws_ext_tax#20222,ws_coupon_amt#20223,ws_ext_ship_cost#20224,ws_net_paid#20225,ws_net_paid_inc_tax#20226,ws_net_paid_inc_ship#20227,ws_net_paid_inc_ship_tax#20228,ws_net_profit#20229] parquet, Statistics(sizeInBytes=52.0 MiB)
      :     :     :  :  +- Project [ws_order_number#180], Statistics(sizeInBytes=8.3 TiB)
      :     :     :  :     +- Join Inner, ((ws_order_number#180 = ws_order_number#20179) AND NOT (ws_warehouse_sk#178 = ws_warehouse_sk#20177)), Statistics(sizeInBytes=16.6 TiB)
      :     :     :  :        :- Project [ws_warehouse_sk#178, ws_order_number#180], Statistics(sizeInBytes=4.1 MiB)
      :     :     :  :        :  +- Filter (isnotnull(ws_order_number#180) AND isnotnull(ws_warehouse_sk#178)), Statistics(sizeInBytes=52.0 MiB)
      :     :     :  :        :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
      :     :     :  :        +- Project [ws_warehouse_sk#20177, ws_order_number#20179], Statistics(sizeInBytes=4.1 MiB)
      :     :     :  :           +- Filter (isnotnull(ws_order_number#20179) AND isnotnull(ws_warehouse_sk#20177)), Statistics(sizeInBytes=52.0 MiB)
      :     :     :  :              +- Relation default.web_sales[ws_sold_date_sk#20162,ws_sold_time_sk#20163,ws_ship_date_sk#20164,ws_item_sk#20165,ws_bill_customer_sk#20166,ws_bill_cdemo_sk#20167,ws_bill_hdemo_sk#20168,ws_bill_addr_sk#20169,ws_ship_customer_sk#20170,ws_ship_cdemo_sk#20171,ws_ship_hdemo_sk#20172,ws_ship_addr_sk#20173,ws_web_page_sk#20174,ws_web_site_sk#20175,ws_ship_mode_sk#20176,ws_warehouse_sk#20177,ws_promo_sk#20178,ws_order_number#20179,ws_quantity#20180,ws_wholesale_cost#20181,ws_list_price#20182,ws_sales_price#20183,ws_ext_discount_amt#20184,ws_ext_sales_price#20185,ws_ext_wholesale_cost#20186,ws_ext_list_price#20187,ws_ext_tax#20188,ws_coupon_amt#20189,ws_ext_ship_cost#20190,ws_net_paid#20191,ws_net_paid_inc_tax#20192,ws_net_paid_inc_ship#20193,ws_net_paid_inc_ship_tax#20194,ws_net_profit#20195] parquet, Statistics(sizeInBytes=52.0 MiB)
      :     :     :  +- Project [wr_order_number#3340], Statistics(sizeInBytes=3.5 EiB)
      :     :     :     +- Join Inner, (wr_order_number#3340 = ws_order_number#180), Statistics(sizeInBytes=4.6 EiB)
      :     :     :        :- Project [wr_order_number#3340], Statistics(sizeInBytes=570.5 KiB)
      :     :     :        :  +- Filter isnotnull(wr_order_number#3340), Statistics(sizeInBytes=6.5 MiB)
      :     :     :        :     +- Relation default.web_returns[wr_returned_date_sk#3327,wr_returned_time_sk#3328,wr_item_sk#3329,wr_refunded_customer_sk#3330,wr_refunded_cdemo_sk#3331,wr_refunded_hdemo_sk#3332,wr_refunded_addr_sk#3333,wr_returning_customer_sk#3334,wr_returning_cdemo_sk#3335,wr_returning_hdemo_sk#3336,wr_returning_addr_sk#3337,wr_web_page_sk#3338,wr_reason_sk#3339,wr_order_number#3340,wr_return_quantity#3341,wr_return_amt#3342,wr_return_tax#3343,wr_return_amt_inc_tax#3344,wr_fee#3345,wr_return_ship_cost#3346,wr_refunded_cash#3347,wr_reversed_charge#3348,wr_account_credit#3349,wr_net_loss#3350] parquet, Statistics(sizeInBytes=6.5 MiB)
      :     :     :        +- Project [ws_order_number#180], Statistics(sizeInBytes=8.3 TiB)
      :     :     :           +- Join Inner, ((ws_order_number#180 = ws_order_number#20179) AND NOT (ws_warehouse_sk#178 = ws_warehouse_sk#20177)), Statistics(sizeInBytes=16.6 TiB)
      :     :     :              :- Project [ws_warehouse_sk#178, ws_order_number#180], Statistics(sizeInBytes=4.1 MiB)
      :     :     :              :  +- Filter (isnotnull(ws_order_number#180) AND isnotnull(ws_warehouse_sk#178)), Statistics(sizeInBytes=52.0 MiB)
      :     :     :              :     +- Relation default.web_sales[ws_sold_date_sk#163,ws_sold_time_sk#164,ws_ship_date_sk#165,ws_item_sk#166,ws_bill_customer_sk#167,ws_bill_cdemo_sk#168,ws_bill_hdemo_sk#169,ws_bill_addr_sk#170,ws_ship_customer_sk#171,ws_ship_cdemo_sk#172,ws_ship_hdemo_sk#173,ws_ship_addr_sk#174,ws_web_page_sk#175,ws_web_site_sk#176,ws_ship_mode_sk#177,ws_warehouse_sk#178,ws_promo_sk#179,ws_order_number#180,ws_quantity#181,ws_wholesale_cost#182,ws_list_price#183,ws_sales_price#184,ws_ext_discount_amt#185,ws_ext_sales_price#186,ws_ext_wholesale_cost#187,ws_ext_list_price#188,ws_ext_tax#189,ws_coupon_amt#190,ws_ext_ship_cost#191,ws_net_paid#192,ws_net_paid_inc_tax#193,ws_net_paid_inc_ship#194,ws_net_paid_inc_ship_tax#195,ws_net_profit#196] parquet, Statistics(sizeInBytes=52.0 MiB)
      :     :     :              +- Project [ws_warehouse_sk#20177, ws_order_number#20179], Statistics(sizeInBytes=4.1 MiB)
      :     :     :                 +- Filter (isnotnull(ws_order_number#20179) AND isnotnull(ws_warehouse_sk#20177)), Statistics(sizeInBytes=52.0 MiB)
      :     :     :                    +- Relation default.web_sales[ws_sold_date_sk#20162,ws_sold_time_sk#20163,ws_ship_date_sk#20164,ws_item_sk#20165,ws_bill_customer_sk#20166,ws_bill_cdemo_sk#20167,ws_bill_hdemo_sk#20168,ws_bill_addr_sk#20169,ws_ship_customer_sk#20170,ws_ship_cdemo_sk#20171,ws_ship_hdemo_sk#20172,ws_ship_addr_sk#20173,ws_web_page_sk#20174,ws_web_site_sk#20175,ws_ship_mode_sk#20176,ws_warehouse_sk#20177,ws_promo_sk#20178,ws_order_number#20179,ws_quantity#20180,ws_wholesale_cost#20181,ws_list_price#20182,ws_sales_price#20183,ws_ext_discount_amt#20184,ws_ext_sales_price#20185,ws_ext_wholesale_cost#20186,ws_ext_list_price#20187,ws_ext_tax#20188,ws_coupon_amt#20189,ws_ext_ship_cost#20190,ws_net_paid#20191,ws_net_paid_inc_tax#20192,ws_net_paid_inc_ship#20193,ws_net_paid_inc_ship_tax#20194,ws_net_profit#20195] parquet, Statistics(sizeInBytes=52.0 MiB)
      :     :     +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
      :     :        +- Filter ((isnotnull(d_date#26) AND ((d_date#26 >= 1999-02-01) AND (d_date#26 <= 1999-04-02))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
      :     :           +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
      :     +- Project [ca_address_sk#3717], Statistics(sizeInBytes=126.2 KiB)
      :        +- Filter ((isnotnull(ca_state#3725) AND (ca_state#3725 = IL)) AND isnotnull(ca_address_sk#3717)), Statistics(sizeInBytes=2.5 MiB)
      :           +- Relation default.customer_address[ca_address_sk#3717,ca_address_id#3718,ca_street_number#3719,ca_street_name#3720,ca_street_type#3721,ca_suite_number#3722,ca_city#3723,ca_county#3724,ca_state#3725,ca_zip#3726,ca_country#3727,ca_gmt_offset#3728,ca_location_type#3729] parquet, Statistics(sizeInBytes=2.5 MiB)
      +- Project [web_site_sk#3351], Statistics(sizeInBytes=7.6 KiB)
         +- Filter ((isnotnull(web_company_name#3365) AND (web_company_name#3365 = pri                                               )) AND isnotnull(web_site_sk#3351)), Statistics(sizeInBytes=249.1 KiB)
            +- Relation default.web_site[web_site_sk#3351,web_site_id#3352,web_rec_start_date#3353,web_rec_end_date#3354,web_name#3355,web_open_date_sk#3356,web_close_date_sk#3357,web_class#3358,web_manager#3359,web_mkt_id#3360,web_mkt_class#3361,web_mkt_desc#3362,web_market_manager#3363,web_company_id#3364,web_company_name#3365,web_street_number#3366,web_street_name#3367,web_street_type#3368,web_suite_number#3369,web_city#3370,web_county#3371,web_state#3372,web_zip#3373,web_country#3374,web_gmt_offset#3375,web_tax_percentage#3376] parquet, Statistics(sizeInBytes=249.1 KiB)


==== q96 ====
== Optimized Logical Plan ==
Aggregate [count(1) AS count(1)#20341L], Statistics(sizeInBytes=16.0 B, rowCount=1)
+- Project, Statistics(sizeInBytes=85.5 EiB)
   +- Join Inner, (ss_store_sk#421 = s_store_sk#52), Statistics(sizeInBytes=170.9 EiB)
      :- Project [ss_store_sk#421], Statistics(sizeInBytes=58.8 PiB)
      :  +- Join Inner, (ss_sold_time_sk#415 = t_time_sk#15927), Statistics(sizeInBytes=98.1 PiB)
      :     :- Project [ss_sold_time_sk#415, ss_store_sk#421], Statistics(sizeInBytes=737.4 GiB)
      :     :  +- Join Inner, (ss_hdemo_sk#419 = hd_demo_sk#5551), Statistics(sizeInBytes=1106.2 GiB)
      :     :     :- Project [ss_sold_time_sk#415, ss_hdemo_sk#419, ss_store_sk#421], Statistics(sizeInBytes=19.1 MiB)
      :     :     :  +- Filter (isnotnull(ss_hdemo_sk#419) AND (isnotnull(ss_sold_time_sk#415) AND isnotnull(ss_store_sk#421))), Statistics(sizeInBytes=141.1 MiB)
      :     :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
      :     :     +- Project [hd_demo_sk#5551], Statistics(sizeInBytes=58.0 KiB)
      :     :        +- Filter ((isnotnull(hd_dep_count#5554) AND (hd_dep_count#5554 = 7)) AND isnotnull(hd_demo_sk#5551)), Statistics(sizeInBytes=212.8 KiB)
      :     :           +- Relation default.household_demographics[hd_demo_sk#5551,hd_income_band_sk#5552,hd_buy_potential#5553,hd_dep_count#5554,hd_vehicle_count#5555] parquet, Statistics(sizeInBytes=212.8 KiB)
      :     +- Project [t_time_sk#15927], Statistics(sizeInBytes=136.2 KiB)
      :        +- Filter (((isnotnull(t_hour#15930) AND isnotnull(t_minute#15931)) AND ((t_hour#15930 = 20) AND (t_minute#15931 >= 30))) AND isnotnull(t_time_sk#15927)), Statistics(sizeInBytes=1452.6 KiB)
      :           +- Relation default.time_dim[t_time_sk#15927,t_time_id#15928,t_time#15929,t_hour#15930,t_minute#15931,t_second#15932,t_am_pm#15933,t_shift#15934,t_sub_shift#15935,t_meal_time#15936] parquet, Statistics(sizeInBytes=1452.6 KiB)
      +- Project [s_store_sk#52], Statistics(sizeInBytes=2.9 KiB)
         +- Filter ((isnotnull(s_store_name#57) AND (s_store_name#57 = ese)) AND isnotnull(s_store_sk#52)), Statistics(sizeInBytes=101.7 KiB)
            +- Relation default.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,s_state#76,s_zip#77,s_country#78,s_gmt_offset#79,s_tax_percentage#80] parquet, Statistics(sizeInBytes=101.7 KiB)


==== q97 ====
== Optimized Logical Plan ==
Aggregate [sum(CASE WHEN (isnotnull(customer_sk#20348) AND isnull(customer_sk#20350)) THEN 1 ELSE 0 END) AS store_only#20345L, sum(CASE WHEN (isnull(customer_sk#20348) AND isnotnull(customer_sk#20350)) THEN 1 ELSE 0 END) AS catalog_only#20346L, sum(CASE WHEN (isnotnull(customer_sk#20348) AND isnotnull(customer_sk#20350)) THEN 1 ELSE 0 END) AS store_and_catalog#20347L], Statistics(sizeInBytes=32.0 B, rowCount=1)
+- Project [customer_sk#20348, customer_sk#20350], Statistics(sizeInBytes=7.49E+23 B)
   +- Join FullOuter, ((customer_sk#20348 = customer_sk#20350) AND (item_sk#20349 = item_sk#20351)), Statistics(sizeInBytes=1.12E+24 B)
      :- Aggregate [ss_customer_sk#417, ss_item_sk#416], [ss_customer_sk#417 AS customer_sk#20348, ss_item_sk#416 AS item_sk#20349], Statistics(sizeInBytes=1338.3 GiB)
      :  +- Project [ss_item_sk#416, ss_customer_sk#417], Statistics(sizeInBytes=1338.3 GiB)
      :     +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2007.5 GiB)
      :        :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_customer_sk#417], Statistics(sizeInBytes=19.1 MiB)
      :        :  +- Filter isnotnull(ss_sold_date_sk#414), Statistics(sizeInBytes=141.1 MiB)
      :        :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
      :        +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
      :           +- Filter ((isnotnull(d_month_seq#27) AND ((d_month_seq#27 >= 1200) AND (d_month_seq#27 <= 1211))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
      :              +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
      +- Aggregate [cs_bill_customer_sk#200, cs_item_sk#212], [cs_bill_customer_sk#200 AS customer_sk#20350, cs_item_sk#212 AS item_sk#20351], Statistics(sizeInBytes=728.3 GiB)
         +- Project [cs_bill_customer_sk#200, cs_item_sk#212], Statistics(sizeInBytes=728.3 GiB)
            +- Join Inner, (cs_sold_date_sk#197 = d_date_sk#20352), Statistics(sizeInBytes=1092.5 GiB)
               :- Project [cs_sold_date_sk#197, cs_bill_customer_sk#200, cs_item_sk#212], Statistics(sizeInBytes=10.4 MiB)
               :  +- Filter isnotnull(cs_sold_date_sk#197), Statistics(sizeInBytes=105.8 MiB)
               :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
               +- Project [d_date_sk#20352], Statistics(sizeInBytes=105.3 KiB)
                  +- Filter ((isnotnull(d_month_seq#20355) AND ((d_month_seq#20355 >= 1200) AND (d_month_seq#20355 <= 1211))) AND isnotnull(d_date_sk#20352)), Statistics(sizeInBytes=2.5 MiB)
                     +- Relation default.date_dim[d_date_sk#20352,d_date_id#20353,d_date#20354,d_month_seq#20355,d_week_seq#20356,d_quarter_seq#20357,d_year#20358,d_dow#20359,d_moy#20360,d_dom#20361,d_qoy#20362,d_fy_year#20363,d_fy_quarter_seq#20364,d_fy_week_seq#20365,d_day_name#20366,d_quarter_name#20367,d_holiday#20368,d_weekend#20369,d_following_holiday#20370,d_first_dom#20371,d_last_dom#20372,d_same_day_ly#20373,d_same_day_lq#20374,d_current_day#20375,d_current_week#20376,d_current_month#20377,d_current_quarter#20378,d_current_year#20379] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q98 ====
== Optimized Logical Plan ==
Project [i_item_desc#441, i_category#449, i_class#447, i_current_price#442, itemrevenue#20405, revenueratio#20406], Statistics(sizeInBytes=2.0 EiB)
+- Sort [i_category#449 ASC NULLS FIRST, i_class#447 ASC NULLS FIRST, i_item_id#438 ASC NULLS FIRST, i_item_desc#441 ASC NULLS FIRST, revenueratio#20406 ASC NULLS FIRST], true, Statistics(sizeInBytes=2.5 EiB)
   +- Project [i_item_desc#441, i_category#449, i_class#447, i_current_price#442, itemrevenue#20405, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(_w0#20411) * 100.00), DecimalType(21,2)) as decimal(27,2))) / promote_precision(_we0#20413)), DecimalType(38,17)) AS revenueratio#20406, i_item_id#438], Statistics(sizeInBytes=2.5 EiB)
      +- Window [sum(_w1#20412) windowspecdefinition(i_class#447, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#20413], [i_class#447], Statistics(sizeInBytes=2.8 EiB)
         +- Aggregate [i_item_id#438, i_item_desc#441, i_category#449, i_class#447, i_current_price#442], [i_item_desc#441, i_category#449, i_class#447, i_current_price#442, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS itemrevenue#20405, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS _w0#20411, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#429)),17,2) AS _w1#20412, i_item_id#438], Statistics(sizeInBytes=2.5 EiB)
            +- Project [ss_ext_sales_price#429, i_item_id#438, i_item_desc#441, i_current_price#442, i_class#447, i_category#449], Statistics(sizeInBytes=2.1 EiB)
               +- Join Inner, (ss_sold_date_sk#414 = d_date_sk#24), Statistics(sizeInBytes=2.3 EiB)
                  :- Project [ss_sold_date_sk#414, ss_ext_sales_price#429, i_item_id#438, i_item_desc#441, i_current_price#442, i_class#447, i_category#449], Statistics(sizeInBytes=22.2 TiB)
                  :  +- Join Inner, (ss_item_sk#416 = i_item_sk#437), Statistics(sizeInBytes=23.9 TiB)
                  :     :- Project [ss_sold_date_sk#414, ss_item_sk#416, ss_ext_sales_price#429], Statistics(sizeInBytes=22.9 MiB)
                  :     :  +- Filter (isnotnull(ss_item_sk#416) AND isnotnull(ss_sold_date_sk#414)), Statistics(sizeInBytes=141.1 MiB)
                  :     :     +- Relation default.store_sales[ss_sold_date_sk#414,ss_sold_time_sk#415,ss_item_sk#416,ss_customer_sk#417,ss_cdemo_sk#418,ss_hdemo_sk#419,ss_addr_sk#420,ss_store_sk#421,ss_promo_sk#422,ss_ticket_number#423,ss_quantity#424,ss_wholesale_cost#425,ss_list_price#426,ss_sales_price#427,ss_ext_discount_amt#428,ss_ext_sales_price#429,ss_ext_wholesale_cost#430,ss_ext_list_price#431,ss_ext_tax#432,ss_coupon_amt#433,ss_net_paid#434,ss_net_paid_inc_tax#435,ss_net_profit#436] parquet, Statistics(sizeInBytes=141.1 MiB)
                  :     +- Project [i_item_sk#437, i_item_id#438, i_item_desc#441, i_current_price#442, i_class#447, i_category#449], Statistics(sizeInBytes=1069.6 KiB)
                  :        +- Filter (i_category#449 IN (Sports                                            ,Books                                             ,Home                                              ) AND isnotnull(i_item_sk#437)), Statistics(sizeInBytes=3.1 MiB)
                  :           +- Relation default.item[i_item_sk#437,i_item_id#438,i_rec_start_date#439,i_rec_end_date#440,i_item_desc#441,i_current_price#442,i_wholesale_cost#443,i_brand_id#444,i_brand#445,i_class_id#446,i_class#447,i_category_id#448,i_category#449,i_manufact_id#450,i_manufact#451,i_size#452,i_formulation#453,i_color#454,i_units#455,i_container#456,i_manager_id#457,i_product_name#458] parquet, Statistics(sizeInBytes=3.1 MiB)
                  +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                     +- Filter ((isnotnull(d_date#26) AND ((d_date#26 >= 1999-02-22) AND (d_date#26 <= 1999-03-24))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                        +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)


==== q99 ====
== Optimized Logical Plan ==
GlobalLimit 100, Statistics(sizeInBytes=10.5 KiB, rowCount=100)
+- LocalLimit 100, Statistics(sizeInBytes=2.33E+23 B)
   +- Sort [substr(w_warehouse_name, 1, 20)#20440 ASC NULLS FIRST, sm_type#15683 ASC NULLS FIRST, cc_name#7114 ASC NULLS FIRST], true, Statistics(sizeInBytes=2.33E+23 B)
      +- Aggregate [_groupingexpression#20449, sm_type#15683, cc_name#7114], [_groupingexpression#20449 AS substr(w_warehouse_name, 1, 20)#20440, sm_type#15683, cc_name#7114, sum(CASE WHEN ((cs_ship_date_sk#199 - cs_sold_date_sk#197) <= 30) THEN 1 ELSE 0 END) AS 30 days #20430L, sum(CASE WHEN (((cs_ship_date_sk#199 - cs_sold_date_sk#197) > 30) AND ((cs_ship_date_sk#199 - cs_sold_date_sk#197) <= 60)) THEN 1 ELSE 0 END) AS 31 - 60 days #20431L, sum(CASE WHEN (((cs_ship_date_sk#199 - cs_sold_date_sk#197) > 60) AND ((cs_ship_date_sk#199 - cs_sold_date_sk#197) <= 90)) THEN 1 ELSE 0 END) AS 61 - 90 days #20432L, sum(CASE WHEN (((cs_ship_date_sk#199 - cs_sold_date_sk#197) > 90) AND ((cs_ship_date_sk#199 - cs_sold_date_sk#197) <= 120)) THEN 1 ELSE 0 END) AS 91 - 120 days #20433L, sum(CASE WHEN ((cs_ship_date_sk#199 - cs_sold_date_sk#197) > 120) THEN 1 ELSE 0 END) AS >120 days #20434L], Statistics(sizeInBytes=2.33E+23 B)
         +- Project [cs_sold_date_sk#197, cs_ship_date_sk#199, sm_type#15683, cc_name#7114, substr(w_warehouse_name#8011, 1, 20) AS _groupingexpression#20449], Statistics(sizeInBytes=1.64E+23 B)
            +- Join Inner, (cs_ship_date_sk#199 = d_date_sk#24), Statistics(sizeInBytes=1.73E+23 B)
               :- Project [cs_sold_date_sk#197, cs_ship_date_sk#199, w_warehouse_name#8011, sm_type#15683, cc_name#7114], Statistics(sizeInBytes=1422.2 PiB)
               :  +- Join Inner, (cs_call_center_sk#208 = cc_call_center_sk#7108), Statistics(sizeInBytes=1571.9 PiB)
               :     :- Project [cs_sold_date_sk#197, cs_ship_date_sk#199, cs_call_center_sk#208, w_warehouse_name#8011, sm_type#15683], Statistics(sizeInBytes=374.5 TiB)
               :     :  +- Join Inner, (cs_ship_mode_sk#210 = sm_ship_mode_sk#15681), Statistics(sizeInBytes=424.4 TiB)
               :     :     :- Project [cs_sold_date_sk#197, cs_ship_date_sk#199, cs_call_center_sk#208, cs_ship_mode_sk#210, w_warehouse_name#8011], Statistics(sizeInBytes=33.7 GiB)
               :     :     :  +- Join Inner, (cs_warehouse_sk#211 = w_warehouse_sk#8009), Statistics(sizeInBytes=39.8 GiB)
               :     :     :     :- Project [cs_sold_date_sk#197, cs_ship_date_sk#199, cs_call_center_sk#208, cs_ship_mode_sk#210, cs_warehouse_sk#211], Statistics(sizeInBytes=14.5 MiB)
               :     :     :     :  +- Filter ((isnotnull(cs_warehouse_sk#211) AND isnotnull(cs_ship_mode_sk#210)) AND (isnotnull(cs_call_center_sk#208) AND isnotnull(cs_ship_date_sk#199))), Statistics(sizeInBytes=105.8 MiB)
               :     :     :     :     +- Relation default.catalog_sales[cs_sold_date_sk#197,cs_sold_time_sk#198,cs_ship_date_sk#199,cs_bill_customer_sk#200,cs_bill_cdemo_sk#201,cs_bill_hdemo_sk#202,cs_bill_addr_sk#203,cs_ship_customer_sk#204,cs_ship_cdemo_sk#205,cs_ship_hdemo_sk#206,cs_ship_addr_sk#207,cs_call_center_sk#208,cs_catalog_page_sk#209,cs_ship_mode_sk#210,cs_warehouse_sk#211,cs_item_sk#212,cs_promo_sk#213,cs_order_number#214,cs_quantity#215,cs_wholesale_cost#216,cs_list_price#217,cs_sales_price#218,cs_ext_discount_amt#219,cs_ext_sales_price#220,cs_ext_wholesale_cost#221,cs_ext_list_price#222,cs_ext_tax#223,cs_coupon_amt#224,cs_ext_ship_cost#225,cs_net_paid#226,cs_net_paid_inc_tax#227,cs_net_paid_inc_ship#228,cs_net_paid_inc_ship_tax#229,cs_net_profit#230] parquet, Statistics(sizeInBytes=105.8 MiB)
               :     :     :     +- Project [w_warehouse_sk#8009, w_warehouse_name#8011], Statistics(sizeInBytes=2.7 KiB)
               :     :     :        +- Filter isnotnull(w_warehouse_sk#8009), Statistics(sizeInBytes=20.9 KiB)
               :     :     :           +- Relation default.warehouse[w_warehouse_sk#8009,w_warehouse_id#8010,w_warehouse_name#8011,w_warehouse_sq_ft#8012,w_street_number#8013,w_street_name#8014,w_street_type#8015,w_suite_number#8016,w_city#8017,w_county#8018,w_state#8019,w_zip#8020,w_country#8021,w_gmt_offset#8022] parquet, Statistics(sizeInBytes=20.9 KiB)
               :     :     +- Project [sm_ship_mode_sk#15681, sm_type#15683], Statistics(sizeInBytes=12.6 KiB)
               :     :        +- Filter isnotnull(sm_ship_mode_sk#15681), Statistics(sizeInBytes=44.1 KiB)
               :     :           +- Relation default.ship_mode[sm_ship_mode_sk#15681,sm_ship_mode_id#15682,sm_type#15683,sm_code#15684,sm_carrier#15685,sm_contract#15686] parquet, Statistics(sizeInBytes=44.1 KiB)
               :     +- Project [cc_call_center_sk#7108, cc_name#7114], Statistics(sizeInBytes=4.2 KiB)
               :        +- Filter isnotnull(cc_call_center_sk#7108), Statistics(sizeInBytes=58.2 KiB)
               :           +- Relation default.call_center[cc_call_center_sk#7108,cc_call_center_id#7109,cc_rec_start_date#7110,cc_rec_end_date#7111,cc_closed_date_sk#7112,cc_open_date_sk#7113,cc_name#7114,cc_class#7115,cc_employees#7116,cc_sq_ft#7117,cc_hours#7118,cc_manager#7119,cc_mkt_id#7120,cc_mkt_class#7121,cc_mkt_desc#7122,cc_market_manager#7123,cc_division#7124,cc_division_name#7125,cc_company#7126,cc_company_name#7127,cc_street_number#7128,cc_street_name#7129,cc_street_type#7130,cc_suite_number#7131,cc_city#7132,cc_county#7133,cc_state#7134,cc_zip#7135,cc_country#7136,cc_gmt_offset#7137,cc_tax_percentage#7138] parquet, Statistics(sizeInBytes=58.2 KiB)
               +- Project [d_date_sk#24], Statistics(sizeInBytes=105.3 KiB)
                  +- Filter ((isnotnull(d_month_seq#27) AND ((d_month_seq#27 >= 1200) AND (d_month_seq#27 <= 1211))) AND isnotnull(d_date_sk#24)), Statistics(sizeInBytes=2.5 MiB)
                     +- Relation default.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,d_current_week#48,d_current_month#49,d_current_quarter#50,d_current_year#51] parquet, Statistics(sizeInBytes=2.5 MiB)
